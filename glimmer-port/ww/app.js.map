{"version":3,"file":"app.js","sources":["../../node_modules/@glimmer/util/dist/modules/es2017/lib/platform-utils.js","../../node_modules/@glimmer/util/dist/modules/es2017/lib/assert.js","../../node_modules/@glimmer/util/dist/modules/es2017/lib/object-utils.js","../../node_modules/@glimmer/util/dist/modules/es2017/lib/guid.js","../../node_modules/@glimmer/util/dist/modules/es2017/lib/collections.js","../../node_modules/@glimmer/util/dist/modules/es2017/lib/list-utils.js","../../node_modules/@glimmer/util/dist/modules/es2017/lib/array-utils.js","../../node_modules/@glimmer/reference/dist/modules/es2017/lib/validators.js","../../node_modules/@glimmer/reference/dist/modules/es2017/lib/const.js","../../node_modules/@glimmer/reference/dist/modules/es2017/lib/iterable.js","../../node_modules/@glimmer/component/packages/@glimmer/component/src/tracked.ts","../../node_modules/@glimmer/component/packages/@glimmer/component/src/component-definition.ts","../../node_modules/@glimmer/di/dist/modules/es2017/src/container.ts","../../node_modules/@glimmer/di/dist/modules/es2017/src/registry.ts","../../node_modules/@glimmer/di/dist/modules/es2017/src/owner.ts","../../node_modules/@glimmer/component/packages/@glimmer/component/src/bounds.ts","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/opcodes.js","../../node_modules/@glimmer/vm/dist/modules/es2017/lib/registers.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/references.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/compiled/expressions/concat.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/compiled/opcodes/assert.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/compiled/opcodes/expressions.js","../../node_modules/@glimmer/wire-format/dist/modules/es2017/lib/opcodes.js","../../node_modules/@glimmer/wire-format/dist/modules/es2017/index.js","../../node_modules/@glimmer/opcode-compiler/dist/modules/es2017/lib/client-side.js","../../node_modules/@glimmer/opcode-compiler/dist/modules/es2017/lib/syntax.js","../../node_modules/@glimmer/opcode-compiler/dist/modules/es2017/lib/compilable-template.js","../../node_modules/@glimmer/opcode-compiler/dist/modules/es2017/lib/wrapped-component.js","../../node_modules/@glimmer/encoder/dist/modules/es2017/lib/encoder.js","../../node_modules/@glimmer/opcode-compiler/dist/modules/es2017/lib/opcode-builder.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/vm/arguments.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/component/curried-component.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/compiled/opcodes/content.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/compiled/opcodes/vm.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/compiled/opcodes/dom.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/component/resolve.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/component/interfaces.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/references/curry-component.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/dom/normalize.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/references/class-list.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/compiled/opcodes/component.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/compiled/opcodes/debugger.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/compiled/opcodes/partial.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/compiled/opcodes/lists.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/bounds.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/compat/svg-inner-html-fix.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/compat/text-node-merging-fix.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/dom/helper.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/dom/sanitized-values.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/dom/props.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/vm/attributes/dynamic.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/environment.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/vm/content/dynamic.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/vm/content/text.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/vm/content/node.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/vm/content/html.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/vm/element-builder.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/vm/update.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/vm/render-result.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/vm/append.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/template.js","../../node_modules/@glimmer/runtime/dist/modules/es2017/lib/vm/rehydrate-builder.js","../../node_modules/@glimmer/component/packages/@glimmer/component/src/references.ts","../../node_modules/@glimmer/component/packages/@glimmer/component/src/component-manager.ts","../../node_modules/@glimmer/object-reference/dist/modules/es2017/lib/utils.js","../../node_modules/@glimmer/object-reference/dist/modules/es2017/lib/references/path.js","../../node_modules/@glimmer/object-reference/dist/modules/es2017/lib/references/root.js","../../node_modules/@glimmer/object-reference/dist/modules/es2017/lib/meta.js","../../node_modules/@glimmer/object-reference/dist/modules/es2017/lib/references/descriptors.js","../../node_modules/@glimmer/object-reference/dist/modules/es2017/lib/object.js","../../node_modules/@glimmer/application/packages/@glimmer/application/src/application-registry.ts","../../node_modules/@glimmer/application/packages/@glimmer/application/src/dynamic-scope.ts","../../node_modules/@glimmer/application/packages/@glimmer/application/src/iterable.ts","../../node_modules/@glimmer/program/dist/modules/es2017/lib/constants.js","../../node_modules/@glimmer/program/dist/modules/es2017/lib/opcode.js","../../node_modules/@glimmer/program/dist/modules/es2017/lib/program.js","../../node_modules/@glimmer/application/packages/@glimmer/application/src/helpers/action.ts","../../node_modules/@glimmer/application/packages/@glimmer/application/src/typed-registry.ts","../../node_modules/@glimmer/application/packages/@glimmer/application/src/runtime-resolver.ts","../../node_modules/@glimmer/application/dist/modules/es2017/src/templates/main.js","../../node_modules/@glimmer/application/packages/@glimmer/application/src/environment.ts","../../node_modules/@glimmer/application/packages/@glimmer/application/src/application.ts","../../node_modules/@glimmer/resolver/node_modules/@glimmer/di/dist/modules/es2017/src/owner.ts","../../node_modules/@glimmer/resolver/node_modules/@glimmer/di/dist/modules/es2017/src/specifier.ts","../../node_modules/@glimmer/resolver/dist/modules/es2017/src/utils/debug.ts","../../node_modules/@glimmer/resolver/dist/modules/es2017/src/utils/specifiers.ts","../../node_modules/@glimmer/resolver/dist/modules/es2017/src/resolver.ts","src/ui/components/SierpinskiDot/component.ts","src/ui/components/SierpinskiDot/template.ts","src/ui/components/SierpinskiGlimmer/component.ts","src/ui/components/SierpinskiGlimmer/template.ts","src/ui/components/SierpinskiTriangle/component.ts","src/ui/components/SierpinskiTriangle/template.ts","config/module-map.js","config/resolver-configuration.js","src/main.ts","src/index.ts"],"sourcesContent":["export function unwrap(val) {\n    if (val === null || val === undefined) throw new Error(`Expected value to be present`);\n    return val;\n}\nexport function expect(val, message) {\n    if (val === null || val === undefined) throw new Error(message);\n    return val;\n}\nexport function unreachable(message = \"unreachable\") {\n    return new Error(message);\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGxhdGZvcm0tdXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci91dGlsL2xpYi9wbGF0Zm9ybS11dGlscy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFNQSxBQUFNLHVCQUFvQixBQUFhO0FBQ3JDLEFBQUUsQUFBQyxRQUFDLEFBQUcsUUFBSyxBQUFJLFFBQUksQUFBRyxRQUFLLEFBQVMsQUFBQyxXQUFDLE1BQU0sSUFBSSxBQUFLLEFBQUMsTUFBOEIsQUFBQyxBQUFDO0FBQ3ZGLEFBQU0sV0FBQyxBQUFRLEFBQUMsQUFDbEI7QUFBQztBQUVELEFBQU0sdUJBQW9CLEFBQWEsS0FBRSxBQUFlO0FBQ3RELEFBQUUsQUFBQyxRQUFDLEFBQUcsUUFBSyxBQUFJLFFBQUksQUFBRyxRQUFLLEFBQVMsQUFBQyxXQUFDLE1BQU0sSUFBSSxBQUFLLE1BQUMsQUFBTyxBQUFDLEFBQUM7QUFDaEUsQUFBTSxXQUFDLEFBQVEsQUFBQyxBQUNsQjtBQUFDO0FBRUQsQUFBTSw0QkFBc0IsQUFBTyxVQUFHLEFBQWE7QUFDakQsQUFBTSxXQUFDLElBQUksQUFBSyxNQUFDLEFBQU8sQUFBQyxBQUFDLEFBQzVCO0FBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgdHlwZSBPcGFxdWUgPSB7fSB8IHZvaWQgfCBudWxsIHwgdW5kZWZpbmVkO1xuZXhwb3J0IHR5cGUgT3B0aW9uPFQ+ID0gVCB8IG51bGw7XG5leHBvcnQgdHlwZSBNYXliZTxUPiA9IE9wdGlvbjxUPiB8IHVuZGVmaW5lZCB8IHZvaWQ7XG5cbmV4cG9ydCB0eXBlIEZhY3Rvcnk8VD4gPSBuZXcgKC4uLmFyZ3M6IE9wYXF1ZVtdKSA9PiBUO1xuXG5leHBvcnQgZnVuY3Rpb24gdW53cmFwPFQ+KHZhbDogTWF5YmU8VD4pOiBUIHtcbiAgaWYgKHZhbCA9PT0gbnVsbCB8fCB2YWwgPT09IHVuZGVmaW5lZCkgdGhyb3cgbmV3IEVycm9yKGBFeHBlY3RlZCB2YWx1ZSB0byBiZSBwcmVzZW50YCk7XG4gIHJldHVybiB2YWwgYXMgVDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGV4cGVjdDxUPih2YWw6IE1heWJlPFQ+LCBtZXNzYWdlOiBzdHJpbmcpOiBUIHtcbiAgaWYgKHZhbCA9PT0gbnVsbCB8fCB2YWwgPT09IHVuZGVmaW5lZCkgdGhyb3cgbmV3IEVycm9yKG1lc3NhZ2UpO1xuICByZXR1cm4gdmFsIGFzIFQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1bnJlYWNoYWJsZShtZXNzYWdlID0gXCJ1bnJlYWNoYWJsZVwiKTogRXJyb3Ige1xuICByZXR1cm4gbmV3IEVycm9yKG1lc3NhZ2UpO1xufVxuIl19","// import Logger from './logger';\n// let alreadyWarned = false;\nexport function debugAssert(test, msg) {\n    // if (!alreadyWarned) {\n    //   alreadyWarned = true;\n    //   Logger.warn(\"Don't leave debug assertions on in public builds\");\n    // }\n    if (!test) {\n        throw new Error(msg || \"assertion failure\");\n    }\n}\nexport function prodAssert() {}\nexport default debugAssert;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXNzZXJ0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcGFja2FnZXMvQGdsaW1tZXIvdXRpbC9saWIvYXNzZXJ0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLEFBQWlDO0FBRWpDLEFBQTZCO0FBRTdCLEFBQU0sNEJBQXNCLEFBQVMsTUFBRSxBQUFXO0FBQ2hELEFBQXdCO0FBQ3hCLEFBQTBCO0FBQzFCLEFBQXFFO0FBQ3JFLEFBQUk7QUFFSixBQUFFLEFBQUMsUUFBQyxDQUFDLEFBQUksQUFBQyxNQUFDLEFBQUM7QUFDVixjQUFNLElBQUksQUFBSyxNQUFDLEFBQUcsT0FBSSxBQUFtQixBQUFDLEFBQUMsQUFDOUM7QUFBQyxBQUNIO0FBQUM7QUFFRCxBQUFNLDZCQUF3QixDQUFDO0FBRS9CLGVBQWUsQUFBVyxBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gaW1wb3J0IExvZ2dlciBmcm9tICcuL2xvZ2dlcic7XG5cbi8vIGxldCBhbHJlYWR5V2FybmVkID0gZmFsc2U7XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWJ1Z0Fzc2VydCh0ZXN0OiBhbnksIG1zZzogc3RyaW5nKSB7XG4gIC8vIGlmICghYWxyZWFkeVdhcm5lZCkge1xuICAvLyAgIGFscmVhZHlXYXJuZWQgPSB0cnVlO1xuICAvLyAgIExvZ2dlci53YXJuKFwiRG9uJ3QgbGVhdmUgZGVidWcgYXNzZXJ0aW9ucyBvbiBpbiBwdWJsaWMgYnVpbGRzXCIpO1xuICAvLyB9XG5cbiAgaWYgKCF0ZXN0KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKG1zZyB8fCBcImFzc2VydGlvbiBmYWlsdXJlXCIpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwcm9kQXNzZXJ0KCkge31cblxuZXhwb3J0IGRlZmF1bHQgZGVidWdBc3NlcnQ7XG4iXX0=","const { keys: objKeys } = Object;\nexport function assign(obj) {\n    for (let i = 1; i < arguments.length; i++) {\n        let assignment = arguments[i];\n        if (assignment === null || typeof assignment !== 'object') continue;\n        let keys = objKeys(assignment);\n        for (let j = 0; j < keys.length; j++) {\n            let key = keys[j];\n            obj[key] = assignment[key];\n        }\n    }\n    return obj;\n}\nexport function fillNulls(count) {\n    let arr = new Array(count);\n    for (let i = 0; i < count; i++) {\n        arr[i] = null;\n    }\n    return arr;\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2JqZWN0LXV0aWxzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcGFja2FnZXMvQGdsaW1tZXIvdXRpbC9saWIvb2JqZWN0LXV0aWxzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE1BQU0sRUFBRSxBQUFJLE1BQUUsQUFBTyxBQUFFLFlBQUcsQUFBTSxBQUFDO0FBU2pDLEFBQU0sdUJBQWlCLEFBQVE7QUFDN0IsQUFBRyxBQUFDLFNBQUMsSUFBSSxBQUFDLElBQUcsQUFBQyxHQUFFLEFBQUMsSUFBRyxBQUFTLFVBQUMsQUFBTSxRQUFFLEFBQUMsQUFBRSxLQUFFLEFBQUM7QUFDMUMsWUFBSSxBQUFVLGFBQUcsQUFBUyxVQUFDLEFBQUMsQUFBQyxBQUFDO0FBQzlCLEFBQUUsQUFBQyxZQUFDLEFBQVUsZUFBSyxBQUFJLFFBQUksT0FBTyxBQUFVLGVBQUssQUFBUSxBQUFDLFVBQUMsQUFBUSxBQUFDO0FBQ3BFLFlBQUksQUFBSSxPQUFHLEFBQU8sUUFBQyxBQUFVLEFBQUMsQUFBQztBQUMvQixBQUFHLEFBQUMsYUFBQyxJQUFJLEFBQUMsSUFBRyxBQUFDLEdBQUUsQUFBQyxJQUFHLEFBQUksS0FBQyxBQUFNLFFBQUUsQUFBQyxBQUFFLEtBQUUsQUFBQztBQUNyQyxnQkFBSSxBQUFHLE1BQUcsQUFBSSxLQUFDLEFBQUMsQUFBQyxBQUFDO0FBQ2xCLEFBQUcsZ0JBQUMsQUFBRyxBQUFDLE9BQUcsQUFBVSxXQUFDLEFBQUcsQUFBQyxBQUFDLEFBQzdCO0FBQUMsQUFDSDtBQUFDO0FBQ0QsQUFBTSxXQUFDLEFBQUcsQUFBQyxBQUNiO0FBQUM7QUFFRCxBQUFNLDBCQUF1QixBQUFhO0FBQ3hDLFFBQUksQUFBRyxNQUFHLElBQUksQUFBSyxNQUFDLEFBQUssQUFBQyxBQUFDO0FBRTNCLEFBQUcsQUFBQyxTQUFDLElBQUksQUFBQyxJQUFDLEFBQUMsR0FBRSxBQUFDLElBQUMsQUFBSyxPQUFFLEFBQUMsQUFBRSxLQUFFLEFBQUM7QUFDM0IsQUFBRyxZQUFDLEFBQUMsQUFBQyxLQUFHLEFBQUksQUFBQyxBQUNoQjtBQUFDO0FBRUQsQUFBTSxXQUFDLEFBQUcsQUFBQyxBQUNiO0FBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7IGtleXM6IG9iaktleXMgfSA9IE9iamVjdDtcblxuZXhwb3J0IGZ1bmN0aW9uIGFzc2lnbjxULCBVPihvYmo6IFQsIGFzc2lnbm1lbnRzOiBVKTogVCAmIFU7XG5leHBvcnQgZnVuY3Rpb24gYXNzaWduPFQsIFUsIFY+KG9iajogVCwgYTogVSwgYjogVik6IFQgJiBVICYgVjtcbmV4cG9ydCBmdW5jdGlvbiBhc3NpZ248VCwgVSwgViwgVz4ob2JqOiBULCBhOiBVLCBiOiBWLCBjOiBXKTogVCAmIFUgJiBWICYgVztcbmV4cG9ydCBmdW5jdGlvbiBhc3NpZ248VCwgVSwgViwgVywgWD4ob2JqOiBULCBhOiBVLCBiOiBWLCBjOiBXLCBkOiBYKTogVCAmIFUgJiBWICYgVyAmIFg7XG5leHBvcnQgZnVuY3Rpb24gYXNzaWduPFQsIFUsIFYsIFcsIFgsIFk+KG9iajogVCwgYTogVSwgYjogViwgYzogVywgZDogWCwgZTogWSk6IFQgJiBVICYgViAmIFcgJiBYICYgWTtcbmV4cG9ydCBmdW5jdGlvbiBhc3NpZ248VCwgVSwgViwgVywgWCwgWSwgWj4ob2JqOiBULCBhOiBVLCBiOiBWLCBjOiBXLCBkOiBYLCBlOiBZLCBmOiBaKTogVCAmIFUgJiBWICYgVyAmIFggJiBZICYgWjtcbmV4cG9ydCBmdW5jdGlvbiBhc3NpZ24odGFyZ2V0OiBhbnksIC4uLmFyZ3M6IGFueVtdKTogYW55O1xuZXhwb3J0IGZ1bmN0aW9uIGFzc2lnbihvYmo6IGFueSkge1xuICBmb3IgKGxldCBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgIGxldCBhc3NpZ25tZW50ID0gYXJndW1lbnRzW2ldO1xuICAgIGlmIChhc3NpZ25tZW50ID09PSBudWxsIHx8IHR5cGVvZiBhc3NpZ25tZW50ICE9PSAnb2JqZWN0JykgY29udGludWU7XG4gICAgbGV0IGtleXMgPSBvYmpLZXlzKGFzc2lnbm1lbnQpO1xuICAgIGZvciAobGV0IGogPSAwOyBqIDwga2V5cy5sZW5ndGg7IGorKykge1xuICAgICAgbGV0IGtleSA9IGtleXNbal07XG4gICAgICBvYmpba2V5XSA9IGFzc2lnbm1lbnRba2V5XTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG9iajtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZpbGxOdWxsczxUPihjb3VudDogbnVtYmVyKTogVFtdIHtcbiAgbGV0IGFyciA9IG5ldyBBcnJheShjb3VudCk7XG5cbiAgZm9yIChsZXQgaT0wOyBpPGNvdW50OyBpKyspIHtcbiAgICBhcnJbaV0gPSBudWxsO1xuICB9XG5cbiAgcmV0dXJuIGFycjtcbn0iXX0=","let GUID = 0;\nexport function initializeGuid(object) {\n    return object._guid = ++GUID;\n}\nexport function ensureGuid(object) {\n    return object._guid || initializeGuid(object);\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ3VpZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3V0aWwvbGliL2d1aWQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsSUFBSSxBQUFJLE9BQUcsQUFBQyxBQUFDO0FBTWIsQUFBTSwrQkFBeUIsQUFBZTtBQUM1QyxBQUFNLEFBQUMsV0FBQyxBQUFNLE9BQUMsQUFBSyxRQUFHLEVBQUUsQUFBSSxBQUFDLEFBQUMsQUFDakM7QUFBQztBQUVELEFBQU0sMkJBQXFCLEFBQWU7QUFDeEMsQUFBTSxXQUFDLEFBQU0sT0FBQyxBQUFLLFNBQUksQUFBYyxlQUFDLEFBQU0sQUFBQyxBQUFDLEFBQ2hEO0FBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJsZXQgR1VJRCA9IDA7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSGFzR3VpZCB7XG4gIF9ndWlkOiBudW1iZXI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpbml0aWFsaXplR3VpZChvYmplY3Q6IEhhc0d1aWQpOiBudW1iZXIge1xuICByZXR1cm4gKG9iamVjdC5fZ3VpZCA9ICsrR1VJRCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBlbnN1cmVHdWlkKG9iamVjdDogSGFzR3VpZCk6IG51bWJlciB7XG4gIHJldHVybiBvYmplY3QuX2d1aWQgfHwgaW5pdGlhbGl6ZUd1aWQob2JqZWN0KTtcbn0iXX0=","import { ensureGuid } from './guid';\nexport function dict() {\n    return Object.create(null);\n}\nexport class DictSet {\n    constructor() {\n        this.dict = dict();\n    }\n    add(obj) {\n        if (typeof obj === 'string') this.dict[obj] = obj;else this.dict[ensureGuid(obj)] = obj;\n        return this;\n    }\n    delete(obj) {\n        if (typeof obj === 'string') delete this.dict[obj];else if (obj._guid) delete this.dict[obj._guid];\n    }\n}\nexport class Stack {\n    constructor() {\n        this.stack = [];\n        this.current = null;\n    }\n    get size() {\n        return this.stack.length;\n    }\n    push(item) {\n        this.current = item;\n        this.stack.push(item);\n    }\n    pop() {\n        let item = this.stack.pop();\n        let len = this.stack.length;\n        this.current = len === 0 ? null : this.stack[len - 1];\n        return item === undefined ? null : item;\n    }\n    isEmpty() {\n        return this.stack.length === 0;\n    }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29sbGVjdGlvbnMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci91dGlsL2xpYi9jb2xsZWN0aW9ucy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxBQUFPLFNBQVcsQUFBVSxBQUFFLGtCQUFNLEFBQVEsQUFBQztBQVk3QyxBQUFNO0FBQ0osQUFBTSxXQUFDLEFBQU0sT0FBQyxBQUFNLE9BQUMsQUFBSSxBQUFDLEFBQUMsQUFDN0I7QUFBQztBQUlELEFBQU07QUFHSjtBQUNFLEFBQUksYUFBQyxBQUFJLE9BQUcsQUFBSSxBQUFLLEFBQUMsQUFDeEI7QUFBQztBQUVELEFBQUcsUUFBQyxBQUFNO0FBQ1IsQUFBRSxBQUFDLFlBQUMsT0FBTyxBQUFHLFFBQUssQUFBUSxBQUFDLFVBQUMsQUFBSSxLQUFDLEFBQUksS0FBQyxBQUFVLEFBQUMsT0FBRyxBQUFHLEFBQUMsQUFDekQsQUFBSSxTQUFDLEFBQUksS0FBQyxBQUFJLEtBQUMsQUFBVSxXQUFDLEFBQVUsQUFBQyxBQUFDLFFBQUcsQUFBRyxBQUFDO0FBQzdDLEFBQU0sZUFBQyxBQUFJLEFBQUMsQUFDZDtBQUFDO0FBRUQsQUFBTSxXQUFDLEFBQU07QUFDWCxBQUFFLEFBQUMsWUFBQyxPQUFPLEFBQUcsUUFBSyxBQUFRLEFBQUMsVUFBQyxPQUFPLEFBQUksS0FBQyxBQUFJLEtBQUMsQUFBVSxBQUFDLEFBQUMsQUFDMUQsQUFBSSxVQUFDLEFBQUUsQUFBQyxJQUFFLEFBQVcsSUFBQyxBQUFLLEFBQUMsT0FBQyxPQUFPLEFBQUksS0FBQyxBQUFJLEtBQUUsQUFBVyxJQUFDLEFBQUssQUFBQyxBQUFDLEFBQ3BFO0FBQUMsQUFDRjs7QUFFRCxBQUFNO0FBQU47QUFDVSxhQUFLLFFBQVEsQUFBRSxBQUFDO0FBQ2pCLGFBQU8sVUFBYyxBQUFJLEFBQUMsQUFzQm5DO0FBQUM7QUFwQkMsUUFBVyxBQUFJO0FBQ2IsQUFBTSxlQUFDLEFBQUksS0FBQyxBQUFLLE1BQUMsQUFBTSxBQUFDLEFBQzNCO0FBQUM7QUFFRCxBQUFJLFNBQUMsQUFBTztBQUNWLEFBQUksYUFBQyxBQUFPLFVBQUcsQUFBSSxBQUFDO0FBQ3BCLEFBQUksYUFBQyxBQUFLLE1BQUMsQUFBSSxLQUFDLEFBQUksQUFBQyxBQUFDLEFBQ3hCO0FBQUM7QUFFRCxBQUFHO0FBQ0QsWUFBSSxBQUFJLE9BQUcsQUFBSSxLQUFDLEFBQUssTUFBQyxBQUFHLEFBQUUsQUFBQztBQUM1QixZQUFJLEFBQUcsTUFBRyxBQUFJLEtBQUMsQUFBSyxNQUFDLEFBQU0sQUFBQztBQUM1QixBQUFJLGFBQUMsQUFBTyxVQUFHLEFBQUcsUUFBSyxBQUFDLElBQUcsQUFBSSxPQUFHLEFBQUksS0FBQyxBQUFLLE1BQUMsQUFBRyxNQUFHLEFBQUMsQUFBQyxBQUFDO0FBRXRELEFBQU0sZUFBQyxBQUFJLFNBQUssQUFBUyxZQUFHLEFBQUksT0FBRyxBQUFJLEFBQUMsQUFDMUM7QUFBQztBQUVELEFBQU87QUFDTCxBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQUssTUFBQyxBQUFNLFdBQUssQUFBQyxBQUFDLEFBQ2pDO0FBQUMsQUFDRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEhhc0d1aWQsIGVuc3VyZUd1aWQgfSBmcm9tICcuL2d1aWQnO1xuaW1wb3J0IHsgT3B0aW9uIH0gZnJvbSAnLi9wbGF0Zm9ybS11dGlscyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRGljdDxUPiB7XG4gIFtpbmRleDogc3RyaW5nXTogVDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTZXQ8VD4ge1xuICBhZGQodmFsdWU6IFQpOiBTZXQ8VD47XG4gIGRlbGV0ZSh2YWx1ZTogVCk6IHZvaWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkaWN0PFQ+KCk6IERpY3Q8VD4ge1xuICByZXR1cm4gT2JqZWN0LmNyZWF0ZShudWxsKTtcbn1cblxuZXhwb3J0IHR5cGUgU2V0TWVtYmVyID0gSGFzR3VpZCB8IHN0cmluZztcblxuZXhwb3J0IGNsYXNzIERpY3RTZXQ8VCBleHRlbmRzIFNldE1lbWJlcj4gaW1wbGVtZW50cyBTZXQ8VD4ge1xuICBwcml2YXRlIGRpY3Q6IERpY3Q8VD47XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5kaWN0ID0gZGljdDxUPigpO1xuICB9XG5cbiAgYWRkKG9iajogVCk6IFNldDxUPiB7XG4gICAgaWYgKHR5cGVvZiBvYmogPT09ICdzdHJpbmcnKSB0aGlzLmRpY3Rbb2JqIGFzIGFueV0gPSBvYmo7XG4gICAgZWxzZSB0aGlzLmRpY3RbZW5zdXJlR3VpZChvYmogYXMgYW55KV0gPSBvYmo7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBkZWxldGUob2JqOiBUKSB7XG4gICAgaWYgKHR5cGVvZiBvYmogPT09ICdzdHJpbmcnKSBkZWxldGUgdGhpcy5kaWN0W29iaiBhcyBhbnldO1xuICAgIGVsc2UgaWYgKChvYmogYXMgYW55KS5fZ3VpZCkgZGVsZXRlIHRoaXMuZGljdFsob2JqIGFzIGFueSkuX2d1aWRdO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBTdGFjazxUPiB7XG4gIHByaXZhdGUgc3RhY2s6IFRbXSA9IFtdO1xuICBwdWJsaWMgY3VycmVudDogT3B0aW9uPFQ+ID0gbnVsbDtcblxuICBwdWJsaWMgZ2V0IHNpemUoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RhY2subGVuZ3RoO1xuICB9XG5cbiAgcHVzaChpdGVtOiBUKSB7XG4gICAgdGhpcy5jdXJyZW50ID0gaXRlbTtcbiAgICB0aGlzLnN0YWNrLnB1c2goaXRlbSk7XG4gIH1cblxuICBwb3AoKTogT3B0aW9uPFQ+IHtcbiAgICBsZXQgaXRlbSA9IHRoaXMuc3RhY2sucG9wKCk7XG4gICAgbGV0IGxlbiA9IHRoaXMuc3RhY2subGVuZ3RoO1xuICAgIHRoaXMuY3VycmVudCA9IGxlbiA9PT0gMCA/IG51bGwgOiB0aGlzLnN0YWNrW2xlbiAtIDFdO1xuXG4gICAgcmV0dXJuIGl0ZW0gPT09IHVuZGVmaW5lZCA/IG51bGwgOiBpdGVtO1xuICB9XG5cbiAgaXNFbXB0eSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5zdGFjay5sZW5ndGggPT09IDA7XG4gIH1cbn1cbiJdfQ==","export class ListNode {\n    constructor(value) {\n        this.next = null;\n        this.prev = null;\n        this.value = value;\n    }\n}\nexport class LinkedList {\n    constructor() {\n        this.clear();\n    }\n    head() {\n        return this._head;\n    }\n    tail() {\n        return this._tail;\n    }\n    clear() {\n        this._head = this._tail = null;\n    }\n    toArray() {\n        let out = [];\n        this.forEachNode(n => out.push(n));\n        return out;\n    }\n    nextNode(node) {\n        return node.next;\n    }\n    forEachNode(callback) {\n        let node = this._head;\n        while (node !== null) {\n            callback(node);\n            node = node.next;\n        }\n    }\n    insertBefore(node, reference = null) {\n        if (reference === null) return this.append(node);\n        if (reference.prev) reference.prev.next = node;else this._head = node;\n        node.prev = reference.prev;\n        node.next = reference;\n        reference.prev = node;\n        return node;\n    }\n    append(node) {\n        let tail = this._tail;\n        if (tail) {\n            tail.next = node;\n            node.prev = tail;\n            node.next = null;\n        } else {\n            this._head = node;\n        }\n        return this._tail = node;\n    }\n    remove(node) {\n        if (node.prev) node.prev.next = node.next;else this._head = node.next;\n        if (node.next) node.next.prev = node.prev;else this._tail = node.prev;\n        return node;\n    }\n}\nexport class ListSlice {\n    constructor(head, tail) {\n        this._head = head;\n        this._tail = tail;\n    }\n    forEachNode(callback) {\n        let node = this._head;\n        while (node !== null) {\n            callback(node);\n            node = this.nextNode(node);\n        }\n    }\n    head() {\n        return this._head;\n    }\n    tail() {\n        return this._tail;\n    }\n    toArray() {\n        let out = [];\n        this.forEachNode(n => out.push(n));\n        return out;\n    }\n    nextNode(node) {\n        if (node === this._tail) return null;\n        return node.next;\n    }\n}\nexport const EMPTY_SLICE = new ListSlice(null, null);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGlzdC11dGlscy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3V0aWwvbGliL2xpc3QtdXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBT0EsQUFBTTtBQUtKLGdCQUFZLEFBQVE7QUFKYixhQUFJLE9BQXdCLEFBQUksQUFBQztBQUNqQyxhQUFJLE9BQXdCLEFBQUksQUFBQztBQUl0QyxBQUFJLGFBQUMsQUFBSyxRQUFHLEFBQUssQUFBQyxBQUNyQjtBQUFDLEFBQ0Y7O0FBTUQsQUFBTTtBQUtKO0FBQ0UsQUFBSSxhQUFDLEFBQUssQUFBRSxBQUFDLEFBQ2Y7QUFBQztBQUVELEFBQUk7QUFDRixBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQUssQUFBQyxBQUNwQjtBQUFDO0FBRUQsQUFBSTtBQUNGLEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBSyxBQUFDLEFBQ3BCO0FBQUM7QUFFRCxBQUFLO0FBQ0gsQUFBSSxhQUFDLEFBQUssUUFBRyxBQUFJLEtBQUMsQUFBSyxRQUFHLEFBQUksQUFBQyxBQUNqQztBQUFDO0FBRUQsQUFBTztBQUNMLFlBQUksQUFBRyxNQUFRLEFBQUUsQUFBQztBQUNsQixBQUFJLGFBQUMsQUFBVyxZQUFDLEFBQUMsS0FBSSxBQUFHLElBQUMsQUFBSSxLQUFDLEFBQUMsQUFBQyxBQUFDLEFBQUM7QUFDbkMsQUFBTSxlQUFDLEFBQUcsQUFBQyxBQUNiO0FBQUM7QUFFRCxBQUFRLGFBQUMsQUFBTztBQUNkLEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBYSxBQUFDLEFBQzVCO0FBQUM7QUFFRCxBQUFXLGdCQUFDLEFBQTJCO0FBQ3JDLFlBQUksQUFBSSxPQUFHLEFBQUksS0FBQyxBQUFLLEFBQUM7QUFFdEIsZUFBTyxBQUFJLFNBQUssQUFBSSxNQUFFLEFBQUM7QUFDckIsQUFBUSxxQkFBQyxBQUFhLEFBQUMsQUFBQztBQUN4QixBQUFJLG1CQUFHLEFBQUksS0FBQyxBQUFhLEFB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S0FBQyxBQUFLLEFBQUMsT0FBQyxBQUFNLE9BQUMsQUFBSSxBQUFDO0FBQ3JDLEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBUyxBQUFDLEFBQ3hCO0FBQUMsQUFDRjs7QUFFRCxBQUFNLE9BQUMsTUFBTSxBQUFXLGNBQUcsSUFBSSxBQUFTLFVBQUMsQUFBSSxNQUFFLEFBQUksQUFBQyxBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgT3B0aW9uIH0gZnJvbSAnLi9wbGF0Zm9ybS11dGlscyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGlua2VkTGlzdE5vZGUge1xuICBuZXh0OiBPcHRpb248TGlua2VkTGlzdE5vZGU+O1xuICBwcmV2OiBPcHRpb248TGlua2VkTGlzdE5vZGU+O1xufVxuXG5leHBvcnQgY2xhc3MgTGlzdE5vZGU8VD4gaW1wbGVtZW50cyBMaW5rZWRMaXN0Tm9kZSB7XG4gIHB1YmxpYyBuZXh0OiBPcHRpb248TGlzdE5vZGU8VD4+ID0gbnVsbDtcbiAgcHVibGljIHByZXY6IE9wdGlvbjxMaXN0Tm9kZTxUPj4gPSBudWxsO1xuICBwdWJsaWMgdmFsdWU6IFQ7XG5cbiAgY29uc3RydWN0b3IodmFsdWU6IFQpIHtcbiAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gIH1cbn1cblxuLy8gd2UgYXJlIHVuYWJsZSB0byBleHByZXNzIHRoZSBjb25zdHJhaW50IHRoYXQgVCdzIC5wcmV2IGFuZCAubmV4dCBhcmVcbi8vIHRoZW1zZWx2ZXMgVC4gSG93ZXZlciwgaXQgd2lsbCBhbHdheXMgYmUgdHJ1ZSwgc28gdHJ1c3QgdXMuXG50eXBlIHRydXN0ID0gYW55O1xuXG5leHBvcnQgY2xhc3MgTGlua2VkTGlzdDxUIGV4dGVuZHMgTGlua2VkTGlzdE5vZGU+IGltcGxlbWVudHMgU2xpY2U8VD4ge1xuXG4gIHByaXZhdGUgX2hlYWQ6IE9wdGlvbjxUPjtcbiAgcHJpdmF0ZSBfdGFpbDogT3B0aW9uPFQ+O1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuY2xlYXIoKTtcbiAgfVxuXG4gIGhlYWQoKTogT3B0aW9uPFQ+IHtcbiAgICByZXR1cm4gdGhpcy5faGVhZDtcbiAgfVxuXG4gIHRhaWwoKTogT3B0aW9uPFQ+IHtcbiAgICByZXR1cm4gdGhpcy5fdGFpbDtcbiAgfVxuXG4gIGNsZWFyKCkge1xuICAgIHRoaXMuX2hlYWQgPSB0aGlzLl90YWlsID0gbnVsbDtcbiAgfVxuXG4gIHRvQXJyYXkoKTogVFtdIHtcbiAgICBsZXQgb3V0OiBUW10gPSBbXTtcbiAgICB0aGlzLmZvckVhY2hOb2RlKG4gPT4gb3V0LnB1c2gobikpO1xuICAgIHJldHVybiBvdXQ7XG4gIH1cblxuICBuZXh0Tm9kZShub2RlOiBUKTogVCB7XG4gICAgcmV0dXJuIG5vZGUubmV4dCBhcyB0cnVzdDtcbiAgfVxuXG4gIGZvckVhY2hOb2RlKGNhbGxiYWNrOiAobm9kZTogVCkgPT4gdm9pZCkge1xuICAgIGxldCBub2RlID0gdGhpcy5faGVhZDtcblxuICAgIHdoaWxlIChub2RlICE9PSBudWxsKSB7XG4gICAgICBjYWxsYmFjayhub2RlIGFzIHRydXN0KTtcbiAgICAgIG5vZGUgPSBub2RlLm5leHQgYXMgdHJ1c3Q7XG4gICAgfVxuICB9XG5cbiAgaW5zZXJ0QmVmb3JlKG5vZGU6IFQsIHJlZmVyZW5jZTogT3B0aW9uPFQ+ID0gbnVsbCk6IFQge1xuICAgIGlmIChyZWZlcmVuY2UgPT09IG51bGwpIHJldHVybiB0aGlzLmFwcGVuZChub2RlKTtcblxuICAgIGlmIChyZWZlcmVuY2UucHJldikgcmVmZXJlbmNlLnByZXYubmV4dCA9IG5vZGU7XG4gICAgZWxzZSB0aGlzLl9oZWFkID0gbm9kZTtcblxuICAgIG5vZGUucHJldiA9IHJlZmVyZW5jZS5wcmV2O1xuICAgIG5vZGUubmV4dCA9IHJlZmVyZW5jZTtcbiAgICByZWZlcmVuY2UucHJldiA9IG5vZGU7XG5cbiAgICByZXR1cm4gbm9kZTtcbiAgfVxuXG4gIGFwcGVuZChub2RlOiBUKTogVCB7XG4gICAgbGV0IHRhaWwgPSB0aGlzLl90YWlsO1xuXG4gICAgaWYgKHRhaWwpIHtcbiAgICAgIHRhaWwubmV4dCA9IG5vZGU7XG4gICAgICBub2RlLnByZXYgPSB0YWlsO1xuICAgICAgbm9kZS5uZXh0ID0gbnVsbDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGVhZCA9IG5vZGU7XG4gICAgfVxuXG4gICAgcmV0dXJuICh0aGlzLl90YWlsID0gbm9kZSk7XG4gIH1cblxuICByZW1vdmUobm9kZTogVCk6IFQge1xuICAgIGlmIChub2RlLnByZXYpIG5vZGUucHJldi5uZXh0ID0gbm9kZS5uZXh0O1xuICAgIGVsc2UgdGhpcy5faGVhZCA9IG5vZGUubmV4dCBhcyB0cnVzdDtcblxuICAgIGlmIChub2RlLm5leHQpIG5vZGUubmV4dC5wcmV2ID0gbm9kZS5wcmV2O1xuICAgIGVsc2UgdGhpcy5fdGFpbCA9IG5vZGUucHJldiBhcyB0cnVzdDtcblxuICAgIHJldHVybiBub2RlO1xuICB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2xpY2U8VCBleHRlbmRzIExpbmtlZExpc3ROb2RlPiB7XG4gIGhlYWQoKTogT3B0aW9uPFQ+O1xuICB0YWlsKCk6IE9wdGlvbjxUPjtcbiAgbmV4dE5vZGUobm9kZTogVCk6IE9wdGlvbjxUPjtcbiAgZm9yRWFjaE5vZGUoY2FsbGJhY2s6IChub2RlOiBUKSA9PiB2b2lkKTogdm9pZDtcbiAgdG9BcnJheSgpOiBUW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2xvbmVhYmxlTGlzdE5vZGUgZXh0ZW5kcyBMaW5rZWRMaXN0Tm9kZSB7XG4gIGNsb25lKCk6IHRoaXM7XG59XG5cbmV4cG9ydCBjbGFzcyBMaXN0U2xpY2U8VCBleHRlbmRzIExpbmtlZExpc3ROb2RlPiBpbXBsZW1lbnRzIFNsaWNlPFQ+IHtcbiAgcHJpdmF0ZSBfaGVhZDogT3B0aW9uPFQ+O1xuICBwcml2YXRlIF90YWlsOiBPcHRpb248VD47XG5cbiAgY29uc3RydWN0b3IoaGVhZDogT3B0aW9uPFQ+LCB0YWlsOiBPcHRpb248VD4pIHtcbiAgICB0aGlzLl9oZWFkID0gaGVhZDtcbiAgICB0aGlzLl90YWlsID0gdGFpbDtcbiAgfVxuXG4gIGZvckVhY2hOb2RlKGNhbGxiYWNrOiAobm9kZTogVCkgPT4gdm9pZCkge1xuICAgIGxldCBub2RlID0gdGhpcy5faGVhZDtcblxuICAgIHdoaWxlIChub2RlICE9PSBudWxsKSB7XG4gICAgICBjYWxsYmFjayhub2RlKTtcbiAgICAgIG5vZGUgPSB0aGlzLm5leHROb2RlKG5vZGUpO1xuICAgIH1cbiAgfVxuXG4gIGhlYWQoKTogT3B0aW9uPFQ+IHtcbiAgICByZXR1cm4gdGhpcy5faGVhZDtcbiAgfVxuXG4gIHRhaWwoKTogT3B0aW9uPFQ+IHtcbiAgICByZXR1cm4gdGhpcy5fdGFpbDtcbiAgfVxuXG4gIHRvQXJyYXkoKTogVFtdIHtcbiAgICBsZXQgb3V0OiBUW10gPSBbXTtcbiAgICB0aGlzLmZvckVhY2hOb2RlKG4gPT4gb3V0LnB1c2gobikpO1xuICAgIHJldHVybiBvdXQ7XG4gIH1cblxuICBuZXh0Tm9kZShub2RlOiBUKTogT3B0aW9uPFQ+IHtcbiAgICBpZiAobm9kZSA9PT0gdGhpcy5fdGFpbCkgcmV0dXJuIG51bGw7XG4gICAgcmV0dXJuIG5vZGUubmV4dCBhcyBUO1xuICB9XG59XG5cbmV4cG9ydCBjb25zdCBFTVBUWV9TTElDRSA9IG5ldyBMaXN0U2xpY2UobnVsbCwgbnVsbCk7XG4iXX0=","export const EMPTY_ARRAY = Object.freeze([]);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXJyYXktdXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci91dGlsL2xpYi9hcnJheS11dGlscy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxBQUFNLE9BQUMsTUFBTSxBQUFXLGNBQVUsQUFBTSxPQUFDLEFBQU0sT0FBQyxBQUFFLEFBQVEsQUFBQyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBFTVBUWV9BUlJBWTogYW55W10gPSBPYmplY3QuZnJlZXplKFtdKSBhcyBhbnk7XG4iXX0=","export const CONSTANT = 0;\nexport const INITIAL = 1;\nexport const VOLATILE = NaN;\nexport class RevisionTag {\n    validate(snapshot) {\n        return this.value() === snapshot;\n    }\n}\nRevisionTag.id = 0;\nconst VALUE = [];\nconst VALIDATE = [];\nexport class TagWrapper {\n    constructor(type, inner) {\n        this.type = type;\n        this.inner = inner;\n    }\n    value() {\n        let func = VALUE[this.type];\n        return func(this.inner);\n    }\n    validate(snapshot) {\n        let func = VALIDATE[this.type];\n        return func(this.inner, snapshot);\n    }\n}\nfunction register(Type) {\n    let type = VALUE.length;\n    VALUE.push(tag => tag.value());\n    VALIDATE.push((tag, snapshot) => tag.validate(snapshot));\n    Type.id = type;\n}\n///\n// CONSTANT: 0\nVALUE.push(() => CONSTANT);\nVALIDATE.push((_tag, snapshot) => snapshot === CONSTANT);\nexport const CONSTANT_TAG = new TagWrapper(0, null);\n// VOLATILE: 1\nVALUE.push(() => VOLATILE);\nVALIDATE.push((_tag, snapshot) => snapshot === VOLATILE);\nexport const VOLATILE_TAG = new TagWrapper(1, null);\n// CURRENT: 2\nVALUE.push(() => $REVISION);\nVALIDATE.push((_tag, snapshot) => snapshot === $REVISION);\nexport const CURRENT_TAG = new TagWrapper(2, null);\nexport function isConst({ tag }) {\n    return tag === CONSTANT_TAG;\n}\nexport function isConstTag(tag) {\n    return tag === CONSTANT_TAG;\n}\n///\nlet $REVISION = INITIAL;\nexport class DirtyableTag extends RevisionTag {\n    static create(revision = $REVISION) {\n        return new TagWrapper(this.id, new DirtyableTag(revision));\n    }\n    constructor(revision = $REVISION) {\n        super();\n        this.revision = revision;\n    }\n    value() {\n        return this.revision;\n    }\n    dirty() {\n        this.revision = ++$REVISION;\n    }\n}\nregister(DirtyableTag);\nexport function combineTagged(tagged) {\n    let optimized = [];\n    for (let i = 0, l = tagged.length; i < l; i++) {\n        let tag = tagged[i].tag;\n        if (tag === VOLATILE_TAG) return VOLATILE_TAG;\n        if (tag === CONSTANT_TAG) continue;\n        optimized.push(tag);\n    }\n    return _combine(optimized);\n}\nexport function combineSlice(slice) {\n    let optimized = [];\n    let node = slice.head();\n    while (node !== null) {\n        let tag = node.tag;\n        if (tag === VOLATILE_TAG) return VOLATILE_TAG;\n        if (tag !== CONSTANT_TAG) optimized.push(tag);\n        node = slice.nextNode(node);\n    }\n    return _combine(optimized);\n}\nexport function combine(tags) {\n    let optimized = [];\n    for (let i = 0, l = tags.length; i < l; i++) {\n        let tag = tags[i];\n        if (tag === VOLATILE_TAG) return VOLATILE_TAG;\n        if (tag === CONSTANT_TAG) continue;\n        optimized.push(tag);\n    }\n    return _combine(optimized);\n}\nfunction _combine(tags) {\n    switch (tags.length) {\n        case 0:\n            return CONSTANT_TAG;\n        case 1:\n            return tags[0];\n        case 2:\n            return TagsPair.create(tags[0], tags[1]);\n        default:\n            return TagsCombinator.create(tags);\n    }\n}\nexport class CachedTag extends RevisionTag {\n    constructor() {\n        super(...arguments);\n        this.lastChecked = null;\n        this.lastValue = null;\n    }\n    value() {\n        let { lastChecked, lastValue } = this;\n        if (lastChecked !== $REVISION) {\n            this.lastChecked = $REVISION;\n            this.lastValue = lastValue = this.compute();\n        }\n        return this.lastValue;\n    }\n    invalidate() {\n        this.lastChecked = null;\n    }\n}\nclass TagsPair extends CachedTag {\n    static create(first, second) {\n        return new TagWrapper(this.id, new TagsPair(first, second));\n    }\n    constructor(first, second) {\n        super();\n        this.first = first;\n        this.second = second;\n    }\n    compute() {\n        return Math.max(this.first.value(), this.second.value());\n    }\n}\nregister(TagsPair);\nclass TagsCombinator extends CachedTag {\n    static create(tags) {\n        return new TagWrapper(this.id, new TagsCombinator(tags));\n    }\n    constructor(tags) {\n        super();\n        this.tags = tags;\n    }\n    compute() {\n        let { tags } = this;\n        let max = -1;\n        for (let i = 0; i < tags.length; i++) {\n            let value = tags[i].value();\n            max = Math.max(value, max);\n        }\n        return max;\n    }\n}\nregister(TagsCombinator);\nexport class UpdatableTag extends CachedTag {\n    static create(tag) {\n        return new TagWrapper(this.id, new UpdatableTag(tag));\n    }\n    constructor(tag) {\n        super();\n        this.tag = tag;\n        this.lastUpdated = INITIAL;\n    }\n    compute() {\n        return Math.max(this.lastUpdated, this.tag.value());\n    }\n    update(tag) {\n        if (tag !== this.tag) {\n            this.tag = tag;\n            this.lastUpdated = $REVISION;\n            this.invalidate();\n        }\n    }\n}\nregister(UpdatableTag);\nexport class CachedReference {\n    constructor() {\n        this.lastRevision = null;\n        this.lastValue = null;\n    }\n    value() {\n        let { tag, lastRevision, lastValue } = this;\n        if (lastRevision === null || !tag.validate(lastRevision)) {\n            lastValue = this.lastValue = this.compute();\n            this.lastRevision = tag.value();\n        }\n        return lastValue;\n    }\n    invalidate() {\n        this.lastRevision = null;\n    }\n}\nclass MapperReference extends CachedReference {\n    constructor(reference, mapper) {\n        super();\n        this.tag = reference.tag;\n        this.reference = reference;\n        this.mapper = mapper;\n    }\n    compute() {\n        let { reference, mapper } = this;\n        return mapper(reference.value());\n    }\n}\nexport function map(reference, mapper) {\n    return new MapperReference(reference, mapper);\n}\n//////////\nexport class ReferenceCache {\n    constructor(reference) {\n        this.lastValue = null;\n        this.lastRevision = null;\n        this.initialized = false;\n        this.tag = reference.tag;\n        this.reference = reference;\n    }\n    peek() {\n        if (!this.initialized) {\n            return this.initialize();\n        }\n        return this.lastValue;\n    }\n    revalidate() {\n        if (!this.initialized) {\n            return this.initialize();\n        }\n        let { reference, lastRevision } = this;\n        let tag = reference.tag;\n        if (tag.validate(lastRevision)) return NOT_MODIFIED;\n        this.lastRevision = tag.value();\n        let { lastValue } = this;\n        let value = reference.value();\n        if (value === lastValue) return NOT_MODIFIED;\n        this.lastValue = value;\n        return value;\n    }\n    initialize() {\n        let { reference } = this;\n        let value = this.lastValue = reference.value();\n        this.lastRevision = reference.tag.value();\n        this.initialized = true;\n        return value;\n    }\n}\nconst NOT_MODIFIED = \"adb3b78e-3d22-4e4b-877a-6317c2c5c145\";\nexport function isModified(value) {\n    return value !== NOT_MODIFIED;\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmFsaWRhdG9ycy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3JlZmVyZW5jZS9saWIvdmFsaWRhdG9ycy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFzQkEsQUFBTSxPQUFDLE1BQU0sQUFBUSxXQUFhLEFBQUMsQUFBQztBQUNwQyxBQUFNLE9BQUMsTUFBTSxBQUFPLFVBQWMsQUFBQyxBQUFDO0FBQ3BDLEFBQU0sT0FBQyxNQUFNLEFBQVEsV0FBYSxBQUFHLEFBQUM7QUFFdEMsQUFBTTtBQUtKLEFBQVEsYUFBQyxBQUFrQjtBQUN6QixBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQUssQUFBRSxZQUFLLEFBQVEsQUFBQyxBQUNuQztBQUFDOztBQU5NLFlBQUUsS0FBRyxBQUFDLEFBQUM7QUFTaEIsTUFBTSxBQUFLLFFBQStDLEFBQUUsQUFBQztBQUM3RCxNQUFNLEFBQVEsV0FBa0UsQUFBRSxBQUFDO0FBRW5GLEFBQU07QUFDSixnQkFBb0IsQUFBWSxNQUFTLEFBQVE7QUFBN0IsYUFBSSxPQUFKLEFBQUksQUFBUTtBQUFTLGFBQUssUUFBTCxBQUFLLEFBQUcsQUFBRztBQUFDO0FBRXJELEFBQUs7QUFDSCxZQUFJLEFBQUksT0FBRyxBQUFLLE1BQUMsQUFBSSxLQUFDLEFBQUksQUFBQyxBQUFDO0FBQzVCLEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBSSxLQUFDLEFBQUssQUFBQyxBQUFDLEFBQzFCO0FBQUM7QUFFRCxBQUFRLGFBQUMsQUFBa0I7QUFDekIsWUFBSSxBQUFJLE9BQUcsQUFBUSxTQUFDLEFBQUksS0FBQyxBQUFJLEFBQUMsQUFBQztBQUMvQixBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQUksS0FBQyxBQUFLLE9BQUUsQUFBUSxBQUFDLEFBQUMsQUFDcEM7QUFBQyxBQUNGOztBQUlELGtCQUFrQixBQUFpRDtBQUNqRSxRQUFJLEFBQUksT0FBRyxBQUFLLE1BQUMsQUFBTSxBQUFDO0FBQ3hC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LEFBQVMsVUFBQyxBQUFLLEFBQUUsQUFBQztBQUMvQyxBQUFJLGFBQUMsQUFBWSxlQUFHLEFBQVMsVUFBQyxBQUFHLElBQUMsQUFBSyxBQUFFLEFBQUM7QUFDMUMsQUFBSSxhQUFDLEFBQVcsY0FBRyxBQUFJLEFBQUM7QUFFeEIsQUFBTSxlQUFDLEFBQUssQUFBQyxBQUNmO0FBQUMsQUFDRjs7QUFNRCxNQUFNLEFBQVksZUFBZ0IsQUFBc0MsQUFBQztBQUV6RSxBQUFNLDJCQUF3QixBQUFvQjtBQUNoRCxBQUFNLFdBQUMsQUFBSyxVQUFLLEFBQVksQUFBQyxBQUNoQztBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlZmVyZW5jZSwgeyBQYXRoUmVmZXJlbmNlIH0gZnJvbSAnLi9yZWZlcmVuY2UnO1xuaW1wb3J0IHsgT3BhcXVlLCBPcHRpb24sIFNsaWNlLCBMaW5rZWRMaXN0Tm9kZSB9IGZyb20gJ0BnbGltbWVyL3V0aWwnO1xuXG4vLy8vLy8vLy8vXG5cbmV4cG9ydCBpbnRlcmZhY2UgRW50aXR5VGFnPFQ+IGV4dGVuZHMgUmVmZXJlbmNlPFQ+IHtcbiAgdmFsdWUoKTogVDtcbiAgdmFsaWRhdGUoc25hcHNob3Q6IFQpOiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEVudGl0eVRhZ2dlZDxUPiB7XG4gIHRhZzogRW50aXR5VGFnPFQ+O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRhZ2dlZCB7XG4gIHRhZzogVGFnO1xufVxuXG4vLy8vLy8vLy8vXG5cbmV4cG9ydCB0eXBlIFJldmlzaW9uID0gbnVtYmVyO1xuXG5leHBvcnQgY29uc3QgQ09OU1RBTlQ6IFJldmlzaW9uID0gMDtcbmV4cG9ydCBjb25zdCBJTklUSUFMOiAgUmV2aXNpb24gPSAxO1xuZXhwb3J0IGNvbnN0IFZPTEFUSUxFOiBSZXZpc2lvbiA9IE5hTjtcblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFJldmlzaW9uVGFnIGltcGxlbWVudHMgRW50aXR5VGFnPFJldmlzaW9uPiB7XG4gIHN0YXRpYyBpZCA9IDA7XG5cbiAgYWJzdHJhY3QgdmFsdWUoKTogUmV2aXNpb247XG5cbiAgdmFsaWRhdGUoc25hcHNob3Q6IFJldmlzaW9uKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMudmFsdWUoKSA9PT0gc25hcHNob3Q7XG4gIH1cbn1cblxuY29uc3QgVkFMVUU6ICgodGFnOiBPcHRpb248UmV2aXNpb25UYWc+KSA9PiBSZXZpc2lvbilbXSA9IFtdO1xuY29uc3QgVkFMSURBVEU6ICgodGFnOiBPcHRpb248UmV2aXNpb25UYWc+LCBzbmFwc2hvdDogUmV2aXNpb24pID0+IGJvb2xlYW4pW10gPSBbXTtcblxuZXhwb3J0IGNsYXNzIFRhZ1dyYXBwZXI8VCBleHRlbmRzIFJldmlzaW9uVGFnIHwgbnVsbD4ge1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHR5cGU6IG51bWJlciwgcHVibGljIGlubmVyOiBUKSB7fVxuXG4gIHZhbHVlKCk6IFJldmlzaW9uIHtcbiAgICBsZXQgZnVuYyA9IFZBTFVFW3RoaXMudHlwZV07XG4gICAgcmV0dXJuIGZ1bmModGhpcy5pbm5lcik7XG4gIH1cblxuICB2YWxpZGF0ZShzbmFwc2hvdDogUmV2aXNpb24pOiBib29sZWFuIHtcbiAgICBsZXQgZnVuYyA9IFZBTElEQVRFW3RoaXMudHlwZV07XG4gICAgcmV0dXJuIGZ1bmModGhpcy5pbm5lciwgc25hcHNob3QpO1xuICB9XG59XG5cbmV4cG9ydCB0eXBlIFRhZyA9IFRhZ1dyYXBwZXI8UmV2aXNpb25UYWcgfCBudWxsPjtcblxuZnVuY3Rpb24gcmVnaXN0ZXIoVHlwZTogeyBjcmVhdGUoLi4uYXJnczogYW55W10pOiBUYWcsIGlkOiBudW1iZXIgfSkge1xuICBsZXQgdHlwZSA9IFZBTFVFLmxlbmd0aDtcbiAgVkFMVUUucHVzaCgodGFnOiBSZXZpc2lvblRhZykgPT4gdGFnLnZhbHVlKCkpO1xuICBWQUxJREFURS5wdXNoKCh0YWc6IFJldmlzaW9uVGFnLCBzbmFwc2hvdDogUmV2aXNpb24pID0+IHRhZy52YWxpZGF0ZShzbmFwc2hvdCkpO1xuICBUeXBlLmlkID0gdHlwZTtcbn1cblxuLy8vXG5cbi8vIENPTlNUQU5UOiAwXG5WQUxVRS5wdXNoKCgpID0+IENPTlNUQU5UKTtcblZBTElEQVRFLnB1c2goKF90YWcsIHNuYXBzaG90KSA9PiBzbmFwc2hvdCA9PT0gQ09OU1RBTlQpO1xuZXhwb3J0IGNvbnN0IENPTlNUQU5UX1RBRyA9IG5ldyBUYWdXcmFwcGVyKDAsIG51bGwpO1xuXG4vLyBWT0xBVElMRTogMVxuVkFMVUUucHVzaCgoKSA9PiBWT0xBVElMRSk7XG5WQUxJREFURS5wdXNoKChfdGFnLCBzbmFwc2hvdCkgPT4gc25hcHNob3QgPT09IFZPTEFUSUxFKTtcbmV4cG9ydCBjb25zdCBWT0xBVElMRV9UQUcgPSBuZXcgVGFnV3JhcHBlcigxLCBudWxsKTtcblxuLy8gQ1VSUkVOVDogMlxuVkFMVUUucHVzaCgoKSA9PiAkUkVWSVNJT04pO1xuVkFMSURBVEUucHVzaCgoX3RhZywgc25hcHNob3QpID0+IHNuYXBzaG90ID09PSAkUkVWSVNJT04pO1xuZXhwb3J0IGNvbnN0IENVUlJFTlRfVEFHID0gbmV3IFRhZ1dyYXBwZXIoMiwgbnVsbCk7XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0NvbnN0KHsgdGFnIH06IFRhZ2dlZCk6IGJvb2xlYW4ge1xuICByZXR1cm4gdGFnID09PSBDT05TVEFOVF9UQUc7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0NvbnN0VGFnKHRhZzogVGFnKTogYm9vbGVhbiB7XG4gIHJldHVybiB0YWcgPT09IENPTlNUQU5UX1RBRztcbn1cblxuLy8vXG5cbmxldCAkUkVWSVNJT04gPSBJTklUSUFMO1xuXG5leHBvcnQgY2xhc3MgRGlydHlhYmxlVGFnIGV4dGVuZHMgUmV2aXNpb25UYWcge1xuICBzdGF0aWMgY3JlYXRlKHJldmlzaW9uID0gJFJFVklTSU9OKSB7XG4gICAgcmV0dXJuIG5ldyBUYWdXcmFwcGVyKHRoaXMuaWQsIG5ldyBEaXJ0eWFibGVUYWcocmV2aXNpb24pKTtcbiAgfVxuXG4gIHByaXZhdGUgcmV2aXNpb246IFJldmlzaW9uO1xuXG4gIGNvbnN0cnVjdG9yKHJldmlzaW9uID0gJFJFVklTSU9OKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLnJldmlzaW9uID0gcmV2aXNpb247XG4gIH1cblxuICB2YWx1ZSgpOiBSZXZpc2lvbiB7XG4gICAgcmV0dXJuIHRoaXMucmV2aXNpb247XG4gIH1cblxuICBkaXJ0eSgpIHtcbiAgICB0aGlzLnJldmlzaW9uID0gKyskUkVWSVNJT047XG4gIH1cbn1cblxucmVnaXN0ZXIoRGlydHlhYmxlVGFnKTtcblxuZXhwb3J0IGZ1bmN0aW9uIGNvbWJpbmVUYWdnZWQodGFnZ2VkOiBSZWFkb25seUFycmF5PFRhZ2dlZD4pOiBUYWcge1xuICBsZXQgb3B0aW1pemVkOiBUYWdbXSA9IFtdO1xuXG4gIGZvciAobGV0IGk9MCwgbD10YWdnZWQubGVuZ3RoOyBpPGw7IGkrKykge1xuICAgIGxldCB0YWcgPSB0YWdnZWRbaV0udGFnO1xuICAgIGlmICh0YWcgPT09IFZPTEFUSUxFX1RBRykgcmV0dXJuIFZPTEFUSUxFX1RBRztcbiAgICBpZiAodGFnID09PSBDT05TVEFOVF9UQUcpIGNvbnRpbnVlO1xuICAgIG9wdGltaXplZC5wdXNoKHRhZyk7XG4gIH1cblxuICByZXR1cm4gX2NvbWJpbmUob3B0aW1pemVkKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbWJpbmVTbGljZShzbGljZTogU2xpY2U8VGFnZ2VkICYgTGlua2VkTGlzdE5vZGU+KTogVGFnIHtcbiAgbGV0IG9wdGltaXplZDogVGFnW10gPSBbXTtcblxuICBsZXQgbm9kZSA9IHNsaWNlLmhlYWQoKTtcblxuICB3aGlsZShub2RlICE9PSBudWxsKSB7XG4gICAgbGV0IHRhZyA9IG5vZGUudGFnO1xuXG4gICAgaWYgKHRhZyA9PT0gVk9MQVRJTEVfVEFHKSByZXR1cm4gVk9MQVRJTEVfVEFHO1xuICAgIGlmICh0YWcgIT09IENPTlNUQU5UX1RBRykgb3B0aW1pemVkLnB1c2godGFnKTtcblxuICAgIG5vZGUgPSBzbGljZS5uZXh0Tm9kZShub2RlKTtcbiAgfVxuXG4gIHJldHVybiBfY29tYmluZShvcHRpbWl6ZWQpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY29tYmluZSh0YWdzOiBUYWdbXSk6IFRhZyB7XG4gIGxldCBvcHRpbWl6ZWQ6IFRhZ1tdID0gW107XG5cbiAgZm9yIChsZXQgaT0wLCBsPXRhZ3MubGVuZ3RoOyBpPGw7IGkrKykge1xuICAgIGxldCB0YWcgPSB0YWdzW2ldO1xuICAgIGlmICh0YWcgPT09IFZPTEFUSUxFX1RBRykgcmV0dXJuIFZPTEFUSUxFX1RBRztcbiAgICBpZiAodGFnID09PSBDT05TVEFOVF9UQUcpIGNvbnRpbnVlO1xuICAgIG9wdGltaXplZC5wdXNoKHRhZyk7XG4gIH1cblxuICByZXR1cm4gX2NvbWJpbmUob3B0aW1pemVkKTtcbn1cblxuZnVuY3Rpb24gX2NvbWJpbmUodGFnczogVGFnW10pOiBUYWcge1xuICBzd2l0Y2ggKHRhZ3MubGVuZ3RoKSB7XG4gICAgY2FzZSAwOlxuICAgICAgcmV0dXJuIENPTlNUQU5UX1RBRztcbiAgICBjYXNlIDE6XG4gICAgICByZXR1cm4gdGFnc1swXTtcbiAgICBjYXNlIDI6XG4gICAgICByZXR1cm4gVGFnc1BhaXIuY3JlYXRlKHRhZ3NbMF0sIHRhZ3NbMV0pO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gVGFnc0NvbWJpbmF0b3IuY3JlYXRlKHRhZ3MpO1xuICB9XG59XG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBDYWNoZWRUYWcgZXh0ZW5kcyBSZXZpc2lvblRhZyB7XG4gIHByaXZhdGUgbGFzdENoZWNrZWQ6IE9wdGlvbjxSZXZpc2lvbj4gPSBudWxsO1xuICBwcml2YXRlIGxhc3RWYWx1ZTogT3B0aW9uPFJldmlzaW9uPiA9IG51bGw7XG5cbiAgdmFsdWUoKTogUmV2aXNpb24ge1xuICAgIGxldCB7IGxhc3RDaGVja2VkLCBsYXN0VmFsdWUgfSA9IHRoaXM7XG5cbiAgICBpZiAobGFzdENoZWNrZWQgIT09ICRSRVZJU0lPTikge1xuICAgICAgdGhpcy5sYXN0Q2hlY2tlZCA9ICRSRVZJU0lPTjtcbiAgICAgIHRoaXMubGFzdFZhbHVlID0gbGFzdFZhbHVlID0gdGhpcy5jb21wdXRlKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMubGFzdFZhbHVlIGFzIFJldmlzaW9uO1xuICB9XG5cbiAgcHJvdGVjdGVkIGludmFsaWRhdGUoKSB7XG4gICAgdGhpcy5sYXN0Q2hlY2tlZCA9IG51bGw7XG4gIH1cblxuICBwcm90ZWN0ZWQgYWJzdHJhY3QgY29tcHV0ZSgpOiBSZXZpc2lvbjtcbn1cblxuY2xhc3MgVGFnc1BhaXIgZXh0ZW5kcyBDYWNoZWRUYWcge1xuICBzdGF0aWMgY3JlYXRlKGZpcnN0OiBUYWcsIHNlY29uZDogVGFnKSB7XG4gICAgcmV0dXJuIG5ldyBUYWdXcmFwcGVyKHRoaXMuaWQsIG5ldyBUYWdzUGFpcihmaXJzdCwgc2Vjb25kKSk7XG4gIH1cblxuICBwcml2YXRlIGZpcnN0OiBUYWc7XG4gIHByaXZhdGUgc2Vjb25kOiBUYWc7XG5cbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvcihmaXJzdDogVGFnLCBzZWNvbmQ6IFRhZykge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5maXJzdCA9IGZpcnN0O1xuICAgIHRoaXMuc2Vjb25kID0gc2Vjb25kO1xuICB9XG5cbiAgcHJvdGVjdGVkIGNvbXB1dGUoKTogUmV2aXNpb24ge1xuICAgIHJldHVybiBNYXRoLm1heCh0aGlzLmZpcnN0LnZhbHVlKCksIHRoaXMuc2Vjb25kLnZhbHVlKCkpO1xuICB9XG59XG5cbnJlZ2lzdGVyKFRhZ3NQYWlyKTtcblxuY2xhc3MgVGFnc0NvbWJpbmF0b3IgZXh0ZW5kcyBDYWNoZWRUYWcge1xuICBzdGF0aWMgY3JlYXRlKHRhZ3M6IFRhZ1tdKSB7XG4gICAgcmV0dXJuIG5ldyBUYWdXcmFwcGVyKHRoaXMuaWQsIG5ldyBUYWdzQ29tYmluYXRvcih0YWdzKSk7XG4gIH1cblxuICBwcml2YXRlIHRhZ3M6IFRhZ1tdO1xuXG4gIHByaXZhdGUgY29uc3RydWN0b3IodGFnczogVGFnW10pIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMudGFncyA9IHRhZ3M7XG4gIH1cblxuICBwcm90ZWN0ZWQgY29tcHV0ZSgpOiBSZXZpc2lvbiB7XG4gICAgbGV0IHsgdGFncyB9ID0gdGhpcztcblxuICAgIGxldCBtYXggPSAtMTtcblxuICAgIGZvciAobGV0IGk9MDsgaTx0YWdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgdmFsdWUgPSB0YWdzW2ldLnZhbHVlKCk7XG4gICAgICBtYXggPSBNYXRoLm1heCh2YWx1ZSwgbWF4KTtcbiAgICB9XG5cbiAgICByZXR1cm4gbWF4O1xuICB9XG59XG5cbnJlZ2lzdGVyKFRhZ3NDb21iaW5hdG9yKTtcblxuZXhwb3J0IGNsYXNzIFVwZGF0YWJsZVRhZyBleHRlbmRzIENhY2hlZFRhZyB7XG4gIHN0YXRpYyBjcmVhdGUodGFnOiBUYWcpOiBUYWdXcmFwcGVyPFVwZGF0YWJsZVRhZz4ge1xuICAgIHJldHVybiBuZXcgVGFnV3JhcHBlcih0aGlzLmlkLCBuZXcgVXBkYXRhYmxlVGFnKHRhZykpO1xuICB9XG5cbiAgcHJpdmF0ZSB0YWc6IFRhZztcbiAgcHJpdmF0ZSBsYXN0VXBkYXRlZDogbnVtYmVyO1xuXG4gIHByaXZhdGUgY29uc3RydWN0b3IodGFnOiBUYWcpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMudGFnID0gdGFnO1xuICAgIHRoaXMubGFzdFVwZGF0ZWQgPSBJTklUSUFMO1xuICB9XG5cbiAgcHJvdGVjdGVkIGNvbXB1dGUoKTogUmV2aXNpb24ge1xuICAgIHJldHVybiBNYXRoLm1heCh0aGlzLmxhc3RVcGRhdGVkLCB0aGlzLnRhZy52YWx1ZSgpKTtcbiAgfVxuXG4gIHVwZGF0ZSh0YWc6IFRhZykge1xuICAgIGlmICh0YWcgIT09IHRoaXMudGFnKSB7XG4gICAgICB0aGlzLnRhZyA9IHRhZztcbiAgICAgIHRoaXMubGFzdFVwZGF0ZWQgPSAkUkVWSVNJT047XG4gICAgICB0aGlzLmludmFsaWRhdGUoKTtcbiAgICB9XG4gIH1cbn1cblxucmVnaXN0ZXIoVXBkYXRhYmxlVGFnKTtcblxuLy8vLy8vLy8vL1xuXG5leHBvcnQgaW50ZXJmYWNlIFZlcnNpb25lZFJlZmVyZW5jZTxUID0gT3BhcXVlPiBleHRlbmRzIFJlZmVyZW5jZTxUPiwgVGFnZ2VkIHt9XG5cbmV4cG9ydCBpbnRlcmZhY2UgVmVyc2lvbmVkUGF0aFJlZmVyZW5jZTxUID0gT3BhcXVlPiBleHRlbmRzIFBhdGhSZWZlcmVuY2U8VD4sIFRhZ2dlZCB7XG4gIGdldChwcm9wZXJ0eTogc3RyaW5nKTogVmVyc2lvbmVkUGF0aFJlZmVyZW5jZTxPcGFxdWU+O1xufVxuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQ2FjaGVkUmVmZXJlbmNlPFQ+IGltcGxlbWVudHMgVmVyc2lvbmVkUmVmZXJlbmNlPFQ+IHtcbiAgcHVibGljIGFic3RyYWN0IHRhZzogVGFnO1xuXG4gIHByaXZhdGUgbGFzdFJldmlzaW9uOiBPcHRpb248UmV2aXNpb24+ID0gbnVsbDtcbiAgcHJpdmF0ZSBsYXN0VmFsdWU6IE9wdGlvbjxUPiA9IG51bGw7XG5cbiAgdmFsdWUoKTogVCB7XG4gICAgbGV0IHsgdGFnLCBsYXN0UmV2aXNpb24sIGxhc3RWYWx1ZSB9ID0gdGhpcztcblxuICAgIGlmIChsYXN0UmV2aXNpb24gPT09IG51bGwgfHwgIXRhZy52YWxpZGF0ZShsYXN0UmV2aXNpb24pKSB7XG4gICAgICBsYXN0VmFsdWUgPSB0aGlzLmxhc3RWYWx1ZSA9IHRoaXMuY29tcHV0ZSgpO1xuICAgICAgdGhpcy5sYXN0UmV2aXNpb24gPSB0YWcudmFsdWUoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbGFzdFZhbHVlIGFzIFQ7XG4gIH1cblxuICBwcm90ZWN0ZWQgYWJzdHJhY3QgY29tcHV0ZSgpOiBUO1xuXG4gIHByb3RlY3RlZCBpbnZhbGlkYXRlKCkge1xuICAgIHRoaXMubGFzdFJldmlzaW9uID0gbnVsbDtcbiAgfVxufVxuXG4vLy8vLy8vLy8vXG5cbmV4cG9ydCB0eXBlIE1hcHBlcjxULCBVPiA9ICh2YWx1ZTogVCkgPT4gVTtcblxuY2xhc3MgTWFwcGVyUmVmZXJlbmNlPFQsIFU+IGV4dGVuZHMgQ2FjaGVkUmVmZXJlbmNlPFU+IHtcbiAgcHVibGljIHRhZzogVGFnO1xuXG4gIHByaXZhdGUgcmVmZXJlbmNlOiBWZXJzaW9uZWRSZWZlcmVuY2U8VD47XG4gIHByaXZhdGUgbWFwcGVyOiBNYXBwZXI8VCwgVT47XG5cbiAgY29uc3RydWN0b3IocmVmZXJlbmNlOiBWZXJzaW9uZWRSZWZlcmVuY2U8VD4sIG1hcHBlcjogTWFwcGVyPFQsIFU+KSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLnRhZyA9IHJlZmVyZW5jZS50YWc7XG4gICAgdGhpcy5yZWZlcmVuY2UgPSByZWZlcmVuY2U7XG4gICAgdGhpcy5tYXBwZXIgPSBtYXBwZXI7XG4gIH1cblxuICBwcm90ZWN0ZWQgY29tcHV0ZSgpOiBVIHtcbiAgICBsZXQgeyByZWZlcmVuY2UsIG1hcHBlciB9ID0gdGhpcztcbiAgICByZXR1cm4gbWFwcGVyKHJlZmVyZW5jZS52YWx1ZSgpKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbWFwPFQsIFU+KHJlZmVyZW5jZTogVmVyc2lvbmVkUmVmZXJlbmNlPFQ+LCBtYXBwZXI6IE1hcHBlcjxULCBVPik6IFZlcnNpb25lZFJlZmVyZW5jZTxVPiB7XG4gIHJldHVybiBuZXcgTWFwcGVyUmVmZXJlbmNlPFQsIFU+KHJlZmVyZW5jZSwgbWFwcGVyKTtcbn1cblxuLy8vLy8vLy8vL1xuXG5leHBvcnQgY2xhc3MgUmVmZXJlbmNlQ2FjaGU8VD4gaW1wbGVtZW50cyBUYWdnZWQge1xuICBwdWJsaWMgdGFnOiBUYWc7XG5cbiAgcHJpdmF0ZSByZWZlcmVuY2U6IFZlcnNpb25lZFJlZmVyZW5jZTxUPjtcbiAgcHJpdmF0ZSBsYXN0VmFsdWU6IE9wdGlvbjxUPiA9IG51bGw7XG4gIHByaXZhdGUgbGFzdFJldmlzaW9uOiBPcHRpb248UmV2aXNpb24+ID0gbnVsbDtcbiAgcHJpdmF0ZSBpbml0aWFsaXplZCA9IGZhbHNlO1xuXG4gIGNvbnN0cnVjdG9yKHJlZmVyZW5jZTogVmVyc2lvbmVkUmVmZXJlbmNlPFQ+KSB7XG4gICAgdGhpcy50YWcgPSByZWZlcmVuY2UudGFnO1xuICAgIHRoaXMucmVmZXJlbmNlID0gcmVmZXJlbmNlO1xuICB9XG5cbiAgcGVlaygpOiBUIHtcbiAgICBpZiAoIXRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgIHJldHVybiB0aGlzLmluaXRpYWxpemUoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5sYXN0VmFsdWUgYXMgVDtcbiAgfVxuXG4gIHJldmFsaWRhdGUoKTogVmFsaWRhdGlvbjxUPiB7XG4gICAgaWYgKCF0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICByZXR1cm4gdGhpcy5pbml0aWFsaXplKCk7XG4gICAgfVxuXG4gICAgbGV0IHsgcmVmZXJlbmNlLCBsYXN0UmV2aXNpb24gfSA9IHRoaXM7XG4gICAgbGV0IHRhZyA9IHJlZmVyZW5jZS50YWc7XG5cbiAgICBpZiAodGFnLnZhbGlkYXRlKGxhc3RSZXZpc2lvbiBhcyBudW1iZXIpKSByZXR1cm4gTk9UX01PRElGSUVEO1xuICAgIHRoaXMubGFzdFJldmlzaW9uID0gdGFnLnZhbHVlKCk7XG5cbiAgICBsZXQgeyBsYXN0VmFsdWUgfSA9IHRoaXM7XG4gICAgbGV0IHZhbHVlID0gcmVmZXJlbmNlLnZhbHVlKCk7XG4gICAgaWYgKHZhbHVlID09PSBsYXN0VmFsdWUpIHJldHVybiBOT1RfTU9ESUZJRUQ7XG4gICAgdGhpcy5sYXN0VmFsdWUgPSB2YWx1ZTtcblxuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuXG4gIHByaXZhdGUgaW5pdGlhbGl6ZSgpOiBUIHtcbiAgICBsZXQgeyByZWZlcmVuY2UgfSA9IHRoaXM7XG5cbiAgICBsZXQgdmFsdWUgPSB0aGlzLmxhc3RWYWx1ZSA9IHJlZmVyZW5jZS52YWx1ZSgpO1xuICAgIHRoaXMubGFzdFJldmlzaW9uID0gcmVmZXJlbmNlLnRhZy52YWx1ZSgpO1xuICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuXG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG59XG5cbmV4cG9ydCB0eXBlIFZhbGlkYXRpb248VD4gPSBUIHwgTm90TW9kaWZpZWQ7XG5cbmV4cG9ydCB0eXBlIE5vdE1vZGlmaWVkID0gXCJhZGIzYjc4ZS0zZDIyLTRlNGItODc3YS02MzE3YzJjNWMxNDVcIjtcblxuY29uc3QgTk9UX01PRElGSUVEOiBOb3RNb2RpZmllZCA9IFwiYWRiM2I3OGUtM2QyMi00ZTRiLTg3N2EtNjMxN2MyYzVjMTQ1XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBpc01vZGlmaWVkPFQ+KHZhbHVlOiBWYWxpZGF0aW9uPFQ+KTogdmFsdWUgaXMgVCB7XG4gIHJldHVybiB2YWx1ZSAhPT0gTk9UX01PRElGSUVEO1xufVxuIl19","import { CONSTANT_TAG } from './validators';\nexport class ConstReference {\n    constructor(inner) {\n        this.inner = inner;\n        this.tag = CONSTANT_TAG;\n    }\n    value() {\n        return this.inner;\n    }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci9yZWZlcmVuY2UvbGliL2NvbnN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLEFBQU8sU0FBRSxBQUFZLEFBQTJCLG9CQUFNLEFBQWMsQUFBQztBQUVyRSxBQUFNO0FBR0osZ0JBQXNCLEFBQVE7QUFBUixhQUFLLFFBQUwsQUFBSyxBQUFHO0FBRnZCLGFBQUcsTUFBUSxBQUFZLEFBQUMsQUFFRztBQUFDO0FBRW5DLEFBQUs7QUFBUSxBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQUssQUFBQyxBQUFDO0FBQUMsQUFDbEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDT05TVEFOVF9UQUcsIFZlcnNpb25lZFJlZmVyZW5jZSwgVGFnIH0gZnJvbSAnLi92YWxpZGF0b3JzJztcblxuZXhwb3J0IGNsYXNzIENvbnN0UmVmZXJlbmNlPFQ+IGltcGxlbWVudHMgVmVyc2lvbmVkUmVmZXJlbmNlPFQ+IHtcbiAgcHVibGljIHRhZzogVGFnID0gQ09OU1RBTlRfVEFHO1xuXG4gIGNvbnN0cnVjdG9yKHByb3RlY3RlZCBpbm5lcjogVCkgeyB9XG5cbiAgdmFsdWUoKTogVCB7IHJldHVybiB0aGlzLmlubmVyOyB9XG59XG4iXX0=","import { LinkedList, ListNode, dict } from '@glimmer/util';\nexport class ListItem extends ListNode {\n    constructor(iterable, result) {\n        super(iterable.valueReferenceFor(result));\n        this.retained = false;\n        this.seen = false;\n        this.key = result.key;\n        this.iterable = iterable;\n        this.memo = iterable.memoReferenceFor(result);\n    }\n    update(item) {\n        this.retained = true;\n        this.iterable.updateValueReference(this.value, item);\n        this.iterable.updateMemoReference(this.memo, item);\n    }\n    shouldRemove() {\n        return !this.retained;\n    }\n    reset() {\n        this.retained = false;\n        this.seen = false;\n    }\n}\nexport class IterationArtifacts {\n    constructor(iterable) {\n        this.iterator = null;\n        this.map = dict();\n        this.list = new LinkedList();\n        this.tag = iterable.tag;\n        this.iterable = iterable;\n    }\n    isEmpty() {\n        let iterator = this.iterator = this.iterable.iterate();\n        return iterator.isEmpty();\n    }\n    iterate() {\n        let iterator;\n        if (this.iterator === null) {\n            iterator = this.iterable.iterate();\n        } else {\n            iterator = this.iterator;\n        }\n        this.iterator = null;\n        return iterator;\n    }\n    has(key) {\n        return !!this.map[key];\n    }\n    get(key) {\n        return this.map[key];\n    }\n    wasSeen(key) {\n        let node = this.map[key];\n        return node !== undefined && node.seen;\n    }\n    append(item) {\n        let { map, list, iterable } = this;\n        let node = map[item.key] = new ListItem(iterable, item);\n        list.append(node);\n        return node;\n    }\n    insertBefore(item, reference) {\n        let { map, list, iterable } = this;\n        let node = map[item.key] = new ListItem(iterable, item);\n        node.retained = true;\n        list.insertBefore(node, reference);\n        return node;\n    }\n    move(item, reference) {\n        let { list } = this;\n        item.retained = true;\n        list.remove(item);\n        list.insertBefore(item, reference);\n    }\n    remove(item) {\n        let { list } = this;\n        list.remove(item);\n        delete this.map[item.key];\n    }\n    nextNode(item) {\n        return this.list.nextNode(item);\n    }\n    head() {\n        return this.list.head();\n    }\n}\nexport class ReferenceIterator {\n    // if anyone needs to construct this object with something other than\n    // an iterable, let @wycats know.\n    constructor(iterable) {\n        this.iterator = null;\n        let artifacts = new IterationArtifacts(iterable);\n        this.artifacts = artifacts;\n    }\n    next() {\n        let { artifacts } = this;\n        let iterator = this.iterator = this.iterator || artifacts.iterate();\n        let item = iterator.next();\n        if (item === null) return null;\n        return artifacts.append(item);\n    }\n}\nvar Phase;\n(function (Phase) {\n    Phase[Phase[\"Append\"] = 0] = \"Append\";\n    Phase[Phase[\"Prune\"] = 1] = \"Prune\";\n    Phase[Phase[\"Done\"] = 2] = \"Done\";\n})(Phase || (Phase = {}));\nexport class IteratorSynchronizer {\n    constructor({ target, artifacts }) {\n        this.target = target;\n        this.artifacts = artifacts;\n        this.iterator = artifacts.iterate();\n        this.current = artifacts.head();\n    }\n    sync() {\n        let phase = Phase.Append;\n        while (true) {\n            switch (phase) {\n                case Phase.Append:\n                    phase = this.nextAppend();\n                    break;\n                case Phase.Prune:\n                    phase = this.nextPrune();\n                    break;\n                case Phase.Done:\n                    this.nextDone();\n                    return;\n            }\n        }\n    }\n    advanceToKey(key) {\n        let { current, artifacts } = this;\n        let seek = current;\n        while (seek !== null && seek.key !== key) {\n            seek.seen = true;\n            seek = artifacts.nextNode(seek);\n        }\n        if (seek !== null) {\n            this.current = artifacts.nextNode(seek);\n        }\n    }\n    nextAppend() {\n        let { iterator, current, artifacts } = this;\n        let item = iterator.next();\n        if (item === null) {\n            return this.startPrune();\n        }\n        let { key } = item;\n        if (current !== null && current.key === key) {\n            this.nextRetain(item);\n        } else if (artifacts.has(key)) {\n            this.nextMove(item);\n        } else {\n            this.nextInsert(item);\n        }\n        return Phase.Append;\n    }\n    nextRetain(item) {\n        let { artifacts, current } = this;\n        current = current;\n        current.update(item);\n        this.current = artifacts.nextNode(current);\n        this.target.retain(item.key, current.value, current.memo);\n    }\n    nextMove(item) {\n        let { current, artifacts, target } = this;\n        let { key } = item;\n        let found = artifacts.get(item.key);\n        found.update(item);\n        if (artifacts.wasSeen(item.key)) {\n            artifacts.move(found, current);\n            target.move(found.key, found.value, found.memo, current ? current.key : null);\n        } else {\n            this.advanceToKey(key);\n        }\n    }\n    nextInsert(item) {\n        let { artifacts, target, current } = this;\n        let node = artifacts.insertBefore(item, current);\n        target.insert(node.key, node.value, node.memo, current ? current.key : null);\n    }\n    startPrune() {\n        this.current = this.artifacts.head();\n        return Phase.Prune;\n    }\n    nextPrune() {\n        let { artifacts, target, current } = this;\n        if (current === null) {\n            return Phase.Done;\n        }\n        let node = current;\n        this.current = artifacts.nextNode(node);\n        if (node.shouldRemove()) {\n            artifacts.remove(node);\n            target.delete(node.key);\n        } else {\n            node.reset();\n        }\n        return Phase.Prune;\n    }\n    nextDone() {\n        this.target.done();\n    }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaXRlcmFibGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci9yZWZlcmVuY2UvbGliL2l0ZXJhYmxlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLEFBQU8sU0FBRSxBQUFVLFlBQUUsQUFBUSxVQUFrQixBQUFJLEFBQUUsQUFBTSxBQUFFLFlBQU0sQUFBZSxBQUFDO0FBa0NuRixBQUFNLGFBQWdCLGlCQUFRLEFBQTZCO0FBT3pELGdCQUFZLEFBQXdCLFVBQUUsQUFBMkI7QUFDL0QsQUFBSyxjQUFDLEFBQVEsU0FBQyxBQUFpQixrQkFBQyxBQUFNLEFBQUMsQUFBQyxBQUFDO0FBTHJDLGFBQVEsV0FBRyxBQUFLLEFBQUM7QUFDakIsYUFBSSxPQUFHLEFBQUssQUFBQztBQUtsQixBQUFJLGFBQUMsQUFBRyxNQUFHLEFBQU0sT0FBQyxBQUFHLEFBQUM7QUFDdEIsQUFBSSxhQUFDLEFBQVEsV0FBRyxBQUFRLEFBQUM7QUFDekIsQUFBSSxhQUFDLEFBQUksT0FBRyxBQUFRLFNBQUMsQUFBZ0IsaUJBQUMsQUFBTSxBQUFDLEFBQUMsQUFDaEQ7QUFBQztBQUVELEFBQU0sV0FBQyxBQUF5QjtBQUM5QixBQUFJLGFBQUMsQUFBUSxXQUFHLEFBQUksQUFBQztBQUNyQixBQUFJLGFBQUMsQUFBUSxTQUFDLEFBQW9CLHFCQUFDLEFBQUksS0FBQyxBQUFLLE9BQUUsQUFBSSxBQUFDLEFBQUM7QUFDckQsQUFBSSxhQUFDLEFBQVEsU0FBQyxBQUFtQixvQkFBQyxBQUFJLEtBQUMsQUFBSSxNQUFFLEFBQUksQUFBQyxBQUFDLEFBQ3JEO0FBQUM7QUFFRCxBQUFZO0FBQ1YsQUFBTSxlQUFDLENBQUMsQUFBSSxLQUFDLEFBQVEsQUFBQyxBQUN4QjtBQUFDO0FBRUQsQUFBSztBQUNILEFBQUksYUFBQyxBQUFRLFdBQUcsQUFBSyxBQUFDO0FBQ3RCLEFBQUksYUFBQyxBQUFJLE9BQUcsQUFBSyxBQUFDLEFBQ3BC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aW1wb3J0IHsgTGlua2VkTGlzdCwgTGlzdE5vZGUsIE9wYXF1ZSwgT3B0aW9uLCBkaWN0LCBleHBlY3QgfSBmcm9tICdAZ2xpbW1lci91dGlsJztcbmltcG9ydCB7IFZlcnNpb25lZFBhdGhSZWZlcmVuY2UgYXMgUGF0aFJlZmVyZW5jZSwgVGFnIH0gZnJvbSAnLi92YWxpZGF0b3JzJztcblxuZXhwb3J0IGludGVyZmFjZSBJdGVyYXRpb25JdGVtPFQsIFU+IHtcbiAga2V5OiBzdHJpbmc7XG4gIHZhbHVlOiBUO1xuICBtZW1vOiBVO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFic3RyYWN0SXRlcmF0b3I8VCwgVSwgViBleHRlbmRzIEl0ZXJhdGlvbkl0ZW08VCwgVT4+IHtcbiAgaXNFbXB0eSgpOiBib29sZWFuO1xuICBuZXh0KCk6IE9wdGlvbjxWPjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBBYnN0cmFjdEl0ZXJhYmxlPFQsIFUsIEl0ZW1UeXBlIGV4dGVuZHMgSXRlcmF0aW9uSXRlbTxULCBVPiwgVmFsdWVSZWZlcmVuY2VUeXBlIGV4dGVuZHMgUGF0aFJlZmVyZW5jZTxUPiwgTWVtb1JlZmVyZW5jZVR5cGUgZXh0ZW5kcyBQYXRoUmVmZXJlbmNlPFU+PiB7XG4gIHRhZzogVGFnO1xuICBpdGVyYXRlKCk6IEFic3RyYWN0SXRlcmF0b3I8VCwgVSwgSXRlbVR5cGU+O1xuXG4gIHZhbHVlUmVmZXJlbmNlRm9yKGl0ZW06IEl0ZW1UeXBlKTogVmFsdWVSZWZlcmVuY2VUeXBlO1xuICB1cGRhdGVWYWx1ZVJlZmVyZW5jZShyZWZlcmVuY2U6IFZhbHVlUmVmZXJlbmNlVHlwZSwgaXRlbTogSXRlbVR5cGUpOiB2b2lkO1xuXG4gIG1lbW9SZWZlcmVuY2VGb3IoaXRlbTogSXRlbVR5cGUpOiBNZW1vUmVmZXJlbmNlVHlwZTtcbiAgdXBkYXRlTWVtb1JlZmVyZW5jZShyZWZlcmVuY2U6IE1lbW9SZWZlcmVuY2VUeXBlLCBpdGVtOiBJdGVtVHlwZSk6IHZvaWQ7XG59XG5cbmV4cG9ydCB0eXBlIEl0ZXJhdG9yPFQsIFU+ID0gQWJzdHJhY3RJdGVyYXRvcjxULCBVLCBJdGVyYXRpb25JdGVtPFQsIFU+PjtcbmV4cG9ydCB0eXBlIEl0ZXJhYmxlPFQsIFU+ID0gQWJzdHJhY3RJdGVyYWJsZTxULCBVLCBJdGVyYXRpb25JdGVtPFQsIFU+LCBQYXRoUmVmZXJlbmNlPFQ+LCBQYXRoUmVmZXJlbmNlPFU+PjtcblxuZXhwb3J0IHR5cGUgT3BhcXVlSXRlcmF0aW9uSXRlbSA9IEl0ZXJhdGlvbkl0ZW08T3BhcXVlLCBPcGFxdWU+O1xuZXhwb3J0IHR5cGUgT3BhcXVlSXRlcmF0b3IgPSBBYnN0cmFjdEl0ZXJhdG9yPE9wYXF1ZSwgT3BhcXVlLCBPcGFxdWVJdGVyYXRpb25JdGVtPjtcbmV4cG9ydCB0eXBlIE9wYXF1ZVBhdGhSZWZlcmVuY2UgPSBQYXRoUmVmZXJlbmNlPE9wYXF1ZT47XG5leHBvcnQgdHlwZSBPcGFxdWVJdGVyYWJsZSA9IEFic3RyYWN0SXRlcmFibGU8T3BhcXVlLCBPcGFxdWUsIE9wYXF1ZUl0ZXJhdGlvbkl0ZW0sIE9wYXF1ZVBhdGhSZWZlcmVuY2UsIE9wYXF1ZVBhdGhSZWZlcmVuY2U+O1xuZXhwb3J0IHR5cGUgT3BhcXVlUGF0aFJlZmVyZW5jZUl0ZXJhdGlvbkl0ZW0gPSBJdGVyYXRpb25JdGVtPE9wYXF1ZVBhdGhSZWZlcmVuY2UsIE9wYXF1ZVBhdGhSZWZlcmVuY2U+O1xuXG5leHBvcnQgY2xhc3MgTGlzdEl0ZW0gZXh0ZW5kcyBMaXN0Tm9kZTxPcGFxdWVQYXRoUmVmZXJlbmNlPiBpbXBsZW1lbnRzIE9wYXF1ZUl0ZXJhdGlvbkl0ZW0ge1xuICBwdWJsaWMga2V5OiBzdHJpbmc7XG4gIHB1YmxpYyBtZW1vOiBPcGFxdWVQYXRoUmVmZXJlbmNlO1xuICBwdWJsaWMgcmV0YWluZWQgPSBmYWxzZTtcbiAgcHVibGljIHNlZW4gPSBmYWxzZTtcbiAgcHJpdmF0ZSBpdGVyYWJsZTogT3BhcXVlSXRlcmFibGU7XG5cbiAgY29uc3RydWN0b3IoaXRlcmFibGU6IE9wYXF1ZUl0ZXJhYmxlLCByZXN1bHQ6IE9wYXF1ZUl0ZXJhdGlvbkl0ZW0pIHtcbiAgICBzdXBlcihpdGVyYWJsZS52YWx1ZVJlZmVyZW5jZUZvcihyZXN1bHQpKTtcbiAgICB0aGlzLmtleSA9IHJlc3VsdC5rZXk7XG4gICAgdGhpcy5pdGVyYWJsZSA9IGl0ZXJhYmxlO1xuICAgIHRoaXMubWVtbyA9IGl0ZXJhYmxlLm1lbW9SZWZlcmVuY2VGb3IocmVzdWx0KTtcbiAgfVxuXG4gIHVwZGF0ZShpdGVtOiBPcGFxdWVJdGVyYXRpb25JdGVtKSB7XG4gICAgdGhpcy5yZXRhaW5lZCA9IHRydWU7XG4gICAgdGhpcy5pdGVyYWJsZS51cGRhdGVWYWx1ZVJlZmVyZW5jZSh0aGlzLnZhbHVlLCBpdGVtKTtcbiAgICB0aGlzLml0ZXJhYmxlLnVwZGF0ZU1lbW9SZWZlcmVuY2UodGhpcy5tZW1vLCBpdGVtKTtcbiAgfVxuXG4gIHNob3VsZFJlbW92ZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gIXRoaXMucmV0YWluZWQ7XG4gIH1cblxuICByZXNldCgpIHtcbiAgICB0aGlzLnJldGFpbmVkID0gZmFsc2U7XG4gICAgdGhpcy5zZWVuID0gZmFsc2U7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIEl0ZXJhdGlvbkFydGlmYWN0cyB7XG4gIHB1YmxpYyB0YWc6IFRhZztcblxuICBwcml2YXRlIGl0ZXJhYmxlOiBPcGFxdWVJdGVyYWJsZTtcbiAgcHJpdmF0ZSBpdGVyYXRvcjogT3B0aW9uPE9wYXF1ZUl0ZXJhdG9yPiA9IG51bGw7XG4gIHByaXZhdGUgbWFwID0gZGljdDxMaXN0SXRlbT4oKTtcbiAgcHJpdmF0ZSBsaXN0ID0gbmV3IExpbmtlZExpc3Q8TGlzdEl0ZW0+KCk7XG5cbiAgY29uc3RydWN0b3IoaXRlcmFibGU6IE9wYXF1ZUl0ZXJhYmxlKSB7XG4gICAgdGhpcy50YWcgPSBpdGVyYWJsZS50YWc7XG4gICAgdGhpcy5pdGVyYWJsZSA9IGl0ZXJhYmxlO1xuICB9XG5cbiAgaXNFbXB0eSgpOiBib29sZWFuIHtcbiAgICBsZXQgaXRlcmF0b3IgPSB0aGlzLml0ZXJhdG9yID0gdGhpcy5pdGVyYWJsZS5pdGVyYXRlKCk7XG4gICAgcmV0dXJuIGl0ZXJhdG9yLmlzRW1wdHkoKTtcbiAgfVxuXG4gIGl0ZXJhdGUoKTogT3BhcXVlSXRlcmF0b3Ige1xuICAgIGxldCBpdGVyYXRvcjogT3BhcXVlSXRlcmF0b3I7XG5cbiAgICBpZiAodGhpcy5pdGVyYXRvciA9PT0gbnVsbCkge1xuICAgICAgaXRlcmF0b3IgPSB0aGlzLml0ZXJhYmxlLml0ZXJhdGUoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaXRlcmF0b3IgPSB0aGlzLml0ZXJhdG9yO1xuICAgIH1cblxuICAgIHRoaXMuaXRlcmF0b3IgPSBudWxsO1xuXG4gICAgcmV0dXJuIGl0ZXJhdG9yO1xuICB9XG5cbiAgaGFzKGtleTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICEhdGhpcy5tYXBba2V5XTtcbiAgfVxuXG4gIGdldChrZXk6IHN0cmluZyk6IExpc3RJdGVtIHtcbiAgICByZXR1cm4gdGhpcy5tYXBba2V5XTtcbiAgfVxuXG4gIHdhc1NlZW4oa2V5OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICBsZXQgbm9kZSA9IHRoaXMubWFwW2tleV07XG4gICAgcmV0dXJuIG5vZGUgIT09IHVuZGVmaW5lZCAmJiBub2RlLnNlZW47XG4gIH1cblxuICBhcHBlbmQoaXRlbTogT3BhcXVlSXRlcmF0aW9uSXRlbSk6IExpc3RJdGVtIHtcbiAgICBsZXQgeyBtYXAsIGxpc3QsIGl0ZXJhYmxlIH0gPSB0aGlzO1xuICAgIGxldCBub2RlID0gbWFwW2l0ZW0ua2V5XSA9IG5ldyBMaXN0SXRlbShpdGVyYWJsZSwgaXRlbSk7XG5cbiAgICBsaXN0LmFwcGVuZChub2RlKTtcbiAgICByZXR1cm4gbm9kZTtcbiAgfVxuXG4gIGluc2VydEJlZm9yZShpdGVtOiBPcGFxdWVJdGVyYXRpb25JdGVtLCByZWZlcmVuY2U6IE9wdGlvbjxMaXN0SXRlbT4pOiBMaXN0SXRlbSB7XG4gICAgbGV0IHsgbWFwLCBsaXN0LCBpdGVyYWJsZSB9ID0gdGhpcztcblxuICAgIGxldCBub2RlID0gbWFwW2l0ZW0ua2V5XSA9IG5ldyBMaXN0SXRlbShpdGVyYWJsZSwgaXRlbSk7XG4gICAgbm9kZS5yZXRhaW5lZCA9IHRydWU7XG4gICAgbGlzdC5pbnNlcnRCZWZvcmUobm9kZSwgcmVmZXJlbmNlKTtcbiAgICByZXR1cm4gbm9kZTtcbiAgfVxuXG4gIG1vdmUoaXRlbTogTGlzdEl0ZW0sIHJlZmVyZW5jZTogT3B0aW9uPExpc3RJdGVtPik6IHZvaWQge1xuICAgIGxldCB7IGxpc3QgfSA9IHRoaXM7XG5cbiAgICBpdGVtLnJldGFpbmVkID0gdHJ1ZTtcbiAgICBsaXN0LnJlbW92ZShpdGVtKTtcbiAgICBsaXN0Lmluc2VydEJlZm9yZShpdGVtLCByZWZlcmVuY2UpO1xuICB9XG5cbiAgcmVtb3ZlKGl0ZW06IExpc3RJdGVtKTogdm9pZCB7XG4gICAgbGV0IHsgbGlzdCB9ID0gdGhpcztcblxuICAgIGxpc3QucmVtb3ZlKGl0ZW0pO1xuICAgIGRlbGV0ZSB0aGlzLm1hcFtpdGVtLmtleV07XG4gIH1cblxuICBuZXh0Tm9kZShpdGVtOiBMaXN0SXRlbSk6IExpc3RJdGVtIHtcbiAgICByZXR1cm4gdGhpcy5saXN0Lm5leHROb2RlKGl0ZW0pO1xuICB9XG5cbiAgaGVhZCgpOiBPcHRpb248TGlzdEl0ZW0+IHtcbiAgICByZXR1cm4gdGhpcy5saXN0LmhlYWQoKTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgUmVmZXJlbmNlSXRlcmF0b3Ige1xuICBwdWJsaWMgYXJ0aWZhY3RzOiBJdGVyYXRpb25BcnRpZmFjdHM7XG4gIHByaXZhdGUgaXRlcmF0b3I6IE9wdGlvbjxPcGFxdWVJdGVyYXRvcj4gPSBudWxsO1xuXG4gIC8vIGlmIGFueW9uZSBuZWVkcyB0byBjb25zdHJ1Y3QgdGhpcyBvYmplY3Qgd2l0aCBzb21ldGhpbmcgb3RoZXIgdGhhblxuICAvLyBhbiBpdGVyYWJsZSwgbGV0IEB3eWNhdHMga25vdy5cbiAgY29uc3RydWN0b3IoaXRlcmFibGU6IE9wYXF1ZUl0ZXJhYmxlKSB7XG4gICAgbGV0IGFydGlmYWN0cyA9IG5ldyBJdGVyYXRpb25BcnRpZmFjdHMoaXRlcmFibGUpO1xuICAgIHRoaXMuYXJ0aWZhY3RzID0gYXJ0aWZhY3RzO1xuICB9XG5cbiAgbmV4dCgpOiBPcHRpb248TGlzdEl0ZW0+IHtcbiAgICBsZXQgeyBhcnRpZmFjdHMgfSA9IHRoaXM7XG5cbiAgICBsZXQgaXRlcmF0b3IgPSAodGhpcy5pdGVyYXRvciA9IHRoaXMuaXRlcmF0b3IgfHwgYXJ0aWZhY3RzLml0ZXJhdGUoKSk7XG5cbiAgICBsZXQgaXRlbSA9IGl0ZXJhdG9yLm5leHQoKTtcblxuICAgIGlmIChpdGVtID09PSBudWxsKSByZXR1cm4gbnVsbDtcblxuICAgIHJldHVybiBhcnRpZmFjdHMuYXBwZW5kKGl0ZW0pO1xuICB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSXRlcmF0b3JTeW5jaHJvbml6ZXJEZWxlZ2F0ZSB7XG4gIHJldGFpbihrZXk6IHN0cmluZywgaXRlbTogUGF0aFJlZmVyZW5jZTxPcGFxdWU+LCBtZW1vOiBQYXRoUmVmZXJlbmNlPE9wYXF1ZT4pOiB2b2lkO1xuICBpbnNlcnQoa2V5OiBzdHJpbmcsIGl0ZW06IFBhdGhSZWZlcmVuY2U8T3BhcXVlPiwgbWVtbzogUGF0aFJlZmVyZW5jZTxPcGFxdWU+LCBiZWZvcmU6IE9wdGlvbjxzdHJpbmc+KTogdm9pZDtcbiAgbW92ZShrZXk6IHN0cmluZywgaXRlbTogUGF0aFJlZmVyZW5jZTxPcGFxdWU+LCBtZW1vOiBQYXRoUmVmZXJlbmNlPE9wYXF1ZT4sIGJlZm9yZTogT3B0aW9uPHN0cmluZz4pOiB2b2lkO1xuICBkZWxldGUoa2V5OiBzdHJpbmcpOiB2b2lkO1xuICBkb25lKCk6IHZvaWQ7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSXRlcmF0b3JTeW5jaHJvbml6ZXJPcHRpb25zIHtcbiAgdGFyZ2V0OiBJdGVyYXRvclN5bmNocm9uaXplckRlbGVnYXRlO1xuICBhcnRpZmFjdHM6IEl0ZXJhdGlvbkFydGlmYWN0cztcbn1cblxuZW51bSBQaGFzZSB7XG4gIEFwcGVuZCxcbiAgUHJ1bmUsXG4gIERvbmVcbn1cblxuZXhwb3J0IGNsYXNzIEl0ZXJhdG9yU3luY2hyb25pemVyIHtcbiAgcHJpdmF0ZSB0YXJnZXQ6IEl0ZXJhdG9yU3luY2hyb25pemVyRGVsZWdhdGU7XG4gIHByaXZhdGUgaXRlcmF0b3I6IE9wYXF1ZUl0ZXJhdG9yO1xuICBwcml2YXRlIGN1cnJlbnQ6IE9wdGlvbjxMaXN0SXRlbT47XG4gIHByaXZhdGUgYXJ0aWZhY3RzOiBJdGVyYXRpb25BcnRpZmFjdHM7XG5cbiAgY29uc3RydWN0b3IoeyB0YXJnZXQsIGFydGlmYWN0cyB9OiBJdGVyYXRvclN5bmNocm9uaXplck9wdGlvbnMpIHtcbiAgICB0aGlzLnRhcmdldCA9IHRhcmdldDtcbiAgICB0aGlzLmFydGlmYWN0cyA9IGFydGlmYWN0cztcbiAgICB0aGlzLml0ZXJhdG9yID0gYXJ0aWZhY3RzLml0ZXJhdGUoKTtcbiAgICB0aGlzLmN1cnJlbnQgPSBhcnRpZmFjdHMuaGVhZCgpO1xuICB9XG5cbiAgc3luYygpIHtcbiAgICBsZXQgcGhhc2U6IFBoYXNlID0gUGhhc2UuQXBwZW5kO1xuXG4gICAgd2hpbGUgKHRydWUpIHtcbiAgICAgIHN3aXRjaCAocGhhc2UpIHtcbiAgICAgICAgY2FzZSBQaGFzZS5BcHBlbmQ6IHBoYXNlID0gdGhpcy5uZXh0QXBwZW5kKCk7IGJyZWFrO1xuICAgICAgICBjYXNlIFBoYXNlLlBydW5lOiBwaGFzZSA9IHRoaXMubmV4dFBydW5lKCk7IGJyZWFrO1xuICAgICAgICBjYXNlIFBoYXNlLkRvbmU6IHRoaXMubmV4dERvbmUoKTsgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYWR2YW5jZVRvS2V5KGtleTogc3RyaW5nKSB7XG4gICAgbGV0IHsgY3VycmVudCwgYXJ0aWZhY3RzIH0gPSB0aGlzO1xuXG4gICAgbGV0IHNlZWsgPSBjdXJyZW50O1xuXG4gICAgd2hpbGUgKHNlZWsgIT09IG51bGwgJiYgc2Vlay5rZXkgIT09IGtleSkge1xuICAgICAgc2Vlay5zZWVuID0gdHJ1ZTtcbiAgICAgIHNlZWsgPSBhcnRpZmFjdHMubmV4dE5vZGUoc2Vlayk7XG4gICAgfVxuXG4gICAgaWYgKHNlZWsgIT09IG51bGwpIHtcbiAgICAgIHRoaXMuY3VycmVudCA9IGFydGlmYWN0cy5uZXh0Tm9kZShzZWVrKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIG5leHRBcHBlbmQoKTogUGhhc2Uge1xuICAgIGxldCB7IGl0ZXJhdG9yLCBjdXJyZW50LCBhcnRpZmFjdHMgfSA9IHRoaXM7XG5cbiAgICBsZXQgaXRlbSA9IGl0ZXJhdG9yLm5leHQoKTtcblxuICAgIGlmIChpdGVtID09PSBudWxsKSB7XG4gICAgICByZXR1cm4gdGhpcy5zdGFydFBydW5lKCk7XG4gICAgfVxuXG4gICAgbGV0IHsga2V5IH0gPSBpdGVtO1xuXG4gICAgaWYgKGN1cnJlbnQgIT09IG51bGwgJiYgY3VycmVudC5rZXkgPT09IGtleSkge1xuICAgICAgdGhpcy5uZXh0UmV0YWluKGl0ZW0pO1xuICAgIH0gZWxzZSBpZiAoYXJ0aWZhY3RzLmhhcyhrZXkpKSB7XG4gICAgICB0aGlzLm5leHRNb3ZlKGl0ZW0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm5leHRJbnNlcnQoaXRlbSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIFBoYXNlLkFwcGVuZDtcbiAgfVxuXG4gIHByaXZhdGUgbmV4dFJldGFpbihpdGVtOiBPcGFxdWVJdGVyYXRpb25JdGVtKSB7XG4gICAgbGV0IHsgYXJ0aWZhY3RzLCBjdXJyZW50IH0gPSB0aGlzO1xuXG4gICAgY3VycmVudCA9IGV4cGVjdChjdXJyZW50LCAnQlVHOiBjdXJyZW50IGlzIGVtcHR5Jyk7XG5cbiAgICBjdXJyZW50LnVwZGF0ZShpdGVtKTtcbiAgICB0aGlzLmN1cnJlbnQgPSBhcnRpZmFjdHMubmV4dE5vZGUoY3VycmVudCk7XG4gICAgdGhpcy50YXJnZXQucmV0YWluKGl0ZW0ua2V5LCBjdXJyZW50LnZhbHVlLCBjdXJyZW50Lm1lbW8pO1xuICB9XG5cbiAgcHJpdmF0ZSBuZXh0TW92ZShpdGVtOiBPcGFxdWVJdGVyYXRpb25JdGVtKSB7XG4gICAgbGV0IHsgY3VycmVudCwgYXJ0aWZhY3RzLCB0YXJnZXQgfSA9IHRoaXM7XG4gICAgbGV0IHsga2V5IH0gPSBpdGVtO1xuXG4gICAgbGV0IGZvdW5kID0gYXJ0aWZhY3RzLmdldChpdGVtLmtleSk7XG4gICAgZm91bmQudXBkYXRlKGl0ZW0pO1xuXG4gICAgaWYgKGFydGlmYWN0cy53YXNTZWVuKGl0ZW0ua2V5KSkge1xuICAgICAgYXJ0aWZhY3RzLm1vdmUoZm91bmQsIGN1cnJlbnQpO1xuICAgICAgdGFyZ2V0Lm1vdmUoZm91bmQua2V5LCBmb3VuZC52YWx1ZSwgZm91bmQubWVtbywgY3VycmVudCA/IGN1cnJlbnQua2V5IDogbnVsbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYWR2YW5jZVRvS2V5KGtleSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBuZXh0SW5zZXJ0KGl0ZW06IE9wYXF1ZUl0ZXJhdGlvbkl0ZW0pIHtcbiAgICBsZXQgeyBhcnRpZmFjdHMsIHRhcmdldCwgY3VycmVudCB9ID0gdGhpcztcblxuICAgIGxldCBub2RlID0gYXJ0aWZhY3RzLmluc2VydEJlZm9yZShpdGVtLCBjdXJyZW50KTtcbiAgICB0YXJnZXQuaW5zZXJ0KG5vZGUua2V5LCBub2RlLnZhbHVlLCBub2RlLm1lbW8sIGN1cnJlbnQgPyBjdXJyZW50LmtleSA6IG51bGwpO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGFydFBydW5lKCk6IFBoYXNlIHtcbiAgICB0aGlzLmN1cnJlbnQgPSB0aGlzLmFydGlmYWN0cy5oZWFkKCk7XG4gICAgcmV0dXJuIFBoYXNlLlBydW5lO1xuICB9XG5cbiAgcHJpdmF0ZSBuZXh0UHJ1bmUoKTogUGhhc2Uge1xuICAgIGxldCB7IGFydGlmYWN0cywgdGFyZ2V0LCBjdXJyZW50IH0gPSB0aGlzO1xuXG4gICAgaWYgKGN1cnJlbnQgPT09IG51bGwpIHtcbiAgICAgIHJldHVybiBQaGFzZS5Eb25lO1xuICAgIH1cblxuICAgIGxldCBub2RlID0gY3VycmVudDtcbiAgICB0aGlzLmN1cnJlbnQgPSBhcnRpZmFjdHMubmV4dE5vZGUobm9kZSk7XG5cbiAgICBpZiAobm9kZS5zaG91bGRSZW1vdmUoKSkge1xuICAgICAgYXJ0aWZhY3RzLnJlbW92ZShub2RlKTtcbiAgICAgIHRhcmdldC5kZWxldGUobm9kZS5rZXkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBub2RlLnJlc2V0KCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIFBoYXNlLlBydW5lO1xuICB9XG5cbiAgcHJpdmF0ZSBuZXh0RG9uZSgpIHtcbiAgICB0aGlzLnRhcmdldC5kb25lKCk7XG4gIH1cbn1cbiJdfQ==","import { DEBUG } from \"@glimmer/env\";\nimport { Tag, DirtyableTag, TagWrapper, combine, CONSTANT_TAG } from \"@glimmer/reference\";\nimport { dict, Dict } from \"@glimmer/util\";\n\n/**\n * @decorator\n *\n * Marks a property as tracked.\n *\n * By default, a component's properties are expected to be static,\n * meaning you are not able to update them and have the template update accordingly.\n * Marking a property as tracked means that when that property changes,\n * a rerender of the component is scheduled so the template is kept up to date.\n *\n * @param dependencies Optional dependents to be tracked.\n */\nexport function tracked(...dependencies: string[]): MethodDecorator;\nexport function tracked(target: any, key: any): any;\nexport function tracked(target: any, key: any, descriptor: PropertyDescriptor): PropertyDescriptor;\nexport function tracked(...dependencies: any[]): any {\n  let [target, key, descriptor] = dependencies;\n\n  if (typeof target === \"string\") {\n    return function(target: any, key: string | Symbol, descriptor: PropertyDescriptor) {\n      return descriptorForTrackedComputedProperty(target, key, descriptor, dependencies);\n    };\n  } else {\n    if (descriptor) {\n      return descriptorForTrackedComputedProperty(target, key, descriptor, []);\n    } else {\n      installTrackedProperty(target, key);\n    }\n  }\n}\n\nfunction descriptorForTrackedComputedProperty(target: any, key: any, descriptor: PropertyDescriptor, dependencies: string[]): PropertyDescriptor {\n  let meta = metaFor(target);\n  meta.trackedProperties[key] = true;\n  meta.trackedPropertyDependencies[key] = dependencies || [];\n\n  return {\n    enumerable: true,\n    configurable: false,\n    get: descriptor.get,\n    set: function() {\n      metaFor(this).dirtyableTagFor(key).inner.dirty();\n      descriptor.set.apply(this, arguments);\n      propertyDidChange();\n    }\n  };\n}\n\nexport type Key = string;\n\n/**\n  Installs a getter/setter for change tracking. The accessor\n  acts just like a normal property, but it triggers the `propertyDidChange`\n  hook when written to.\n\n  Values are saved on the object using a \"shadow key,\" or a symbol based on the\n  tracked property name. Sets write the value to the shadow key, and gets read\n  from it.\n */\nfunction installTrackedProperty(target: any, key: Key) {\n  let value: any;\n  let shadowKey = Symbol(key);\n\n  let meta = metaFor(target);\n  meta.trackedProperties[key] = true;\n\n  if (target[key] !== undefined) {\n    value = target[key];\n  }\n\n  Object.defineProperty(target, key, {\n    configurable: true,\n\n    get() {\n      return this[shadowKey];\n    },\n\n    set(newValue) {\n      metaFor(this).dirtyableTagFor(key).inner.dirty();\n      this[shadowKey] = newValue;\n      propertyDidChange();\n    }\n  });\n}\n\n/**\n * Stores bookkeeping information about tracked properties on the target object\n * and includes helper methods for manipulating and retrieving that data.\n *\n * Computed properties (i.e., tracked getters/setters) deserve some explanation.\n * A computed property is invalidated when either it is set, or one of its\n * dependencies is invalidated. Therefore, we store two tags for each computed\n * property:\n *\n * 1. The dirtyable tag that we invalidate when the setter is invoked.\n * 2. A union tag (tag combinator) of the dirtyable tag and all of the computed\n *    property's dependencies' tags, used by Glimmer to determine \"does this\n *    computed property need to be recomputed?\"\n */\nexport default class Meta {\n  tags: Dict<Tag>;\n  computedPropertyTags: Dict<TagWrapper<DirtyableTag>>;\n  trackedProperties: Dict<boolean>;\n  trackedPropertyDependencies: Dict<string[]>;\n\n  constructor(parent: Meta) {\n    this.tags = dict<Tag>();\n    this.computedPropertyTags = dict<TagWrapper<DirtyableTag>>();\n    this.trackedProperties = parent ? Object.create(parent.trackedProperties) : dict<boolean>();\n    this.trackedPropertyDependencies = parent ? Object.create(parent.trackedPropertyDependencies) : dict<string[]>();\n  }\n\n  /**\n   * The tag representing whether the given property should be recomputed. Used\n   * by e.g. Glimmer VM to detect when a property should be re-rendered. Think\n   * of this as the \"public-facing\" tag.\n   *\n   * For static tracked properties, this is a single DirtyableTag. For computed\n   * properties, it is a combinator of the property's DirtyableTag as well as\n   * all of its dependencies' tags.\n   */\n  tagFor(key: Key): Tag {\n    let tag = this.tags[key];\n    if (tag) { return tag; }\n\n    let dependencies;\n    if (dependencies = this.trackedPropertyDependencies[key]) {\n      return this.tags[key] = combinatorForComputedProperties(this, key, dependencies);\n    }\n\n    return this.tags[key] = DirtyableTag.create();\n  }\n\n  /**\n   * The tag used internally to invalidate when a tracked property is set. For\n   * static properties, this is the same DirtyableTag returned from `tagFor`.\n   * For computed properties, it is the DirtyableTag used as one of the tags in\n   * the tag combinator of the CP and its dependencies.\n  */\n  dirtyableTagFor(key: Key): TagWrapper<DirtyableTag> {\n    let dependencies = this.trackedPropertyDependencies[key];\n    let tag;\n\n    if (dependencies) {\n      // The key is for a computed property.\n      tag = this.computedPropertyTags[key];\n      if (tag) { return tag; }\n      return this.computedPropertyTags[key] = DirtyableTag.create();\n    } else {\n      // The key is for a static property.\n      tag = this.tags[key];\n      if (tag) { return tag as TagWrapper<DirtyableTag>; }\n      return this.tags[key] = DirtyableTag.create();\n    }\n  }\n}\n\nfunction combinatorForComputedProperties(meta: Meta, key: Key, dependencies: Key[] | void): Tag {\n  // Start off with the tag for the CP's own dirty state.\n  let tags: Tag[] = [meta.dirtyableTagFor(key)];\n\n  // Next, add in all of the tags for its dependencies.\n  if (dependencies && dependencies.length) {\n    for (let i = 0; i < dependencies.length; i++) {\n      tags.push(meta.tagFor(dependencies[i]));\n    }\n  }\n\n  // Return a combinator across the CP's tags and its dependencies' tags.\n  return combine(tags);\n}\n\nexport interface Interceptors {\n  [key: string]: boolean;\n}\n\nlet META = Symbol(\"ember-object\");\n\nexport function metaFor(obj: any): Meta {\n  let meta = obj[META];\n  if (meta && hasOwnProperty(obj, META)) {\n    return meta;\n  }\n\n  return obj[META] = new Meta(meta);\n}\n\nlet hOP = Object.prototype.hasOwnProperty;\nfunction hasOwnProperty(obj: any, key: symbol) {\n  return hOP.call(obj, key);\n}\n\nlet propertyDidChange = function() {};\n\nexport function setPropertyDidChange(cb: () => void) {\n  propertyDidChange = cb;\n}\n\nexport function hasTag(obj: any, key: string): boolean {\n  let meta = obj[META] as Meta;\n\n  if (!obj[META]) { return false; }\n  if (!meta.trackedProperties[key]) { return false; }\n\n  return true;\n}\n\nexport class UntrackedPropertyError extends Error {\n  static for(obj: any, key: string): UntrackedPropertyError {\n    return new UntrackedPropertyError(obj, key, `The property '${key}' on ${obj} was changed after being rendered. If you want to change a property used in a template after the component has rendered, mark the property as a tracked property with the @tracked decorator.`);\n  }\n\n  constructor(public target: any, public key: string, message: string) {\n    super(message);\n  }\n}\n\n/**\n * Function that can be used in development mode to generate more meaningful\n * error messages.\n */\nexport interface UntrackedPropertyErrorThrower {\n  (obj: any, key: string): void;\n}\n\nfunction defaultErrorThrower(obj: any, key: string): UntrackedPropertyError {\n  throw UntrackedPropertyError.for(obj, key);\n}\n\nexport function tagForProperty(obj: any, key: string, throwError: UntrackedPropertyErrorThrower = defaultErrorThrower): Tag {\n  if (typeof obj === \"object\" && obj) {\n    if (DEBUG && !hasTag(obj, key)) {\n      installDevModeErrorInterceptor(obj, key, throwError);\n    }\n\n    let meta = metaFor(obj);\n    return meta.tagFor(key);\n  } else {\n    return CONSTANT_TAG;\n  }\n}\n\n/**\n * In development mode only, we install an ad hoc setter on properties where a\n * tag is requested (i.e., it was used in a template) without being tracked. In\n * cases where the property is set, we raise an error.\n */\nfunction installDevModeErrorInterceptor(obj: object, key: string, throwError: UntrackedPropertyErrorThrower) {\n  let target = obj;\n  let descriptor: PropertyDescriptor;\n\n  // Find the descriptor for the current property. We may need to walk the\n  // prototype chain to do so. If the property is undefined, we may never get a\n  // descriptor here.\n  let hasOwnDescriptor = true;\n  while (target) {\n    descriptor = Object.getOwnPropertyDescriptor(target, key);\n    if (descriptor) { break; }\n    hasOwnDescriptor = false;\n    target = Object.getPrototypeOf(target);\n  }\n\n  // If possible, define a property descriptor that passes through the current\n  // value on reads but throws an exception on writes.\n  if (descriptor) {\n    if (descriptor.configurable || !hasOwnDescriptor) {\n      Object.defineProperty(obj, key, {\n        configurable: descriptor.configurable,\n        enumerable: descriptor.enumerable,\n\n        get() {\n          if (descriptor.get) {\n            return descriptor.get.call(this);\n          } else {\n            return descriptor.value;\n          }\n        },\n\n        set() {\n          throwError(this, key);\n        }\n      });\n    }\n  } else {\n    Object.defineProperty(obj, key, {\n      set() {\n        throwError(this, key);\n      }\n    });\n  }\n}\n","import ComponentManager from \"./component-manager\";\nimport { Option, ComponentCapabilities } from '@glimmer/interfaces';\nimport { ComponentFactory } from './component';\nimport { ComponentDefinition as IComponentDefinition } from '@glimmer/runtime';\n\nconst capabilities: ComponentCapabilities = {\n  dynamicLayout: false,\n  dynamicTag: true,\n  prepareArgs: false,\n  createArgs: true,\n  attributeHook: true,\n  elementHook: true\n};\n\nexport interface DefinitionState {\n  /* Manager-related */\n  capabilities: ComponentCapabilities;\n\n  /* Component-related */\n  name: string;\n  ComponentClass: any;\n  layout: Option<number>;\n}\n\nexport default class ComponentDefinition implements IComponentDefinition {\n  state: DefinitionState;\n  constructor(public name: string, public manager: ComponentManager, public ComponentClass: ComponentFactory, public layout: Option<number>) {\n    this.state = {\n      name,\n      capabilities,\n      ComponentClass,\n      layout\n    };\n  }\n\n  toJSON() {\n    return { GlimmerDebug: `<component-definition name=\"${this.name}\">` };\n  }\n}\n","import { Factory, FactoryDefinition } from './factory';\nimport { RegistryReader, Injection } from './registry';\nimport { Resolver } from './resolver';\nimport { Dict } from './dict';\n\nexport default class Container {\n  private _registry: RegistryReader;\n  private _resolver: Resolver;\n  private _lookups: Dict<any>;\n  private _factoryDefinitionLookups: Dict<FactoryDefinition<any>>;\n\n  constructor(registry: RegistryReader, resolver: Resolver = null) {\n    this._registry = registry;\n    this._resolver = resolver;\n    this._lookups = {};\n    this._factoryDefinitionLookups = {};\n  }\n\n  factoryFor(specifier: string): Factory<any> {\n    let factoryDefinition: FactoryDefinition<any> = this._factoryDefinitionLookups[specifier];\n\n    if (!factoryDefinition) {\n      if (this._resolver) {\n        factoryDefinition = this._resolver.retrieve(specifier);\n      }\n\n      if (!factoryDefinition) {\n        factoryDefinition = this._registry.registration(specifier);\n      }\n\n      if (factoryDefinition) {\n        this._factoryDefinitionLookups[specifier] = factoryDefinition;\n      }\n    }\n\n    if (!factoryDefinition) {\n      return;\n    }\n\n    return this.buildFactory(specifier, factoryDefinition);\n  }\n\n  lookup(specifier: string): any {\n    let singleton = (this._registry.registeredOption(specifier, 'singleton') !== false);\n\n    if (singleton && this._lookups[specifier]) {\n      return this._lookups[specifier];\n    }\n\n    let factory = this.factoryFor(specifier);\n    if (!factory) { return; }\n\n    if (this._registry.registeredOption(specifier, 'instantiate') === false) {\n      return factory.class;\n    }\n\n    let object = factory.create();\n\n    if (singleton && object) {\n      this._lookups[specifier] = object;\n    }\n\n    return object;\n  }\n\n  defaultInjections(specifier: string): Object {\n    return {};\n  }\n\n  private buildInjections(specifier: string): Object {\n    let hash = this.defaultInjections(specifier);\n    let injections: Injection[] = this._registry.registeredInjections(specifier);\n    let injection: Injection;\n\n    for (let i = 0; i < injections.length; i++) {\n      injection = injections[i];\n      hash[injection.property] = this.lookup(injection.source);\n    }\n\n    return hash;\n  }\n\n  private buildFactory(specifier: string, factoryDefinition: FactoryDefinition<any>): Factory<any> {\n    let injections = this.buildInjections(specifier);\n\n    return {\n      class: factoryDefinition,\n      create(options) {\n        let mergedOptions = Object.assign({}, injections, options);\n\n        return factoryDefinition.create(mergedOptions);\n      }\n    }\n  }\n}\n","import { Dict } from './dict';\nimport { Factory, FactoryDefinition } from './factory';\n\nexport interface RegistrationOptions {\n  singleton?: boolean;\n  instantiate?: boolean;\n}\n\nexport interface Injection {\n  property: string,\n  source: string\n}\n\nexport interface RegistryWriter {\n  register(specifier: string, factory: any, options?: RegistrationOptions): void;\n  unregister(specifier: string): void;\n  registerOption(specifier: string, option: string, value: any): void;\n  unregisterOption(specifier: string, option: string): void;\n  registerInjection(specifier: string, property: string, source: string): void;\n}\n\nexport interface RegistryReader {\n  registration(specifier: string): any;\n  registeredOption(specifier: string, option: string): any;\n  registeredOptions(specifier: string): any;\n  registeredInjections(specifier: string): Injection[];\n}\n\nexport interface RegistryOptions {\n  fallback?: RegistryReader;\n}\n\nexport interface RegistryAccessor extends RegistryReader, RegistryWriter {}\n\nexport default class Registry implements RegistryAccessor {\n  private _registrations: Dict<FactoryDefinition<any>>;\n  private _registeredOptions: Dict<any>;\n  private _registeredInjections: Dict<Injection[]>;\n  private _fallback: RegistryReader;\n\n  constructor(options?: RegistryOptions) {\n    this._registrations = {};\n    this._registeredOptions = {};\n    this._registeredInjections = {};\n    if (options && options.fallback) {\n      this._fallback = options.fallback;\n    }\n  }\n\n  register(specifier: string, factoryDefinition: FactoryDefinition<any>, options?: RegistrationOptions): void {\n    this._registrations[specifier] = factoryDefinition;\n    if (options) {\n      this._registeredOptions[specifier] = options;\n    }\n  }\n\n  registration(specifier: string): FactoryDefinition<any> {\n    let registration = this._registrations[specifier];\n    if (registration === undefined && this._fallback) {\n      registration = this._fallback.registration(specifier);\n    }\n    return registration;\n  }\n\n  unregister(specifier: string): void {\n    delete this._registrations[specifier];\n    delete this._registeredOptions[specifier];\n    delete this._registeredInjections[specifier];\n  }\n\n  registerOption(specifier: string, option: string, value: any): void {\n    let options = this._registeredOptions[specifier];\n\n    if (!options) {\n      options = {};\n      this._registeredOptions[specifier] = options;\n    }\n\n    options[option] = value;\n  }\n\n  registeredOption(specifier: string, option: string): any {\n    let result: Boolean;\n    let options = this.registeredOptions(specifier);\n\n    if (options) {\n      result = options[option];\n    }\n\n    if (result === undefined && this._fallback !== undefined) {\n      result = this._fallback.registeredOption(specifier, option);\n    }\n\n    return result;\n  }\n\n  registeredOptions(specifier: string): any {\n    let options = this._registeredOptions[specifier];\n    if (options === undefined) {\n      let [type] = specifier.split(':');\n      options = this._registeredOptions[type];\n    }\n    return options;\n  }\n\n  unregisterOption(specifier: string, option: string): void {\n    let options = this._registeredOptions[specifier];\n\n    if (options) {\n      delete options[option];\n    }\n  }\n\n  registerInjection(specifier: string, property: string, source: string): void {\n    let injections = this._registeredInjections[specifier];\n    if (injections === undefined) {\n      this._registeredInjections[specifier] = injections = [];\n    }\n    injections.push({\n      property,\n      source\n    });\n  }\n\n  registeredInjections(specifier: string): Injection[] {\n    let [type] = specifier.split(':');\n    let injections: Injection[] = this._fallback ? this._fallback.registeredInjections(specifier) : [];\n    Array.prototype.push.apply(injections, this._registeredInjections[type]);\n    Array.prototype.push.apply(injections, this._registeredInjections[specifier]);\n    return injections;\n  }\n}\n","import { RegistrationOptions } from './registry';\nimport { Factory } from './factory';\n\n// TODO - use symbol\nexport const OWNER = '__owner__';\n\nexport function getOwner(object: Object): Owner {\n  return object[OWNER];\n}\n\nexport function setOwner(object: Object, owner: Owner): void {\n  object[OWNER] = owner;\n}\n\nexport interface Owner {\n  identify(specifier: string, referrer?: string): string;\n\n  factoryFor(specifier: string, referrer?: string): Factory<any>;\n  \n  lookup(specifier: string, referrer?: string): any;\n}\n","import { Bounds as VMBounds } from '@glimmer/runtime';\n\n/**\n * Contains the first and last DOM nodes in a component's rendered\n * template. These nodes can be used to traverse the section of DOM\n * that belongs to a particular component.\n *\n * Note that these nodes *can* change over the lifetime of a component\n * if the beginning or ending of the template is dynamic.\n */\nexport default class Bounds {\n  constructor(private _bounds: VMBounds) {\n  }\n\n  get firstNode(): Node {\n    return this._bounds.firstNode() as Node;\n  }\n\n  get lastNode(): Node {\n    return this._bounds.lastNode() as Node;\n  }\n}\n","import { initializeGuid, fillNulls, unreachable } from '@glimmer/util';\n\nexport class AppendOpcodes {\n    constructor() {\n        this.evaluateOpcode = fillNulls(78 /* Size */).slice();\n    }\n    add(name, evaluate) {\n        this.evaluateOpcode[name] = evaluate;\n    }\n    evaluate(vm, opcode, type) {\n        let func = this.evaluateOpcode[type];\n        if (false) {\n            /* tslint:disable */\n            let [name, params] = [];\n            // console.log(`${typePos(vm['pc'])}.`);\n            console.log(`${vm['pc'] - opcode.size}. ${''}`);\n            let debugParams = [];\n            for (let prop in params) {\n                debugParams.push(prop, \"=\", params[prop]);\n            }\n            console.log(...debugParams);\n            /* tslint:enable */\n        }\n        let sp;\n        let expectedChange;\n        let state;\n        if (false) {\n            let metadata = null;\n            if (metadata && metadata.before) {\n                state = metadata.before(opcode, vm);\n            } else {\n                state = undefined;\n            }\n            sp = vm.stack.sp;\n        }\n\n        func(vm, opcode);\n        if (false) {\n            let metadata = null;\n            if (metadata !== null) {\n                if (typeof metadata.stackChange === 'number') {\n                    expectedChange = metadata.stackChange;\n                } else {\n                    expectedChange = metadata.stackChange({ opcode, constants: vm.constants, state });\n                    if (isNaN(expectedChange)) throw unreachable();\n                }\n            }\n            let actualChange = vm.stack.sp - sp;\n            if (metadata && metadata.check && typeof expectedChange === 'number' && expectedChange !== actualChange) {\n                let [name, params] = [];\n                throw new Error(`Error in ${name}:\\n\\n${vm['pc'] + opcode.size}. ${''}\\n\\nStack changed by ${actualChange}, expected ${expectedChange}`);\n            }\n        }\n        if (false) {\n            /* tslint:disable */\n            console.log('%c -> pc: %d, ra: %d, fp: %d, sp: %d, s0: %O, s1: %O, t0: %O, t1: %O, v0: %O', 'color: orange', vm['pc'], vm['ra'], vm['fp'], vm['sp'], vm['s0'], vm['s1'], vm['t0'], vm['t1'], vm['v0']);\n            console.log('%c -> eval stack', 'color: red', vm.stack.toArray());\n            console.log('%c -> scope', 'color: green', vm.scope()['slots'].map(s => s && s['value'] ? s['value']() : s));\n            console.log('%c -> elements', 'color: blue', vm.elements()['cursorStack']['stack'].map(c => c.element));\n            /* tslint:enable */\n        }\n    }\n}\nexport const APPEND_OPCODES = new AppendOpcodes();\nexport class AbstractOpcode {\n    constructor() {\n        initializeGuid(this);\n    }\n}\nexport class UpdatingOpcode extends AbstractOpcode {\n    constructor() {\n        super(...arguments);\n        this.next = null;\n        this.prev = null;\n    }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3Bjb2Rlcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3J1bnRpbWUvbGliL29wY29kZXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsQUFBTyxTQUFvQyxBQUFjLGdCQUFFLEFBQVMsV0FBRSxBQUFXLEFBQUUsbUJBQU0sQUFBZSxBQUFDLEFBQ3pHLEFBQU8sQUFBRSxBQUFlLEFBQUUsQUFBTSxBQUFnQixBQUFDLEFBR2pELEFBQU8sQUFBRSxBQUFLLEFBQUUsQUFBUyxBQUFFLEFBQU0sQUFBMEIsQUFBQyxBQUM1RCxBQUFPLEFBQUUsQUFBUSxBQUFFLEFBQU0sQUFBYSxBQUFDLEFBR3ZDLEFBQU8sQUFBRSxBQUFLLEFBQUUsQUFBTyxBQUFFLEFBQU0sQUFBNEIsQUFBQzs7QUFpQjVELEFBQU07QUFBTjtBQUNVLGFBQWMsaUJBQXFCLEFBQVMsYUFBeUIsWUFBQyxBQUFLLEFBQUUsQUFBQyxBQXNFeEY7QUFBQztBQXBFQyxBQUFHLFFBQWtCLEFBQVUsTUFBRSxBQUF3QjtBQUN2RCxBQUFJLGFBQUMsQUFBYyxlQUFDLEFBQWMsQUFBQyxRQUFHLEFBQVEsQUFBQyxBQUNqRDtBQUFDO0FBRUQsQUFBUSxhQUFDLEFBQWMsSUFBRSxBQUFjLFFBQUUsQUFBWTtBQUNuRCxZQUFJLEFBQUksT0FBRyxBQUFJLEtBQUMsQUFBYyxlQUFDLEFBQUksQUFBQyxBQUFDO0FBQ3JDLEFBQUUsQUFBQyxBQUFDLEFBQUssQUFBQyxtQkFBQyxBQUFDO0FBQ1YsQUFBb0I7QUFDcEIsZ0JBQUksQ0FBQyxBQUFJLE1BQUUsQUFBTSxBQUFDLEFBQUcsQUFBSyxBQUFDLEFBQUUsQUFBQyxBQUFTLEFBQUUsQUFBTSxBQUFDLEFBQUksQUFBRSxBQUFNLEFBQUMsQUFBRyxBQUFFLEFBQU0sQUFBQyxBQUFHLEFBQUUsQUFBTSxBQUFDLEFBQUcsQUFBQyxBQUFDO0FBQzFGLEFBQXdDO0FBQ3hDLEFBQU8sb0JBQUMsQUFB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QU07QUFJSjtBQUNFLEFBQWMsdUJBQUMsQUFBSSxBQUFDLEFBQUMsQUFDdkI7QUFBQyxBQUNGOztBQUVELEFBQU0sYUFBK0IsdUJBQVEsQUFBYztBQUEzRDs7QUFHRSxhQUFJLE9BQTJCLEFBQUksQUFBQztBQUNwQyxhQUFJLE9BQTJCLEFBQUksQUFBQyxBQUd0QztBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgT3B0aW9uLCBEaWN0LCBTbGljZSBhcyBMaXN0U2xpY2UsIGluaXRpYWxpemVHdWlkLCBmaWxsTnVsbHMsIHVucmVhY2hhYmxlIH0gZnJvbSAnQGdsaW1tZXIvdXRpbCc7XG5pbXBvcnQgeyByZWNvcmRTdGFja1NpemUgfSBmcm9tICdAZ2xpbW1lci9kZWJ1Zyc7XG5pbXBvcnQgeyBPcCB9IGZyb20gJ0BnbGltbWVyL3ZtJztcbmltcG9ydCB7IFRhZyB9IGZyb20gJ0BnbGltbWVyL3JlZmVyZW5jZSc7XG5pbXBvcnQgeyBkZWJ1ZywgbG9nT3Bjb2RlIH0gZnJvbSBcIkBnbGltbWVyL29wY29kZS1jb21waWxlclwiO1xuaW1wb3J0IHsgTUVUQURBVEEgfSBmcm9tIFwiQGdsaW1tZXIvdm1cIjtcbmltcG9ydCB7IE9wY29kZSwgT3BhcXVlIH0gZnJvbSBcIkBnbGltbWVyL2ludGVyZmFjZXNcIjtcbmltcG9ydCB7IFZNLCBVcGRhdGluZ1ZNIH0gZnJvbSAnLi92bSc7XG5pbXBvcnQgeyBERUJVRywgREVWTU9ERSB9IGZyb20gJ0BnbGltbWVyL2xvY2FsLWRlYnVnLWZsYWdzJztcblxuZXhwb3J0IGludGVyZmFjZSBPcGNvZGVKU09OIHtcbiAgdHlwZTogbnVtYmVyIHwgc3RyaW5nO1xuICBndWlkPzogT3B0aW9uPG51bWJlcj47XG4gIGRlb3B0ZWQ/OiBib29sZWFuO1xuICBhcmdzPzogc3RyaW5nW107XG4gIGRldGFpbHM/OiBEaWN0PE9wdGlvbjxzdHJpbmc+PjtcbiAgY2hpbGRyZW4/OiBPcGNvZGVKU09OW107XG59XG5cbmV4cG9ydCB0eXBlIE9wZXJhbmQxID0gbnVtYmVyO1xuZXhwb3J0IHR5cGUgT3BlcmFuZDIgPSBudW1iZXI7XG5leHBvcnQgdHlwZSBPcGVyYW5kMyA9IG51bWJlcjtcblxuZXhwb3J0IHR5cGUgRXZhbHVhdGVPcGNvZGUgPSAodm06IFZNPE9wYXF1ZT4sIG9wY29kZTogT3Bjb2RlKSA9PiB2b2lkO1xuXG5leHBvcnQgY2xhc3MgQXBwZW5kT3Bjb2RlcyB7XG4gIHByaXZhdGUgZXZhbHVhdGVPcGNvZGU6IEV2YWx1YXRlT3Bjb2RlW10gPSBmaWxsTnVsbHM8RXZhbHVhdGVPcGNvZGU+KE9wLlNpemUpLnNsaWNlKCk7XG5cbiAgYWRkPE5hbWUgZXh0ZW5kcyBPcD4obmFtZTogTmFtZSwgZXZhbHVhdGU6IEV2YWx1YXRlT3Bjb2RlKTogdm9pZCB7XG4gICAgdGhpcy5ldmFsdWF0ZU9wY29kZVtuYW1lIGFzIG51bWJlcl0gPSBldmFsdWF0ZTtcbiAgfVxuXG4gIGV2YWx1YXRlKHZtOiBWTTxPcGFxdWU+LCBvcGNvZGU6IE9wY29kZSwgdHlwZTogbnVtYmVyKSB7XG4gICAgbGV0IGZ1bmMgPSB0aGlzLmV2YWx1YXRlT3Bjb2RlW3R5cGVdO1xuICAgIGlmIChERUJVRykge1xuICAgICAgLyogdHNsaW50OmRpc2FibGUgKi9cbiAgICAgIGxldCBbbmFtZSwgcGFyYW1zXSA9IGRlYnVnKHZtLmNvbnN0YW50cywgb3Bjb2RlLnR5cGUsIG9wY29kZS5vcDEsIG9wY29kZS5vcDIsIG9wY29kZS5vcDMpO1xuICAgICAgLy8gY29uc29sZS5sb2coYCR7dHlwZVBvcyh2bVsncGMnXSl9LmApO1xuICAgICAgY29uc29sZS5sb2coYCR7dm1bJ3BjJ10gLSBvcGNvZGUuc2l6ZX0uICR7bG9nT3Bjb2RlKG5hbWUsIHBhcmFtcyl9YCk7XG5cbiAgICAgIGxldCBkZWJ1Z1BhcmFtcyA9IFtdO1xuICAgICAgZm9yIChsZXQgcHJvcCBpbiBwYXJhbXMpIHtcbiAgICAgICAgZGVidWdQYXJhbXMucHVzaChwcm9wLCBcIj1cIiwgcGFyYW1zW3Byb3BdKTtcbiAgICAgIH1cblxuICAgICAgY29uc29sZS5sb2coLi4uZGVidWdQYXJhbXMpO1xuICAgICAgLyogdHNsaW50OmVuYWJsZSAqL1xuICAgIH1cblxuICAgIGxldCBzcDogbnVtYmVyO1xuICAgIGxldCBleHBlY3RlZENoYW5nZTogbnVtYmVyO1xuICAgIGxldCBzdGF0ZTogT3BhcXVlO1xuXG4gICAgaWYgKERFVk1PREUpIHtcbiAgICAgIGxldCBtZXRhZGF0YSA9IE1FVEFEQVRBW3R5cGVdO1xuXG4gICAgICBpZiAobWV0YWRhdGEgJiYgbWV0YWRhdGEuYmVmb3JlKSB7XG4gICAgICAgIHN0YXRlID0gbWV0YWRhdGEuYmVmb3JlKG9wY29kZSwgdm0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3RhdGUgPSB1bmRlZmluZWQ7XG4gICAgICB9XG5cbiAgICAgIHNwID0gdm0uc3RhY2suc3A7XG4gICAgfVxuXG4gICAgcmVjb3JkU3RhY2tTaXplKHZtLnN0YWNrKTtcbiAgICBmdW5jKHZtLCBvcGNvZGUpO1xuXG4gICAgaWYgKERFVk1PREUpIHtcbiAgICAgIGxldCBtZXRhZGF0YSA9IE1FVEFEQVRBW3R5cGVdO1xuICAgICAgaWYgKG1ldGFkYXRhICE9PSBudWxsKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbWV0YWRhdGEuc3RhY2tDaGFuZ2UgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgZXhwZWN0ZWRDaGFuZ2UgPSBtZXRhZGF0YS5zdGFja0NoYW5nZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBleHBlY3RlZENoYW5nZSA9IG1ldGFkYXRhLnN0YWNrQ2hhbmdlKHsgb3Bjb2RlLCBjb25zdGFudHM6IHZtLmNvbnN0YW50cywgc3RhdGUgfSk7XG4gICAgICAgICAgaWYgKGlzTmFOKGV4cGVjdGVkQ2hhbmdlKSkgdGhyb3cgdW5yZWFjaGFibGUoKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBsZXQgYWN0dWFsQ2hhbmdlID0gdm0uc3RhY2suc3AgLSBzcCE7XG4gICAgICBpZiAobWV0YWRhdGEgJiYgbWV0YWRhdGEuY2hlY2sgJiYgdHlwZW9mIGV4cGVjdGVkQ2hhbmdlISA9PT0gJ251bWJlcicgJiYgZXhwZWN0ZWRDaGFuZ2UhICE9PSBhY3R1YWxDaGFuZ2UpIHtcbiAgICAgICAgbGV0IFtuYW1lLCBwYXJhbXNdID0gZGVidWcodm0uY29uc3RhbnRzLCBvcGNvZGUudHlwZSwgb3Bjb2RlLm9wMSwgb3Bjb2RlLm9wMiwgb3Bjb2RlLm9wMyk7XG5cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciBpbiAke25hbWV9OlxcblxcbiR7KHZtWydwYyddICsgKG9wY29kZS5zaXplKSl9LiAke2xvZ09wY29kZShuYW1lLCBwYXJhbXMpfVxcblxcblN0YWNrIGNoYW5nZWQgYnkgJHthY3R1YWxDaGFuZ2V9LCBleHBlY3RlZCAke2V4cGVjdGVkQ2hhbmdlIX1gKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoREVCVUcpIHtcbiAgICAgIC8qIHRzbGludDpkaXNhYmxlICovXG4gICAgICBjb25zb2xlLmxvZygnJWMgLT4gcGM6ICVkLCByYTogJWQsIGZwOiAlZCwgc3A6ICVkLCBzMDogJU8sIHMxOiAlTywgdDA6ICVPLCB0MTogJU8sIHYwOiAlTycsICdjb2xvcjogb3JhbmdlJywgdm1bJ3BjJ10sIHZtWydyYSddLCB2bVsnZnAnXSwgdm1bJ3NwJ10sIHZtWydzMCddLCB2bVsnczEnXSwgdm1bJ3QwJ10sIHZtWyd0MSddLCB2bVsndjAnXSk7XG4gICAgICBjb25zb2xlLmxvZygnJWMgLT4gZXZhbCBzdGFjaycsICdjb2xvcjogcmVkJywgdm0uc3RhY2sudG9BcnJheSgpKTtcbiAgICAgIGNvbnNvbGUubG9nKCclYyAtPiBzY29wZScsICdjb2xvcjogZ3JlZW4nLCB2bS5zY29wZSgpWydzbG90cyddLm1hcChzID0+IHMgJiYgc1sndmFsdWUnXSA/IHNbJ3ZhbHVlJ10oKSA6IHMpKTtcbiAgICAgIGNvbnNvbGUubG9nKCclYyAtPiBlbGVtZW50cycsICdjb2xvcjogYmx1ZScsIHZtLmVsZW1lbnRzKClbJ2N1cnNvclN0YWNrJ11bJ3N0YWNrJ10ubWFwKChjOiBhbnkpID0+IGMuZWxlbWVudCkpO1xuICAgICAgLyogdHNsaW50OmVuYWJsZSAqL1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgY29uc3QgQVBQRU5EX09QQ09ERVMgPSBuZXcgQXBwZW5kT3Bjb2RlcygpO1xuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQWJzdHJhY3RPcGNvZGUge1xuICBwdWJsaWMgdHlwZTogc3RyaW5nO1xuICBwdWJsaWMgX2d1aWQ6IG51bWJlcjtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBpbml0aWFsaXplR3VpZCh0aGlzKTtcbiAgfVxufVxuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgVXBkYXRpbmdPcGNvZGUgZXh0ZW5kcyBBYnN0cmFjdE9wY29kZSB7XG4gIHB1YmxpYyBhYnN0cmFjdCB0YWc6IFRhZztcblxuICBuZXh0OiBPcHRpb248VXBkYXRpbmdPcGNvZGU+ID0gbnVsbDtcbiAgcHJldjogT3B0aW9uPFVwZGF0aW5nT3Bjb2RlPiA9IG51bGw7XG5cbiAgYWJzdHJhY3QgZXZhbHVhdGUodm06IFVwZGF0aW5nVk08T3BhcXVlPik6IHZvaWQ7XG59XG5cbmV4cG9ydCB0eXBlIFVwZGF0aW5nT3BTZXEgPSBMaXN0U2xpY2U8VXBkYXRpbmdPcGNvZGU+O1xuIl19","/**\n * Registers\n *\n * For the most part, these follows MIPS naming conventions, however the\n * register numbers are different.\n */\nexport var Register;\n(function (Register) {\n    // $0 or $pc (program counter): pointer into `program` for the next insturction; -1 means exit\n    Register[Register[\"pc\"] = 0] = \"pc\";\n    // $1 or $ra (return address): pointer into `program` for the return\n    Register[Register[\"ra\"] = 1] = \"ra\";\n    // $2 or $fp (frame pointer): pointer into the `evalStack` for the base of the stack\n    Register[Register[\"fp\"] = 2] = \"fp\";\n    // $3 or $sp (stack pointer): pointer into the `evalStack` for the top of the stack\n    Register[Register[\"sp\"] = 3] = \"sp\";\n    // $4-$5 or $s0-$s1 (saved): callee saved general-purpose registers\n    Register[Register[\"s0\"] = 4] = \"s0\";\n    Register[Register[\"s1\"] = 5] = \"s1\";\n    // $6-$7 or $t0-$t1 (temporaries): caller saved general-purpose registers\n    Register[Register[\"t0\"] = 6] = \"t0\";\n    Register[Register[\"t1\"] = 7] = \"t1\";\n    // $8 or $v0 (return value)\n    Register[Register[\"v0\"] = 8] = \"v0\";\n})(Register || (Register = {}));\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVnaXN0ZXJzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcGFja2FnZXMvQGdsaW1tZXIvdm0vbGliL3JlZ2lzdGVycy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxBQUtHOzs7Ozs7QUFFSCxBQUFNLE9BQU4sSUFBWSxBQXVCWDtBQXZCRCxXQUFZLEFBQVE7QUFDbEIsQUFBOEY7QUFDOUYsbUNBQUk7QUFFSixBQUFvRTtBQUNwRSxtQ0FBSTtBQUVKLEFBQW9GO0FBQ3BGLG1DQUFJO0FBRUosQUFBbUY7QUFDbkYsbUNBQUk7QUFFSixBQUFtRTtBQUNuRSxtQ0FBSTtBQUNKLG1DQUFJO0FBRUosQUFBeUU7QUFDekUsbUNBQUk7QUFDSixtQ0FBSTtBQUVKLEFBQTJCO0FBQzNCLG1DQUFJLEFBQ047QUFBQyxHQXZCVyxBQUFRLGFBQVIsQUFBUSxXQXVCbkIiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFJlZ2lzdGVyc1xuICpcbiAqIEZvciB0aGUgbW9zdCBwYXJ0LCB0aGVzZSBmb2xsb3dzIE1JUFMgbmFtaW5nIGNvbnZlbnRpb25zLCBob3dldmVyIHRoZVxuICogcmVnaXN0ZXIgbnVtYmVycyBhcmUgZGlmZmVyZW50LlxuICovXG5cbmV4cG9ydCBlbnVtIFJlZ2lzdGVyIHtcbiAgLy8gJDAgb3IgJHBjIChwcm9ncmFtIGNvdW50ZXIpOiBwb2ludGVyIGludG8gYHByb2dyYW1gIGZvciB0aGUgbmV4dCBpbnN0dXJjdGlvbjsgLTEgbWVhbnMgZXhpdFxuICAncGMnLFxuXG4gIC8vICQxIG9yICRyYSAocmV0dXJuIGFkZHJlc3MpOiBwb2ludGVyIGludG8gYHByb2dyYW1gIGZvciB0aGUgcmV0dXJuXG4gICdyYScsXG5cbiAgLy8gJDIgb3IgJGZwIChmcmFtZSBwb2ludGVyKTogcG9pbnRlciBpbnRvIHRoZSBgZXZhbFN0YWNrYCBmb3IgdGhlIGJhc2Ugb2YgdGhlIHN0YWNrXG4gICdmcCcsXG5cbiAgLy8gJDMgb3IgJHNwIChzdGFjayBwb2ludGVyKTogcG9pbnRlciBpbnRvIHRoZSBgZXZhbFN0YWNrYCBmb3IgdGhlIHRvcCBvZiB0aGUgc3RhY2tcbiAgJ3NwJyxcblxuICAvLyAkNC0kNSBvciAkczAtJHMxIChzYXZlZCk6IGNhbGxlZSBzYXZlZCBnZW5lcmFsLXB1cnBvc2UgcmVnaXN0ZXJzXG4gICdzMCcsXG4gICdzMScsXG5cbiAgLy8gJDYtJDcgb3IgJHQwLSR0MSAodGVtcG9yYXJpZXMpOiBjYWxsZXIgc2F2ZWQgZ2VuZXJhbC1wdXJwb3NlIHJlZ2lzdGVyc1xuICAndDAnLFxuICAndDEnLFxuXG4gIC8vICQ4IG9yICR2MCAocmV0dXJuIHZhbHVlKVxuICAndjAnXG59XG4iXX0=","import { ConstReference } from '@glimmer/reference';\nexport class PrimitiveReference extends ConstReference {\n    constructor(value) {\n        super(value);\n    }\n    static create(value) {\n        if (value === undefined) {\n            return UNDEFINED_REFERENCE;\n        } else if (value === null) {\n            return NULL_REFERENCE;\n        } else if (value === true) {\n            return TRUE_REFERENCE;\n        } else if (value === false) {\n            return FALSE_REFERENCE;\n        } else if (typeof value === 'number') {\n            return new ValueReference(value);\n        } else {\n            return new StringReference(value);\n        }\n    }\n    get(_key) {\n        return UNDEFINED_REFERENCE;\n    }\n}\nclass StringReference extends PrimitiveReference {\n    constructor() {\n        super(...arguments);\n        this.lengthReference = null;\n    }\n    get(key) {\n        if (key === 'length') {\n            let { lengthReference } = this;\n            if (lengthReference === null) {\n                lengthReference = this.lengthReference = new ValueReference(this.inner.length);\n            }\n            return lengthReference;\n        } else {\n            return super.get(key);\n        }\n    }\n}\nclass ValueReference extends PrimitiveReference {\n    constructor(value) {\n        super(value);\n    }\n}\nexport const UNDEFINED_REFERENCE = new ValueReference(undefined);\nexport const NULL_REFERENCE = new ValueReference(null);\nexport const TRUE_REFERENCE = new ValueReference(true);\nexport const FALSE_REFERENCE = new ValueReference(false);\nexport class ConditionalReference {\n    constructor(inner) {\n        this.inner = inner;\n        this.tag = inner.tag;\n    }\n    value() {\n        return this.toBool(this.inner.value());\n    }\n    toBool(value) {\n        return !!value;\n    }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVmZXJlbmNlcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3J1bnRpbWUvbGliL3JlZmVyZW5jZXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsQUFBTyxTQUFFLEFBQWMsQUFBaUMsc0JBQU0sQUFBb0IsQUFBQztBQUluRixBQUFNLGFBQStDLDJCQUFRLEFBQWlCO0FBaUI1RSxnQkFBc0IsQUFBUTtBQUM1QixBQUFLLGNBQUMsQUFBSyxBQUFDLEFBQUMsQUFDZjtBQUFDO0FBbEJELEFBQU0sV0FBQyxBQUFNLE9BQXNCLEFBQVE7QUFDekMsQUFBRSxBQUFDLFlBQUMsQUFBSyxVQUFLLEFBQVMsQUFBQyxXQUFDLEFBQUM7QUFDeEIsQUFBTSxtQkFBQyxBQUE0QyxBQUFDLEFBQ3REO0FBQUMsQUFBQyxBQUFJLG1CQUFLLEFBQUssVUFBSyxBQUFJLEFBQUMsTUFBQyxBQUFDO0FBQzFCLEFBQU0sbUJBQUMsQUFBdUMsQUFBQyxBQUNqRDtBQUFDLEFBQUMsQUFBSSxTQUZDLEFBQUUsQUFBQyxVQUVDLEFBQUssVUFBSyxBQUFJLEFBQUMsTUFBQyxBQUFDO0FBQzFCLEFBQU0sbUJBQUMsQUFBdUMsQUFBQyxBQUNqRDtBQUFDLEFBQUMsQUFBSSxTQUZDLEFBQUUsQUFBQyxVQUVDLEFBQUssVUFBSyxBQUFLLEFBQUMsT0FBQyxBQUFDO0FBQzNCLEFBQU0sbUJBQUMsQUFBd0MsQUFBQyxBQUNsRDtBQUFDLEFBQUMsQUFBSSxTQUZDLEFBQUUsQUFBQyxVQUVDLE9BQU8sQUFBSyxVQUFLLEFBQVEsQUFBQyxVQUFDLEFBQUM7QUFDckMsQUFBTSxtQkFBQyxJQUFJLEFBQWMsZUFBQyxBQUFLLEFBQTBCLEFBQUMsQUFDNUQ7QUFBQyxBQUFDLEFBQUksU0FGQyxBQUFFLEFBQUMsTUFFSCxBQUFDO0FBQ04sQUFBTSxtQkFBQyxJQUFJLEFBQWUsZ0JBQUMsQUFBZSxBQUFtRCxBQUFDLEFBQ2hHO0FBQUMsQUFDSDtBQUFDO0FBTUQsQUFBRyxRQUFDLEFBQVk7QUFDZCxBQUFNLGVBQUMsQUFBbUIsQUFBQyxBQUM3QjtBQUFDLEFBQ0Y7O0FBRUQsTUFBc0Isd0JBQVEsQUFBMEI7QUFBeEQ7O0FBQ1UsYUFBZSxrQkFBdUMsQUFBSSxBQUFDLEFBZXJFO0FBQUM7QUFiQyxBQUFHLFFBQUMsQUFBVztBQUNiLEFBQUUsQUFBQyxZQUFDLEFBQUcsUUFBSyxBQUFRLEFBQUMsVUFBQyxBQUFDO0FBQ3JCLGdCQUFJLEVBQUUsQUFBZSxBQUFFLG9CQUFHLEFBQUksQUFBQztBQUUvQixBQUFFLEFBQUMsZ0JBQUMsQUFBZSxvQkFBSyxBQUFJLEFBQUMsTUFBQyxBQUFDO0FBQzdCLEFBQWUsa0NBQUcsQUFBSSxLQUFDLEFBQWUsa0JBQUcsSUFBSSxBQUFjLGVBQUMsQUFBSSxLQUFDLEFBQUssTUFBQyxBQUFNLEFBQUMsQUFBQyxBQUNqRjtBQUFDO0FBRUQsQUFBTSxtQkFBQyxBQUFlLEFBQUMsQUFDekI7QUFBQyxBQUFDLEFBQUksZUFBQyxBQUFDO0FBQ04sQUFBTSxtQkFBQyxBQUFLLE1BQUMsQUFBRyxJQUFDLEFBQUcsQUFBQyxBQUFDLEFBQ3hCO0FBQUMsQUFDSDtBQUFDLEFBQ0Y7O0FBSUQsTUFBc0MsdUJBQVEsQUFBcUI7QUFDakUsZ0JBQVksQUFBUTtBQUNsQixBQUFLLGNBQUMsQUFBSyxBQUFDLEFBQUMsQUFDZjtBQUFDLEFBQ0Y7O0FBRUQsQUFBTSxPQUFDLE1BQU0sQUFBbUIsc0JBQWtDLElBQUksQUFBYyxlQUFDLEFBQVMsQUFBQyxBQUFDO0FBQ2hHLEFBQU0sT0FBQyxNQUFNLEFBQWMsaUJBQTZCLElBQUksQUFBYyxlQUFDLEFBQUksQUFBQyxBQUFDO0FBQ2pGLEFBQU0sT0FBQyxNQUFNLEFBQWMsaUJBQWdDLElBQUksQUFBYyxlQUFDLEFBQUksQUFBQyxBQUFDO0FBQ3BGLEFBQU0sT0FBQyxNQUFNLEFBQWUsa0JBQWdDLElBQUksQUFBYyxlQUFDLEFBQUssQUFBQyxBQUFDO0FBRXRGLEFBQU07QUFHSixnQkFBb0IsQUFBd0I7QUFBeEIsYUFBSyxRQUFMLEFBQUssQUFBbUI7QUFDMUMsQUFBSSxhQUFDLEFBQUcsTUFBRyxBQUFLLE1BQUMsQUFBRyxBQUFDLEFBQ3ZCO0FBQUM7QUFFRCxBQUFLO0FBQ0gsQUFBTSxlQUFDLEFBQUksS0FBQyxBQUFNLE9BQUMsQUFBSSxLQUFDLEFBQUssTUFBQyxBQUFLLEFBQUUsQUFBQyxBQUFDLEFBQ3pDO0FBQUM7QUFFUyxBQUFNLFdBQUMsQUFBYTtBQUM1QixBQUFNLGVBQUMsQ0FBQyxDQUFDLEFBQUssQUFBQyxBQUNqQjtBQUFDLEFBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBPcGFxdWUsIE9wdGlvbiwgUmVjYXN0IH0gZnJvbSAnQGdsaW1tZXIvaW50ZXJmYWNlcyc7XG5pbXBvcnQgeyBDb25zdFJlZmVyZW5jZSwgUGF0aFJlZmVyZW5jZSwgUmVmZXJlbmNlLCBUYWcgfSBmcm9tICdAZ2xpbW1lci9yZWZlcmVuY2UnO1xuXG5leHBvcnQgdHlwZSBQcmltaXRpdmUgPSB1bmRlZmluZWQgfCBudWxsIHwgYm9vbGVhbiB8IG51bWJlciB8IHN0cmluZztcblxuZXhwb3J0IGNsYXNzIFByaW1pdGl2ZVJlZmVyZW5jZTxUIGV4dGVuZHMgUHJpbWl0aXZlPiBleHRlbmRzIENvbnN0UmVmZXJlbmNlPFQ+IGltcGxlbWVudHMgUGF0aFJlZmVyZW5jZTxUPiB7XG4gIHN0YXRpYyBjcmVhdGU8VCBleHRlbmRzIFByaW1pdGl2ZT4odmFsdWU6IFQpOiBQcmltaXRpdmVSZWZlcmVuY2U8VD4ge1xuICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gVU5ERUZJTkVEX1JFRkVSRU5DRSBhcyBQcmltaXRpdmVSZWZlcmVuY2U8VD47XG4gICAgfSBlbHNlIGlmICh2YWx1ZSA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIE5VTExfUkVGRVJFTkNFIGFzIFByaW1pdGl2ZVJlZmVyZW5jZTxUPjtcbiAgICB9IGVsc2UgaWYgKHZhbHVlID09PSB0cnVlKSB7XG4gICAgICByZXR1cm4gVFJVRV9SRUZFUkVOQ0UgYXMgUHJpbWl0aXZlUmVmZXJlbmNlPFQ+O1xuICAgIH0gZWxzZSBpZiAodmFsdWUgPT09IGZhbHNlKSB7XG4gICAgICByZXR1cm4gRkFMU0VfUkVGRVJFTkNFIGFzIFByaW1pdGl2ZVJlZmVyZW5jZTxUPjtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgIHJldHVybiBuZXcgVmFsdWVSZWZlcmVuY2UodmFsdWUpIGFzIFByaW1pdGl2ZVJlZmVyZW5jZTxUPjtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG5ldyBTdHJpbmdSZWZlcmVuY2UodmFsdWUgYXMgc3RyaW5nKSBhcyBSZWNhc3Q8U3RyaW5nUmVmZXJlbmNlLCBQcmltaXRpdmVSZWZlcmVuY2U8VD4+O1xuICAgIH1cbiAgfVxuXG4gIHByb3RlY3RlZCBjb25zdHJ1Y3Rvcih2YWx1ZTogVCkge1xuICAgIHN1cGVyKHZhbHVlKTtcbiAgfVxuXG4gIGdldChfa2V5OiBzdHJpbmcpOiBQcmltaXRpdmVSZWZlcmVuY2U8UHJpbWl0aXZlPiB7XG4gICAgcmV0dXJuIFVOREVGSU5FRF9SRUZFUkVOQ0U7XG4gIH1cbn1cblxuY2xhc3MgU3RyaW5nUmVmZXJlbmNlIGV4dGVuZHMgUHJpbWl0aXZlUmVmZXJlbmNlPHN0cmluZz4ge1xuICBwcml2YXRlIGxlbmd0aFJlZmVyZW5jZTogT3B0aW9uPFByaW1pdGl2ZVJlZmVyZW5jZTxudW1iZXI+PiA9IG51bGw7XG5cbiAgZ2V0KGtleTogc3RyaW5nKTogUHJpbWl0aXZlUmVmZXJlbmNlPFByaW1pdGl2ZT4ge1xuICAgIGlmIChrZXkgPT09ICdsZW5ndGgnKSB7XG4gICAgICBsZXQgeyBsZW5ndGhSZWZlcmVuY2UgfSA9IHRoaXM7XG5cbiAgICAgIGlmIChsZW5ndGhSZWZlcmVuY2UgPT09IG51bGwpIHtcbiAgICAgICAgbGVuZ3RoUmVmZXJlbmNlID0gdGhpcy5sZW5ndGhSZWZlcmVuY2UgPSBuZXcgVmFsdWVSZWZlcmVuY2UodGhpcy5pbm5lci5sZW5ndGgpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbGVuZ3RoUmVmZXJlbmNlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gc3VwZXIuZ2V0KGtleSk7XG4gICAgfVxuICB9XG59XG5cbnR5cGUgVmFsdWUgPSB1bmRlZmluZWQgfCBudWxsIHwgbnVtYmVyIHwgYm9vbGVhbjtcblxuY2xhc3MgVmFsdWVSZWZlcmVuY2U8VCBleHRlbmRzIFZhbHVlPiBleHRlbmRzIFByaW1pdGl2ZVJlZmVyZW5jZTxUPiB7XG4gIGNvbnN0cnVjdG9yKHZhbHVlOiBUKSB7XG4gICAgc3VwZXIodmFsdWUpO1xuICB9XG59XG5cbmV4cG9ydCBjb25zdCBVTkRFRklORURfUkVGRVJFTkNFOiBQcmltaXRpdmVSZWZlcmVuY2U8dW5kZWZpbmVkPiA9IG5ldyBWYWx1ZVJlZmVyZW5jZSh1bmRlZmluZWQpO1xuZXhwb3J0IGNvbnN0IE5VTExfUkVGRVJFTkNFOiBQcmltaXRpdmVSZWZlcmVuY2U8bnVsbD4gPSBuZXcgVmFsdWVSZWZlcmVuY2UobnVsbCk7XG5leHBvcnQgY29uc3QgVFJVRV9SRUZFUkVOQ0U6IFByaW1pdGl2ZVJlZmVyZW5jZTxib29sZWFuPiA9IG5ldyBWYWx1ZVJlZmVyZW5jZSh0cnVlKTtcbmV4cG9ydCBjb25zdCBGQUxTRV9SRUZFUkVOQ0U6IFByaW1pdGl2ZVJlZmVyZW5jZTxib29sZWFuPiA9IG5ldyBWYWx1ZVJlZmVyZW5jZShmYWxzZSk7XG5cbmV4cG9ydCBjbGFzcyBDb25kaXRpb25hbFJlZmVyZW5jZSBpbXBsZW1lbnRzIFJlZmVyZW5jZTxib29sZWFuPiB7XG4gIHB1YmxpYyB0YWc6IFRhZztcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGlubmVyOiBSZWZlcmVuY2U8T3BhcXVlPikge1xuICAgIHRoaXMudGFnID0gaW5uZXIudGFnO1xuICB9XG5cbiAgdmFsdWUoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMudG9Cb29sKHRoaXMuaW5uZXIudmFsdWUoKSk7XG4gIH1cblxuICBwcm90ZWN0ZWQgdG9Cb29sKHZhbHVlOiBPcGFxdWUpOiBib29sZWFuIHtcbiAgICByZXR1cm4gISF2YWx1ZTtcbiAgfVxufVxuIl19","import { CachedReference, combineTagged } from '@glimmer/reference';\nexport class ConcatReference extends CachedReference {\n    constructor(parts) {\n        super();\n        this.parts = parts;\n        this.tag = combineTagged(parts);\n    }\n    compute() {\n        let parts = new Array();\n        for (let i = 0; i < this.parts.length; i++) {\n            let value = this.parts[i].value();\n            if (value !== null && value !== undefined) {\n                parts[i] = castToString(value);\n            }\n        }\n        if (parts.length > 0) {\n            return parts.join('');\n        }\n        return null;\n    }\n}\nfunction castToString(value) {\n    if (typeof value.toString !== 'function') {\n        return '';\n    }\n    return String(value);\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uY2F0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vcGFja2FnZXMvQGdsaW1tZXIvcnVudGltZS9saWIvY29tcGlsZWQvZXhwcmVzc2lvbnMvY29uY2F0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLEFBQU8sU0FBRSxBQUFlLGlCQUFFLEFBQWEsQUFBc0IscUJBQU0sQUFBb0IsQUFBQztBQUV4RixBQUFNLGFBQXVCLHdCQUFRLEFBQStCO0FBR2xFLGdCQUFvQixBQUFtQztBQUNyRCxBQUFLLEFBQUUsQUFBQztBQURVLGFBQUssUUFBTCxBQUFLLEFBQThCO0FBRXJELEFBQUksYUFBQyxBQUFHLE1BQUcsQUFBYSxjQUFDLEFBQUssQUFBQyxBQUFDLEFBQ2xDO0FBQUM7QUFFUyxBQUFPO0FBQ2YsWUFBSSxBQUFLLFFBQUcsSUFBSSxBQUFLLEFBQVUsQUFBQztBQUVoQyxBQUFHLEFBQUMsYUFBQyxJQUFJLEFBQUMsSUFBRyxBQUFDLEdBQUUsQUFBQyxJQUFHLEFBQUksS0FBQyxBQUFLLE1BQUMsQUFBTSxRQUFFLEFBQUMsQUFBRSxLQUFFLEFBQUM7QUFDM0MsZ0JBQUksQUFBSyxRQUFHLEFBQUksS0FBQyxBQUFLLE1BQUMsQUFBQyxBQUFDLEdBQUMsQUFBSyxBQUFFLEFBQUM7QUFFbEMsQUFBRSxBQUFDLGdCQUFDLEFBQUssVUFBSyxBQUFJLFFBQUksQUFBSyxVQUFLLEFBQVMsQUFBQyxXQUFDLEFBQUM7QUFDMUMsQUFBSyxzQkFBQyxBQUFDLEFBQUMsS0FBRyxBQUFZLGFBQUMsQUFBSyxBQUFDLEFBQUMsQUFDakM7QUFBQyxBQUNIO0FBQUM7QUFFRCxBQUFFLEFBQUMsWUFBQyxBQUFLLE1BQUMsQUFBTSxTQUFHLEFBQUMsQUFBQyxHQUFDLEFBQUM7QUFDckIsQUFBTSxtQkFBQyxBQUFLLE1BQUMsQUFBSSxLQUFDLEFBQUUsQUFBQyxBQUFDLEFBQ3hCO0FBQUM7QUFFRCxBQUFNLGVBQUMsQUFBSSxBQUFDLEFBQ2Q7QUFBQyxBQUNGOztBQUVELHNCQUFzQixBQUFTO0FBQzdCLEFBQUUsQUFBQyxRQUFDLE9BQU8sQUFBSyxNQUFDLEFBQVEsYUFBSyxBQUFVLEFBQUMsWUFBQyxBQUFDO0FBQ3pDLEFBQU0sZUFBQyxBQUFFLEFBQUMsQUFDWjtBQUFDO0FBRUQsQUFBTSxXQUFDLEFBQU0sT0FBQyxBQUFLLEFBQUMsQUFBQyxBQUN2QjtBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgT3BhcXVlLCBPcHRpb24gfSBmcm9tICdAZ2xpbW1lci9pbnRlcmZhY2VzJztcbmltcG9ydCB7IENhY2hlZFJlZmVyZW5jZSwgY29tYmluZVRhZ2dlZCwgUGF0aFJlZmVyZW5jZSwgVGFnIH0gZnJvbSAnQGdsaW1tZXIvcmVmZXJlbmNlJztcblxuZXhwb3J0IGNsYXNzIENvbmNhdFJlZmVyZW5jZSBleHRlbmRzIENhY2hlZFJlZmVyZW5jZTxPcHRpb248c3RyaW5nPj4ge1xuICBwdWJsaWMgdGFnOiBUYWc7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBwYXJ0czogQXJyYXk8UGF0aFJlZmVyZW5jZTxPcGFxdWU+Pikge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy50YWcgPSBjb21iaW5lVGFnZ2VkKHBhcnRzKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBjb21wdXRlKCk6IE9wdGlvbjxzdHJpbmc+IHtcbiAgICBsZXQgcGFydHMgPSBuZXcgQXJyYXk8c3RyaW5nPigpO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnBhcnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgdmFsdWUgPSB0aGlzLnBhcnRzW2ldLnZhbHVlKCk7XG5cbiAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCAmJiB2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHBhcnRzW2ldID0gY2FzdFRvU3RyaW5nKHZhbHVlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAocGFydHMubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIHBhcnRzLmpvaW4oJycpO1xuICAgIH1cblxuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNhc3RUb1N0cmluZyh2YWx1ZToge30pIHtcbiAgaWYgKHR5cGVvZiB2YWx1ZS50b1N0cmluZyAhPT0gJ2Z1bmN0aW9uJykge1xuICAgIHJldHVybiAnJztcbiAgfVxuXG4gIHJldHVybiBTdHJpbmcodmFsdWUpO1xufVxuIl19","export function stackAssert(name, top) {\n    return `Expected top of stack to be ${name}, was ${String(top)}`;\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXNzZXJ0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vcGFja2FnZXMvQGdsaW1tZXIvcnVudGltZS9saWIvY29tcGlsZWQvb3Bjb2Rlcy9hc3NlcnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBR0EsQUFBTSw0QkFBc0IsQUFBWSxNQUFFLEFBQVc7QUFDbkQsQUFBTSxBQUFDLDBDQUErQixBQUFJLGFBQVMsQUFBTSxPQUFDLEFBQUcsQUFBQyxJQUFFLEFBQUMsQUFDbkU7QUFBQyIsInNvdXJjZXNDb250ZW50IjpbIlxuaW1wb3J0IHsgT3BhcXVlIH0gZnJvbSBcIkBnbGltbWVyL2ludGVyZmFjZXNcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHN0YWNrQXNzZXJ0KG5hbWU6IHN0cmluZywgdG9wOiBPcGFxdWUpIHtcbiAgcmV0dXJuIGBFeHBlY3RlZCB0b3Agb2Ygc3RhY2sgdG8gYmUgJHtuYW1lfSwgd2FzICR7U3RyaW5nKHRvcCl9YDtcbn0iXX0=","import { Register } from '@glimmer/vm';\nimport { APPEND_OPCODES } from '../../opcodes';\nimport { FALSE_REFERENCE, TRUE_REFERENCE } from '../../references';\nimport { ConcatReference } from '../expressions/concat';\nimport { assert } from \"@glimmer/util\";\n\nimport { stackAssert } from './assert';\n\nAPPEND_OPCODES.add(1 /* Helper */, (vm, { op1: handle }) => {\n    let stack = vm.stack;\n    let helper = vm.constants.resolveHandle(handle);\n    let args = stack.pop();\n    let value = helper(vm, args);\n    vm.loadValue(Register.v0, value);\n});\nAPPEND_OPCODES.add(4 /* GetVariable */, (vm, { op1: symbol }) => {\n    let expr = vm.referenceForSymbol(symbol);\n    vm.stack.push(expr);\n});\nAPPEND_OPCODES.add(2 /* SetVariable */, (vm, { op1: symbol }) => {\n    let expr = vm.stack.pop();\n    vm.scope().bindSymbol(symbol, expr);\n});\nAPPEND_OPCODES.add(3 /* SetBlock */, (vm, { op1: symbol }) => {\n    let handle = vm.stack.pop();\n    let scope = vm.stack.pop(); // FIXME(mmun): shouldn't need to cast this\n    let table = vm.stack.pop();\n    let block = table ? [handle, scope, table] : null;\n    vm.scope().bindBlock(symbol, block);\n});\nAPPEND_OPCODES.add(76 /* ResolveMaybeLocal */, (vm, { op1: _name }) => {\n    let name = vm.constants.getString(_name);\n    let locals = vm.scope().getPartialMap();\n    let ref = locals[name];\n    if (ref === undefined) {\n        ref = vm.getSelf().get(name);\n    }\n    vm.stack.push(ref);\n});\nAPPEND_OPCODES.add(17 /* RootScope */, (vm, { op1: symbols, op2: bindCallerScope }) => {\n    vm.pushRootScope(symbols, !!bindCallerScope);\n});\nAPPEND_OPCODES.add(5 /* GetProperty */, (vm, { op1: _key }) => {\n    let key = vm.constants.getString(_key);\n    let expr = vm.stack.pop();\n    vm.stack.push(expr.get(key));\n});\nAPPEND_OPCODES.add(6 /* GetBlock */, (vm, { op1: _block }) => {\n    let { stack } = vm;\n    let block = vm.scope().getBlock(_block);\n    if (block) {\n        stack.push(block[2]);\n        stack.push(block[1]);\n        stack.push(block[0]);\n    } else {\n        stack.push(null);\n        stack.push(null);\n        stack.push(null);\n    }\n});\nAPPEND_OPCODES.add(7 /* HasBlock */, (vm, { op1: _block }) => {\n    let hasBlock = !!vm.scope().getBlock(_block);\n    vm.stack.push(hasBlock ? TRUE_REFERENCE : FALSE_REFERENCE);\n});\nAPPEND_OPCODES.add(8 /* HasBlockParams */, vm => {\n    // FIXME(mmun): should only need to push the symbol table\n    let table = vm.stack.pop();\n    (false && assert(table === null || table && typeof table === 'object' && Array.isArray(table.parameters), stackAssert('Option<BlockSymbolTable>', table)));\n\n    let hasBlockParams = table && table.parameters.length;\n    vm.stack.push(hasBlockParams ? TRUE_REFERENCE : FALSE_REFERENCE);\n});\nAPPEND_OPCODES.add(9 /* Concat */, (vm, { op1: count }) => {\n    let out = new Array(count);\n    for (let i = count; i > 0; i--) {\n        let offset = i - 1;\n        out[offset] = vm.stack.pop();\n    }\n    vm.stack.push(new ConcatReference(out));\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXhwcmVzc2lvbnMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci9ydW50aW1lL2xpYi9jb21waWxlZC9vcGNvZGVzL2V4cHJlc3Npb25zLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLEFBQU8sU0FBTSxBQUFRLEFBQUUsZ0JBQU0sQUFBYSxBQUFDO0FBRTNDLEFBQU8sU0FBRSxBQUFjLEFBQUUsc0JBQU0sQUFBZSxBQUFDO0FBQy9DLEFBQU8sU0FBRSxBQUFlLGlCQUFFLEFBQWMsQUFBRSxzQkFBTSxBQUFrQixBQUFDO0FBRW5FLEFBQU8sU0FBRSxBQUFlLEFBQUUsdUJBQU0sQUFBdUIsQUFBQztBQUN4RCxBQUFPLFNBQUUsQUFBTSxBQUFFLGNBQU0sQUFBZSxBQUFDLEFBQ3ZDLEFBQU8sQUFBRSxBQUFLLEFBQUUsQUFBaUIsQUFBRSxBQUFhLEFBQUUsQUFBVyxBQUFFLEFBQVcsQUFBRSxBQUFxQixBQUFFLEFBQU8sQUFBRSxBQUFNLEFBQWdCLEFBQUM7O0FBQ25JLEFBQU8sU0FBRSxBQUFXLEFBQUUsbUJBQU0sQUFBVSxBQUFDLEFBQ3ZDLEFBQU8sQUFBRSxBQUFjLEFBQUUsQUFBa0IsQUFBRSxBQUFvQixBQUFFLEFBQVUsQUFBRSxBQUFNLEFBQWdCLEFBQUM7O0FBSXRHLEFBQWMsZUFBQyxBQUFHLG9CQUFZLENBQUMsQUFBRSxJQUFFLEVBQUUsQUFBRyxLQUFFLEFBQU0sQUFBRTtBQUNoRCxRQUFJLEFBQUssUUFBRyxBQUFFLEdBQUMsQUFBSyxBQUFDO0FBQ3JCLFFBQUksQUFBTSxBQUFHLEFBQUssU0FBQyxBQUFFLEdBQUMsQUFBUyxVQUFDLEFBQWEsY0FBQyxBQUFNLEFBQUMsQUFBRSxBQUFhLEFBQUMsQUFBQztBQUN0RSxRQUFJLEFBQUksQUFBRyxBQUFLLE9BQUMsQUFBSyxNQUFDLEFBQUcsQUFBRSxBQUFFLEFBQWMsQUFBQyxBQUFDO0FBQzlDLFFBQUksQUFBSyxR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RyxLQUFFLEFBQUssQUFBRTtBQUMvQyxRQUFJLEFBQUcsTUFBMEMsSUFBSSxBQUFLLE1BQUMsQUFBSyxBQUFDLEFBQUM7QUFFbEUsQUFBRyxBQUFDLFNBQUMsSUFBSSxBQUFDLElBQUcsQUFBSyxPQUFFLEFBQUMsSUFBRyxBQUFDLEdBQUUsQUFBQyxBQUFFLEtBQUUsQUFBQztBQUMvQixZQUFJLEFBQU0sU0FBRyxBQUFDLElBQUcsQUFBQyxBQUFDO0FBQ25CLEFBQUcsWUFBQyxBQUFNLEFBQUMsQUFBRyxBQUFLLFVBQUMsQUFBRSxHQUFDLEFBQUssTUFBQyxBQUFHLEFBQUUsQUFBRSxBQUFrQixBQUFDLEFBQUMsQUFDMUQ7QUFBQztBQUVELEFBQUUsT0FBQyxBQUFLLE1BQUMsQUFBSSxLQUFDLElBQUksQUFBZSxnQkFBQyxBQUFHLEFBQUMsQUFBQyxBQUFDLEFBQzFDO0FBQUMsQUFBQyxBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgT3BhcXVlLCBPcHRpb24gfSBmcm9tICdAZ2xpbW1lci9pbnRlcmZhY2VzJztcbmltcG9ydCB7IFZlcnNpb25lZFBhdGhSZWZlcmVuY2UgfSBmcm9tICdAZ2xpbW1lci9yZWZlcmVuY2UnO1xuaW1wb3J0IHsgT3AsIFJlZ2lzdGVyIH0gZnJvbSAnQGdsaW1tZXIvdm0nO1xuaW1wb3J0IHsgU2NvcGUsIFNjb3BlQmxvY2sgfSBmcm9tICcuLi8uLi9lbnZpcm9ubWVudCc7XG5pbXBvcnQgeyBBUFBFTkRfT1BDT0RFUyB9IGZyb20gJy4uLy4uL29wY29kZXMnO1xuaW1wb3J0IHsgRkFMU0VfUkVGRVJFTkNFLCBUUlVFX1JFRkVSRU5DRSB9IGZyb20gJy4uLy4uL3JlZmVyZW5jZXMnO1xuaW1wb3J0IHsgUHVibGljVk0gfSBmcm9tICcuLi8uLi92bSc7XG5pbXBvcnQgeyBDb25jYXRSZWZlcmVuY2UgfSBmcm9tICcuLi9leHByZXNzaW9ucy9jb25jYXQnO1xuaW1wb3J0IHsgYXNzZXJ0IH0gZnJvbSBcIkBnbGltbWVyL3V0aWxcIjtcbmltcG9ydCB7IGNoZWNrLCBleHBlY3RTdGFja0NoYW5nZSwgQ2hlY2tGdW5jdGlvbiwgQ2hlY2tPcHRpb24sIENoZWNrSGFuZGxlLCBDaGVja0Jsb2NrU3ltYm9sVGFibGUsIENoZWNrT3IgfSBmcm9tICdAZ2xpbW1lci9kZWJ1Zyc7XG5pbXBvcnQgeyBzdGFja0Fzc2VydCB9IGZyb20gJy4vYXNzZXJ0JztcbmltcG9ydCB7IENoZWNrQXJndW1lbnRzLCBDaGVja1BhdGhSZWZlcmVuY2UsIENoZWNrQ29tcGlsYWJsZUJsb2NrLCBDaGVja1Njb3BlIH0gZnJvbSAnLi8tZGVidWctc3RyaXAnO1xuXG5leHBvcnQgdHlwZSBGdW5jdGlvbkV4cHJlc3Npb248VD4gPSAodm06IFB1YmxpY1ZNKSA9PiBWZXJzaW9uZWRQYXRoUmVmZXJlbmNlPFQ+O1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuSGVscGVyLCAodm0sIHsgb3AxOiBoYW5kbGUgfSkgPT4ge1xuICBsZXQgc3RhY2sgPSB2bS5zdGFjaztcbiAgbGV0IGhlbHBlciA9IGNoZWNrKHZtLmNvbnN0YW50cy5yZXNvbHZlSGFuZGxlKGhhbmRsZSksIENoZWNrRnVuY3Rpb24pO1xuICBsZXQgYXJncyA9IGNoZWNrKHN0YWNrLnBvcCgpLCBDaGVja0FyZ3VtZW50cyk7XG4gIGxldCB2YWx1ZSA9IGhlbHBlcih2bSwgYXJncyk7XG5cbiAgdm0ubG9hZFZhbHVlKFJlZ2lzdGVyLnYwLCB2YWx1ZSk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkdldFZhcmlhYmxlLCAodm0sIHsgb3AxOiBzeW1ib2wgfSkgPT4ge1xuICBsZXQgZXhwciA9IHZtLnJlZmVyZW5jZUZvclN5bWJvbChzeW1ib2wpO1xuICB2bS5zdGFjay5wdXNoKGV4cHIpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5TZXRWYXJpYWJsZSwgKHZtLCB7IG9wMTogc3ltYm9sIH0pID0+IHtcbiAgbGV0IGV4cHIgPSBjaGVjayh2bS5zdGFjay5wb3AoKSwgQ2hlY2tQYXRoUmVmZXJlbmNlKTtcbiAgdm0uc2NvcGUoKS5iaW5kU3ltYm9sKHN5bWJvbCwgZXhwcik7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLlNldEJsb2NrLCAodm0sIHsgb3AxOiBzeW1ib2wgfSkgPT4ge1xuICBsZXQgaGFuZGxlID0gY2hlY2sodm0uc3RhY2sucG9wKCksIENoZWNrT3IoQ2hlY2tPcHRpb24oQ2hlY2tIYW5kbGUpLCBDaGVja0NvbXBpbGFibGVCbG9jaykpO1xuICBsZXQgc2NvcGUgPSBjaGVjayh2bS5zdGFjay5wb3AoKSwgQ2hlY2tTY29wZSkgYXMgT3B0aW9uPFNjb3BlPjsgLy8gRklYTUUobW11bik6IHNob3VsZG4ndCBuZWVkIHRvIGNhc3QgdGhpc1xuICBsZXQgdGFibGUgPSBjaGVjayh2bS5zdGFjay5wb3AoKSwgQ2hlY2tPcHRpb24oQ2hlY2tCbG9ja1N5bWJvbFRhYmxlKSk7XG5cbiAgbGV0IGJsb2NrOiBPcHRpb248U2NvcGVCbG9jaz4gPSB0YWJsZSA/IFtoYW5kbGUhLCBzY29wZSEsIHRhYmxlXSA6IG51bGw7XG5cbiAgdm0uc2NvcGUoKS5iaW5kQmxvY2soc3ltYm9sLCBibG9jayk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLlJlc29sdmVNYXliZUxvY2FsLCAodm0sIHsgb3AxOiBfbmFtZSB9KSA9PiB7XG4gIGxldCBuYW1lID0gdm0uY29uc3RhbnRzLmdldFN0cmluZyhfbmFtZSk7XG4gIGxldCBsb2NhbHMgPSB2bS5zY29wZSgpLmdldFBhcnRpYWxNYXAoKSE7XG5cbiAgbGV0IHJlZiA9IGxvY2Fsc1tuYW1lXTtcbiAgaWYgKHJlZiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmVmID0gdm0uZ2V0U2VsZigpLmdldChuYW1lKTtcbiAgfVxuXG4gIHZtLnN0YWNrLnB1c2gocmVmKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUm9vdFNjb3BlLCAodm0sIHsgb3AxOiBzeW1ib2xzLCBvcDI6IGJpbmRDYWxsZXJTY29wZSB9KSA9PiB7XG4gIHZtLnB1c2hSb290U2NvcGUoc3ltYm9scywgISFiaW5kQ2FsbGVyU2NvcGUpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5HZXRQcm9wZXJ0eSwgKHZtLCB7IG9wMTogX2tleSB9KSA9PiB7XG4gIGxldCBrZXkgPSB2bS5jb25zdGFudHMuZ2V0U3RyaW5nKF9rZXkpO1xuICBsZXQgZXhwciA9IGNoZWNrKHZtLnN0YWNrLnBvcCgpLCBDaGVja1BhdGhSZWZlcmVuY2UpO1xuICB2bS5zdGFjay5wdXNoKGV4cHIuZ2V0KGtleSkpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5HZXRCbG9jaywgKHZtLCB7IG9wMTogX2Jsb2NrIH0pID0+IHtcbiAgbGV0IHsgc3RhY2sgfSA9IHZtO1xuICBsZXQgYmxvY2sgPSB2bS5zY29wZSgpLmdldEJsb2NrKF9ibG9jayk7XG5cbiAgaWYgKGJsb2NrKSB7XG4gICAgc3RhY2sucHVzaChibG9ja1syXSk7XG4gICAgc3RhY2sucHVzaChibG9ja1sxXSk7XG4gICAgc3RhY2sucHVzaChibG9ja1swXSk7XG4gIH0gZWxzZSB7XG4gICAgc3RhY2sucHVzaChudWxsKTtcbiAgICBzdGFjay5wdXNoKG51bGwpO1xuICAgIHN0YWNrLnB1c2gobnVsbCk7XG4gIH1cblxuICBleHBlY3RTdGFja0NoYW5nZSh2bS5zdGFjaywgMywgJ0dldEJsb2NrJyk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkhhc0Jsb2NrLCAodm0sIHsgb3AxOiBfYmxvY2sgfSkgPT4ge1xuICBsZXQgaGFzQmxvY2sgPSAhIXZtLnNjb3BlKCkuZ2V0QmxvY2soX2Jsb2NrKTtcbiAgdm0uc3RhY2sucHVzaChoYXNCbG9jayA/IFRSVUVfUkVGRVJFTkNFIDogRkFMU0VfUkVGRVJFTkNFKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuSGFzQmxvY2tQYXJhbXMsICh2bSkgPT4ge1xuICAvLyBGSVhNRShtbXVuKTogc2hvdWxkIG9ubHkgbmVlZCB0byBwdXNoIHRoZSBzeW1ib2wgdGFibGVcbiAgY2hlY2sodm0uc3RhY2sucG9wKCksIENoZWNrT3B0aW9uKENoZWNrT3IoQ2hlY2tIYW5kbGUsIENoZWNrQ29tcGlsYWJsZUJsb2NrKSkpO1xuICBjaGVjayh2bS5zdGFjay5wb3AoKSwgQ2hlY2tPcHRpb24oQ2hlY2tTY29wZSkpO1xuICBsZXQgdGFibGUgPSBjaGVjayh2bS5zdGFjay5wb3AoKSwgQ2hlY2tPcHRpb24oQ2hlY2tCbG9ja1N5bWJvbFRhYmxlKSk7XG5cbiAgYXNzZXJ0KHRhYmxlID09PSBudWxsIHx8ICh0YWJsZSAmJiB0eXBlb2YgdGFibGUgPT09ICdvYmplY3QnICYmIEFycmF5LmlzQXJyYXkodGFibGUucGFyYW1ldGVycykpLCBzdGFja0Fzc2VydCgnT3B0aW9uPEJsb2NrU3ltYm9sVGFibGU+JywgdGFibGUpKTtcblxuICBsZXQgaGFzQmxvY2tQYXJhbXMgPSB0YWJsZSAmJiB0YWJsZS5wYXJhbWV0ZXJzLmxlbmd0aDtcbiAgdm0uc3RhY2sucHVzaChoYXNCbG9ja1BhcmFtcyA/IFRSVUVfUkVGRVJFTkNFIDogRkFMU0VfUkVGRVJFTkNFKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuQ29uY2F0LCAodm0sIHsgb3AxOiBjb3VudCB9KSA9PiB7XG4gIGxldCBvdXQ6IEFycmF5PFZlcnNpb25lZFBhdGhSZWZlcmVuY2U8T3BhcXVlPj4gPSBuZXcgQXJyYXkoY291bnQpO1xuXG4gIGZvciAobGV0IGkgPSBjb3VudDsgaSA+IDA7IGktLSkge1xuICAgIGxldCBvZmZzZXQgPSBpIC0gMTtcbiAgICBvdXRbb2Zmc2V0XSA9IGNoZWNrKHZtLnN0YWNrLnBvcCgpLCBDaGVja1BhdGhSZWZlcmVuY2UpO1xuICB9XG5cbiAgdm0uc3RhY2sucHVzaChuZXcgQ29uY2F0UmVmZXJlbmNlKG91dCkpO1xufSk7XG4iXX0=","export var Opcodes;\n(function (Opcodes) {\n    // Statements\n    Opcodes[Opcodes[\"Text\"] = 0] = \"Text\";\n    Opcodes[Opcodes[\"Append\"] = 1] = \"Append\";\n    Opcodes[Opcodes[\"Comment\"] = 2] = \"Comment\";\n    Opcodes[Opcodes[\"Modifier\"] = 3] = \"Modifier\";\n    Opcodes[Opcodes[\"Block\"] = 4] = \"Block\";\n    Opcodes[Opcodes[\"Component\"] = 5] = \"Component\";\n    Opcodes[Opcodes[\"OpenElement\"] = 6] = \"OpenElement\";\n    Opcodes[Opcodes[\"OpenSplattedElement\"] = 7] = \"OpenSplattedElement\";\n    Opcodes[Opcodes[\"FlushElement\"] = 8] = \"FlushElement\";\n    Opcodes[Opcodes[\"CloseElement\"] = 9] = \"CloseElement\";\n    Opcodes[Opcodes[\"StaticAttr\"] = 10] = \"StaticAttr\";\n    Opcodes[Opcodes[\"DynamicAttr\"] = 11] = \"DynamicAttr\";\n    Opcodes[Opcodes[\"AttrSplat\"] = 12] = \"AttrSplat\";\n    Opcodes[Opcodes[\"Yield\"] = 13] = \"Yield\";\n    Opcodes[Opcodes[\"Partial\"] = 14] = \"Partial\";\n    Opcodes[Opcodes[\"DynamicArg\"] = 15] = \"DynamicArg\";\n    Opcodes[Opcodes[\"StaticArg\"] = 16] = \"StaticArg\";\n    Opcodes[Opcodes[\"TrustingAttr\"] = 17] = \"TrustingAttr\";\n    Opcodes[Opcodes[\"Debugger\"] = 18] = \"Debugger\";\n    Opcodes[Opcodes[\"ClientSideStatement\"] = 19] = \"ClientSideStatement\";\n    // Expressions\n    Opcodes[Opcodes[\"Unknown\"] = 20] = \"Unknown\";\n    Opcodes[Opcodes[\"Get\"] = 21] = \"Get\";\n    Opcodes[Opcodes[\"MaybeLocal\"] = 22] = \"MaybeLocal\";\n    Opcodes[Opcodes[\"HasBlock\"] = 23] = \"HasBlock\";\n    Opcodes[Opcodes[\"HasBlockParams\"] = 24] = \"HasBlockParams\";\n    Opcodes[Opcodes[\"Undefined\"] = 25] = \"Undefined\";\n    Opcodes[Opcodes[\"Helper\"] = 26] = \"Helper\";\n    Opcodes[Opcodes[\"Concat\"] = 27] = \"Concat\";\n    Opcodes[Opcodes[\"ClientSideExpression\"] = 28] = \"ClientSideExpression\";\n})(Opcodes || (Opcodes = {}));\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3Bjb2Rlcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3dpcmUtZm9ybWF0L2xpYi9vcGNvZGVzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLEFBQU0sT0FBTixJQUFZLEFBbUNYO0FBbkNELFdBQVksQUFBTztBQUNqQixBQUFhO0FBQ2IsbUNBQUk7QUFDSixxQ0FBTTtBQUNOLHNDQUFPO0FBQ1AsdUNBQVE7QUFDUixvQ0FBSztBQUNMLHdDQUFTO0FBQ1QsMENBQVc7QUFDWCxrREFBbUI7QUFDbkIsMkNBQVk7QUFDWiwyQ0FBWTtBQUNaLDBDQUFVO0FBQ1YsMkNBQVc7QUFDWCx5Q0FBUztBQUNULHFDQUFLO0FBQ0wsdUNBQU87QUFFUCwwQ0FBVTtBQUNWLHlDQUFTO0FBQ1QsNENBQVk7QUFDWix3Q0FBUTtBQUNSLG1EQUFtQjtBQUVuQixBQUFjO0FBRWQsdUNBQU87QUFDUCxtQ0FBRztBQUNILDBDQUFVO0FBQ1Ysd0NBQVE7QUFDUiw4Q0FBYztBQUNkLHlDQUFTO0FBQ1Qsc0NBQU07QUFDTixzQ0FBTTtBQUNOLG9EQUFvQixBQUN0QjtBQUFDLEdBbkNXLEFBQU8sWUFBUCxBQUFPLFVBbUNsQiIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBlbnVtIE9wY29kZXMge1xuICAvLyBTdGF0ZW1lbnRzXG4gIFRleHQsXG4gIEFwcGVuZCxcbiAgQ29tbWVudCxcbiAgTW9kaWZpZXIsXG4gIEJsb2NrLFxuICBDb21wb25lbnQsXG4gIE9wZW5FbGVtZW50LFxuICBPcGVuU3BsYXR0ZWRFbGVtZW50LFxuICBGbHVzaEVsZW1lbnQsXG4gIENsb3NlRWxlbWVudCxcbiAgU3RhdGljQXR0cixcbiAgRHluYW1pY0F0dHIsXG4gIEF0dHJTcGxhdCxcbiAgWWllbGQsXG4gIFBhcnRpYWwsXG5cbiAgRHluYW1pY0FyZyxcbiAgU3RhdGljQXJnLFxuICBUcnVzdGluZ0F0dHIsXG4gIERlYnVnZ2VyLFxuICBDbGllbnRTaWRlU3RhdGVtZW50LFxuXG4gIC8vIEV4cHJlc3Npb25zXG5cbiAgVW5rbm93bixcbiAgR2V0LFxuICBNYXliZUxvY2FsLFxuICBIYXNCbG9jayxcbiAgSGFzQmxvY2tQYXJhbXMsXG4gIFVuZGVmaW5lZCxcbiAgSGVscGVyLFxuICBDb25jYXQsXG4gIENsaWVudFNpZGVFeHByZXNzaW9uXG59XG4iXX0=","import { Opcodes } from './lib/opcodes';\nexport { Opcodes as Ops } from './lib/opcodes';\nexport function is(variant) {\n    return function (value) {\n        return Array.isArray(value) && value[0] === variant;\n    };\n}\n// Statements\nexport const isModifier = is(Opcodes.Modifier);\nexport const isFlushElement = is(Opcodes.FlushElement);\nexport function isAttribute(val) {\n    return val[0] === Opcodes.StaticAttr || val[0] === Opcodes.DynamicAttr || val[0] === Opcodes.TrustingAttr;\n}\nexport function isArgument(val) {\n    return val[0] === Opcodes.StaticArg || val[0] === Opcodes.DynamicArg;\n}\n// Expressions\nexport const isGet = is(Opcodes.Get);\nexport const isMaybeLocal = is(Opcodes.MaybeLocal);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci93aXJlLWZvcm1hdC9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxBQUFPLFNBQUUsQUFBTyxBQUFFLGVBQU0sQUFBZSxBQUFDO0FBRXhDLEFBQU8sU0FBRSxBQUFPLFdBQUksQUFBRyxBQUFFLFdBQU0sQUFBZSxBQUFDO0FBbUIvQyxBQUFNLG1CQUFnQixBQUFlO0FBQ25DLEFBQU0sV0FBQyxVQUFTLEFBQVU7QUFDeEIsQUFBTSxlQUFDLEFBQUssTUFBQyxBQUFPLFFBQUMsQUFBSyxBQUFDLFVBQUksQUFBSyxNQUFDLEFBQUMsQUFBQyxPQUFLLEFBQU8sQUFBQyxBQUN0RDtBQUFDLEFBQUMsQUFDSjtBQUFDO0FBeUxELEFBQWE7QUFDYixBQUFNLE9BQUMsTUFBTSxBQUFVLGFBQVMsQUFBRSxHQUFzQixBQUFPLFFBQUMsQUFBUSxBQUFDLEFBQUM7QUFDMUUsQUFBTSxPQUFDLE1BQU0sQUFBYyxpQkFBSyxBQUFFLEdBQTBCLEFBQU8sUUFBQyxBQUFZLEFBQUMsQUFBQztBQUVsRixBQUFNLDRCQUFzQixBQUFjO0FBQ3hDLEFBQU0sV0FBQyxBQUFHLElBQUMsQUFBQyxBQUFDLE9BQUssQUFBTyxRQUFDLEFBQVUsY0FBSSxBQUFHLElBQUMsQUFBQyxBQUFDLE9BQUssQUFBTyxRQUFDLEFBQVcsZUFBSSxBQUFHLElBQUMsQUFBQyxBQUFDLE9BQUssQUFBTyxRQUFDLEFBQVksQUFBQyxBQUM1RztBQUFDO0FBRUQsQUFBTSwyQkFBcUIsQUFBYztBQUN2QyxBQUFNLFdBQUMsQUFBRyxJQUFDLEFBQUMsQUFBQyxPQUFLLEFBQU8sUUFBQyxBQUFTLGFBQUksQUFBRyxJQUFDLEFBQUMsQUFBQyxPQUFLLEFBQU8sUUFBQyxBQUFVLEFBQUMsQUFDdkU7QUFBQztBQUVELEFBQWM7QUFDZCxBQUFNLE9BQUMsTUFBTSxBQUFLLFFBQWMsQUFBRSxHQUFrQixBQUFPLFFBQUMsQUFBRyxBQUFDLEFBQUM7QUFDakUsQUFBTSxPQUFDLE1BQU0sQUFBWSxlQUFPLEFBQUUsR0FBeUIsQUFBTyxRQUFDLEFBQVUsQUFBQyxBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRGljdCwgT3B0aW9uLCBPcGFxdWUgfSBmcm9tICdAZ2xpbW1lci91dGlsJztcbmltcG9ydCB7IE9wY29kZXMgfSBmcm9tICcuL2xpYi9vcGNvZGVzJztcblxuZXhwb3J0IHsgT3Bjb2RlcyBhcyBPcHMgfSBmcm9tICcuL2xpYi9vcGNvZGVzJztcblxudHlwZSBKc29uVmFsdWUgPVxuICAgIHN0cmluZ1xuICB8IG51bWJlclxuICB8IGJvb2xlYW5cbiAgfCBKc29uT2JqZWN0XG4gIHwgSnNvbkFycmF5XG4gIDtcblxuaW50ZXJmYWNlIEpzb25PYmplY3QgZXh0ZW5kcyBEaWN0PEpzb25WYWx1ZT4ge31cbmludGVyZmFjZSBKc29uQXJyYXkgZXh0ZW5kcyBBcnJheTxKc29uVmFsdWU+IHt9XG5cbi8vIFRoaXMgZW50aXJlIGZpbGUgaXMgc2VyaWFsaXplZCB0byBkaXNrLCBzbyBhbGwgc3RyaW5nc1xuLy8gZW5kIHVwIGJlaW5nIGludGVybmVkLlxuZXhwb3J0IHR5cGUgc3RyID0gc3RyaW5nO1xuZXhwb3J0IHR5cGUgVGVtcGxhdGVSZWZlcmVuY2UgPSBPcHRpb248U2VyaWFsaXplZEJsb2NrPjtcbmV4cG9ydCB0eXBlIFlpZWxkVG8gPSBudW1iZXI7XG5cbmV4cG9ydCBmdW5jdGlvbiBpczxUPih2YXJpYW50OiBudW1iZXIpOiAodmFsdWU6IGFueSkgPT4gdmFsdWUgaXMgVCB7XG4gIHJldHVybiBmdW5jdGlvbih2YWx1ZTogYW55KTogdmFsdWUgaXMgVCB7XG4gICAgcmV0dXJuIEFycmF5LmlzQXJyYXkodmFsdWUpICYmIHZhbHVlWzBdID09PSB2YXJpYW50O1xuICB9O1xufVxuXG5leHBvcnQgbmFtZXNwYWNlIENvcmUge1xuICBleHBvcnQgdHlwZSBFeHByZXNzaW9uID0gRXhwcmVzc2lvbnMuRXhwcmVzc2lvbjtcblxuICBleHBvcnQgdHlwZSBQYXRoICAgICAgICAgID0gc3RyW107XG4gIGV4cG9ydCB0eXBlIFBhcmFtcyAgICAgICAgPSBFeHByZXNzaW9uW107XG4gIGV4cG9ydCB0eXBlIEhhc2ggICAgICAgICAgPSBPcHRpb248W3N0cltdLCBFeHByZXNzaW9uW11dPjtcbiAgZXhwb3J0IHR5cGUgQXJncyAgICAgICAgICA9IFtQYXJhbXMsIEhhc2hdO1xuICBleHBvcnQgdHlwZSBFdmFsSW5mbyAgICAgID0gbnVtYmVyW107XG59XG5cbmV4cG9ydCBuYW1lc3BhY2UgRXhwcmVzc2lvbnMge1xuICBleHBvcnQgdHlwZSBQYXRoID0gQ29yZS5QYXRoO1xuICBleHBvcnQgdHlwZSBQYXJhbXMgPSBDb3JlLlBhcmFtcztcbiAgZXhwb3J0IHR5cGUgSGFzaCA9IENvcmUuSGFzaDtcblxuICBleHBvcnQgdHlwZSBVbmtub3duICAgICAgICA9IFtPcGNvZGVzLlVua25vd24sIHN0cl07XG4gIGV4cG9ydCB0eXBlIEdldCAgICAgICAgICAgID0gW09wY29kZXMuR2V0LCBudW1iZXIsIFBhdGhdO1xuXG4gIC8qKlxuICAgKiBBbWJpZ3VvdXMgYmV0d2VlbiBhIHNlbGYgbG9va3VwICh3aGVuIG5vdCBpbnNpZGUgYW4gZXZhbCkgYW5kXG4gICAqIGEgbG9jYWwgdmFyaWFibGUgKHdoZW4gdXNlZCBpbnNpZGUgb2YgYW4gZXZhbCkuXG4gICAqL1xuICBleHBvcnQgdHlwZSBNYXliZUxvY2FsICAgICA9IFtPcGNvZGVzLk1heWJlTG9jYWwsIFBhdGhdO1xuXG4gIGV4cG9ydCB0eXBlIFZhbHVlICAgICAgICAgID0gc3RyIHwgbnVtYmVyIHwgYm9vbGVhbiB8IG51bGw7XG5cbiAgZXhwb3J0IHR5cGUgSGFzQmxvY2sgICAgICAgPSBbT3Bjb2Rlcy5IYXNCbG9jaywgWWllbGRUb107XG4gIGV4cG9ydCB0eXBlIEhhc0Jsb2NrUGFyYW1zID0gW09wY29kZXMuSGFzQmxvY2tQYXJhbXMsIFlpZWxkVG9dO1xuICBleHBvcnQgdHlwZSBVbmRlZmluZWQgICAgICA9IFtPcGNvZGVzLlVuZGVmaW5lZF07XG4gIGV4cG9ydCB0eXBlIENsaWVudFNpZGUgICAgID0gW09wY29kZXMuQ2xpZW50U2lkZUV4cHJlc3Npb24sIGFueV07XG5cbiAgZXhwb3J0IHR5cGUgVHVwbGVFeHByZXNzaW9uID1cbiAgICBVbmtub3duXG4gICAgfCBHZXRcbiAgICB8IE1heWJlTG9jYWxcbiAgICB8IENvbmNhdFxuICAgIHwgSGFzQmxvY2tcbiAgICB8IEhhc0Jsb2NrUGFyYW1zXG4gICAgfCBIZWxwZXJcbiAgICB8IFVuZGVmaW5lZFxuICAgIHwgQ2xpZW50U2lkZVxuICAgIDtcblxuICBleHBvcnQgdHlwZSBFeHByZXNzaW9uID0gVHVwbGVFeHByZXNzaW9uIHwgVmFsdWU7XG5cbiAgZXhwb3J0IGludGVyZmFjZSBDb25jYXQgZXh0ZW5kcyBBcnJheTxhbnk+IHtcbiAgICBbMF06IE9wY29kZXMuQ29uY2F0O1xuICAgIFsxXTogUGFyYW1zO1xuICB9XG5cbiAgZXhwb3J0IGludGVyZmFjZSBIZWxwZXIgZXh0ZW5kcyBBcnJheTxhbnk+IHtcbiAgICBbMF06IE9wY29kZXMuSGVscGVyO1xuICAgIFsxXTogc3RyO1xuICAgIFsyXTogUGFyYW1zO1xuICAgIFszXTogSGFzaDtcbiAgfVxufVxuXG5leHBvcnQgdHlwZSBFeHByZXNzaW9uID0gRXhwcmVzc2lvbnMuRXhwcmVzc2lvbjtcblxuZXhwb3J0IHR5cGUgVHVwbGVFeHByZXNzaW9uID0gRXhwcmVzc2lvbnMuVHVwbGVFeHByZXNzaW9uO1xuXG5leHBvcnQgbmFtZXNwYWNlIFN0YXRlbWVudHMge1xuICBleHBvcnQgdHlwZSBFeHByZXNzaW9uID0gRXhwcmVzc2lvbnMuRXhwcmVzc2lvbjtcbiAgZXhwb3J0IHR5cGUgUGFyYW1zID0gQ29yZS5QYXJhbXM7XG4gIGV4cG9ydCB0eXBlIEhhc2ggPSBDb3JlLkhhc2g7XG4gIGV4cG9ydCB0eXBlIFBhdGggPSBDb3JlLlBhdGg7XG5cbiAgZXhwb3J0IHR5cGUgVGV4dCAgICAgICAgICA9IFtPcGNvZGVzLlRleHQsIHN0cl07XG4gIGV4cG9ydCB0eXBlIEFwcGVuZCAgICAgICAgPSBbT3Bjb2Rlcy5BcHBlbmQsIEV4cHJlc3Npb24sIGJvb2xlYW5dO1xuICBleHBvcnQgdHlwZSBDb21tZW50ICAgICAgID0gW09wY29kZXMuQ29tbWVudCwgc3RyXTtcbiAgZXhwb3J0IHR5cGUgTW9kaWZpZXIgICAgICA9IFtPcGNvZGVzLk1vZGlmaWVyLCBzdHIsIFBhcmFtcywgSGFzaF07XG4gIGV4cG9ydCB0eXBlIEJsb2NrICAgICAgICAgPSBbT3Bjb2Rlcy5CbG9jaywgc3RyLCBQYXJhbXMsIEhhc2gsIE9wdGlvbjxTZXJpYWxpemVkSW5saW5lQmxvY2s+LCBPcHRpb248U2VyaWFsaXplZElubGluZUJsb2NrPl07XG4gIGV4cG9ydCB0eXBlIENvbXBvbmVudCAgICAgPSBbT3Bjb2Rlcy5Db21wb25lbnQsIHN0ciwgQXR0cmlidXRlW10sIEhhc2gsIE9wdGlvbjxTZXJpYWxpemVkSW5saW5lQmxvY2s+XTtcbiAgZXhwb3J0IHR5cGUgT3BlbkVsZW1lbnQgICA9IFtPcGNvZGVzLk9wZW5FbGVtZW50LCBzdHJdO1xuICBleHBvcnQgdHlwZSBTcGxhdEVsZW1lbnQgID0gW09wY29kZXMuT3BlblNwbGF0dGVkRWxlbWVudCwgc3RyXTtcbiAgZXhwb3J0IHR5cGUgRmx1c2hFbGVtZW50ICA9IFtPcGNvZGVzLkZsdXNoRWxlbWVudF07XG4gIGV4cG9ydCB0eXBlIENsb3NlRWxlbWVudCAgPSBbT3Bjb2Rlcy5DbG9zZUVsZW1lbnRdO1xuICBleHBvcnQgdHlwZSBTdGF0aWNBdHRyICAgID0gW09wY29kZXMuU3RhdGljQXR0ciwgc3RyLCBFeHByZXNzaW9uLCBPcHRpb248c3RyPl07XG4gIGV4cG9ydCB0eXBlIER5bmFtaWNBdHRyICAgPSBbT3Bjb2Rlcy5EeW5hbWljQXR0ciwgc3RyLCBFeHByZXNzaW9uLCBPcHRpb248c3RyPl07XG4gIGV4cG9ydCB0eXBlIEF0dHJTcGxhdCAgICAgPSBbT3Bjb2Rlcy5BdHRyU3BsYXQsIFlpZWxkVG9dO1xuICBleHBvcnQgdHlwZSBZaWVsZCAgICAgICAgID0gW09wY29kZXMuWWllbGQsIFlpZWxkVG8sIE9wdGlvbjxQYXJhbXM+XTtcbiAgZXhwb3J0IHR5cGUgUGFydGlhbCAgICAgICA9IFtPcGNvZGVzLlBhcnRpYWwsIEV4cHJlc3Npb24sIENvcmUuRXZhbEluZm9dO1xuICBleHBvcnQgdHlwZSBEeW5hbWljQXJnICAgID0gW09wY29kZXMuRHluYW1pY0FyZywgc3RyLCBFeHByZXNzaW9uXTtcbiAgZXhwb3J0IHR5cGUgU3RhdGljQXJnICAgICA9IFtPcGNvZGVzLlN0YXRpY0FyZywgc3RyLCBFeHByZXNzaW9uXTtcbiAgZXhwb3J0IHR5cGUgVHJ1c3RpbmdBdHRyICA9IFtPcGNvZGVzLlRydXN0aW5nQXR0ciwgc3RyLCBFeHByZXNzaW9uLCBzdHJdO1xuICBleHBvcnQgdHlwZSBEZWJ1Z2dlciAgICAgID0gW09wY29kZXMuRGVidWdnZXIsIENvcmUuRXZhbEluZm9dO1xuICBleHBvcnQgdHlwZSBDbGllbnRTaWRlICAgID0gW09wY29kZXMuQ2xpZW50U2lkZVN0YXRlbWVudCwgYW55XTtcblxuICBleHBvcnQgdHlwZSBTdGF0ZW1lbnQgPVxuICAgICAgVGV4dFxuICAgIHwgQXBwZW5kXG4gICAgfCBDb21tZW50XG4gICAgfCBNb2RpZmllclxuICAgIHwgQmxvY2tcbiAgICB8IENvbXBvbmVudFxuICAgIHwgT3BlbkVsZW1lbnRcbiAgICB8IFNwbGF0RWxlbWVudFxuICAgIHwgRmx1c2hFbGVtZW50XG4gICAgfCBDbG9zZUVsZW1lbnRcbiAgICB8IFN0YXRpY0F0dHJcbiAgICB8IER5bmFtaWNBdHRyXG4gICAgfCBBdHRyU3BsYXRcbiAgICB8IFlpZWxkXG4gICAgfCBQYXJ0aWFsXG4gICAgfCBTdGF0aWNBcmdcbiAgICB8IER5bmFtaWNBcmdcbiAgICB8IFRydXN0aW5nQXR0clxuICAgIHwgRGVidWdnZXJcbiAgICB8IENsaWVudFNpZGVcbiAgICA7XG5cbiAgZXhwb3J0IHR5cGUgQXR0cmlidXRlID1cbiAgICAgIFN0YXRlbWVudHMuU3RhdGljQXR0clxuICAgIHwgU3RhdGVtZW50cy5EeW5hbWljQXR0clxuICAgIHwgU3RhdGVtZW50cy5BdHRyU3BsYXRcbiAgICA7XG5cbiAgZXhwb3J0IHR5cGUgQXJndW1lbnQgPVxuICAgICAgU3RhdGVtZW50cy5TdGF0aWNBcmdcbiAgICB8IFN0YXRlbWVudHMuRHluYW1pY0FyZ1xuICAgIDtcblxuICBleHBvcnQgdHlwZSBQYXJhbWV0ZXIgPSBBdHRyaWJ1dGUgfCBBcmd1bWVudDtcbn1cblxuZXhwb3J0IHR5cGUgU3RhdGVtZW50ID0gU3RhdGVtZW50cy5TdGF0ZW1lbnQ7XG5cbi8qKlxuICogQSBKU09OIG9iamVjdCBvZiBzdGF0aWMgY29tcGlsZSB0aW1lIG1ldGEgZm9yIHRoZSB0ZW1wbGF0ZS5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBUZW1wbGF0ZU1ldGEge1xuICBba2V5OiBzdHJpbmddOiBPcGFxdWU7XG4gIG1vZHVsZU5hbWU/OiBzdHJpbmc7XG59XG5cbi8qKlxuICogQSBKU09OIG9iamVjdCB0aGF0IHRoZSBCbG9jayB3YXMgc2VyaWFsaXplZCBpbnRvLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIFNlcmlhbGl6ZWRCbG9jayB7XG4gIHN0YXRlbWVudHM6IFN0YXRlbWVudHMuU3RhdGVtZW50W107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VyaWFsaXplZElubGluZUJsb2NrIGV4dGVuZHMgU2VyaWFsaXplZEJsb2NrIHtcbiAgcGFyYW1ldGVyczogbnVtYmVyW107XG59XG5cbi8qKlxuICogQSBKU09OIG9iamVjdCB0aGF0IHRoZSBjb21waWxlZCBUZW1wbGF0ZUJsb2NrIHdhcyBzZXJpYWxpemVkIGludG8uXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgU2VyaWFsaXplZFRlbXBsYXRlQmxvY2sgZXh0ZW5kcyBTZXJpYWxpemVkQmxvY2sge1xuICBzeW1ib2xzOiBzdHJpbmdbXTtcbiAgaGFzRXZhbDogYm9vbGVhbjtcbn1cblxuLyoqXG4gKiBBIEpTT04gb2JqZWN0IHRoYXQgdGhlIGNvbXBpbGVkIFRlbXBsYXRlIHdhcyBzZXJpYWxpemVkIGludG8uXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgU2VyaWFsaXplZFRlbXBsYXRlPFQgZXh0ZW5kcyBUZW1wbGF0ZU1ldGE+IHtcbiAgYmxvY2s6IFNlcmlhbGl6ZWRUZW1wbGF0ZUJsb2NrO1xuICBtZXRhOiBUO1xufVxuXG4vKipcbiAqIEEgc3RyaW5nIG9mIEpTT04gY29udGFpbmluZyBhIFNlcmlhbGl6ZWRUZW1wbGF0ZUJsb2NrXG4gKi9cbmV4cG9ydCB0eXBlIFNlcmlhbGl6ZWRUZW1wbGF0ZUJsb2NrSlNPTiA9IHN0cmluZztcblxuLyoqXG4gKiBBIEpTT04gb2JqZWN0IGNvbnRhaW5pbmcgdGhlIFNlcmlhbGl6ZWRUZW1wbGF0ZUJsb2NrIGFzIEpTT04gYW5kIFRlbXBsYXRlTWV0YS5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBTZXJpYWxpemVkVGVtcGxhdGVXaXRoTGF6eUJsb2NrPFNwZWNpZmllcj4ge1xuICBpZD86IE9wdGlvbjxzdHJpbmc+O1xuICBibG9jazogU2VyaWFsaXplZFRlbXBsYXRlQmxvY2tKU09OO1xuICBtZXRhOiBTcGVjaWZpZXI7XG59XG5cbi8qKlxuICogQSBzdHJpbmcgb2YgSmF2YXNjcmlwdCBjb250YWluaW5nIGEgU2VyaWFsaXplZFRlbXBsYXRlV2l0aExhenlCbG9jayB0byBiZVxuICogY29uY2F0ZW5hdGVkIGludG8gYSBKYXZhc2NyaXB0IG1vZHVsZS5cbiAqL1xuZXhwb3J0IHR5cGUgVGVtcGxhdGVKYXZhc2NyaXB0ID0gc3RyaW5nO1xuXG4vLyBTdGF0ZW1lbnRzXG5leHBvcnQgY29uc3QgaXNNb2RpZmllciAgICAgICA9IGlzPFN0YXRlbWVudHMuTW9kaWZpZXI+KE9wY29kZXMuTW9kaWZpZXIpO1xuZXhwb3J0IGNvbnN0IGlzRmx1c2hFbGVtZW50ICAgPSBpczxTdGF0ZW1lbnRzLkZsdXNoRWxlbWVudD4oT3Bjb2Rlcy5GbHVzaEVsZW1lbnQpO1xuXG5leHBvcnQgZnVuY3Rpb24gaXNBdHRyaWJ1dGUodmFsOiBTdGF0ZW1lbnQpOiB2YWwgaXMgU3RhdGVtZW50cy5BdHRyaWJ1dGUge1xuICByZXR1cm4gdmFsWzBdID09PSBPcGNvZGVzLlN0YXRpY0F0dHIgfHwgdmFsWzBdID09PSBPcGNvZGVzLkR5bmFtaWNBdHRyIHx8IHZhbFswXSA9PT0gT3Bjb2Rlcy5UcnVzdGluZ0F0dHI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0FyZ3VtZW50KHZhbDogU3RhdGVtZW50KTogdmFsIGlzIFN0YXRlbWVudHMuQXJndW1lbnQge1xuICByZXR1cm4gdmFsWzBdID09PSBPcGNvZGVzLlN0YXRpY0FyZyB8fCB2YWxbMF0gPT09IE9wY29kZXMuRHluYW1pY0FyZztcbn1cblxuLy8gRXhwcmVzc2lvbnNcbmV4cG9ydCBjb25zdCBpc0dldCAgICAgICAgICAgID0gaXM8RXhwcmVzc2lvbnMuR2V0PihPcGNvZGVzLkdldCk7XG5leHBvcnQgY29uc3QgaXNNYXliZUxvY2FsICAgICA9IGlzPEV4cHJlc3Npb25zLk1heWJlTG9jYWw+KE9wY29kZXMuTWF5YmVMb2NhbCk7XG4iXX0=","export var Ops;\n(function (Ops) {\n    Ops[Ops[\"OpenComponentElement\"] = 0] = \"OpenComponentElement\";\n    Ops[Ops[\"DidCreateElement\"] = 1] = \"DidCreateElement\";\n    Ops[Ops[\"SetComponentAttrs\"] = 2] = \"SetComponentAttrs\";\n    Ops[Ops[\"DidRenderLayout\"] = 3] = \"DidRenderLayout\";\n    Ops[Ops[\"Debugger\"] = 4] = \"Debugger\";\n})(Ops || (Ops = {}));\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2xpZW50LXNpZGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci9vcGNvZGUtY29tcGlsZXIvbGliL2NsaWVudC1zaWRlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLEFBQU0sT0FBTixJQUFZLEFBTVg7QUFORCxXQUFZLEFBQUc7QUFDYiwyQ0FBb0I7QUFDcEIsdUNBQWdCO0FBQ2hCLHdDQUFpQjtBQUNqQixzQ0FBZTtBQUNmLCtCQUFRLEFBQ1Y7QUFBQyxHQU5XLEFBQUcsUUFBSCxBQUFHLE1BTWQiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBPcHMgYXMgV2lyZUZvcm1hdE9wcyB9IGZyb20gJ0BnbGltbWVyL3dpcmUtZm9ybWF0JztcblxuZXhwb3J0IGVudW0gT3BzIHtcbiAgT3BlbkNvbXBvbmVudEVsZW1lbnQsXG4gIERpZENyZWF0ZUVsZW1lbnQsXG4gIFNldENvbXBvbmVudEF0dHJzLFxuICBEaWRSZW5kZXJMYXlvdXQsXG4gIERlYnVnZ2VyXG59XG5cbmltcG9ydCBDbGllbnRTaWRlU3RhdGVtZW50ID0gV2lyZUZvcm1hdE9wcy5DbGllbnRTaWRlU3RhdGVtZW50O1xuXG5leHBvcnQgdHlwZSBPcGVuQ29tcG9uZW50RWxlbWVudCAgPSBbQ2xpZW50U2lkZVN0YXRlbWVudCwgT3BzLk9wZW5Db21wb25lbnRFbGVtZW50LCBzdHJpbmddO1xuZXhwb3J0IHR5cGUgRGlkQ3JlYXRlRWxlbWVudCAgICAgID0gW0NsaWVudFNpZGVTdGF0ZW1lbnQsIE9wcy5EaWRDcmVhdGVFbGVtZW50XTtcbmV4cG9ydCB0eXBlIFNldENvbXBvbmVudEF0dHJzICAgICA9IFtDbGllbnRTaWRlU3RhdGVtZW50LCBPcHMuU2V0Q29tcG9uZW50QXR0cnMsIGJvb2xlYW5dO1xuZXhwb3J0IHR5cGUgRGlkUmVuZGVyTGF5b3V0ICAgICAgID0gW0NsaWVudFNpZGVTdGF0ZW1lbnQsIE9wcy5EaWRSZW5kZXJMYXlvdXRdO1xuXG5leHBvcnQgdHlwZSBDbGllbnRTaWRlU3RhdGVtZW50ID1cbiAgICBPcGVuQ29tcG9uZW50RWxlbWVudFxuICB8IERpZENyZWF0ZUVsZW1lbnRcbiAgfCBTZXRDb21wb25lbnRBdHRyc1xuICB8IERpZFJlbmRlckxheW91dFxuICA7XG4iXX0=","import { assert, dict, EMPTY_ARRAY } from '@glimmer/util';\nimport { Register } from '@glimmer/vm';\nimport * as WireFormat from '@glimmer/wire-format';\nimport * as ClientSide from './client-side';\nvar Ops = WireFormat.Ops;\nexport const ATTRS_BLOCK = '&attrs';\nexport class Compilers {\n    constructor(offset = 0) {\n        this.offset = offset;\n        this.names = dict();\n        this.funcs = [];\n    }\n    add(name, func) {\n        this.funcs.push(func);\n        this.names[name] = this.funcs.length - 1;\n    }\n    compile(sexp, builder) {\n        let name = sexp[this.offset];\n        let index = this.names[name];\n        let func = this.funcs[index];\n        (false && assert(!!func, `expected an implementation for ${this.offset === 0 ? Ops[sexp[0]] : ClientSide.Ops[sexp[1]]}`));\n\n        func(sexp, builder);\n    }\n}\nlet _statementCompiler;\nexport function statementCompiler() {\n    if (_statementCompiler) {\n        return _statementCompiler;\n    }\n    const STATEMENTS = _statementCompiler = new Compilers();\n    STATEMENTS.add(Ops.Text, (sexp, builder) => {\n        builder.text(sexp[1]);\n    });\n    STATEMENTS.add(Ops.Comment, (sexp, builder) => {\n        builder.comment(sexp[1]);\n    });\n    STATEMENTS.add(Ops.CloseElement, (_sexp, builder) => {\n        builder.closeElement();\n    });\n    STATEMENTS.add(Ops.FlushElement, (_sexp, builder) => {\n        builder.flushElement();\n    });\n    STATEMENTS.add(Ops.Modifier, (sexp, builder) => {\n        let { lookup, referrer } = builder;\n        let [, name, params, hash] = sexp;\n        let specifier = lookup.lookupModifier(name, referrer);\n        if (specifier) {\n            builder.modifier(specifier, params, hash);\n        } else {\n            throw new Error(`Compile Error ${name} is not a modifier: Helpers may not be used in the element form.`);\n        }\n    });\n    STATEMENTS.add(Ops.StaticAttr, (sexp, builder) => {\n        let [, name, value, namespace] = sexp;\n        builder.staticAttr(name, namespace, value);\n    });\n    STATEMENTS.add(Ops.DynamicAttr, (sexp, builder) => {\n        dynamicAttr(sexp, false, builder);\n    });\n    STATEMENTS.add(Ops.TrustingAttr, (sexp, builder) => {\n        dynamicAttr(sexp, true, builder);\n    });\n    STATEMENTS.add(Ops.OpenElement, (sexp, builder) => {\n        builder.openPrimitiveElement(sexp[1]);\n    });\n    STATEMENTS.add(Ops.OpenSplattedElement, (sexp, builder) => {\n        builder.setComponentAttrs(true);\n        builder.putComponentOperations();\n        builder.openElementWithOperations(sexp[1]);\n    });\n    STATEMENTS.add(Ops.Component, (sexp, builder) => {\n        let [, tag, _attrs, args, block] = sexp;\n        let { lookup, referrer } = builder;\n        let handle = lookup.lookupComponentSpec(tag, referrer);\n        if (handle !== null) {\n            let capabilities = lookup.getCapabilities(handle);\n            let attrs = [[Ops.ClientSideStatement, ClientSide.Ops.SetComponentAttrs, true], ..._attrs, [Ops.ClientSideStatement, ClientSide.Ops.SetComponentAttrs, false]];\n            let attrsBlock = builder.inlineBlock({ statements: attrs, parameters: EMPTY_ARRAY });\n            let child = builder.template(block);\n            if (capabilities.dynamicLayout === false) {\n                let layout = lookup.getLayout(handle);\n                builder.pushComponentDefinition(handle);\n                builder.invokeStaticComponent(capabilities, layout, attrsBlock, null, args, false, child && child);\n            } else {\n                builder.pushComponentDefinition(handle);\n                builder.invokeComponent(attrsBlock, null, args, false, child && child);\n            }\n        } else {\n            throw new Error(`Compile Error: Cannot find component ${tag}`);\n        }\n    });\n    STATEMENTS.add(Ops.Partial, (sexp, builder) => {\n        let [, name, evalInfo] = sexp;\n        let { referrer } = builder;\n        builder.startLabels();\n        builder.pushFrame();\n        builder.returnTo('END');\n        builder.expr(name);\n        builder.dup();\n        builder.enter(2);\n        builder.jumpUnless('ELSE');\n        builder.invokePartial(referrer, builder.evalSymbols(), evalInfo);\n        builder.popScope();\n        builder.popFrame();\n        builder.label('ELSE');\n        builder.exit();\n        builder.return();\n        builder.label('END');\n        builder.popFrame();\n        builder.stopLabels();\n    });\n    STATEMENTS.add(Ops.Yield, (sexp, builder) => {\n        let [, to, params] = sexp;\n        builder.yield(to, params);\n    });\n    STATEMENTS.add(Ops.AttrSplat, (sexp, builder) => {\n        let [, to] = sexp;\n        builder.yield(to, []);\n        builder.didCreateElement(Register.s0);\n        builder.setComponentAttrs(false);\n    });\n    STATEMENTS.add(Ops.Debugger, (sexp, builder) => {\n        let [, evalInfo] = sexp;\n        builder.debugger(builder.evalSymbols(), evalInfo);\n    });\n    STATEMENTS.add(Ops.ClientSideStatement, (sexp, builder) => {\n        CLIENT_SIDE.compile(sexp, builder);\n    });\n    STATEMENTS.add(Ops.Append, (sexp, builder) => {\n        let [, value, trusting] = sexp;\n        let { inlines } = builder.macros;\n        let returned = inlines.compile(sexp, builder) || value;\n        if (returned === true) return;\n        let isGet = WireFormat.isGet(value);\n        let isMaybeLocal = WireFormat.isMaybeLocal(value);\n        if (trusting) {\n            builder.guardedAppend(value, true);\n        } else {\n            if (isGet || isMaybeLocal) {\n                builder.guardedAppend(value, false);\n            } else {\n                builder.expr(value);\n                builder.dynamicContent(false);\n            }\n        }\n    });\n    STATEMENTS.add(Ops.Block, (sexp, builder) => {\n        let [, name, params, hash, _template, _inverse] = sexp;\n        let template = builder.template(_template);\n        let inverse = builder.template(_inverse);\n        let templateBlock = template && template;\n        let inverseBlock = inverse && inverse;\n        let { blocks } = builder.macros;\n        blocks.compile(name, params, hash, templateBlock, inverseBlock, builder);\n    });\n    const CLIENT_SIDE = new Compilers(1);\n    CLIENT_SIDE.add(ClientSide.Ops.OpenComponentElement, (sexp, builder) => {\n        builder.putComponentOperations();\n        builder.openElementWithOperations(sexp[2]);\n    });\n    CLIENT_SIDE.add(ClientSide.Ops.DidCreateElement, (_sexp, builder) => {\n        builder.didCreateElement(Register.s0);\n    });\n    CLIENT_SIDE.add(ClientSide.Ops.SetComponentAttrs, (sexp, builder) => {\n        builder.setComponentAttrs(sexp[2]);\n    });\n    CLIENT_SIDE.add(ClientSide.Ops.Debugger, () => {\n        // tslint:disable-next-line:no-debugger\n        debugger;\n    });\n    CLIENT_SIDE.add(ClientSide.Ops.DidRenderLayout, (_sexp, builder) => {\n        builder.didRenderLayout(Register.s0);\n    });\n    return STATEMENTS;\n}\nfunction dynamicAttr(sexp, trusting, builder) {\n    let [, name, value, namespace] = sexp;\n    builder.expr(value);\n    if (namespace) {\n        builder.dynamicAttr(name, namespace, trusting);\n    } else {\n        builder.dynamicAttr(name, null, trusting);\n    }\n}\nlet _expressionCompiler;\nexport function expressionCompiler() {\n    if (_expressionCompiler) {\n        return _expressionCompiler;\n    }\n    const EXPRESSIONS = _expressionCompiler = new Compilers();\n    EXPRESSIONS.add(Ops.Unknown, (sexp, builder) => {\n        let { lookup, asPartial, referrer } = builder;\n        let name = sexp[1];\n        let specifier = lookup.lookupHelper(name, referrer);\n        if (specifier !== null) {\n            builder.helper(specifier, null, null);\n        } else if (asPartial) {\n            builder.resolveMaybeLocal(name);\n        } else {\n            builder.getVariable(0);\n            builder.getProperty(name);\n        }\n    });\n    EXPRESSIONS.add(Ops.Concat, (sexp, builder) => {\n        let parts = sexp[1];\n        for (let i = 0; i < parts.length; i++) {\n            builder.expr(parts[i]);\n        }\n        builder.concat(parts.length);\n    });\n    EXPRESSIONS.add(Ops.Helper, (sexp, builder) => {\n        let { lookup, referrer } = builder;\n        let [, name, params, hash] = sexp;\n        // TODO: triage this in the WF compiler\n        if (name === 'component') {\n            (false && assert(params.length, 'SYNTAX ERROR: component helper requires at least one argument'));\n\n            let [definition, ...restArgs] = params;\n            builder.curryComponent(definition, restArgs, hash, true);\n            return;\n        }\n        let specifier = lookup.lookupHelper(name, referrer);\n        if (specifier !== null) {\n            builder.helper(specifier, params, hash);\n        } else {\n            throw new Error(`Compile Error: ${name} is not a helper`);\n        }\n    });\n    EXPRESSIONS.add(Ops.Get, (sexp, builder) => {\n        let [, head, path] = sexp;\n        builder.getVariable(head);\n        for (let i = 0; i < path.length; i++) {\n            builder.getProperty(path[i]);\n        }\n    });\n    EXPRESSIONS.add(Ops.MaybeLocal, (sexp, builder) => {\n        let [, path] = sexp;\n        if (builder.asPartial) {\n            let head = path[0];\n            path = path.slice(1);\n            builder.resolveMaybeLocal(head);\n        } else {\n            builder.getVariable(0);\n        }\n        for (let i = 0; i < path.length; i++) {\n            builder.getProperty(path[i]);\n        }\n    });\n    EXPRESSIONS.add(Ops.Undefined, (_sexp, builder) => {\n        return builder.pushPrimitiveReference(undefined);\n    });\n    EXPRESSIONS.add(Ops.HasBlock, (sexp, builder) => {\n        builder.hasBlock(sexp[1]);\n    });\n    EXPRESSIONS.add(Ops.HasBlockParams, (sexp, builder) => {\n        builder.hasBlockParams(sexp[1]);\n    });\n    return EXPRESSIONS;\n}\nexport class Macros {\n    constructor() {\n        let { blocks, inlines } = populateBuiltins();\n        this.blocks = blocks;\n        this.inlines = inlines;\n    }\n}\nexport class Blocks {\n    constructor() {\n        this.names = dict();\n        this.funcs = [];\n    }\n    add(name, func) {\n        this.funcs.push(func);\n        this.names[name] = this.funcs.length - 1;\n    }\n    addMissing(func) {\n        this.missing = func;\n    }\n    compile(name, params, hash, template, inverse, builder) {\n        let index = this.names[name];\n        if (index === undefined) {\n            (false && assert(!!this.missing, `${name} not found, and no catch-all block handler was registered`));\n\n            let func = this.missing;\n            let handled = func(name, params, hash, template, inverse, builder);\n            (false && assert(!!handled, `${name} not found, and the catch-all block handler didn't handle it`));\n        } else {\n            let func = this.funcs[index];\n            func(params, hash, template, inverse, builder);\n        }\n    }\n}\nexport class Inlines {\n    constructor() {\n        this.names = dict();\n        this.funcs = [];\n    }\n    add(name, func) {\n        this.funcs.push(func);\n        this.names[name] = this.funcs.length - 1;\n    }\n    addMissing(func) {\n        this.missing = func;\n    }\n    compile(sexp, builder) {\n        let value = sexp[1];\n        // TODO: Fix this so that expression macros can return\n        // things like components, so that {{component foo}}\n        // is the same as {{(component foo)}}\n        if (!Array.isArray(value)) return ['expr', value];\n        let name;\n        let params;\n        let hash;\n        if (value[0] === Ops.Helper) {\n            name = value[1];\n            params = value[2];\n            hash = value[3];\n        } else if (value[0] === Ops.Unknown) {\n            name = value[1];\n            params = hash = null;\n        } else {\n            return ['expr', value];\n        }\n        let index = this.names[name];\n        if (index === undefined && this.missing) {\n            let func = this.missing;\n            let returned = func(name, params, hash, builder);\n            return returned === false ? ['expr', value] : returned;\n        } else if (index !== undefined) {\n            let func = this.funcs[index];\n            let returned = func(name, params, hash, builder);\n            return returned === false ? ['expr', value] : returned;\n        } else {\n            return ['expr', value];\n        }\n    }\n}\nexport function populateBuiltins(blocks = new Blocks(), inlines = new Inlines()) {\n    blocks.add('if', (params, _hash, template, inverse, builder) => {\n        //        PutArgs\n        //        Test(Environment)\n        //        Enter(BEGIN, END)\n        // BEGIN: Noop\n        //        JumpUnless(ELSE)\n        //        Evaluate(default)\n        //        Jump(END)\n        // ELSE:  Noop\n        //        Evalulate(inverse)\n        // END:   Noop\n        //        Exit\n        if (!params || params.length !== 1) {\n            throw new Error(`SYNTAX ERROR: #if requires a single argument`);\n        }\n        builder.startLabels();\n        builder.pushFrame();\n        builder.returnTo('END');\n        builder.expr(params[0]);\n        builder.toBoolean();\n        builder.enter(1);\n        builder.jumpUnless('ELSE');\n        builder.invokeStaticBlock(template);\n        if (inverse) {\n            builder.jump('EXIT');\n            builder.label('ELSE');\n            builder.invokeStaticBlock(inverse);\n            builder.label('EXIT');\n            builder.exit();\n            builder.return();\n        } else {\n            builder.label('ELSE');\n            builder.exit();\n            builder.return();\n        }\n        builder.label('END');\n        builder.popFrame();\n        builder.stopLabels();\n    });\n    blocks.add('unless', (params, _hash, template, inverse, builder) => {\n        //        PutArgs\n        //        Test(Environment)\n        //        Enter(BEGIN, END)\n        // BEGIN: Noop\n        //        JumpUnless(ELSE)\n        //        Evaluate(default)\n        //        Jump(END)\n        // ELSE:  Noop\n        //        Evalulate(inverse)\n        // END:   Noop\n        //        Exit\n        if (!params || params.length !== 1) {\n            throw new Error(`SYNTAX ERROR: #unless requires a single argument`);\n        }\n        builder.startLabels();\n        builder.pushFrame();\n        builder.returnTo('END');\n        builder.expr(params[0]);\n        builder.toBoolean();\n        builder.enter(1);\n        builder.jumpIf('ELSE');\n        builder.invokeStaticBlock(template);\n        if (inverse) {\n            builder.jump('EXIT');\n            builder.label('ELSE');\n            builder.invokeStaticBlock(inverse);\n            builder.label('EXIT');\n            builder.exit();\n            builder.return();\n        } else {\n            builder.label('ELSE');\n            builder.exit();\n            builder.return();\n        }\n        builder.label('END');\n        builder.popFrame();\n        builder.stopLabels();\n    });\n    blocks.add('with', (params, _hash, template, inverse, builder) => {\n        //        PutArgs\n        //        Test(Environment)\n        //        Enter(BEGIN, END)\n        // BEGIN: Noop\n        //        JumpUnless(ELSE)\n        //        Evaluate(default)\n        //        Jump(END)\n        // ELSE:  Noop\n        //        Evalulate(inverse)\n        // END:   Noop\n        //        Exit\n        if (!params || params.length !== 1) {\n            throw new Error(`SYNTAX ERROR: #with requires a single argument`);\n        }\n        builder.startLabels();\n        builder.pushFrame();\n        builder.returnTo('END');\n        builder.expr(params[0]);\n        builder.dup();\n        builder.toBoolean();\n        builder.enter(2);\n        builder.jumpUnless('ELSE');\n        builder.invokeStaticBlock(template, 1);\n        if (inverse) {\n            builder.jump('EXIT');\n            builder.label('ELSE');\n            builder.invokeStaticBlock(inverse);\n            builder.label('EXIT');\n            builder.exit();\n            builder.return();\n        } else {\n            builder.label('ELSE');\n            builder.exit();\n            builder.return();\n        }\n        builder.label('END');\n        builder.popFrame();\n        builder.stopLabels();\n    });\n    blocks.add('each', (params, hash, template, inverse, builder) => {\n        //         Enter(BEGIN, END)\n        // BEGIN:  Noop\n        //         PutArgs\n        //         PutIterable\n        //         JumpUnless(ELSE)\n        //         EnterList(BEGIN2, END2)\n        // ITER:   Noop\n        //         NextIter(BREAK)\n        // BEGIN2: Noop\n        //         PushChildScope\n        //         Evaluate(default)\n        //         PopScope\n        // END2:   Noop\n        //         Exit\n        //         Jump(ITER)\n        // BREAK:  Noop\n        //         ExitList\n        //         Jump(END)\n        // ELSE:   Noop\n        //         Evalulate(inverse)\n        // END:    Noop\n        //         Exit\n        builder.startLabels();\n        builder.pushFrame();\n        builder.returnTo('END');\n        if (hash && hash[0][0] === 'key') {\n            builder.expr(hash[1][0]);\n        } else {\n            builder.pushPrimitiveReference(null);\n        }\n        builder.expr(params[0]);\n        builder.enter(2);\n        builder.putIterator();\n        builder.jumpUnless('ELSE');\n        builder.pushFrame();\n        builder.returnTo('ITER');\n        builder.dup(Register.fp, 1);\n        builder.enterList('BODY');\n        builder.label('ITER');\n        builder.iterate('BREAK');\n        builder.label('BODY');\n        builder.invokeStaticBlock(template, 2);\n        builder.pop(2);\n        builder.exit();\n        builder.return();\n        builder.label('BREAK');\n        builder.exitList();\n        builder.popFrame();\n        if (inverse) {\n            builder.jump('EXIT');\n            builder.label('ELSE');\n            builder.invokeStaticBlock(inverse);\n            builder.label('EXIT');\n            builder.exit();\n            builder.return();\n        } else {\n            builder.label('ELSE');\n            builder.exit();\n            builder.return();\n        }\n        builder.label('END');\n        builder.popFrame();\n        builder.stopLabels();\n    });\n    blocks.add('in-element', (params, hash, template, _inverse, builder) => {\n        if (!params || params.length !== 1) {\n            throw new Error(`SYNTAX ERROR: #in-element requires a single argument`);\n        }\n        builder.startLabels();\n        builder.pushFrame();\n        builder.returnTo('END');\n        let [keys, values] = hash;\n        for (let i = 0; i < keys.length; i++) {\n            let key = keys[i];\n            if (key === 'nextSibling' || key === 'guid') {\n                builder.expr(values[i]);\n            } else {\n                throw new Error(`SYNTAX ERROR: #in-element does not take a \\`${keys[0]}\\` option`);\n            }\n        }\n        builder.expr(params[0]);\n        builder.dup();\n        builder.enter(4);\n        builder.jumpUnless('ELSE');\n        builder.pushRemoteElement();\n        builder.invokeStaticBlock(template);\n        builder.popRemoteElement();\n        builder.label('ELSE');\n        builder.exit();\n        builder.return();\n        builder.label('END');\n        builder.popFrame();\n        builder.stopLabels();\n    });\n    blocks.add('-with-dynamic-vars', (_params, hash, template, _inverse, builder) => {\n        if (hash) {\n            let [names, expressions] = hash;\n            builder.compileParams(expressions);\n            builder.pushDynamicScope();\n            builder.bindDynamicScope(names);\n            builder.invokeStaticBlock(template);\n            builder.popDynamicScope();\n        } else {\n            builder.invokeStaticBlock(template);\n        }\n    });\n    blocks.add('component', (_params, hash, template, inverse, builder) => {\n        (false && assert(_params && _params.length, 'SYNTAX ERROR: #component requires at least one argument'));\n\n        let [definition, ...params] = _params;\n        builder.dynamicComponent(definition, params, hash, true, template, inverse);\n    });\n    inlines.add('component', (_name, _params, hash, builder) => {\n        (false && assert(_params && _params.length, 'SYNTAX ERROR: component helper requires at least one argument'));\n\n        let [definition, ...params] = _params;\n        builder.dynamicComponent(definition, params, hash, true, null, null);\n        return true;\n    });\n    return { blocks, inlines };\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3ludGF4LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcGFja2FnZXMvQGdsaW1tZXIvb3Bjb2RlLWNvbXBpbGVyL2xpYi9zeW50YXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsQUFBTyxTQUFFLEFBQU0sUUFBRSxBQUFJLEFBQUUsQUFBTSxNQUFFLEFBQVcsQUFBRSxtQkFBTSxBQUFlLEFBQUM7QUFDbEUsQUFBTyxTQUFFLEFBQVEsQUFBRSxnQkFBTSxBQUFhLEFBQUM7QUFDdkMsT0FBTyxLQUFLLEFBQVUsZ0JBQU0sQUFBc0IsQUFBQztBQUNuRCxPQUFPLEtBQUssQUFBVSxnQkFBTSxBQUFlLEFBQUM7QUFJNUMsSUFBTyxBQUFHLE1BQUcsQUFBVSxXQUFDLEFBQUcsQUFBQztBQVE1QixBQUFNLE9BQUMsTUFBTSxBQUFXLGNBQUcsQUFBUSxBQUFDO0FBRXBDLEFBQU07QUFJSixnQkFBb0IsU0FBUyxBQUFDO0FBQVYsYUFBTSxTQUFOLEFBQU0sQUFBSTtBQUh0QixhQUFLLFFBQUcsQUFBSSxBQUFVLEFBQUM7QUFDdkIsYUFBSyxRQUFrQyxBQUFFLEFBQUMsQUFFakI7QUFBQztBQUVsQyxBQUFHLFFBQVksQUFBWSxNQUFFLEFBQW9DO0FBQy9ELEFBQUksYUFBQyxBQUFLLE1BQUMsQUFBSSxLQUFDLEFBQUksQUFBQyxBQUFDO0FBQ3RCLEFBQUksYUFBQyxBQUFLLE1BQUMsQUFBSSxBQUFDLFFBQUcsQUFBSSxLQUFDLEFBQUssTUFBQyxBQUFNLFNBQUcsQUFBQyxBQUFDLEFBQzNDO0FBQUM7QUFFRCxBQUFPLFlBQVksQUFBTyxNQUFFLEFBQWlDO0FBQzNELFlBQUksQUFBSSxPQUFXLEFBQUksS0FBQyxBQUFJLEtBQUMsQUFBTSxBQUFDLEFBQUM7QUFDckMsWUFBSSxBQUFLLFFBQUcsQUFBSSxLQUFDLEFBQUssTUFBQyxBQUFJLEFBQUMsQUFBQztBQUM3QixZQUFJLEFBQUksT0FBRyxBQUFJLEtBQUMsQUFBSyxNQUFD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LEFBQU0sQUFBQyxVQUFHLEFBQVEsQUFBQztBQUN2QyxBQUFPLGdCQUFDLEFBQWdCLGlCQUFDLEFBQVUsWUFBRSxBQUFNLFFBQUUsQUFBSSxNQUFFLEFBQUksTUFBRSxBQUFRLFVBQUUsQUFBTyxBQUFDLEFBQUMsQUFDOUU7QUFBQyxBQUFDLEFBQUM7QUFFSCxBQUFPLFlBQUMsQUFBRyxJQUFDLEFBQVcsYUFBRSxDQUFDLEFBQUssT0FBRSxBQUFPLFNBQUUsQUFBSSxNQUFFLEFBQU87a0JBQ3JELEFBQU0sT0FBQyxBQUFPLFdBQUksQUFBTyxRQUFDLEFBQU0sUUFBRSxBQUErRCxBQUFDLEFBQUM7O0FBRW5HLFlBQUksQ0FBQyxBQUFVLFlBQUUsR0FBRyxBQUFNLEFBQUMsVUFBRyxBQUFRLEFBQUM7QUFDdkMsQUFBTyxnQkFBQyxBQUFnQixpQkFBQyxBQUFVLFlBQUUsQUFBTSxRQUFFLEFBQUksTUFBRSxBQUFJLE1BQUUsQUFBSSxNQUFFLEFBQUksQUFBQyxBQUFDO0FBRXJFLEFBQU0sZUFBQyxBQUFJLEFBQUMsQUFDZDtBQUFDLEFBQUMsQUFBQztBQUVILEFBQU0sV0FBQyxFQUFFLEFBQU0sUUFBRSxBQUFPLEFBQUUsQUFBQyxBQUM3QjtBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcGlsZVRpbWVQcm9ncmFtLCBPcHRpb24sIE9wYXF1ZSB9IGZyb20gJ0BnbGltbWVyL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgYXNzZXJ0LCBkaWN0LCB1bndyYXAsIEVNUFRZX0FSUkFZIH0gZnJvbSAnQGdsaW1tZXIvdXRpbCc7XG5pbXBvcnQgeyBSZWdpc3RlciB9IGZyb20gJ0BnbGltbWVyL3ZtJztcbmltcG9ydCAqIGFzIFdpcmVGb3JtYXQgZnJvbSAnQGdsaW1tZXIvd2lyZS1mb3JtYXQnO1xuaW1wb3J0ICogYXMgQ2xpZW50U2lkZSBmcm9tICcuL2NsaWVudC1zaWRlJztcbmltcG9ydCBPcGNvZGVCdWlsZGVyLCB7IENvbXBpbGVUaW1lTG9va3VwLCBPcGNvZGVCdWlsZGVyQ29uc3RydWN0b3IgfSBmcm9tIFwiLi9vcGNvZGUtYnVpbGRlclwiO1xuaW1wb3J0IHsgQ29tcGlsYWJsZUJsb2NrIH0gZnJvbSAnLi9pbnRlcmZhY2VzJztcblxuaW1wb3J0IE9wcyA9IFdpcmVGb3JtYXQuT3BzO1xuaW1wb3J0IFMgPSBXaXJlRm9ybWF0LlN0YXRlbWVudHM7XG5pbXBvcnQgRSA9IFdpcmVGb3JtYXQuRXhwcmVzc2lvbnM7XG5pbXBvcnQgQyA9IFdpcmVGb3JtYXQuQ29yZTtcblxuZXhwb3J0IHR5cGUgVHVwbGVTeW50YXggPSBXaXJlRm9ybWF0LlN0YXRlbWVudCB8IFdpcmVGb3JtYXQuVHVwbGVFeHByZXNzaW9uO1xuZXhwb3J0IHR5cGUgQ29tcGlsZXJGdW5jdGlvbjxUIGV4dGVuZHMgVHVwbGVTeW50YXgsIFNwZWNpZmllcj4gPSAoKHNleHA6IFQsIGJ1aWxkZXI6IE9wY29kZUJ1aWxkZXI8U3BlY2lmaWVyPikgPT4gdm9pZCk7XG5cbmV4cG9ydCBjb25zdCBBVFRSU19CTE9DSyA9ICcmYXR0cnMnO1xuXG5leHBvcnQgY2xhc3MgQ29tcGlsZXJzPFQgZXh0ZW5kcyBUdXBsZVN5bnRheD4ge1xuICBwcml2YXRlIG5hbWVzID0gZGljdDxudW1iZXI+KCk7XG4gIHByaXZhdGUgZnVuY3M6IENvbXBpbGVyRnVuY3Rpb248VCwgT3BhcXVlPltdID0gW107XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBvZmZzZXQgPSAwKSB7fVxuXG4gIGFkZDxTcGVjaWZpZXI+KG5hbWU6IG51bWJlciwgZnVuYzogQ29tcGlsZXJGdW5jdGlvbjxULCBTcGVjaWZpZXI+KTogdm9pZCB7XG4gICAgdGhpcy5mdW5jcy5wdXNoKGZ1bmMpO1xuICAgIHRoaXMubmFtZXNbbmFtZV0gPSB0aGlzLmZ1bmNzLmxlbmd0aCAtIDE7XG4gIH1cblxuICBjb21waWxlPFNwZWNpZmllcj4oc2V4cDogVCwgYnVpbGRlcjogT3Bjb2RlQnVpbGRlcjxTcGVjaWZpZXI+KTogdm9pZCB7XG4gICAgbGV0IG5hbWU6IG51bWJlciA9IHNleHBbdGhpcy5vZmZzZXRdO1xuICAgIGxldCBpbmRleCA9IHRoaXMubmFtZXNbbmFtZV07XG4gICAgbGV0IGZ1bmMgPSB0aGlzLmZ1bmNzW2luZGV4XTtcbiAgICBhc3NlcnQoISFmdW5jLCBgZXhwZWN0ZWQgYW4gaW1wbGVtZW50YXRpb24gZm9yICR7dGhpcy5vZmZzZXQgPT09IDAgPyBPcHNbc2V4cFswXV0gOiBDbGllbnRTaWRlLk9wc1tzZXhwWzFdXX1gKTtcbiAgICBmdW5jKHNleHAsIGJ1aWxkZXIpO1xuICB9XG59XG5cbmxldCBfc3RhdGVtZW50Q29tcGlsZXI6IENvbXBpbGVyczxXaXJlRm9ybWF0LlN0YXRlbWVudD47XG5cbmV4cG9ydCBmdW5jdGlvbiBzdGF0ZW1lbnRDb21waWxlcigpIHtcbiAgaWYgKF9zdGF0ZW1lbnRDb21waWxlcikge1xuICAgIHJldHVybiBfc3RhdGVtZW50Q29tcGlsZXI7XG4gIH1cblxuICBjb25zdCBTVEFURU1FTlRTID0gX3N0YXRlbWVudENvbXBpbGVyID0gbmV3IENvbXBpbGVyczxXaXJlRm9ybWF0LlN0YXRlbWVudD4oKTtcblxuICBTVEFURU1FTlRTLmFkZChPcHMuVGV4dCwgKHNleHA6IFMuVGV4dCwgYnVpbGRlcikgPT4ge1xuICAgIGJ1aWxkZXIudGV4dChzZXhwWzFdKTtcbiAgfSk7XG5cbiAgU1RBVEVNRU5UUy5hZGQoT3BzLkNvbW1lbnQsIChzZXhwOiBTLkNvbW1lbnQsIGJ1aWxkZXIpID0+IHtcbiAgICBidWlsZGVyLmNvbW1lbnQoc2V4cFsxXSk7XG4gIH0pO1xuXG4gIFNUQVRFTUVOVFMuYWRkKE9wcy5DbG9zZUVsZW1lbnQsIChfc2V4cDogUy5DbG9zZUVsZW1lbnQsIGJ1aWxkZXIpID0+IHtcbiAgICBidWlsZGVyLmNsb3NlRWxlbWVudCgpO1xuICB9KTtcblxuICBTVEFURU1FTlRTLmFkZChPcHMuRmx1c2hFbGVtZW50LCAoX3NleHA6IFMuRmx1c2hFbGVtZW50LCBidWlsZGVyKSA9PiB7XG4gICAgYnVpbGRlci5mbHVzaEVsZW1lbnQoKTtcbiAgfSk7XG5cbiAgU1RBVEVNRU5UUy5hZGQoT3BzLk1vZGlmaWVyLCAoc2V4cDogUy5Nb2RpZmllciwgYnVpbGRlcikgPT4ge1xuICAgIGxldCB7IGxvb2t1cCwgcmVmZXJyZXIgfSA9IGJ1aWxkZXI7XG4gICAgbGV0IFssIG5hbWUsIHBhcmFtcywgaGFzaF0gPSBzZXhwO1xuXG4gICAgbGV0IHNwZWNpZmllciA9IGxvb2t1cC5sb29rdXBNb2RpZmllcihuYW1lLCByZWZlcnJlcik7XG5cbiAgICBpZiAoc3BlY2lmaWVyKSB7XG4gICAgICBidWlsZGVyLm1vZGlmaWVyKHNwZWNpZmllciwgcGFyYW1zLCBoYXNoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBDb21waWxlIEVycm9yICR7bmFtZX0gaXMgbm90IGEgbW9kaWZpZXI6IEhlbHBlcnMgbWF5IG5vdCBiZSB1c2VkIGluIHRoZSBlbGVtZW50IGZvcm0uYCk7XG4gICAgfVxuICB9KTtcblxuICBTVEFURU1FTlRTLmFkZChPcHMuU3RhdGljQXR0ciwgKHNleHA6IFMuU3RhdGljQXR0ciwgYnVpbGRlcikgPT4ge1xuICAgIGxldCBbLCBuYW1lLCB2YWx1ZSwgbmFtZXNwYWNlXSA9IHNleHA7XG4gICAgYnVpbGRlci5zdGF0aWNBdHRyKG5hbWUsIG5hbWVzcGFjZSwgdmFsdWUgYXMgc3RyaW5nKTtcbiAgfSk7XG5cbiAgU1RBVEVNRU5UUy5hZGQoT3BzLkR5bmFtaWNBdHRyLCAoc2V4cDogUy5EeW5hbWljQXR0ciwgYnVpbGRlcikgPT4ge1xuICAgIGR5bmFtaWNBdHRyKHNleHAsIGZhbHNlLCBidWlsZGVyKTtcbiAgfSk7XG5cbiAgU1RBVEVNRU5UUy5hZGQoT3BzLlRydXN0aW5nQXR0ciwgKHNleHA6IFMuRHluYW1pY0F0dHIsIGJ1aWxkZXIpID0+IHtcbiAgICBkeW5hbWljQXR0cihzZXhwLCB0cnVlLCBidWlsZGVyKTtcbiAgfSk7XG5cbiAgU1RBVEVNRU5UUy5hZGQoT3BzLk9wZW5FbGVtZW50LCAoc2V4cDogUy5PcGVuRWxlbWVudCwgYnVpbGRlcikgPT4ge1xuICAgIGJ1aWxkZXIub3BlblByaW1pdGl2ZUVsZW1lbnQoc2V4cFsxXSk7XG4gIH0pO1xuXG4gIFNUQVRFTUVOVFMuYWRkKE9wcy5PcGVuU3BsYXR0ZWRFbGVtZW50LCAoc2V4cDogUy5TcGxhdEVsZW1lbnQsIGJ1aWxkZXIpID0+IHtcbiAgICBidWlsZGVyLnNldENvbXBvbmVudEF0dHJzKHRydWUpO1xuICAgIGJ1aWxkZXIucHV0Q29tcG9uZW50T3BlcmF0aW9ucygpO1xuICAgIGJ1aWxkZXIub3BlbkVsZW1lbnRXaXRoT3BlcmF0aW9ucyhzZXhwWzFdKTtcbiAgfSk7XG5cbiAgU1RBVEVNRU5UUy5hZGQoT3BzLkNvbXBvbmVudCwgKHNleHA6IFMuQ29tcG9uZW50LCBidWlsZGVyKSA9PiB7XG4gICAgbGV0IFssIHRhZywgX2F0dHJzLCBhcmdzLCBibG9ja10gPSBzZXhwO1xuXG4gICAgbGV0IHsgbG9va3VwLCByZWZlcnJlciB9ID0gYnVpbGRlcjtcbiAgICBsZXQgaGFuZGxlID0gbG9va3VwLmxvb2t1cENvbXBvbmVudFNwZWModGFnLCByZWZlcnJlcik7XG5cbiAgICBpZiAoaGFuZGxlICE9PSBudWxsKSB7XG4gICAgICBsZXQgY2FwYWJpbGl0aWVzID0gbG9va3VwLmdldENhcGFiaWxpdGllcyhoYW5kbGUpO1xuXG4gICAgICBsZXQgYXR0cnM6IFdpcmVGb3JtYXQuU3RhdGVtZW50W10gPSBbXG4gICAgICAgIFtPcHMuQ2xpZW50U2lkZVN0YXRlbWVudCwgQ2xpZW50U2lkZS5PcHMuU2V0Q29tcG9uZW50QXR0cnMsIHRydWVdLFxuICAgICAgICAuLi5fYXR0cnMsXG4gICAgICAgIFtPcHMuQ2xpZW50U2lkZVN0YXRlbWVudCwgQ2xpZW50U2lkZS5PcHMuU2V0Q29tcG9uZW50QXR0cnMsIGZhbHNlXVxuICAgICAgXTtcbiAgICAgIGxldCBhdHRyc0Jsb2NrID0gYnVpbGRlci5pbmxpbmVCbG9jayh7IHN0YXRlbWVudHM6IGF0dHJzLCBwYXJhbWV0ZXJzOiBFTVBUWV9BUlJBWSB9KTtcbiAgICAgIGxldCBjaGlsZCA9IGJ1aWxkZXIudGVtcGxhdGUoYmxvY2spO1xuXG4gICAgICBpZiAoY2FwYWJpbGl0aWVzLmR5bmFtaWNMYXlvdXQgPT09IGZhbHNlKSB7XG4gICAgICAgIGxldCBsYXlvdXQgPSBsb29rdXAuZ2V0TGF5b3V0KGhhbmRsZSkhO1xuXG4gICAgICAgIGJ1aWxkZXIucHVzaENvbXBvbmVudERlZmluaXRpb24oaGFuZGxlKTtcbiAgICAgICAgYnVpbGRlci5pbnZva2VTdGF0aWNDb21wb25lbnQoY2FwYWJpbGl0aWVzLCBsYXlvdXQsIGF0dHJzQmxvY2ssIG51bGwsIGFyZ3MsIGZhbHNlLCBjaGlsZCAmJiBjaGlsZCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBidWlsZGVyLnB1c2hDb21wb25lbnREZWZpbml0aW9uKGhhbmRsZSk7XG4gICAgICAgIGJ1aWxkZXIuaW52b2tlQ29tcG9uZW50KGF0dHJzQmxvY2ssIG51bGwsIGFyZ3MsIGZhbHNlLCBjaGlsZCAmJiBjaGlsZCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQ29tcGlsZSBFcnJvcjogQ2Fubm90IGZpbmQgY29tcG9uZW50ICR7dGFnfWApO1xuICAgIH1cbiAgfSk7XG5cbiAgU1RBVEVNRU5UUy5hZGQoT3BzLlBhcnRpYWwsIChzZXhwOiBTLlBhcnRpYWwsIGJ1aWxkZXIpID0+IHtcbiAgICBsZXQgWywgbmFtZSwgZXZhbEluZm9dID0gc2V4cDtcblxuICAgIGxldCB7IHJlZmVycmVyIH0gPSBidWlsZGVyO1xuXG4gICAgYnVpbGRlci5zdGFydExhYmVscygpO1xuXG4gICAgYnVpbGRlci5wdXNoRnJhbWUoKTtcblxuICAgIGJ1aWxkZXIucmV0dXJuVG8oJ0VORCcpO1xuXG4gICAgYnVpbGRlci5leHByKG5hbWUpO1xuXG4gICAgYnVpbGRlci5kdXAoKTtcblxuICAgIGJ1aWxkZXIuZW50ZXIoMik7XG5cbiAgICBidWlsZGVyLmp1bXBVbmxlc3MoJ0VMU0UnKTtcblxuICAgIGJ1aWxkZXIuaW52b2tlUGFydGlhbChyZWZlcnJlciwgYnVpbGRlci5ldmFsU3ltYm9scygpISwgZXZhbEluZm8pO1xuICAgIGJ1aWxkZXIucG9wU2NvcGUoKTtcbiAgICBidWlsZGVyLnBvcEZyYW1lKCk7XG5cbiAgICBidWlsZGVyLmxhYmVsKCdFTFNFJyk7XG4gICAgYnVpbGRlci5leGl0KCk7XG4gICAgYnVpbGRlci5yZXR1cm4oKTtcblxuICAgIGJ1aWxkZXIubGFiZWwoJ0VORCcpO1xuICAgIGJ1aWxkZXIucG9wRnJhbWUoKTtcblxuICAgIGJ1aWxkZXIuc3RvcExhYmVscygpO1xuICB9KTtcblxuICBTVEFURU1FTlRTLmFkZChPcHMuWWllbGQsIChzZXhwOiBXaXJlRm9ybWF0LlN0YXRlbWVudHMuWWllbGQsIGJ1aWxkZXIpID0+IHtcbiAgICBsZXQgWywgdG8sIHBhcmFtc10gPSBzZXhwO1xuXG4gICAgYnVpbGRlci55aWVsZCh0bywgcGFyYW1zKTtcbiAgfSk7XG5cbiAgU1RBVEVNRU5UUy5hZGQoT3BzLkF0dHJTcGxhdCwgKHNleHA6IFdpcmVGb3JtYXQuU3RhdGVtZW50cy5BdHRyU3BsYXQsIGJ1aWxkZXIpID0+IHtcbiAgICBsZXQgWywgdG9dID0gc2V4cDtcblxuICAgIGJ1aWxkZXIueWllbGQodG8sIFtdKTtcbiAgICBidWlsZGVyLmRpZENyZWF0ZUVsZW1lbnQoUmVnaXN0ZXIuczApO1xuICAgIGJ1aWxkZXIuc2V0Q29tcG9uZW50QXR0cnMoZmFsc2UpO1xuICB9KTtcblxuICBTVEFURU1FTlRTLmFkZChPcHMuRGVidWdnZXIsIChzZXhwOiBXaXJlRm9ybWF0LlN0YXRlbWVudHMuRGVidWdnZXIsIGJ1aWxkZXIpID0+IHtcbiAgICBsZXQgWywgZXZhbEluZm9dID0gc2V4cDtcblxuICAgIGJ1aWxkZXIuZGVidWdnZXIoYnVpbGRlci5ldmFsU3ltYm9scygpISwgZXZhbEluZm8pO1xuICB9KTtcblxuICBTVEFURU1FTlRTLmFkZChPcHMuQ2xpZW50U2lkZVN0YXRlbWVudCwgKHNleHA6IFdpcmVGb3JtYXQuU3RhdGVtZW50cy5DbGllbnRTaWRlLCBidWlsZGVyKSA9PiB7XG4gICAgQ0xJRU5UX1NJREUuY29tcGlsZShzZXhwIGFzIENsaWVudFNpZGUuQ2xpZW50U2lkZVN0YXRlbWVudCwgYnVpbGRlcik7XG4gIH0pO1xuXG4gIFNUQVRFTUVOVFMuYWRkKE9wcy5BcHBlbmQsIChzZXhwOiBTLkFwcGVuZCwgYnVpbGRlcikgPT4ge1xuICAgIGxldCBbLCB2YWx1ZSwgdHJ1c3RpbmddID0gc2V4cDtcblxuICAgIGxldCB7IGlubGluZXMgfSA9IGJ1aWxkZXIubWFjcm9zO1xuICAgIGxldCByZXR1cm5lZCA9IGlubGluZXMuY29tcGlsZShzZXhwLCBidWlsZGVyKSB8fCB2YWx1ZTtcblxuICAgIGlmIChyZXR1cm5lZCA9PT0gdHJ1ZSkgcmV0dXJuO1xuXG4gICAgbGV0IGlzR2V0ID0gV2lyZUZvcm1hdC5pc0dldCh2YWx1ZSk7XG4gICAgbGV0IGlzTWF5YmVMb2NhbCA9IFdpcmVGb3JtYXQuaXNNYXliZUxvY2FsKHZhbHVlKTtcblxuICAgIGlmICh0cnVzdGluZykge1xuICAgICAgYnVpbGRlci5ndWFyZGVkQXBwZW5kKHZhbHVlLCB0cnVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKGlzR2V0IHx8IGlzTWF5YmVMb2NhbCkge1xuICAgICAgICBidWlsZGVyLmd1YXJkZWRBcHBlbmQodmFsdWUsIGZhbHNlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJ1aWxkZXIuZXhwcih2YWx1ZSk7XG4gICAgICAgIGJ1aWxkZXIuZHluYW1pY0NvbnRlbnQoZmFsc2UpO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgU1RBVEVNRU5UUy5hZGQoT3BzLkJsb2NrLCAoc2V4cDogUy5CbG9jaywgYnVpbGRlcikgPT4ge1xuICAgIGxldCBbLCBuYW1lLCBwYXJhbXMsIGhhc2gsIF90ZW1wbGF0ZSwgX2ludmVyc2VdID0gc2V4cDtcbiAgICBsZXQgdGVtcGxhdGUgPSBidWlsZGVyLnRlbXBsYXRlKF90ZW1wbGF0ZSk7XG4gICAgbGV0IGludmVyc2UgPSBidWlsZGVyLnRlbXBsYXRlKF9pbnZlcnNlKTtcblxuICAgIGxldCB0ZW1wbGF0ZUJsb2NrID0gdGVtcGxhdGUgJiYgdGVtcGxhdGU7XG4gICAgbGV0IGludmVyc2VCbG9jayA9IGludmVyc2UgJiYgaW52ZXJzZTtcblxuICAgIGxldCB7IGJsb2NrcyB9ID0gYnVpbGRlci5tYWNyb3M7XG4gICAgYmxvY2tzLmNvbXBpbGUobmFtZSwgcGFyYW1zLCBoYXNoLCB0ZW1wbGF0ZUJsb2NrLCBpbnZlcnNlQmxvY2ssIGJ1aWxkZXIpO1xuICB9KTtcblxuICBjb25zdCBDTElFTlRfU0lERSA9IG5ldyBDb21waWxlcnM8Q2xpZW50U2lkZS5DbGllbnRTaWRlU3RhdGVtZW50PigxKTtcblxuICBDTElFTlRfU0lERS5hZGQoQ2xpZW50U2lkZS5PcHMuT3BlbkNvbXBvbmVudEVsZW1lbnQsIChzZXhwOiBDbGllbnRTaWRlLk9wZW5Db21wb25lbnRFbGVtZW50LCBidWlsZGVyKSA9PiB7XG4gICAgYnVpbGRlci5wdXRDb21wb25lbnRPcGVyYXRpb25zKCk7XG4gICAgYnVpbGRlci5vcGVuRWxlbWVudFdpdGhPcGVyYXRpb25zKHNleHBbMl0pO1xuICB9KTtcblxuICBDTElFTlRfU0lERS5hZGQoQ2xpZW50U2lkZS5PcHMuRGlkQ3JlYXRlRWxlbWVudCwgKF9zZXhwOiBDbGllbnRTaWRlLkRpZENyZWF0ZUVsZW1lbnQsIGJ1aWxkZXIpID0+IHtcbiAgICBidWlsZGVyLmRpZENyZWF0ZUVsZW1lbnQoUmVnaXN0ZXIuczApO1xuICB9KTtcblxuICBDTElFTlRfU0lERS5hZGQoQ2xpZW50U2lkZS5PcHMuU2V0Q29tcG9uZW50QXR0cnMsIChzZXhwOiBDbGllbnRTaWRlLlNldENvbXBvbmVudEF0dHJzLCBidWlsZGVyKSA9PiB7XG4gICAgYnVpbGRlci5zZXRDb21wb25lbnRBdHRycyhzZXhwWzJdKTtcbiAgfSk7XG5cbiAgQ0xJRU5UX1NJREUuYWRkKENsaWVudFNpZGUuT3BzLkRlYnVnZ2VyLCAoKSA9PiB7XG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWRlYnVnZ2VyXG4gICAgZGVidWdnZXI7XG4gIH0pO1xuXG4gIENMSUVOVF9TSURFLmFkZChDbGllbnRTaWRlLk9wcy5EaWRSZW5kZXJMYXlvdXQsIChfc2V4cDogQ2xpZW50U2lkZS5EaWRSZW5kZXJMYXlvdXQsIGJ1aWxkZXIpID0+IHtcbiAgICBidWlsZGVyLmRpZFJlbmRlckxheW91dChSZWdpc3Rlci5zMCk7XG4gIH0pO1xuXG4gIHJldHVybiBTVEFURU1FTlRTO1xufVxuXG5mdW5jdGlvbiBkeW5hbWljQXR0cjxTcGVjaWZpZXI+KHNleHA6IFMuRHluYW1pY0F0dHIgfCBTLlRydXN0aW5nQXR0ciwgdHJ1c3Rpbmc6IGJvb2xlYW4sIGJ1aWxkZXI6IE9wY29kZUJ1aWxkZXI8U3BlY2lmaWVyPikge1xuICBsZXQgWywgbmFtZSwgdmFsdWUsIG5hbWVzcGFjZV0gPSBzZXhwO1xuXG4gIGJ1aWxkZXIuZXhwcih2YWx1ZSk7XG5cbiAgaWYgKG5hbWVzcGFjZSkge1xuICAgIGJ1aWxkZXIuZHluYW1pY0F0dHIobmFtZSwgbmFtZXNwYWNlLCB0cnVzdGluZyk7XG4gIH0gZWxzZSB7XG4gICAgYnVpbGRlci5keW5hbWljQXR0cihuYW1lLCBudWxsLCB0cnVzdGluZyk7XG4gIH1cbn1cblxubGV0IF9leHByZXNzaW9uQ29tcGlsZXI6IENvbXBpbGVyczxXaXJlRm9ybWF0LlR1cGxlRXhwcmVzc2lvbj47XG5cbmV4cG9ydCBmdW5jdGlvbiBleHByZXNzaW9uQ29tcGlsZXIoKSB7XG4gIGlmIChfZXhwcmVzc2lvbkNvbXBpbGVyKSB7XG4gICAgcmV0dXJuIF9leHByZXNzaW9uQ29tcGlsZXI7XG4gIH1cblxuICBjb25zdCBFWFBSRVNTSU9OUyA9IF9leHByZXNzaW9uQ29tcGlsZXIgPSBuZXcgQ29tcGlsZXJzPFdpcmVGb3JtYXQuVHVwbGVFeHByZXNzaW9uPigpO1xuXG4gIEVYUFJFU1NJT05TLmFkZChPcHMuVW5rbm93biwgKHNleHA6IEUuVW5rbm93biwgYnVpbGRlcikgPT4ge1xuICAgIGxldCB7IGxvb2t1cCwgYXNQYXJ0aWFsLCByZWZlcnJlciB9ID0gYnVpbGRlcjtcbiAgICBsZXQgbmFtZSA9IHNleHBbMV07XG5cbiAgICBsZXQgc3BlY2lmaWVyID0gbG9va3VwLmxvb2t1cEhlbHBlcihuYW1lLCByZWZlcnJlcik7XG5cbiAgICBpZiAoc3BlY2lmaWVyICE9PSBudWxsKSB7XG4gICAgICBidWlsZGVyLmhlbHBlcihzcGVjaWZpZXIsIG51bGwsIG51bGwpO1xuICAgIH0gZWxzZSBpZiAoYXNQYXJ0aWFsKSB7XG4gICAgICBidWlsZGVyLnJlc29sdmVNYXliZUxvY2FsKG5hbWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBidWlsZGVyLmdldFZhcmlhYmxlKDApO1xuICAgICAgYnVpbGRlci5nZXRQcm9wZXJ0eShuYW1lKTtcbiAgICB9XG4gIH0pO1xuXG4gIEVYUFJFU1NJT05TLmFkZChPcHMuQ29uY2F0LCAoc2V4cDogRS5Db25jYXQsIGJ1aWxkZXIpID0+IHtcbiAgICBsZXQgcGFydHMgPSBzZXhwWzFdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFydHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGJ1aWxkZXIuZXhwcihwYXJ0c1tpXSk7XG4gICAgfVxuICAgIGJ1aWxkZXIuY29uY2F0KHBhcnRzLmxlbmd0aCk7XG4gIH0pO1xuXG4gIEVYUFJFU1NJT05TLmFkZChPcHMuSGVscGVyLCAoc2V4cDogRS5IZWxwZXIsIGJ1aWxkZXIpID0+IHtcbiAgICBsZXQgeyBsb29rdXAsIHJlZmVycmVyIH0gPSBidWlsZGVyO1xuICAgIGxldCBbLCBuYW1lLCBwYXJhbXMsIGhhc2hdID0gc2V4cDtcblxuICAgIC8vIFRPRE86IHRyaWFnZSB0aGlzIGluIHRoZSBXRiBjb21waWxlclxuICAgIGlmIChuYW1lID09PSAnY29tcG9uZW50Jykge1xuICAgICAgYXNzZXJ0KHBhcmFtcy5sZW5ndGgsICdTWU5UQVggRVJST1I6IGNvbXBvbmVudCBoZWxwZXIgcmVxdWlyZXMgYXQgbGVhc3Qgb25lIGFyZ3VtZW50Jyk7XG5cbiAgICAgIGxldCBbZGVmaW5pdGlvbiwgLi4ucmVzdEFyZ3NdID0gcGFyYW1zO1xuICAgICAgYnVpbGRlci5jdXJyeUNvbXBvbmVudChkZWZpbml0aW9uLCByZXN0QXJncywgaGFzaCwgdHJ1ZSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgbGV0IHNwZWNpZmllciA9IGxvb2t1cC5sb29rdXBIZWxwZXIobmFtZSwgcmVmZXJyZXIpO1xuXG4gICAgaWYgKHNwZWNpZmllciAhPT0gbnVsbCkge1xuICAgICAgYnVpbGRlci5oZWxwZXIoc3BlY2lmaWVyLCBwYXJhbXMsIGhhc2gpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYENvbXBpbGUgRXJyb3I6ICR7bmFtZX0gaXMgbm90IGEgaGVscGVyYCk7XG4gICAgfVxuICB9KTtcblxuICBFWFBSRVNTSU9OUy5hZGQoT3BzLkdldCwgKHNleHA6IEUuR2V0LCBidWlsZGVyKSA9PiB7XG4gICAgbGV0IFssIGhlYWQsIHBhdGhdID0gc2V4cDtcbiAgICBidWlsZGVyLmdldFZhcmlhYmxlKGhlYWQpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGF0aC5sZW5ndGg7IGkrKykge1xuICAgICAgYnVpbGRlci5nZXRQcm9wZXJ0eShwYXRoW2ldKTtcbiAgICB9XG4gIH0pO1xuXG4gIEVYUFJFU1NJT05TLmFkZChPcHMuTWF5YmVMb2NhbCwgKHNleHA6IEUuTWF5YmVMb2NhbCwgYnVpbGRlcikgPT4ge1xuICAgIGxldCBbLCBwYXRoXSA9IHNleHA7XG5cbiAgICBpZiAoYnVpbGRlci5hc1BhcnRpYWwpIHtcbiAgICAgIGxldCBoZWFkID0gcGF0aFswXTtcbiAgICAgIHBhdGggPSBwYXRoLnNsaWNlKDEpO1xuXG4gICAgICBidWlsZGVyLnJlc29sdmVNYXliZUxvY2FsKGhlYWQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBidWlsZGVyLmdldFZhcmlhYmxlKDApO1xuICAgIH1cblxuICAgIGZvcihsZXQgaSA9IDA7IGkgPCBwYXRoLmxlbmd0aDsgaSsrKSB7XG4gICAgICBidWlsZGVyLmdldFByb3BlcnR5KHBhdGhbaV0pO1xuICAgIH1cbiAgfSk7XG5cbiAgRVhQUkVTU0lPTlMuYWRkKE9wcy5VbmRlZmluZWQsIChfc2V4cCwgYnVpbGRlcikgPT4ge1xuICAgIHJldHVybiBidWlsZGVyLnB1c2hQcmltaXRpdmVSZWZlcmVuY2UodW5kZWZpbmVkKTtcbiAgfSk7XG5cbiAgRVhQUkVTU0lPTlMuYWRkKE9wcy5IYXNCbG9jaywgKHNleHA6IEUuSGFzQmxvY2ssIGJ1aWxkZXIpID0+IHtcbiAgICBidWlsZGVyLmhhc0Jsb2NrKHNleHBbMV0pO1xuICB9KTtcblxuICBFWFBSRVNTSU9OUy5hZGQoT3BzLkhhc0Jsb2NrUGFyYW1zLCAoc2V4cDogRS5IYXNCbG9ja1BhcmFtcywgYnVpbGRlcikgPT4ge1xuICAgIGJ1aWxkZXIuaGFzQmxvY2tQYXJhbXMoc2V4cFsxXSk7XG4gIH0pO1xuXG4gIHJldHVybiBFWFBSRVNTSU9OUztcbn1cblxuZXhwb3J0IGNsYXNzIE1hY3JvcyB7XG4gIHB1YmxpYyBibG9ja3M6IEJsb2NrcztcbiAgcHVibGljIGlubGluZXM6IElubGluZXM7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgbGV0IHsgYmxvY2tzLCBpbmxpbmVzIH0gPSBwb3B1bGF0ZUJ1aWx0aW5zKCk7XG4gICAgdGhpcy5ibG9ja3MgPSBibG9ja3M7XG4gICAgdGhpcy5pbmxpbmVzID0gaW5saW5lcztcbiAgfVxufVxuXG5leHBvcnQgdHlwZSBCbG9ja01hY3JvPFNwZWNpZmllcj4gPSAocGFyYW1zOiBDLlBhcmFtcywgaGFzaDogQy5IYXNoLCB0ZW1wbGF0ZTogT3B0aW9uPENvbXBpbGFibGVCbG9jaz4sIGludmVyc2U6IE9wdGlvbjxDb21waWxhYmxlQmxvY2s+LCBidWlsZGVyOiBPcGNvZGVCdWlsZGVyPFNwZWNpZmllcj4pID0+IHZvaWQ7XG5leHBvcnQgdHlwZSBNaXNzaW5nQmxvY2tNYWNybzxTcGVjaWZpZXI+ID0gKG5hbWU6IHN0cmluZywgcGFyYW1zOiBDLlBhcmFtcywgaGFzaDogQy5IYXNoLCB0ZW1wbGF0ZTogT3B0aW9uPENvbXBpbGFibGVCbG9jaz4sIGludmVyc2U6IE9wdGlvbjxDb21waWxhYmxlQmxvY2s+LCBidWlsZGVyOiBPcGNvZGVCdWlsZGVyPFNwZWNpZmllcj4pID0+IHZvaWQ7XG5cbmV4cG9ydCBjbGFzcyBCbG9ja3Mge1xuICBwcml2YXRlIG5hbWVzID0gZGljdDxudW1iZXI+KCk7XG4gIHByaXZhdGUgZnVuY3M6IEJsb2NrTWFjcm88T3BhcXVlPltdID0gW107XG4gIHByaXZhdGUgbWlzc2luZzogTWlzc2luZ0Jsb2NrTWFjcm88T3BhcXVlPjtcblxuICBhZGQ8U3BlY2lmaWVyPihuYW1lOiBzdHJpbmcsIGZ1bmM6IEJsb2NrTWFjcm88U3BlY2lmaWVyPikge1xuICAgIHRoaXMuZnVuY3MucHVzaChmdW5jKTtcbiAgICB0aGlzLm5hbWVzW25hbWVdID0gdGhpcy5mdW5jcy5sZW5ndGggLSAxO1xuICB9XG5cbiAgYWRkTWlzc2luZzxTcGVjaWZpZXI+KGZ1bmM6IE1pc3NpbmdCbG9ja01hY3JvPFNwZWNpZmllcj4pIHtcbiAgICB0aGlzLm1pc3NpbmcgPSBmdW5jO1xuICB9XG5cbiAgY29tcGlsZTxTcGVjaWZpZXI+KG5hbWU6IHN0cmluZywgcGFyYW1zOiBDLlBhcmFtcywgaGFzaDogQy5IYXNoLCB0ZW1wbGF0ZTogT3B0aW9uPENvbXBpbGFibGVCbG9jaz4sIGludmVyc2U6IE9wdGlvbjxDb21waWxhYmxlQmxvY2s+LCBidWlsZGVyOiBPcGNvZGVCdWlsZGVyPFNwZWNpZmllcj4pOiB2b2lkIHtcbiAgICBsZXQgaW5kZXggPSB0aGlzLm5hbWVzW25hbWVdO1xuXG4gICAgaWYgKGluZGV4ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGFzc2VydCghIXRoaXMubWlzc2luZywgYCR7bmFtZX0gbm90IGZvdW5kLCBhbmQgbm8gY2F0Y2gtYWxsIGJsb2NrIGhhbmRsZXIgd2FzIHJlZ2lzdGVyZWRgKTtcbiAgICAgIGxldCBmdW5jID0gdGhpcy5taXNzaW5nO1xuICAgICAgbGV0IGhhbmRsZWQgPSBmdW5jKG5hbWUsIHBhcmFtcywgaGFzaCwgdGVtcGxhdGUsIGludmVyc2UsIGJ1aWxkZXIpO1xuICAgICAgYXNzZXJ0KCEhaGFuZGxlZCwgYCR7bmFtZX0gbm90IGZvdW5kLCBhbmQgdGhlIGNhdGNoLWFsbCBibG9jayBoYW5kbGVyIGRpZG4ndCBoYW5kbGUgaXRgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbGV0IGZ1bmMgPSB0aGlzLmZ1bmNzW2luZGV4XTtcbiAgICAgIGZ1bmMocGFyYW1zLCBoYXNoLCB0ZW1wbGF0ZSwgaW52ZXJzZSwgYnVpbGRlcik7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCB0eXBlIEFwcGVuZFN5bnRheCA9IFMuQXBwZW5kO1xuZXhwb3J0IHR5cGUgQXBwZW5kTWFjcm88U3BlY2lmaWVyPiA9IChuYW1lOiBzdHJpbmcsIHBhcmFtczogT3B0aW9uPEMuUGFyYW1zPiwgaGFzaDogT3B0aW9uPEMuSGFzaD4sIGJ1aWxkZXI6IE9wY29kZUJ1aWxkZXI8U3BlY2lmaWVyPikgPT4gWydleHByJywgV2lyZUZvcm1hdC5FeHByZXNzaW9uXSB8IHRydWUgfCBmYWxzZTtcblxuZXhwb3J0IGNsYXNzIElubGluZXMge1xuICBwcml2YXRlIG5hbWVzID0gZGljdDxudW1iZXI+KCk7XG4gIHByaXZhdGUgZnVuY3M6IEFwcGVuZE1hY3JvPE9wYXF1ZT5bXSA9IFtdO1xuICBwcml2YXRlIG1pc3Npbmc6IEFwcGVuZE1hY3JvPE9wYXF1ZT47XG5cbiAgYWRkPFNwZWNpZmllcj4obmFtZTogc3RyaW5nLCBmdW5jOiBBcHBlbmRNYWNybzxTcGVjaWZpZXI+KSB7XG4gICAgdGhpcy5mdW5jcy5wdXNoKGZ1bmMpO1xuICAgIHRoaXMubmFtZXNbbmFtZV0gPSB0aGlzLmZ1bmNzLmxlbmd0aCAtIDE7XG4gIH1cblxuICBhZGRNaXNzaW5nPFNwZWNpZmllcj4oZnVuYzogQXBwZW5kTWFjcm88U3BlY2lmaWVyPikge1xuICAgIHRoaXMubWlzc2luZyA9IGZ1bmM7XG4gIH1cblxuICBjb21waWxlPFNwZWNpZmllcj4oc2V4cDogQXBwZW5kU3ludGF4LCBidWlsZGVyOiBPcGNvZGVCdWlsZGVyPFNwZWNpZmllcj4pOiBbJ2V4cHInLCBXaXJlRm9ybWF0LkV4cHJlc3Npb25dIHwgdHJ1ZSB7XG4gICAgbGV0IHZhbHVlID0gc2V4cFsxXTtcblxuICAgIC8vIFRPRE86IEZpeCB0aGlzIHNvIHRoYXQgZXhwcmVzc2lvbiBtYWNyb3MgY2FuIHJldHVyblxuICAgIC8vIHRoaW5ncyBsaWtlIGNvbXBvbmVudHMsIHNvIHRoYXQge3tjb21wb25lbnQgZm9vfX1cbiAgICAvLyBpcyB0aGUgc2FtZSBhcyB7eyhjb21wb25lbnQgZm9vKX19XG5cbiAgICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWUpKSByZXR1cm4gWydleHByJywgdmFsdWVdO1xuXG4gICAgbGV0IG5hbWU6IHN0cmluZztcbiAgICBsZXQgcGFyYW1zOiBPcHRpb248Qy5QYXJhbXM+O1xuICAgIGxldCBoYXNoOiBPcHRpb248Qy5IYXNoPjtcblxuICAgIGlmICh2YWx1ZVswXSA9PT0gT3BzLkhlbHBlcikge1xuICAgICAgbmFtZSA9IHZhbHVlWzFdO1xuICAgICAgcGFyYW1zID0gdmFsdWVbMl07XG4gICAgICBoYXNoID0gdmFsdWVbM107XG4gICAgfSBlbHNlIGlmICh2YWx1ZVswXSA9PT0gT3BzLlVua25vd24pIHtcbiAgICAgIG5hbWUgPSB2YWx1ZVsxXTtcbiAgICAgIHBhcmFtcyA9IGhhc2ggPSBudWxsO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gWydleHByJywgdmFsdWVdO1xuICAgIH1cblxuICAgIGxldCBpbmRleCA9IHRoaXMubmFtZXNbbmFtZV07XG5cbiAgICBpZiAoaW5kZXggPT09IHVuZGVmaW5lZCAmJiB0aGlzLm1pc3NpbmcpIHtcbiAgICAgIGxldCBmdW5jID0gdGhpcy5taXNzaW5nO1xuICAgICAgbGV0IHJldHVybmVkID0gZnVuYyhuYW1lLCBwYXJhbXMsIGhhc2gsIGJ1aWxkZXIpO1xuICAgICAgcmV0dXJuIHJldHVybmVkID09PSBmYWxzZSA/IFsnZXhwcicsIHZhbHVlXSA6IHJldHVybmVkO1xuICAgIH0gZWxzZSBpZiAoaW5kZXggIT09IHVuZGVmaW5lZCkge1xuICAgICAgbGV0IGZ1bmMgPSB0aGlzLmZ1bmNzW2luZGV4XTtcbiAgICAgIGxldCByZXR1cm5lZCA9IGZ1bmMobmFtZSwgcGFyYW1zLCBoYXNoLCBidWlsZGVyKTtcbiAgICAgIHJldHVybiByZXR1cm5lZCA9PT0gZmFsc2UgPyBbJ2V4cHInLCB2YWx1ZV0gOiByZXR1cm5lZDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFsnZXhwcicsIHZhbHVlXTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBvcHVsYXRlQnVpbHRpbnMoYmxvY2tzOiBCbG9ja3MgPSBuZXcgQmxvY2tzKCksIGlubGluZXM6IElubGluZXMgPSBuZXcgSW5saW5lcygpKTogeyBibG9ja3M6IEJsb2NrcywgaW5saW5lczogSW5saW5lcyB9IHtcbiAgYmxvY2tzLmFkZCgnaWYnLCAocGFyYW1zLCBfaGFzaCwgdGVtcGxhdGUsIGludmVyc2UsIGJ1aWxkZXIpID0+IHtcbiAgICAvLyAgICAgICAgUHV0QXJnc1xuICAgIC8vICAgICAgICBUZXN0KEVudmlyb25tZW50KVxuICAgIC8vICAgICAgICBFbnRlcihCRUdJTiwgRU5EKVxuICAgIC8vIEJFR0lOOiBOb29wXG4gICAgLy8gICAgICAgIEp1bXBVbmxlc3MoRUxTRSlcbiAgICAvLyAgICAgICAgRXZhbHVhdGUoZGVmYXVsdClcbiAgICAvLyAgICAgICAgSnVtcChFTkQpXG4gICAgLy8gRUxTRTogIE5vb3BcbiAgICAvLyAgICAgICAgRXZhbHVsYXRlKGludmVyc2UpXG4gICAgLy8gRU5EOiAgIE5vb3BcbiAgICAvLyAgICAgICAgRXhpdFxuXG4gICAgaWYgKCFwYXJhbXMgfHwgcGFyYW1zLmxlbmd0aCAhPT0gMSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBTWU5UQVggRVJST1I6ICNpZiByZXF1aXJlcyBhIHNpbmdsZSBhcmd1bWVudGApO1xuICAgIH1cblxuICAgIGJ1aWxkZXIuc3RhcnRMYWJlbHMoKTtcblxuICAgIGJ1aWxkZXIucHVzaEZyYW1lKCk7XG5cbiAgICBidWlsZGVyLnJldHVyblRvKCdFTkQnKTtcblxuICAgIGJ1aWxkZXIuZXhwcihwYXJhbXNbMF0pO1xuXG4gICAgYnVpbGRlci50b0Jvb2xlYW4oKTtcblxuICAgIGJ1aWxkZXIuZW50ZXIoMSk7XG5cbiAgICBidWlsZGVyLmp1bXBVbmxlc3MoJ0VMU0UnKTtcblxuICAgIGJ1aWxkZXIuaW52b2tlU3RhdGljQmxvY2sodW53cmFwKHRlbXBsYXRlKSk7XG5cbiAgICBpZiAoaW52ZXJzZSkge1xuICAgICAgYnVpbGRlci5qdW1wKCdFWElUJyk7XG5cbiAgICAgIGJ1aWxkZXIubGFiZWwoJ0VMU0UnKTtcbiAgICAgIGJ1aWxkZXIuaW52b2tlU3RhdGljQmxvY2soaW52ZXJzZSk7XG5cbiAgICAgIGJ1aWxkZXIubGFiZWwoJ0VYSVQnKTtcbiAgICAgIGJ1aWxkZXIuZXhpdCgpO1xuICAgICAgYnVpbGRlci5yZXR1cm4oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYnVpbGRlci5sYWJlbCgnRUxTRScpO1xuICAgICAgYnVpbGRlci5leGl0KCk7XG4gICAgICBidWlsZGVyLnJldHVybigpO1xuICAgIH1cblxuICAgIGJ1aWxkZXIubGFiZWwoJ0VORCcpO1xuICAgIGJ1aWxkZXIucG9wRnJhbWUoKTtcblxuICAgIGJ1aWxkZXIuc3RvcExhYmVscygpO1xuICB9KTtcblxuICBibG9ja3MuYWRkKCd1bmxlc3MnLCAocGFyYW1zLCBfaGFzaCwgdGVtcGxhdGUsIGludmVyc2UsIGJ1aWxkZXIpID0+IHtcbiAgICAvLyAgICAgICAgUHV0QXJnc1xuICAgIC8vICAgICAgICBUZXN0KEVudmlyb25tZW50KVxuICAgIC8vICAgICAgICBFbnRlcihCRUdJTiwgRU5EKVxuICAgIC8vIEJFR0lOOiBOb29wXG4gICAgLy8gICAgICAgIEp1bXBVbmxlc3MoRUxTRSlcbiAgICAvLyAgICAgICAgRXZhbHVhdGUoZGVmYXVsdClcbiAgICAvLyAgICAgICAgSnVtcChFTkQpXG4gICAgLy8gRUxTRTogIE5vb3BcbiAgICAvLyAgICAgICAgRXZhbHVsYXRlKGludmVyc2UpXG4gICAgLy8gRU5EOiAgIE5vb3BcbiAgICAvLyAgICAgICAgRXhpdFxuXG4gICAgaWYgKCFwYXJhbXMgfHwgcGFyYW1zLmxlbmd0aCAhPT0gMSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBTWU5UQVggRVJST1I6ICN1bmxlc3MgcmVxdWlyZXMgYSBzaW5nbGUgYXJndW1lbnRgKTtcbiAgICB9XG5cbiAgICBidWlsZGVyLnN0YXJ0TGFiZWxzKCk7XG5cbiAgICBidWlsZGVyLnB1c2hGcmFtZSgpO1xuXG4gICAgYnVpbGRlci5yZXR1cm5UbygnRU5EJyk7XG5cbiAgICBidWlsZGVyLmV4cHIocGFyYW1zWzBdKTtcblxuICAgIGJ1aWxkZXIudG9Cb29sZWFuKCk7XG5cbiAgICBidWlsZGVyLmVudGVyKDEpO1xuXG4gICAgYnVpbGRlci5qdW1wSWYoJ0VMU0UnKTtcblxuICAgIGJ1aWxkZXIuaW52b2tlU3RhdGljQmxvY2sodW53cmFwKHRlbXBsYXRlKSk7XG5cbiAgICBpZiAoaW52ZXJzZSkge1xuICAgICAgYnVpbGRlci5qdW1wKCdFWElUJyk7XG5cbiAgICAgIGJ1aWxkZXIubGFiZWwoJ0VMU0UnKTtcbiAgICAgIGJ1aWxkZXIuaW52b2tlU3RhdGljQmxvY2soaW52ZXJzZSk7XG5cbiAgICAgIGJ1aWxkZXIubGFiZWwoJ0VYSVQnKTtcbiAgICAgIGJ1aWxkZXIuZXhpdCgpO1xuICAgICAgYnVpbGRlci5yZXR1cm4oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYnVpbGRlci5sYWJlbCgnRUxTRScpO1xuICAgICAgYnVpbGRlci5leGl0KCk7XG4gICAgICBidWlsZGVyLnJldHVybigpO1xuICAgIH1cblxuICAgIGJ1aWxkZXIubGFiZWwoJ0VORCcpO1xuICAgIGJ1aWxkZXIucG9wRnJhbWUoKTtcblxuICAgIGJ1aWxkZXIuc3RvcExhYmVscygpO1xuICB9KTtcblxuICBibG9ja3MuYWRkKCd3aXRoJywgKHBhcmFtcywgX2hhc2gsIHRlbXBsYXRlLCBpbnZlcnNlLCBidWlsZGVyKSA9PiB7XG4gICAgLy8gICAgICAgIFB1dEFyZ3NcbiAgICAvLyAgICAgICAgVGVzdChFbnZpcm9ubWVudClcbiAgICAvLyAgICAgICAgRW50ZXIoQkVHSU4sIEVORClcbiAgICAvLyBCRUdJTjogTm9vcFxuICAgIC8vICAgICAgICBKdW1wVW5sZXNzKEVMU0UpXG4gICAgLy8gICAgICAgIEV2YWx1YXRlKGRlZmF1bHQpXG4gICAgLy8gICAgICAgIEp1bXAoRU5EKVxuICAgIC8vIEVMU0U6ICBOb29wXG4gICAgLy8gICAgICAgIEV2YWx1bGF0ZShpbnZlcnNlKVxuICAgIC8vIEVORDogICBOb29wXG4gICAgLy8gICAgICAgIEV4aXRcblxuICAgIGlmICghcGFyYW1zIHx8IHBhcmFtcy5sZW5ndGggIT09IDEpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgU1lOVEFYIEVSUk9SOiAjd2l0aCByZXF1aXJlcyBhIHNpbmdsZSBhcmd1bWVudGApO1xuICAgIH1cblxuICAgIGJ1aWxkZXIuc3RhcnRMYWJlbHMoKTtcblxuICAgIGJ1aWxkZXIucHVzaEZyYW1lKCk7XG5cbiAgICBidWlsZGVyLnJldHVyblRvKCdFTkQnKTtcblxuICAgIGJ1aWxkZXIuZXhwcihwYXJhbXNbMF0pO1xuXG4gICAgYnVpbGRlci5kdXAoKTtcbiAgICBidWlsZGVyLnRvQm9vbGVhbigpO1xuXG4gICAgYnVpbGRlci5lbnRlcigyKTtcblxuICAgIGJ1aWxkZXIuanVtcFVubGVzcygnRUxTRScpO1xuXG4gICAgYnVpbGRlci5pbnZva2VTdGF0aWNCbG9jayh1bndyYXAodGVtcGxhdGUpLCAxKTtcblxuICAgIGlmIChpbnZlcnNlKSB7XG4gICAgICBidWlsZGVyLmp1bXAoJ0VYSVQnKTtcblxuICAgICAgYnVpbGRlci5sYWJlbCgnRUxTRScpO1xuICAgICAgYnVpbGRlci5pbnZva2VTdGF0aWNCbG9jayhpbnZlcnNlKTtcblxuICAgICAgYnVpbGRlci5sYWJlbCgnRVhJVCcpO1xuICAgICAgYnVpbGRlci5leGl0KCk7XG4gICAgICBidWlsZGVyLnJldHVybigpO1xuICAgIH0gZWxzZSB7XG4gICAgICBidWlsZGVyLmxhYmVsKCdFTFNFJyk7XG4gICAgICBidWlsZGVyLmV4aXQoKTtcbiAgICAgIGJ1aWxkZXIucmV0dXJuKCk7XG4gICAgfVxuXG4gICAgYnVpbGRlci5sYWJlbCgnRU5EJyk7XG4gICAgYnVpbGRlci5wb3BGcmFtZSgpO1xuXG4gICAgYnVpbGRlci5zdG9wTGFiZWxzKCk7XG4gIH0pO1xuXG4gIGJsb2Nrcy5hZGQoJ2VhY2gnLCAocGFyYW1zLCBoYXNoLCB0ZW1wbGF0ZSwgaW52ZXJzZSwgYnVpbGRlcikgPT4ge1xuICAgIC8vICAgICAgICAgRW50ZXIoQkVHSU4sIEVORClcbiAgICAvLyBCRUdJTjogIE5vb3BcbiAgICAvLyAgICAgICAgIFB1dEFyZ3NcbiAgICAvLyAgICAgICAgIFB1dEl0ZXJhYmxlXG4gICAgLy8gICAgICAgICBKdW1wVW5sZXNzKEVMU0UpXG4gICAgLy8gICAgICAgICBFbnRlckxpc3QoQkVHSU4yLCBFTkQyKVxuICAgIC8vIElURVI6ICAgTm9vcFxuICAgIC8vICAgICAgICAgTmV4dEl0ZXIoQlJFQUspXG4gICAgLy8gQkVHSU4yOiBOb29wXG4gICAgLy8gICAgICAgICBQdXNoQ2hpbGRTY29wZVxuICAgIC8vICAgICAgICAgRXZhbHVhdGUoZGVmYXVsdClcbiAgICAvLyAgICAgICAgIFBvcFNjb3BlXG4gICAgLy8gRU5EMjogICBOb29wXG4gICAgLy8gICAgICAgICBFeGl0XG4gICAgLy8gICAgICAgICBKdW1wKElURVIpXG4gICAgLy8gQlJFQUs6ICBOb29wXG4gICAgLy8gICAgICAgICBFeGl0TGlzdFxuICAgIC8vICAgICAgICAgSnVtcChFTkQpXG4gICAgLy8gRUxTRTogICBOb29wXG4gICAgLy8gICAgICAgICBFdmFsdWxhdGUoaW52ZXJzZSlcbiAgICAvLyBFTkQ6ICAgIE5vb3BcbiAgICAvLyAgICAgICAgIEV4aXRcblxuICAgIGJ1aWxkZXIuc3RhcnRMYWJlbHMoKTtcblxuICAgIGJ1aWxkZXIucHVzaEZyYW1lKCk7XG5cbiAgICBidWlsZGVyLnJldHVyblRvKCdFTkQnKTtcblxuICAgIGlmIChoYXNoICYmIGhhc2hbMF1bMF0gPT09ICdrZXknKSB7XG4gICAgICBidWlsZGVyLmV4cHIoaGFzaFsxXVswXSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGJ1aWxkZXIucHVzaFByaW1pdGl2ZVJlZmVyZW5jZShudWxsKTtcbiAgICB9XG5cbiAgICBidWlsZGVyLmV4cHIocGFyYW1zWzBdKTtcblxuICAgIGJ1aWxkZXIuZW50ZXIoMik7XG5cbiAgICBidWlsZGVyLnB1dEl0ZXJhdG9yKCk7XG5cbiAgICBidWlsZGVyLmp1bXBVbmxlc3MoJ0VMU0UnKTtcblxuICAgIGJ1aWxkZXIucHVzaEZyYW1lKCk7XG5cbiAgICBidWlsZGVyLnJldHVyblRvKCdJVEVSJyk7XG5cbiAgICBidWlsZGVyLmR1cChSZWdpc3Rlci5mcCwgMSk7XG5cbiAgICBidWlsZGVyLmVudGVyTGlzdCgnQk9EWScpO1xuXG4gICAgYnVpbGRlci5sYWJlbCgnSVRFUicpO1xuICAgIGJ1aWxkZXIuaXRlcmF0ZSgnQlJFQUsnKTtcblxuICAgIGJ1aWxkZXIubGFiZWwoJ0JPRFknKTtcbiAgICBidWlsZGVyLmludm9rZVN0YXRpY0Jsb2NrKHVud3JhcCh0ZW1wbGF0ZSksIDIpO1xuICAgIGJ1aWxkZXIucG9wKDIpO1xuICAgIGJ1aWxkZXIuZXhpdCgpO1xuICAgIGJ1aWxkZXIucmV0dXJuKCk7XG5cbiAgICBidWlsZGVyLmxhYmVsKCdCUkVBSycpO1xuICAgIGJ1aWxkZXIuZXhpdExpc3QoKTtcbiAgICBidWlsZGVyLnBvcEZyYW1lKCk7XG5cbiAgICBpZiAoaW52ZXJzZSkge1xuICAgICAgYnVpbGRlci5qdW1wKCdFWElUJyk7XG5cbiAgICAgIGJ1aWxkZXIubGFiZWwoJ0VMU0UnKTtcbiAgICAgIGJ1aWxkZXIuaW52b2tlU3RhdGljQmxvY2soaW52ZXJzZSk7XG5cbiAgICAgIGJ1aWxkZXIubGFiZWwoJ0VYSVQnKTtcbiAgICAgIGJ1aWxkZXIuZXhpdCgpO1xuICAgICAgYnVpbGRlci5yZXR1cm4oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYnVpbGRlci5sYWJlbCgnRUxTRScpO1xuICAgICAgYnVpbGRlci5leGl0KCk7XG4gICAgICBidWlsZGVyLnJldHVybigpO1xuICAgIH1cblxuICAgIGJ1aWxkZXIubGFiZWwoJ0VORCcpO1xuICAgIGJ1aWxkZXIucG9wRnJhbWUoKTtcblxuICAgIGJ1aWxkZXIuc3RvcExhYmVscygpO1xuICB9KTtcblxuICBibG9ja3MuYWRkKCdpbi1lbGVtZW50JywgKHBhcmFtcywgaGFzaCwgdGVtcGxhdGUsIF9pbnZlcnNlLCBidWlsZGVyKSA9PiB7XG4gICAgaWYgKCFwYXJhbXMgfHwgcGFyYW1zLmxlbmd0aCAhPT0gMSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBTWU5UQVggRVJST1I6ICNpbi1lbGVtZW50IHJlcXVpcmVzIGEgc2luZ2xlIGFyZ3VtZW50YCk7XG4gICAgfVxuXG4gICAgYnVpbGRlci5zdGFydExhYmVscygpO1xuXG4gICAgYnVpbGRlci5wdXNoRnJhbWUoKTtcblxuICAgIGJ1aWxkZXIucmV0dXJuVG8oJ0VORCcpO1xuXG4gICAgbGV0IFsga2V5cywgdmFsdWVzIF0gPSBoYXNoITtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IGtleSA9IGtleXNbaV07XG4gICAgICBpZiAoa2V5ID09PSAnbmV4dFNpYmxpbmcnIHx8IGtleSA9PT0gJ2d1aWQnKSB7XG4gICAgICAgIGJ1aWxkZXIuZXhwcih2YWx1ZXNbaV0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBTWU5UQVggRVJST1I6ICNpbi1lbGVtZW50IGRvZXMgbm90IHRha2UgYSBcXGAke2tleXNbMF19XFxgIG9wdGlvbmApO1xuICAgICAgfVxuICAgIH1cblxuICAgIGJ1aWxkZXIuZXhwcihwYXJhbXNbMF0pO1xuXG4gICAgYnVpbGRlci5kdXAoKTtcblxuICAgIGJ1aWxkZXIuZW50ZXIoNCk7XG5cbiAgICBidWlsZGVyLmp1bXBVbmxlc3MoJ0VMU0UnKTtcblxuICAgIGJ1aWxkZXIucHVzaFJlbW90ZUVsZW1lbnQoKTtcbiAgICBidWlsZGVyLmludm9rZVN0YXRpY0Jsb2NrKHVud3JhcCh0ZW1wbGF0ZSkpO1xuICAgIGJ1aWxkZXIucG9wUmVtb3RlRWxlbWVudCgpO1xuXG4gICAgYnVpbGRlci5sYWJlbCgnRUxTRScpO1xuICAgIGJ1aWxkZXIuZXhpdCgpO1xuICAgIGJ1aWxkZXIucmV0dXJuKCk7XG5cbiAgICBidWlsZGVyLmxhYmVsKCdFTkQnKTtcbiAgICBidWlsZGVyLnBvcEZyYW1lKCk7XG5cbiAgICBidWlsZGVyLnN0b3BMYWJlbHMoKTtcbiAgfSk7XG5cbiAgYmxvY2tzLmFkZCgnLXdpdGgtZHluYW1pYy12YXJzJywgKF9wYXJhbXMsIGhhc2gsIHRlbXBsYXRlLCBfaW52ZXJzZSwgYnVpbGRlcikgPT4ge1xuICAgIGlmIChoYXNoKSB7XG4gICAgICBsZXQgW25hbWVzLCBleHByZXNzaW9uc10gPSBoYXNoO1xuXG4gICAgICBidWlsZGVyLmNvbXBpbGVQYXJhbXMoZXhwcmVzc2lvbnMpO1xuXG4gICAgICBidWlsZGVyLnB1c2hEeW5hbWljU2NvcGUoKTtcbiAgICAgIGJ1aWxkZXIuYmluZER5bmFtaWNTY29wZShuYW1lcyk7XG4gICAgICBidWlsZGVyLmludm9rZVN0YXRpY0Jsb2NrKHVud3JhcCh0ZW1wbGF0ZSkpO1xuICAgICAgYnVpbGRlci5wb3BEeW5hbWljU2NvcGUoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYnVpbGRlci5pbnZva2VTdGF0aWNCbG9jayh1bndyYXAodGVtcGxhdGUpKTtcbiAgICB9XG4gIH0pO1xuXG4gIGJsb2Nrcy5hZGQoJ2NvbXBvbmVudCcsIChfcGFyYW1zLCBoYXNoLCB0ZW1wbGF0ZSwgaW52ZXJzZSwgYnVpbGRlcikgPT4ge1xuICAgIGFzc2VydChfcGFyYW1zICYmIF9wYXJhbXMubGVuZ3RoLCAnU1lOVEFYIEVSUk9SOiAjY29tcG9uZW50IHJlcXVpcmVzIGF0IGxlYXN0IG9uZSBhcmd1bWVudCcpO1xuXG4gICAgbGV0IFtkZWZpbml0aW9uLCAuLi5wYXJhbXNdID0gX3BhcmFtcyE7XG4gICAgYnVpbGRlci5keW5hbWljQ29tcG9uZW50KGRlZmluaXRpb24sIHBhcmFtcywgaGFzaCwgdHJ1ZSwgdGVtcGxhdGUsIGludmVyc2UpO1xuICB9KTtcblxuICBpbmxpbmVzLmFkZCgnY29tcG9uZW50JywgKF9uYW1lLCBfcGFyYW1zLCBoYXNoLCBidWlsZGVyKSA9PiB7XG4gICAgYXNzZXJ0KF9wYXJhbXMgJiYgX3BhcmFtcy5sZW5ndGgsICdTWU5UQVggRVJST1I6IGNvbXBvbmVudCBoZWxwZXIgcmVxdWlyZXMgYXQgbGVhc3Qgb25lIGFyZ3VtZW50Jyk7XG5cbiAgICBsZXQgW2RlZmluaXRpb24sIC4uLnBhcmFtc10gPSBfcGFyYW1zITtcbiAgICBidWlsZGVyLmR5bmFtaWNDb21wb25lbnQoZGVmaW5pdGlvbiwgcGFyYW1zLCBoYXNoLCB0cnVlLCBudWxsLCBudWxsKTtcblxuICAgIHJldHVybiB0cnVlO1xuICB9KTtcblxuICByZXR1cm4geyBibG9ja3MsIGlubGluZXMgfTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUZW1wbGF0ZU9wdGlvbnM8U3BlY2lmaWVyPiB7XG4gIC8vIGFscmVhZHkgaW4gY29tcGlsYXRpb24gb3B0aW9uc1xuICBwcm9ncmFtOiBDb21waWxlVGltZVByb2dyYW07XG4gIG1hY3JvczogTWFjcm9zO1xuICBCdWlsZGVyOiBPcGNvZGVCdWlsZGVyQ29uc3RydWN0b3I7XG5cbiAgLy8gYSBzdWJzZXQgb2YgdGhlIHJlc29sdmVyIHcvIGEgY291cGxlIG9mIHNtYWxsIHR3ZWFrc1xuICBsb29rdXA6IENvbXBpbGVUaW1lTG9va3VwPFNwZWNpZmllcj47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29tcGlsZU9wdGlvbnM8U3BlY2lmaWVyPiBleHRlbmRzIFRlbXBsYXRlT3B0aW9uczxTcGVjaWZpZXI+IHtcbiAgYXNQYXJ0aWFsOiBib29sZWFuO1xuICByZWZlcnJlcjogU3BlY2lmaWVyO1xufVxuIl19","\nimport { debugSlice } from './debug';\nimport { statementCompiler } from './syntax';\nexport default class CompilableTemplate {\n    constructor(statements, containingLayout, options, symbolTable) {\n        this.statements = statements;\n        this.containingLayout = containingLayout;\n        this.options = options;\n        this.symbolTable = symbolTable;\n        this.compiled = null;\n        this.statementCompiler = statementCompiler();\n    }\n    static topLevel(block, options) {\n        return new CompilableTemplate(block.statements, { block, referrer: options.referrer }, options, { referrer: options.referrer, hasEval: block.hasEval, symbols: block.symbols });\n    }\n    compile() {\n        let { compiled } = this;\n        if (compiled !== null) return compiled;\n        let { options, statements, containingLayout } = this;\n        let { referrer } = containingLayout;\n        let { program, lookup, macros, asPartial, Builder } = options;\n        let builder = new Builder(program, lookup, referrer, macros, containingLayout, asPartial);\n        for (let i = 0; i < statements.length; i++) {\n            this.statementCompiler.compile(statements[i], builder);\n        }\n        let handle = builder.commit(program.heap);\n        if (false) {\n            let { heap } = program;\n            let start = heap.getaddr(handle);\n            let end = start + heap.sizeof(handle);\n            debugSlice(program, start, end);\n        }\n        return this.compiled = handle;\n    }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcGlsYWJsZS10ZW1wbGF0ZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL29wY29kZS1jb21waWxlci9saWIvY29tcGlsYWJsZS10ZW1wbGF0ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBUUEsQUFBTyxTQUFFLEFBQVUsQUFBRSxrQkFBTSxBQUFTLEFBQUM7QUFFckMsQUFBTyxTQUFrQixBQUFpQixBQUFhLHlCQUFNLEFBQVUsQUFBQztBQUl4RSxBQUFNLEFBQUMsQUFBTztBQWNaLGdCQUFvQixBQUF1QixZQUFVLEFBQThCLGtCQUFVLEFBQWtDLFNBQVMsQUFBYztBQUFsSSxhQUFVLGFBQVYsQUFBVSxBQUFhO0FBQVUsYUFBZ0IsbUJBQWhCLEFBQWdCLEFBQWM7QUFBVSxhQUFPLFVBQVAsQUFBTyxBQUEyQjtBQUFTLGFBQVcsY0FBWCxBQUFXLEFBQUc7QUFKOUksYUFBUSxXQUFxQixBQUFJLEFBQUM7QUFLeEMsQUFBSSxhQUFDLEFBQWlCLG9CQUFHLEFBQWlCLEFBQUUsQUFBQyxBQUMvQztBQUFDO0FBZkQsQUFBTSxXQUFDLEFBQVEsU0FBWSxBQUE4QixPQUFFLEFBQWtDO0FBQzNGLEFBQU0sZUFBQyxJQUFJLEFBQWtCLG1CQUMzQixBQUFLLE1BQUMsQUFBVSxZQUNoQixFQUFFLEFBQUssT0FBRSxBQUFRLFVBQUUsQUFBTyxRQUFDLEFBQVEsQUFBRSxZQUNyQyxBQUFPLFNBQ1AsRUFBRSxBQUFRLFVBQUUsQUFBTyxRQUFDLEFBQVEsVUFBRSxBQUFPLFNBQUUsQUFBSyxNQUFDLEFBQU8sU0FBRSxBQUFPLFNBQUUsQUFBSyxNQUFDLEFBQU8sQUFBRSxBQUMvRSxBQUFDLEFBQ0o7QUFBQztBQVVELEFBQU87QUFDTCxZQUFJLEVBQUUsQUFBUSxBQUFFLGFBQUcsQUFBSSxBQUFDO0FBQ3hCLEFBQUUsQUFBQyxZQUFDLEFBQVEsYUFBSyxBQUFJLEFBQUMsTUFBQyxBQUFNLE9BQUMsQUFBUSxBQUFDO0FBRXZDLFlBQUksRUFBRSxBQUFPLFNBQUUsQUFBVSxZQUFFLEFBQWdCLEFBQUUscUJBQUcsQUFBSSxBQUFDO0FBQ3JELFlBQUksRUFBRSxBQUFRLEFBQUUsYUFBRyxBQUFnQixBQUFDO0FBQ3BDLFlBQUksRUFBRSxBQUFPLFNBQUUsQUFBTSxRQUFFLEFBQU0sUUFBRSxBQUFTLFdBQUUsQUFBTyxBQUFFLFlBQUcsQUFBTyxBQUFDO0FBRTlELFlBQUksQUFBTyxVQUFHLElBQUksQUFBTyxRQUFDLEFBQU8sU0FBRSxBQUFNLFFBQUUsQUFBUSxVQUFFLEFBQU0sUUFBRSxBQUFnQixrQkFBRSxBQUFTLEFBQUMsQUFBQztBQUUxRixBQUFHLEFBQUMsYUFBQyxJQUFJLEFBQUMsSUFBRyxBQUFDLEdBQUUsQUFBQyxJQUFHLEFBQVUsV0FBQyxBQUFNLFFBQUUsQUFBQyxBQUFFLEtBQUUsQUFBQztBQUMzQyxBQUFJLGlCQUFDLEFBQWlCLGtCQUFDLEFBQU8sUUFBQyxBQUFVLFdBQUMsQUFBQyxBQUFDLElBQUUsQUFBTyxBQUFDLEFBQUMsQUFDekQ7QUFBQztBQUVELFlBQUksQUFBTSxTQUFHLEFBQU8sUUFBQyxBQUFNLE9BQUMsQUFBTyxRQUFDLEFBQUksQUFBQyxBQUFDO0FBRTFDLEFBQUUsQUFBQyxBQUFDLEFBQUssQUFBQyxtQkFBQyxBQUFDO0FBQ1YsZ0JBQUksRUFBRSxBQUFJLEFBQUUsU0FBRyxBQUFPLEFBQUM7QUFDdkIsZ0JBQUksQUFBSyxRQUFHLEFBQUksS0FBQyxBQUFPLFFBQUMsQUFBTSxBQUFDLEFBQUM7QUFDakMsZ0JBQUksQUFBRyxNQUFHLEFBQUssUUFBRyxBQUFJLEtBQUMsQUFBTSxPQUFDLEFBQU0sQUFBQyxBQUFDO0FBRXRDLEFBQVUsdUJBQUMsQUFBTyxTQUFFLEFBQUssT0FBRSxBQUFHLEFBQUMsQUFBQyxBQUNsQztBQUFDO0FBRUQsQUFBTSxBQUFDLGVBQUMsQUFBSSxLQUFDLEFBQVEsV0FBRyxBQUFNLEFBQUMsQUFBQyxBQUNsQztBQUFDLEFBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBPcHRpb24sXG4gIFN5bWJvbFRhYmxlLFxuICBQcm9ncmFtU3ltYm9sVGFibGUsXG4gIFZNSGFuZGxlXG59IGZyb20gJ0BnbGltbWVyL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgU3RhdGVtZW50LCBTZXJpYWxpemVkVGVtcGxhdGVCbG9jayB9IGZyb20gJ0BnbGltbWVyL3dpcmUtZm9ybWF0JztcbmltcG9ydCB7IERFQlVHIH0gZnJvbSAnQGdsaW1tZXIvbG9jYWwtZGVidWctZmxhZ3MnO1xuaW1wb3J0IHsgZGVidWdTbGljZSB9IGZyb20gJy4vZGVidWcnO1xuaW1wb3J0IHsgQ29tcGlsYWJsZVRlbXBsYXRlIGFzIElDb21waWxhYmxlVGVtcGxhdGUsIFBhcnNlZExheW91dCB9IGZyb20gJy4vaW50ZXJmYWNlcyc7XG5pbXBvcnQgeyBDb21waWxlT3B0aW9ucywgc3RhdGVtZW50Q29tcGlsZXIsIENvbXBpbGVycyB9IGZyb20gJy4vc3ludGF4JztcblxuZXhwb3J0IHsgSUNvbXBpbGFibGVUZW1wbGF0ZSB9O1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb21waWxhYmxlVGVtcGxhdGU8UyBleHRlbmRzIFN5bWJvbFRhYmxlLCBTcGVjaWZpZXI+IGltcGxlbWVudHMgSUNvbXBpbGFibGVUZW1wbGF0ZTxTPiB7XG4gIHN0YXRpYyB0b3BMZXZlbDxTcGVjaWZpZXI+KGJsb2NrOiBTZXJpYWxpemVkVGVtcGxhdGVCbG9jaywgb3B0aW9uczogQ29tcGlsZU9wdGlvbnM8U3BlY2lmaWVyPik6IElDb21waWxhYmxlVGVtcGxhdGU8UHJvZ3JhbVN5bWJvbFRhYmxlPiB7XG4gICAgcmV0dXJuIG5ldyBDb21waWxhYmxlVGVtcGxhdGU8UHJvZ3JhbVN5bWJvbFRhYmxlLCBTcGVjaWZpZXI+KFxuICAgICAgYmxvY2suc3RhdGVtZW50cyxcbiAgICAgIHsgYmxvY2ssIHJlZmVycmVyOiBvcHRpb25zLnJlZmVycmVyIH0sXG4gICAgICBvcHRpb25zLFxuICAgICAgeyByZWZlcnJlcjogb3B0aW9ucy5yZWZlcnJlciwgaGFzRXZhbDogYmxvY2suaGFzRXZhbCwgc3ltYm9sczogYmxvY2suc3ltYm9scyB9XG4gICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgY29tcGlsZWQ6IE9wdGlvbjxWTUhhbmRsZT4gPSBudWxsO1xuXG4gIHByaXZhdGUgc3RhdGVtZW50Q29tcGlsZXI6IENvbXBpbGVyczxTdGF0ZW1lbnQ+O1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgc3RhdGVtZW50czogU3RhdGVtZW50W10sIHByaXZhdGUgY29udGFpbmluZ0xheW91dDogUGFyc2VkTGF5b3V0LCBwcml2YXRlIG9wdGlvbnM6IENvbXBpbGVPcHRpb25zPFNwZWNpZmllcj4sIHB1YmxpYyBzeW1ib2xUYWJsZTogUykge1xuICAgIHRoaXMuc3RhdGVtZW50Q29tcGlsZXIgPSBzdGF0ZW1lbnRDb21waWxlcigpO1xuICB9XG5cbiAgY29tcGlsZSgpOiBWTUhhbmRsZSB7XG4gICAgbGV0IHsgY29tcGlsZWQgfSA9IHRoaXM7XG4gICAgaWYgKGNvbXBpbGVkICE9PSBudWxsKSByZXR1cm4gY29tcGlsZWQ7XG5cbiAgICBsZXQgeyBvcHRpb25zLCBzdGF0ZW1lbnRzLCBjb250YWluaW5nTGF5b3V0IH0gPSB0aGlzO1xuICAgIGxldCB7IHJlZmVycmVyIH0gPSBjb250YWluaW5nTGF5b3V0O1xuICAgIGxldCB7IHByb2dyYW0sIGxvb2t1cCwgbWFjcm9zLCBhc1BhcnRpYWwsIEJ1aWxkZXIgfSA9IG9wdGlvbnM7XG5cbiAgICBsZXQgYnVpbGRlciA9IG5ldyBCdWlsZGVyKHByb2dyYW0sIGxvb2t1cCwgcmVmZXJyZXIsIG1hY3JvcywgY29udGFpbmluZ0xheW91dCwgYXNQYXJ0aWFsKTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3RhdGVtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgdGhpcy5zdGF0ZW1lbnRDb21waWxlci5jb21waWxlKHN0YXRlbWVudHNbaV0sIGJ1aWxkZXIpO1xuICAgIH1cblxuICAgIGxldCBoYW5kbGUgPSBidWlsZGVyLmNvbW1pdChwcm9ncmFtLmhlYXApO1xuXG4gICAgaWYgKERFQlVHKSB7XG4gICAgICBsZXQgeyBoZWFwIH0gPSBwcm9ncmFtO1xuICAgICAgbGV0IHN0YXJ0ID0gaGVhcC5nZXRhZGRyKGhhbmRsZSk7XG4gICAgICBsZXQgZW5kID0gc3RhcnQgKyBoZWFwLnNpemVvZihoYW5kbGUpO1xuXG4gICAgICBkZWJ1Z1NsaWNlKHByb2dyYW0sIHN0YXJ0LCBlbmQpO1xuICAgIH1cblxuICAgIHJldHVybiAodGhpcy5jb21waWxlZCA9IGhhbmRsZSk7XG4gIH1cbn1cbiJdfQ==","import { Register } from '@glimmer/vm';\nimport CompilableTemplate from './compilable-template';\nimport { debugSlice } from './debug';\nimport { ATTRS_BLOCK } from './syntax';\n\nimport { EMPTY_ARRAY } from \"@glimmer/util\";\nexport class WrappedBuilder {\n    constructor(options, layout, capabilities) {\n        this.options = options;\n        this.layout = layout;\n        this.capabilities = capabilities;\n        let { block } = layout;\n        let referrer = this.referrer = layout.referrer;\n        this.symbolTable = {\n            referrer,\n            hasEval: block.hasEval,\n            symbols: block.symbols.concat([ATTRS_BLOCK])\n        };\n    }\n    compile() {\n        //========DYNAMIC\n        //        PutValue(TagExpr)\n        //        Test\n        //        JumpUnless(BODY)\n        //        OpenDynamicPrimitiveElement\n        //        DidCreateElement\n        //        ...attr statements...\n        //        FlushElement\n        // BODY:  Noop\n        //        ...body statements...\n        //        PutValue(TagExpr)\n        //        Test\n        //        JumpUnless(END)\n        //        CloseElement\n        // END:   Noop\n        //        DidRenderLayout\n        //        Exit\n        //\n        //========STATIC\n        //        OpenPrimitiveElementOpcode\n        //        DidCreateElement\n        //        ...attr statements...\n        //        FlushElement\n        //        ...body statements...\n        //        CloseElement\n        //        DidRenderLayout\n        //        Exit\n        let { options, layout, referrer } = this;\n        let { program, lookup, macros, asPartial } = options;\n        let { Builder } = options;\n        let b = new Builder(program, lookup, referrer, macros, layout, asPartial);\n        b.startLabels();\n        if (this.capabilities.dynamicTag) {\n            b.fetch(Register.s1);\n            b.getComponentTagName(Register.s0);\n            b.primitiveReference();\n            b.dup();\n            b.load(Register.s1);\n            b.jumpUnless('BODY');\n            b.fetch(Register.s1);\n            b.putComponentOperations();\n            b.openDynamicElement();\n            b.didCreateElement(Register.s0);\n            b.flushElement();\n            b.label('BODY');\n        }\n        b.invokeStaticBlock(blockFor(layout, this.options));\n        if (this.capabilities.dynamicTag) {\n            b.fetch(Register.s1);\n            b.jumpUnless('END');\n            b.closeElement();\n            b.label('END');\n            b.load(Register.s1);\n            b.stopLabels();\n        }\n        let handle = b.commit(options.program.heap);\n        if (false) {\n            let { program, program: { heap } } = options;\n            let start = heap.getaddr(handle);\n            let end = start + heap.sizeof(handle);\n            debugSlice(program, start, end);\n        }\n        return handle;\n    }\n}\nfunction blockFor(layout, options) {\n    let { block, referrer } = layout;\n    return new CompilableTemplate(block.statements, layout, options, { referrer, parameters: EMPTY_ARRAY });\n}\nexport class ComponentBuilder {\n    constructor(builder) {\n        this.builder = builder;\n    }\n    static(handle, args) {\n        let [params, hash, _default, inverse] = args;\n        let { builder } = this;\n        let { lookup } = builder;\n        if (handle !== null) {\n            let capabilities = lookup.getCapabilities(handle);\n            if (capabilities.dynamicLayout === false) {\n                let layout = lookup.getLayout(handle);\n                builder.pushComponentDefinition(handle);\n                builder.invokeStaticComponent(capabilities, layout, null, params, hash, false, _default, inverse);\n            } else {\n                builder.pushComponentDefinition(handle);\n                builder.invokeComponent(null, params, hash, false, _default, inverse);\n            }\n        }\n    }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid3JhcHBlZC1jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci9vcGNvZGUtY29tcGlsZXIvbGliL3dyYXBwZWQtY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLEFBQU8sU0FBRSxBQUFRLEFBQUUsZ0JBQU0sQUFBYSxBQUFDO0FBVXZDLE9BQU8sQUFBMkMsd0JBQU0sQUFBdUIsQUFBQztBQUNoRixBQUFPLFNBQUUsQUFBVSxBQUFFLGtCQUFNLEFBQVMsQUFBQztBQUVyQyxBQUFPLFNBQUUsQUFBVyxBQUFFLG1CQUFNLEFBQVUsQUFBQyxBQUV2QyxBQUFPLEFBQUUsQUFBSyxBQUFFLEFBQU0sQUFBNEIsQUFBQzs7QUFDbkQsQUFBTyxTQUFFLEFBQVcsQUFBRSxtQkFBTSxBQUFlLEFBQUM7QUFFNUMsQUFBTTtBQUlKLGdCQUFtQixBQUFrQyxTQUFVLEFBQStCLFFBQVUsQUFBbUM7QUFBeEgsYUFBTyxVQUFQLEFBQU8sQUFBMkI7QUFBVSxhQUFNLFNBQU4sQUFBTSxBQUF5QjtBQUFVLGFBQVksZUFBWixBQUFZLEFBQXVCO0FBQ3pJLFlBQUksRUFBRSxBQUFLLEFBQUUsVUFBRyxBQUFNLEFBQUM7QUFDdkIsWUFBSSxBQUFRLFdBQUcsQUFBSSxLQUFDLEFBQVEsV0FBRyxBQUFNLE9BQUMsQUFBUSxBQUFDO0FBRS9DLEFBQUksYUFBQyxBQUFXO0FBQ2QsQUFBUTtBQUNSLEFBQU8scUJBQUUsQUFBSyxNQUFDLEFBQU87QUFDdEIsQUFBTyxxQkFBRSxBQUFLLE1BQUMsQUFBTyxRQUFDLEFBQU0sT0FBQyxDQUFDLEFBQVcsQUFBQyxBQUFDLEFBQzdDLEFBQUMsQUFDSjtBQUxxQjtBQUtwQjtBQUVELEFBQU87QUFDTCxBQUFpQjtBQUNqQixBQUEyQjtBQUMzQixBQUFjO0FBQ2QsQUFBMEI7QUFDMUIsQUFBcUM7QUFDckMsQUFBMEI7QUFDMUIsQUFBK0I7QUFDL0IsQUFB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LFFBQUUsQUFBSSxNQUFFLEFBQUssT0FBRSxBQUFRLFVBQUUsQUFBTyxBQUFDLEFBQUMsQUFDcEc7QUFBQyxBQUFDLEFBQUksbUJBQUMsQUFBQztBQUNOLEFBQU8sd0JBQUMsQUFBdUIsd0JBQUMsQUFBTSxBQUFDLEFBQUM7QUFDeEMsQUFBTyx3QkFBQyxBQUFlLGdCQUFDLEFBQUksTUFBRSxBQUFNLFFBQUUsQUFBSSxNQUFFLEFBQUssT0FBRSxBQUFRLFVBQUUsQUFBTyxBQUFDLEFBQUMsQUFDeEU7QUFBQyxBQUNIO0FBQUMsQUFDSDtBQUFDLEFBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSZWdpc3RlciB9IGZyb20gJ0BnbGltbWVyL3ZtJztcbmltcG9ydCB7IFByb2dyYW1TeW1ib2xUYWJsZSwgQmxvY2tTeW1ib2xUYWJsZSwgVk1IYW5kbGUsIENvbXBvbmVudENhcGFiaWxpdGllcyB9IGZyb20gJ0BnbGltbWVyL2ludGVyZmFjZXMnO1xuXG5pbXBvcnQge1xuICBDb21wb25lbnRBcmdzLFxuICBDb21wb25lbnRCdWlsZGVyIGFzIElDb21wb25lbnRCdWlsZGVyLFxuICBQYXJzZWRMYXlvdXRcbn0gZnJvbSAnLi9pbnRlcmZhY2VzJztcblxuaW1wb3J0IHsgQ29tcGlsZU9wdGlvbnMgfSBmcm9tICcuL3N5bnRheCc7XG5pbXBvcnQgQ29tcGlsYWJsZVRlbXBsYXRlLCB7IElDb21waWxhYmxlVGVtcGxhdGUgfSBmcm9tICcuL2NvbXBpbGFibGUtdGVtcGxhdGUnO1xuaW1wb3J0IHsgZGVidWdTbGljZSB9IGZyb20gJy4vZGVidWcnO1xuaW1wb3J0IHsgT3Bjb2RlQnVpbGRlciB9IGZyb20gJy4vb3Bjb2RlLWJ1aWxkZXInO1xuaW1wb3J0IHsgQVRUUlNfQkxPQ0sgfSBmcm9tICcuL3N5bnRheCc7XG5cbmltcG9ydCB7IERFQlVHIH0gZnJvbSBcIkBnbGltbWVyL2xvY2FsLWRlYnVnLWZsYWdzXCI7XG5pbXBvcnQgeyBFTVBUWV9BUlJBWSB9IGZyb20gXCJAZ2xpbW1lci91dGlsXCI7XG5cbmV4cG9ydCBjbGFzcyBXcmFwcGVkQnVpbGRlcjxTcGVjaWZpZXI+IGltcGxlbWVudHMgSUNvbXBpbGFibGVUZW1wbGF0ZTxQcm9ncmFtU3ltYm9sVGFibGU+IHtcbiAgcHVibGljIHN5bWJvbFRhYmxlOiBQcm9ncmFtU3ltYm9sVGFibGU7XG4gIHByaXZhdGUgcmVmZXJyZXI6IFNwZWNpZmllcjtcblxuICBjb25zdHJ1Y3RvcihwdWJsaWMgb3B0aW9uczogQ29tcGlsZU9wdGlvbnM8U3BlY2lmaWVyPiwgcHJpdmF0ZSBsYXlvdXQ6IFBhcnNlZExheW91dDxTcGVjaWZpZXI+LCBwcml2YXRlIGNhcGFiaWxpdGllczogQ29tcG9uZW50Q2FwYWJpbGl0aWVzKSB7XG4gICAgbGV0IHsgYmxvY2sgfSA9IGxheW91dDtcbiAgICBsZXQgcmVmZXJyZXIgPSB0aGlzLnJlZmVycmVyID0gbGF5b3V0LnJlZmVycmVyO1xuXG4gICAgdGhpcy5zeW1ib2xUYWJsZSA9IHtcbiAgICAgIHJlZmVycmVyLFxuICAgICAgaGFzRXZhbDogYmxvY2suaGFzRXZhbCxcbiAgICAgIHN5bWJvbHM6IGJsb2NrLnN5bWJvbHMuY29uY2F0KFtBVFRSU19CTE9DS10pXG4gICAgfTtcbiAgfVxuXG4gIGNvbXBpbGUoKTogVk1IYW5kbGUge1xuICAgIC8vPT09PT09PT1EWU5BTUlDXG4gICAgLy8gICAgICAgIFB1dFZhbHVlKFRhZ0V4cHIpXG4gICAgLy8gICAgICAgIFRlc3RcbiAgICAvLyAgICAgICAgSnVtcFVubGVzcyhCT0RZKVxuICAgIC8vICAgICAgICBPcGVuRHluYW1pY1ByaW1pdGl2ZUVsZW1lbnRcbiAgICAvLyAgICAgICAgRGlkQ3JlYXRlRWxlbWVudFxuICAgIC8vICAgICAgICAuLi5hdHRyIHN0YXRlbWVudHMuLi5cbiAgICAvLyAgICAgICAgRmx1c2hFbGVtZW50XG4gICAgLy8gQk9EWTogIE5vb3BcbiAgICAvLyAgICAgICAgLi4uYm9keSBzdGF0ZW1lbnRzLi4uXG4gICAgLy8gICAgICAgIFB1dFZhbHVlKFRhZ0V4cHIpXG4gICAgLy8gICAgICAgIFRlc3RcbiAgICAvLyAgICAgICAgSnVtcFVubGVzcyhFTkQpXG4gICAgLy8gICAgICAgIENsb3NlRWxlbWVudFxuICAgIC8vIEVORDogICBOb29wXG4gICAgLy8gICAgICAgIERpZFJlbmRlckxheW91dFxuICAgIC8vICAgICAgICBFeGl0XG4gICAgLy9cbiAgICAvLz09PT09PT09U1RBVElDXG4gICAgLy8gICAgICAgIE9wZW5QcmltaXRpdmVFbGVtZW50T3Bjb2RlXG4gICAgLy8gICAgICAgIERpZENyZWF0ZUVsZW1lbnRcbiAgICAvLyAgICAgICAgLi4uYXR0ciBzdGF0ZW1lbnRzLi4uXG4gICAgLy8gICAgICAgIEZsdXNoRWxlbWVudFxuICAgIC8vICAgICAgICAuLi5ib2R5IHN0YXRlbWVudHMuLi5cbiAgICAvLyAgICAgICAgQ2xvc2VFbGVtZW50XG4gICAgLy8gICAgICAgIERpZFJlbmRlckxheW91dFxuICAgIC8vICAgICAgICBFeGl0XG5cbiAgICBsZXQgeyBvcHRpb25zLCBsYXlvdXQsIHJlZmVycmVyIH0gPSB0aGlzO1xuICAgIGxldCB7IHByb2dyYW0sIGxvb2t1cCwgbWFjcm9zLCBhc1BhcnRpYWwgfSA9IG9wdGlvbnM7XG4gICAgbGV0IHsgQnVpbGRlciB9ID0gb3B0aW9ucztcblxuICAgIGxldCBiID0gbmV3IEJ1aWxkZXIocHJvZ3JhbSwgbG9va3VwLCByZWZlcnJlciwgbWFjcm9zLCBsYXlvdXQsIGFzUGFydGlhbCk7XG5cbiAgICBiLnN0YXJ0TGFiZWxzKCk7XG5cbiAgICBpZiAodGhpcy5jYXBhYmlsaXRpZXMuZHluYW1pY1RhZykge1xuICAgICAgYi5mZXRjaChSZWdpc3Rlci5zMSk7XG5cbiAgICAgIGIuZ2V0Q29tcG9uZW50VGFnTmFtZShSZWdpc3Rlci5zMCk7XG4gICAgICBiLnByaW1pdGl2ZVJlZmVyZW5jZSgpO1xuXG4gICAgICBiLmR1cCgpO1xuICAgICAgYi5sb2FkKFJlZ2lzdGVyLnMxKTtcblxuICAgICAgYi5qdW1wVW5sZXNzKCdCT0RZJyk7XG5cbiAgICAgIGIuZmV0Y2goUmVnaXN0ZXIuczEpO1xuICAgICAgYi5wdXRDb21wb25lbnRPcGVyYXRpb25zKCk7XG4gICAgICBiLm9wZW5EeW5hbWljRWxlbWVudCgpO1xuICAgICAgYi5kaWRDcmVhdGVFbGVtZW50KFJlZ2lzdGVyLnMwKTtcbiAgICAgIGIuZmx1c2hFbGVtZW50KCk7XG5cbiAgICAgIGIubGFiZWwoJ0JPRFknKTtcbiAgICB9XG5cbiAgICBiLmludm9rZVN0YXRpY0Jsb2NrKGJsb2NrRm9yKGxheW91dCwgdGhpcy5vcHRpb25zKSk7XG5cbiAgICBpZiAodGhpcy5jYXBhYmlsaXRpZXMuZHluYW1pY1RhZykge1xuICAgICAgYi5mZXRjaChSZWdpc3Rlci5zMSk7XG4gICAgICBiLmp1bXBVbmxlc3MoJ0VORCcpO1xuICAgICAgYi5jbG9zZUVsZW1lbnQoKTtcblxuICAgICAgYi5sYWJlbCgnRU5EJyk7XG4gICAgICBiLmxvYWQoUmVnaXN0ZXIuczEpO1xuXG4gICAgICBiLnN0b3BMYWJlbHMoKTtcbiAgICB9XG5cbiAgICBsZXQgaGFuZGxlID0gYi5jb21taXQob3B0aW9ucy5wcm9ncmFtLmhlYXApO1xuXG4gICAgaWYgKERFQlVHKSB7XG4gICAgICBsZXQgeyBwcm9ncmFtLCBwcm9ncmFtOiB7IGhlYXAgfSB9ID0gb3B0aW9ucztcbiAgICAgIGxldCBzdGFydCA9IGhlYXAuZ2V0YWRkcihoYW5kbGUpO1xuICAgICAgbGV0IGVuZCA9IHN0YXJ0ICsgaGVhcC5zaXplb2YoaGFuZGxlKTtcbiAgICAgIGRlYnVnU2xpY2UocHJvZ3JhbSwgc3RhcnQsIGVuZCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGhhbmRsZTtcbiAgfVxufVxuXG5mdW5jdGlvbiBibG9ja0ZvcjxTcGVjaWZpZXI+KGxheW91dDogUGFyc2VkTGF5b3V0LCBvcHRpb25zOiBDb21waWxlT3B0aW9uczxTcGVjaWZpZXI+KTogQ29tcGlsYWJsZVRlbXBsYXRlPEJsb2NrU3ltYm9sVGFibGUsIFNwZWNpZmllcj4ge1xuICBsZXQgeyBibG9jaywgcmVmZXJyZXIgfSA9IGxheW91dDtcblxuICByZXR1cm4gbmV3IENvbXBpbGFibGVUZW1wbGF0ZShibG9jay5zdGF0ZW1lbnRzLCBsYXlvdXQsIG9wdGlvbnMsIHsgcmVmZXJyZXIsIHBhcmFtZXRlcnM6IEVNUFRZX0FSUkFZIH0pO1xufVxuXG5leHBvcnQgY2xhc3MgQ29tcG9uZW50QnVpbGRlcjxTcGVjaWZpZXI+IGltcGxlbWVudHMgSUNvbXBvbmVudEJ1aWxkZXIge1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGJ1aWxkZXI6IE9wY29kZUJ1aWxkZXI8U3BlY2lmaWVyPikge31cblxuICBzdGF0aWMoaGFuZGxlOiBudW1iZXIsIGFyZ3M6IENvbXBvbmVudEFyZ3MpIHtcbiAgICBsZXQgW3BhcmFtcywgaGFzaCwgX2RlZmF1bHQsIGludmVyc2VdID0gYXJncztcbiAgICBsZXQgeyBidWlsZGVyIH0gPSB0aGlzO1xuICAgIGxldCB7IGxvb2t1cCB9ID0gYnVpbGRlcjtcblxuICAgIGlmIChoYW5kbGUgIT09IG51bGwpIHtcbiAgICAgIGxldCBjYXBhYmlsaXRpZXMgPSBsb29rdXAuZ2V0Q2FwYWJpbGl0aWVzKGhhbmRsZSk7XG5cbiAgICAgIGlmIChjYXBhYmlsaXRpZXMuZHluYW1pY0xheW91dCA9PT0gZmFsc2UpIHtcbiAgICAgICAgbGV0IGxheW91dCA9IGxvb2t1cC5nZXRMYXlvdXQoaGFuZGxlKSE7XG5cbiAgICAgICAgYnVpbGRlci5wdXNoQ29tcG9uZW50RGVmaW5pdGlvbihoYW5kbGUpO1xuICAgICAgICBidWlsZGVyLmludm9rZVN0YXRpY0NvbXBvbmVudChjYXBhYmlsaXRpZXMsIGxheW91dCwgbnVsbCwgcGFyYW1zLCBoYXNoLCBmYWxzZSwgX2RlZmF1bHQsIGludmVyc2UpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYnVpbGRlci5wdXNoQ29tcG9uZW50RGVmaW5pdGlvbihoYW5kbGUpO1xuICAgICAgICBidWlsZGVyLmludm9rZUNvbXBvbmVudChudWxsLCBwYXJhbXMsIGhhc2gsIGZhbHNlLCBfZGVmYXVsdCwgaW52ZXJzZSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG4iXX0=","export const ARG_SHIFT = 8;\nconst MAX_SIZE = 0b1111111111111111;\nexport const TYPE_SIZE = 0b11111111;\nexport const TYPE_MASK = 0b0000000011111111;\nexport const OPERAND_LEN_MASK = 0b0000001100000000;\nexport class InstructionEncoder {\n    constructor(buffer) {\n        this.buffer = buffer;\n        this.typePos = 0;\n        this.size = 0;\n    }\n    encode(type, ...operands) {\n        if (type > TYPE_SIZE) {\n            throw new Error(`Opcode type over 8-bits. Got ${type}.`);\n        }\n        this.buffer.push(type | operands.length << ARG_SHIFT);\n        this.typePos = this.buffer.length - 1;\n        operands.forEach(op => {\n            if (op > MAX_SIZE) {\n                throw new Error(`Operand over 16-bits. Got ${op}.`);\n            }\n            this.buffer.push(op);\n        });\n        this.size = this.buffer.length;\n    }\n    compact(program) {\n        return String.fromCharCode(...program);\n    }\n    patch(position, operand) {\n        if (this.buffer[position + 1] === -1) {\n            this.buffer[position + 1] = operand;\n        } else {\n            throw new Error('Trying to patch operand in populated slot instead of a reserved slot.');\n        }\n    }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW5jb2Rlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL2VuY29kZXIvbGliL2VuY29kZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUEsQUFBTSxPQUFDLE1BQU0sQUFBUyxZQUFHLEFBQUMsQUFBQztBQUMzQixNQUFNLEFBQVEsV0FBa0IsQUFBa0IsQUFBQztBQUNuRCxBQUFNLE9BQUMsTUFBTSxBQUFTLFlBQVUsQUFBVSxBQUFDO0FBQzNDLEFBQU0sT0FBQyxNQUFNLEFBQVMsWUFBVSxBQUFrQixBQUFDO0FBQ25ELEFBQU0sT0FBQyxNQUFNLEFBQWdCLG1CQUFHLEFBQWtCLEFBQUM7QUFFbkQsQUFBTTtBQUNKLGdCQUFtQixBQUFnQjtBQUFoQixhQUFNLFNBQU4sQUFBTSxBQUFVO0FBQ25DLGFBQU8sVUFBRyxBQUFDLEFBQUM7QUFDWixhQUFJLE9BQUcsQUFBQyxBQUFDLEFBRjZCO0FBQUM7QUFHdkMsQUFBTSxXQUFDLEFBQVEsTUFBRSxHQUFHLEFBQWtCO0FBQ3BDLEFBQUUsQUFBQyxZQUFDLEFBQUksT0FBRyxBQUFTLEFBQUMsV0FBQyxBQUFDO0FBQ3JCLGtCQUFNLElBQUksQUFBSyxBQUFDLHNDQUFnQyxBQUFJLElBQUcsQUFBQyxBQUFDLEFBQzNEO0FBQUM7QUFFRCxBQUFJLGFBQUMsQUFBTSxPQUFDLEFBQUksQUFBQyxLQUFDLEFBQUksQUFBRyxPQUFDLEFBQVEsU0FBQyxBQUFNLFVBQUksQUFBUyxBQUFDLEFBQUMsQUFBQyxBQUFDO0FBRTFELEFBQUksYUFBQyxBQUFPLFVBQUcsQUFBSSxLQUFDLEFBQU0sT0FBQyxBQUFNLFNBQUcsQUFBQyxBQUFDO0FBRXRDLEFBQVEsaUJBQUMsQUFBTyxRQUFDLEFBQUU7QUFDakIsQUFBRSxBQUFDLGdCQUFDLEFBQUUsS0FBRyxBQUFRLEFBQUMsVUFBQyxBQUFDO0FBQ2xCLHNCQUFNLElBQUksQUFBSyxBQUFDLG1DQUE2QixBQUFFLEVBQUcsQUFBQyxBQUFDLEFBQ3REO0FBQUM7QUFDRCxBQUFJLGlCQUFDLEFBQU0sT0FBQyxBQUFJLEtBQUMsQUFBRSxBQUFDLEFBQUMsQUFDdkI7QUFBQyxBQUFDLEFBQUM7QUFFSCxBQUFJLGFBQUMsQUFBSSxPQUFHLEFBQUksS0FBQyxBQUFNLE9BQUMsQUFBTSxBQUFDLEFBQ2pDO0FBQUM7QUFFRCxBQUFPLFlBQUMsQUFBaUI7QUFDdkIsQUFBTSxlQUFDLEFBQU0sT0FBQyxBQUFZLGFBQUMsR0FBRyxBQUFPLEFBQUMsQUFBQyxBQUN6QztBQUFDO0FBRUQsQUFBSyxVQUFDLEFBQWdCLFVBQUUsQUFBZTtBQUNyQyxBQUFFLEFBQUMsWUFBQyxBQUFJLEtBQUMsQUFBTSxPQUFDLEFBQVEsV0FBRyxBQUFDLEFBQUMsT0FBSyxDQUFDLEFBQUMsQUFBQyxHQUFDLEFBQUM7QUFDckMsQUFBSSxpQkFBQyxBQUFNLE9BQUMsQUFBUSxXQUFHLEFBQUMsQUFBQyxLQUFHLEFBQU8sQUFBQyxBQUN0QztBQUFDLEFBQUMsQUFBSSxlQUFDLEFBQUM7QUFDTixrQkFBTSxJQUFJLEFBQUssTUFBQyxBQUF1RSxBQUFDLEFBQUMsQUFDM0Y7QUFBQyxBQUNIO0FBQUMsQUFDRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE9wIH0gZnJvbSBcIkBnbGltbWVyL3ZtXCI7XG5cbmV4cG9ydCBjb25zdCBBUkdfU0hJRlQgPSA4O1xuY29uc3QgTUFYX1NJWkUgICAgICAgICAgICAgICAgPSAwYjExMTExMTExMTExMTExMTE7XG5leHBvcnQgY29uc3QgVFlQRV9TSVpFICAgICAgICA9IDBiMTExMTExMTE7XG5leHBvcnQgY29uc3QgVFlQRV9NQVNLICAgICAgICA9IDBiMDAwMDAwMDAxMTExMTExMTtcbmV4cG9ydCBjb25zdCBPUEVSQU5EX0xFTl9NQVNLID0gMGIwMDAwMDAxMTAwMDAwMDAwO1xuXG5leHBvcnQgY2xhc3MgSW5zdHJ1Y3Rpb25FbmNvZGVyIHtcbiAgY29uc3RydWN0b3IocHVibGljIGJ1ZmZlcjogbnVtYmVyW10pIHt9XG4gIHR5cGVQb3MgPSAwO1xuICBzaXplID0gMDtcbiAgZW5jb2RlKHR5cGU6IE9wLCAuLi5vcGVyYW5kczogbnVtYmVyW10pIHtcbiAgICBpZiAodHlwZSA+IFRZUEVfU0laRSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBPcGNvZGUgdHlwZSBvdmVyIDgtYml0cy4gR290ICR7dHlwZX0uYCk7XG4gICAgfVxuXG4gICAgdGhpcy5idWZmZXIucHVzaCgodHlwZSB8IChvcGVyYW5kcy5sZW5ndGggPDwgQVJHX1NISUZUKSkpO1xuXG4gICAgdGhpcy50eXBlUG9zID0gdGhpcy5idWZmZXIubGVuZ3RoIC0gMTtcblxuICAgIG9wZXJhbmRzLmZvckVhY2gob3AgPT4ge1xuICAgICAgaWYgKG9wID4gTUFYX1NJWkUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBPcGVyYW5kIG92ZXIgMTYtYml0cy4gR290ICR7b3B9LmApO1xuICAgICAgfVxuICAgICAgdGhpcy5idWZmZXIucHVzaChvcCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLnNpemUgPSB0aGlzLmJ1ZmZlci5sZW5ndGg7XG4gIH1cblxuICBjb21wYWN0KHByb2dyYW06IG51bWJlcltdKSB7XG4gICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoLi4ucHJvZ3JhbSk7XG4gIH1cblxuICBwYXRjaChwb3NpdGlvbjogbnVtYmVyLCBvcGVyYW5kOiBudW1iZXIpIHtcbiAgICBpZiAodGhpcy5idWZmZXJbcG9zaXRpb24gKyAxXSA9PT0gLTEpIHtcbiAgICAgIHRoaXMuYnVmZmVyW3Bvc2l0aW9uICsgMV0gPSBvcGVyYW5kO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RyeWluZyB0byBwYXRjaCBvcGVyYW5kIGluIHBvcHVsYXRlZCBzbG90IGluc3RlYWQgb2YgYSByZXNlcnZlZCBzbG90LicpO1xuICAgIH1cbiAgfVxufVxuIl19","import { dict, EMPTY_ARRAY, fillNulls, Stack, unreachable } from '@glimmer/util';\nimport { Register } from '@glimmer/vm';\nimport { ATTRS_BLOCK, expressionCompiler } from './syntax';\nimport CompilableTemplate from './compilable-template';\nimport { ComponentBuilder } from './wrapped-component';\nimport { InstructionEncoder } from \"@glimmer/encoder\";\nclass Labels {\n    constructor() {\n        this.labels = dict();\n        this.targets = [];\n    }\n    label(name, index) {\n        this.labels[name] = index;\n    }\n    target(at, Target, target) {\n        this.targets.push({ at, Target, target });\n    }\n    patch(encoder) {\n        let { targets, labels } = this;\n        for (let i = 0; i < targets.length; i++) {\n            let { at, target } = targets[i];\n            let address = labels[target] - at;\n            encoder.patch(at, address);\n        }\n    }\n}\nexport class OpcodeBuilder {\n    constructor(program, lookup, referrer, macros, containingLayout, asPartial) {\n        this.program = program;\n        this.lookup = lookup;\n        this.referrer = referrer;\n        this.macros = macros;\n        this.containingLayout = containingLayout;\n        this.asPartial = asPartial;\n        this.encoder = new InstructionEncoder([]);\n        this.labelsStack = new Stack();\n        this.isComponentAttrs = false;\n        this.component = new ComponentBuilder(this);\n        this.constants = program.constants;\n        this.expressionCompiler = expressionCompiler();\n    }\n    get pos() {\n        return this.encoder.typePos;\n    }\n    get nextPos() {\n        return this.encoder.size;\n    }\n    expr(expression) {\n        if (Array.isArray(expression)) {\n            this.expressionCompiler.compile(expression, this);\n        } else {\n            this.pushPrimitiveReference(expression);\n        }\n    }\n    upvars(count) {\n        return fillNulls(count);\n    }\n    reserve(name, size = 1) {\n        let reservedOperands = [];\n        for (let i = 0; i < size; i++) {\n            reservedOperands[i] = -1;\n        }\n        this.push(name, ...reservedOperands);\n    }\n    push(name, ...ops) {\n        let { encoder } = this;\n        encoder.encode(name, ...ops);\n    }\n    commit(heap) {\n        this.push(20 /* Return */);\n        let { buffer } = this.encoder;\n        // TODO: change the whole malloc API and do something more efficient\n        let handle = heap.malloc();\n        for (let i = 0; i < buffer.length; i++) {\n            heap.push(buffer[i]);\n        }\n        heap.finishMalloc(handle, this.containingLayout.block.symbols.length);\n        return handle;\n    }\n    setComponentAttrs(enabled) {\n        this.isComponentAttrs = enabled;\n    }\n    // args\n    pushArgs(names, flags) {\n        let serialized = this.constants.stringArray(names);\n        this.push(61 /* PushArgs */, serialized, flags);\n    }\n    // helpers\n    get labels() {\n        return this.labelsStack.current;\n    }\n    startLabels() {\n        this.labelsStack.push(new Labels());\n    }\n    stopLabels() {\n        let label = this.labelsStack.pop();\n        label.patch(this.encoder);\n    }\n    // components\n    pushComponentDefinition(handle) {\n        this.push(59 /* PushComponentDefinition */, this.constants.handle(handle));\n    }\n    pushDynamicComponentManager(referrer) {\n        this.push(60 /* PushDynamicComponentManager */, this.constants.serializable(referrer));\n    }\n    prepareArgs(state) {\n        this.push(63 /* PrepareArgs */, state);\n    }\n    createComponent(state, hasDefault, hasInverse) {\n        let flag = (hasDefault === true ? 1 : 0) | (hasInverse === true ? 1 : 0) << 1;\n        this.push(64 /* CreateComponent */, flag, state);\n    }\n    registerComponentDestructor(state) {\n        this.push(65 /* RegisterComponentDestructor */, state);\n    }\n    beginComponentTransaction() {\n        this.push(71 /* BeginComponentTransaction */);\n    }\n    commitComponentTransaction() {\n        this.push(72 /* CommitComponentTransaction */);\n    }\n    putComponentOperations() {\n        this.push(66 /* PutComponentOperations */);\n    }\n    getComponentSelf(state) {\n        this.push(67 /* GetComponentSelf */, state);\n    }\n    getComponentTagName(state) {\n        this.push(68 /* GetComponentTagName */, state);\n    }\n    getComponentLayout(state) {\n        this.push(69 /* GetComponentLayout */, state);\n    }\n    invokeComponentLayout() {\n        this.push(70 /* InvokeComponentLayout */);\n    }\n    didCreateElement(state) {\n        this.push(73 /* DidCreateElement */, state);\n    }\n    didRenderLayout(state) {\n        this.push(74 /* DidRenderLayout */, state);\n    }\n    // partial\n    invokePartial(referrer, symbols, evalInfo) {\n        let _meta = this.constants.serializable(referrer);\n        let _symbols = this.constants.stringArray(symbols);\n        let _evalInfo = this.constants.array(evalInfo);\n        this.push(75 /* InvokePartial */, _meta, _symbols, _evalInfo);\n    }\n    resolveMaybeLocal(name) {\n        this.push(76 /* ResolveMaybeLocal */, this.string(name));\n    }\n    // debugger\n    debugger(symbols, evalInfo) {\n        this.push(77 /* Debugger */, this.constants.stringArray(symbols), this.constants.array(evalInfo));\n    }\n    // content\n    dynamicContent(isTrusting) {\n        this.push(24 /* DynamicContent */, isTrusting ? 1 : 0);\n    }\n    // dom\n    text(text) {\n        this.push(22 /* Text */, this.constants.string(text));\n    }\n    openPrimitiveElement(tag) {\n        this.push(25 /* OpenElement */, this.constants.string(tag));\n    }\n    openElementWithOperations(tag) {\n        this.push(26 /* OpenElementWithOperations */, this.constants.string(tag));\n    }\n    openDynamicElement() {\n        this.push(27 /* OpenDynamicElement */);\n    }\n    flushElement() {\n        this.push(31 /* FlushElement */);\n    }\n    closeElement() {\n        this.push(32 /* CloseElement */);\n    }\n    staticAttr(_name, _namespace, _value) {\n        let name = this.constants.string(_name);\n        let namespace = _namespace ? this.constants.string(_namespace) : 0;\n        if (this.isComponentAttrs) {\n            this.pushPrimitiveReference(_value);\n            this.push(30 /* ComponentAttr */, name, 1, namespace);\n        } else {\n            let value = this.constants.string(_value);\n            this.push(28 /* StaticAttr */, name, value, namespace);\n        }\n    }\n    dynamicAttr(_name, _namespace, trusting) {\n        let name = this.constants.string(_name);\n        let namespace = _namespace ? this.constants.string(_namespace) : 0;\n        if (this.isComponentAttrs) {\n            this.push(30 /* ComponentAttr */, name, trusting === true ? 1 : 0, namespace);\n        } else {\n            this.push(29 /* DynamicAttr */, name, trusting === true ? 1 : 0, namespace);\n        }\n    }\n    comment(_comment) {\n        let comment = this.constants.string(_comment);\n        this.push(23 /* Comment */, comment);\n    }\n    modifier(specifier, params, hash) {\n        this.pushFrame();\n        this.compileArgs(params, hash, null, true);\n        this.push(33 /* Modifier */, this.constants.handle(specifier));\n        this.popFrame();\n    }\n    // lists\n    putIterator() {\n        this.push(55 /* PutIterator */);\n    }\n    enterList(start) {\n        this.reserve(53 /* EnterList */);\n        this.labels.target(this.pos, 53 /* EnterList */, start);\n    }\n    exitList() {\n        this.push(54 /* ExitList */);\n    }\n    iterate(breaks) {\n        this.reserve(56 /* Iterate */);\n        this.labels.target(this.pos, 56 /* Iterate */, breaks);\n    }\n    // expressions\n    setVariable(symbol) {\n        this.push(2 /* SetVariable */, symbol);\n    }\n    setBlock(symbol) {\n        this.push(3 /* SetBlock */, symbol);\n    }\n    getVariable(symbol) {\n        this.push(4 /* GetVariable */, symbol);\n    }\n    getProperty(key) {\n        this.push(5 /* GetProperty */, this.string(key));\n    }\n    getBlock(symbol) {\n        this.push(6 /* GetBlock */, symbol);\n    }\n    hasBlock(symbol) {\n        this.push(7 /* HasBlock */, symbol);\n    }\n    hasBlockParams(to) {\n        this.getBlock(to);\n        this.resolveBlock();\n        this.push(8 /* HasBlockParams */);\n    }\n    concat(size) {\n        this.push(9 /* Concat */, size);\n    }\n    load(register) {\n        this.push(15 /* Load */, register);\n    }\n    fetch(register) {\n        this.push(16 /* Fetch */, register);\n    }\n    dup(register = Register.sp, offset = 0) {\n        return this.push(13 /* Dup */, register, offset);\n    }\n    pop(count = 1) {\n        return this.push(14 /* Pop */, count);\n    }\n    // vm\n    pushRemoteElement() {\n        this.push(34 /* PushRemoteElement */);\n    }\n    popRemoteElement() {\n        this.push(35 /* PopRemoteElement */);\n    }\n    label(name) {\n        this.labels.label(name, this.nextPos);\n    }\n    pushRootScope(symbols, bindCallerScope) {\n        this.push(17 /* RootScope */, symbols, bindCallerScope ? 1 : 0);\n    }\n    pushChildScope() {\n        this.push(18 /* ChildScope */);\n    }\n    popScope() {\n        this.push(19 /* PopScope */);\n    }\n    returnTo(label) {\n        this.reserve(21 /* ReturnTo */);\n        this.labels.target(this.pos, 21 /* ReturnTo */, label);\n    }\n    pushDynamicScope() {\n        this.push(37 /* PushDynamicScope */);\n    }\n    popDynamicScope() {\n        this.push(38 /* PopDynamicScope */);\n    }\n    primitive(_primitive) {\n        let type = 0 /* NUMBER */;\n        let primitive;\n        switch (typeof _primitive) {\n            case 'number':\n                if (_primitive % 1 === 0) {\n                    if (_primitive > -1) {\n                        primitive = _primitive;\n                    } else {\n                        primitive = this.negative(_primitive);\n                        type = 4 /* NEGATIVE */;\n                    }\n                } else {\n                    primitive = this.float(_primitive);\n                    type = 1 /* FLOAT */;\n                }\n                break;\n            case 'string':\n                primitive = this.string(_primitive);\n                type = 2 /* STRING */;\n                break;\n            case 'boolean':\n                primitive = _primitive | 0;\n                type = 3 /* BOOLEAN_OR_VOID */;\n                break;\n            case 'object':\n                // assume null\n                primitive = 2;\n                type = 3 /* BOOLEAN_OR_VOID */;\n                break;\n            case 'undefined':\n                primitive = 3;\n                type = 3 /* BOOLEAN_OR_VOID */;\n                break;\n            default:\n                throw new Error('Invalid primitive passed to pushPrimitive');\n        }\n        this.push(11 /* Primitive */, primitive << 3 | type);\n    }\n    float(num) {\n        return this.constants.float(num);\n    }\n    negative(num) {\n        return this.constants.negative(num);\n    }\n    pushPrimitiveReference(primitive) {\n        this.primitive(primitive);\n        this.primitiveReference();\n    }\n    primitiveReference() {\n        this.push(12 /* PrimitiveReference */);\n    }\n    helper(helper, params, hash) {\n        this.pushFrame();\n        this.compileArgs(params, hash, null, true);\n        this.push(1 /* Helper */, this.constants.handle(helper));\n        this.popFrame();\n        this.fetch(Register.v0);\n    }\n    bindDynamicScope(_names) {\n        this.push(36 /* BindDynamicScope */, this.names(_names));\n    }\n    enter(args) {\n        this.push(50 /* Enter */, args);\n    }\n    exit() {\n        this.push(51 /* Exit */);\n    }\n    return() {\n        this.push(20 /* Return */);\n    }\n    pushFrame() {\n        this.push(48 /* PushFrame */);\n    }\n    popFrame() {\n        this.push(49 /* PopFrame */);\n    }\n    invokeVirtual() {\n        this.push(42 /* InvokeVirtual */);\n    }\n    invokeYield() {\n        this.push(44 /* InvokeYield */);\n    }\n    toBoolean() {\n        this.push(52 /* ToBoolean */);\n    }\n    jump(target) {\n        this.reserve(45 /* Jump */);\n        this.labels.target(this.pos, 45 /* Jump */, target);\n    }\n    jumpIf(target) {\n        this.reserve(46 /* JumpIf */);\n        this.labels.target(this.pos, 46 /* JumpIf */, target);\n    }\n    jumpUnless(target) {\n        this.reserve(47 /* JumpUnless */);\n        this.labels.target(this.pos, 47 /* JumpUnless */, target);\n    }\n    // internal helpers\n    string(_string) {\n        return this.constants.string(_string);\n    }\n    names(_names) {\n        let names = [];\n        for (let i = 0; i < _names.length; i++) {\n            let n = _names[i];\n            names[i] = this.constants.string(n);\n        }\n        return this.constants.array(names);\n    }\n    symbols(symbols) {\n        return this.constants.array(symbols);\n    }\n    // convenience methods\n    inlineBlock(block) {\n        let { parameters, statements } = block;\n        let symbolTable = { parameters, referrer: this.containingLayout.referrer };\n        let options = {\n            program: this.program,\n            macros: this.macros,\n            Builder: this.constructor,\n            lookup: this.lookup,\n            asPartial: this.asPartial,\n            referrer: this.referrer\n        };\n        return new CompilableTemplate(statements, this.containingLayout, options, symbolTable);\n    }\n    evalSymbols() {\n        let { containingLayout: { block } } = this;\n        return block.hasEval ? block.symbols : null;\n    }\n    compileParams(params) {\n        if (!params) return 0;\n        for (let i = 0; i < params.length; i++) {\n            this.expr(params[i]);\n        }\n        return params.length;\n    }\n    compileArgs(params, hash, blocks, synthetic) {\n        if (blocks) {\n            this.pushYieldableBlock(blocks.main);\n            this.pushYieldableBlock(blocks.else);\n            this.pushYieldableBlock(blocks.attrs);\n        }\n        let count = this.compileParams(params);\n        let flags = count << 4;\n        if (synthetic) flags |= 0b1000;\n        if (blocks) {\n            flags |= 0b111;\n        }\n        let names = EMPTY_ARRAY;\n        if (hash) {\n            names = hash[0];\n            let val = hash[1];\n            for (let i = 0; i < val.length; i++) {\n                this.expr(val[i]);\n            }\n        }\n        this.pushArgs(names, flags);\n    }\n    invokeStaticBlock(block, callerCount = 0) {\n        let { parameters } = block.symbolTable;\n        let calleeCount = parameters.length;\n        let count = Math.min(callerCount, calleeCount);\n        this.pushFrame();\n        if (count) {\n            this.pushChildScope();\n            for (let i = 0; i < count; i++) {\n                this.dup(Register.fp, callerCount - i);\n                this.setVariable(parameters[i]);\n            }\n        }\n        this.pushBlock(block);\n        this.resolveBlock();\n        this.invokeVirtual();\n        if (count) {\n            this.popScope();\n        }\n        this.popFrame();\n    }\n    guardedAppend(expression, trusting) {\n        this.startLabels();\n        this.pushFrame();\n        this.returnTo('END');\n        this.expr(expression);\n        this.dup();\n        this.isComponent();\n        this.enter(2);\n        this.jumpUnless('ELSE');\n        this.pushDynamicComponentManager(this.referrer);\n        this.invokeComponent(null, null, null, false, null, null);\n        this.exit();\n        this.return();\n        this.label('ELSE');\n        this.dynamicContent(trusting);\n        this.exit();\n        this.return();\n        this.label('END');\n        this.popFrame();\n        this.stopLabels();\n    }\n    yield(to, params) {\n        this.compileArgs(params, null, null, false);\n        this.getBlock(to);\n        this.resolveBlock();\n        this.invokeYield();\n        this.popScope();\n        this.popFrame();\n    }\n    invokeComponent(attrs, params, hash, synthetic, block, inverse = null, layout) {\n        this.fetch(Register.s0);\n        this.dup(Register.sp, 1);\n        this.load(Register.s0);\n        this.pushFrame();\n        let blocks = { main: block, else: inverse, attrs };\n        this.compileArgs(params, hash, blocks, synthetic);\n        this.prepareArgs(Register.s0);\n        this.beginComponentTransaction();\n        this.pushDynamicScope();\n        this.createComponent(Register.s0, block !== null, inverse !== null);\n        this.registerComponentDestructor(Register.s0);\n        this.getComponentSelf(Register.s0);\n        if (layout) {\n            this.pushSymbolTable(layout.symbolTable);\n            this.pushLayout(layout);\n            this.resolveLayout();\n        } else {\n            this.getComponentLayout(Register.s0);\n        }\n        this.invokeComponentLayout();\n        this.didRenderLayout(Register.s0);\n        this.popFrame();\n        this.popScope();\n        this.popDynamicScope();\n        this.commitComponentTransaction();\n        this.load(Register.s0);\n    }\n    invokeStaticComponent(capabilities, layout, attrs, params, hash, synthetic, block, inverse = null) {\n        let { symbolTable } = layout;\n        let bailOut = symbolTable.hasEval || capabilities.prepareArgs;\n        if (bailOut) {\n            this.invokeComponent(attrs, params, hash, synthetic, block, inverse, layout);\n            return;\n        }\n        this.fetch(Register.s0);\n        this.dup(Register.sp, 1);\n        this.load(Register.s0);\n        let { symbols } = symbolTable;\n        if (capabilities.createArgs) {\n            this.pushFrame();\n            this.compileArgs(null, hash, null, synthetic);\n        }\n        this.beginComponentTransaction();\n        this.pushDynamicScope();\n        this.createComponent(Register.s0, block !== null, inverse !== null);\n        if (capabilities.createArgs) {\n            this.popFrame();\n        }\n        this.registerComponentDestructor(Register.s0);\n        let bindings = [];\n        this.getComponentSelf(Register.s0);\n        bindings.push({ symbol: 0, isBlock: false });\n        for (let i = 0; i < symbols.length; i++) {\n            let symbol = symbols[i];\n            switch (symbol.charAt(0)) {\n                case '&':\n                    let callerBlock = null;\n                    if (symbol === '&default') {\n                        callerBlock = block;\n                    } else if (symbol === '&inverse') {\n                        callerBlock = inverse;\n                    } else if (symbol === ATTRS_BLOCK) {\n                        callerBlock = attrs;\n                    } else {\n                        throw unreachable();\n                    }\n                    if (callerBlock) {\n                        this.pushYieldableBlock(callerBlock);\n                        bindings.push({ symbol: i + 1, isBlock: true });\n                    } else {\n                        this.pushYieldableBlock(null);\n                        bindings.push({ symbol: i + 1, isBlock: true });\n                    }\n                    break;\n                case '@':\n                    if (!hash) {\n                        break;\n                    }\n                    let [keys, values] = hash;\n                    let lookupName = symbol;\n                    if (synthetic) {\n                        lookupName = symbol.slice(1);\n                    }\n                    let index = keys.indexOf(lookupName);\n                    if (index !== -1) {\n                        this.expr(values[index]);\n                        bindings.push({ symbol: i + 1, isBlock: false });\n                    }\n                    break;\n            }\n        }\n        this.pushRootScope(symbols.length + 1, !!(block || inverse || attrs));\n        for (let i = bindings.length - 1; i >= 0; i--) {\n            let { symbol, isBlock } = bindings[i];\n            if (isBlock) {\n                this.setBlock(symbol);\n            } else {\n                this.setVariable(symbol);\n            }\n        }\n        this.pushFrame();\n        this.invokeStatic(layout);\n        this.didRenderLayout(Register.s0);\n        this.popFrame();\n        this.popScope();\n        this.popDynamicScope();\n        this.commitComponentTransaction();\n        this.load(Register.s0);\n    }\n    dynamicComponent(definition, /* TODO: attrs: Option<RawInlineBlock>, */params, hash, synthetic, block, inverse = null) {\n        this.startLabels();\n        this.pushFrame();\n        this.returnTo('END');\n        this.expr(definition);\n        this.dup();\n        this.enter(2);\n        this.jumpUnless('ELSE');\n        this.pushDynamicComponentManager(this.referrer);\n        this.invokeComponent(null, params, hash, synthetic, block, inverse);\n        this.label('ELSE');\n        this.exit();\n        this.return();\n        this.label('END');\n        this.popFrame();\n        this.stopLabels();\n    }\n    isComponent() {\n        this.push(57 /* IsComponent */);\n    }\n    curryComponent(definition, /* TODO: attrs: Option<RawInlineBlock>, */params, hash, synthetic) {\n        let referrer = this.referrer;\n        this.pushFrame();\n        this.compileArgs(params, hash, null, synthetic);\n        this.expr(definition);\n        this.push(58 /* CurryComponent */, this.constants.serializable(referrer));\n        this.popFrame();\n        this.fetch(Register.v0);\n    }\n    pushSymbolTable(table) {\n        if (table) {\n            let constant = this.constants.table(table);\n            this.push(41 /* PushSymbolTable */, constant);\n        } else {\n            this.primitive(null);\n        }\n    }\n    pushBlockScope() {\n        this.push(40 /* PushBlockScope */);\n    }\n    pushYieldableBlock(block) {\n        this.pushSymbolTable(block && block.symbolTable);\n        this.pushBlockScope();\n        this.pushBlock(block);\n    }\n    template(block) {\n        if (!block) return null;\n        return this.inlineBlock(block);\n    }\n}\nexport default OpcodeBuilder;\nexport class LazyOpcodeBuilder extends OpcodeBuilder {\n    pushBlock(block) {\n        if (block) {\n            this.pushOther(block);\n        } else {\n            this.primitive(null);\n        }\n    }\n    resolveBlock() {\n        this.push(39 /* CompileBlock */);\n    }\n    pushLayout(layout) {\n        if (layout) {\n            this.pushOther(layout);\n        } else {\n            this.primitive(null);\n        }\n    }\n    resolveLayout() {\n        this.push(39 /* CompileBlock */);\n    }\n    invokeStatic(compilable) {\n        this.pushOther(compilable);\n        this.push(39 /* CompileBlock */);\n        this.push(42 /* InvokeVirtual */);\n    }\n    pushOther(value) {\n        this.push(10 /* Constant */, this.other(value));\n    }\n    other(value) {\n        return this.constants.other(value);\n    }\n}\nexport class EagerOpcodeBuilder extends OpcodeBuilder {\n    pushBlock(block) {\n        let handle = block ? block.compile() : null;\n        this.primitive(handle);\n    }\n    resolveBlock() {\n        return;\n    }\n    pushLayout(layout) {\n        if (layout) {\n            this.primitive(layout.compile());\n        } else {\n            this.primitive(null);\n        }\n    }\n    resolveLayout() {}\n    invokeStatic(compilable) {\n        let handle = compilable.compile();\n        this.push(43 /* InvokeStatic */, handle);\n    }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3Bjb2RlLWJ1aWxkZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci9vcGNvZGUtY29tcGlsZXIvbGliL29wY29kZS1idWlsZGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQWNBLEFBQU8sU0FBRSxBQUFJLE1BQUUsQUFBVyxBQUFFLEFBQU0sYUFBRSxBQUFTLFdBQUUsQUFBSyxPQUFFLEFBQVcsQUFBRSxtQkFBTSxBQUFlLEFBQUM7QUFDekYsQUFBTyxTQUFNLEFBQVEsQUFBRSxnQkFBTSxBQUFhLEFBQUM7QUFXM0MsQUFBTyxTQUNMLEFBQVcsYUFHWCxBQUFrQixBQUNuQiwwQkFBTSxBQUFVLEFBQUM7QUFFbEIsT0FBTyxBQUEyQyx3QkFBTSxBQUF1QixBQUFDO0FBRWhGLEFBQU8sU0FDTCxBQUFnQixBQUNqQix3QkFBTSxBQUFxQixBQUFDO0FBQzdCLEFBQU8sU0FBRSxBQUFrQixBQUFFLDBCQUFNLEFBQWtCLEFBQUM7QUFNdEQ7QUFBQTtBQUNFLGFBQU0sU0FBRyxBQUFJLEFBQVUsQUFBQztBQUN4QixhQUFPLFVBQWdFLEFBQUUsQUFBQyxBQWtCNUU7QUFBQztBQWhCQyxBQUFLLFVBQUMsQUFBWSxNQUFFLEFBQWE7QUFDL0IsQUFBSSxhQUFDLEFBQU0sT0FBQyxBQUFJLEFBQUMsUUFBRyxBQUFLLEFBQUMsQUFDNUI7QUFBQztBQUVELEFBQU0sV0FBQyxBQUFVLElBQUUsQUFBb0IsUUFBRSxBQUFjO0FBQ3JELEFBQUksYUFBQyxBQUFPLFFBQUMsQUFBSSxLQUFDLEVBQUUsQUFBRSxJQUFFLEFBQU0sUUFBRSxBQUFNLEFBQUUsQUFBQyxBQUFDLEFBQzVDO0FBQUM7QUFFRCxBQUFLLFVBQUMsQUFBMkI7QUFDL0IsWUFBSSxFQUFFLEFBQU8sU0FBRSxBQUFNLEFBQUUsV0FBRyxBQUFJLEFBQUM7QUFDL0IsQUFBRyxBQUFDLGFBQUMsSUFBSSxBQUFDLElBQUcsQUFBQyxHQUFFLEFBQUMs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QUFBQztBQUNOLEFBQUksaUJBQUMsQUFBUyxVQUFDLEFBQUksQUFBQyxBQUFDLEFBQ3ZCO0FBQUMsQUFDSDtBQUFDO0FBRUQsQUFBYSxvQkFBSSxDQUFDO0FBRWxCLEFBQVksaUJBQUMsQUFBNEM7QUFDdkQsWUFBSSxBQUFNLFNBQUcsQUFBVSxXQUFDLEFBQU8sQUFBRSxBQUFDO0FBQ2xDLEFBQUksYUFBQyxBQUFJLDRCQUFrQixBQUFrQyxBQUFDLEFBQUMsQUFDakU7QUFBQyxBQUNGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgT3BhcXVlLFxuICBPcHRpb24sXG4gIFByb2dyYW1TeW1ib2xUYWJsZSxcbiAgU3ltYm9sVGFibGUsXG4gIFJlY2FzdCxcbiAgVk1IYW5kbGUsXG4gIEJsb2NrU3ltYm9sVGFibGUsXG4gIENvbXBvbmVudENhcGFiaWxpdGllcyxcbiAgQ29tcGlsZVRpbWVDb25zdGFudHMsXG4gIENvbXBpbGVUaW1lUHJvZ3JhbSxcbiAgQ29tcGlsZVRpbWVMYXp5Q29uc3RhbnRzLFxuICBDb21waWxlVGltZUhlYXBcbn0gZnJvbSBcIkBnbGltbWVyL2ludGVyZmFjZXNcIjtcbmltcG9ydCB7IGRpY3QsIEVNUFRZX0FSUkFZLCBleHBlY3QsIGZpbGxOdWxscywgU3RhY2ssIHVucmVhY2hhYmxlIH0gZnJvbSAnQGdsaW1tZXIvdXRpbCc7XG5pbXBvcnQgeyBPcCwgUmVnaXN0ZXIgfSBmcm9tICdAZ2xpbW1lci92bSc7XG5pbXBvcnQgKiBhcyBXaXJlRm9ybWF0IGZyb20gJ0BnbGltbWVyL3dpcmUtZm9ybWF0JztcbmltcG9ydCB7IFNlcmlhbGl6ZWRJbmxpbmVCbG9jayB9IGZyb20gXCJAZ2xpbW1lci93aXJlLWZvcm1hdFwiO1xuaW1wb3J0IHsgUHJpbWl0aXZlVHlwZSB9IGZyb20gXCJAZ2xpbW1lci9wcm9ncmFtXCI7XG5cbmltcG9ydCB7XG4gIFByaW1pdGl2ZSxcbiAgQ29tcGlsYWJsZUJsb2NrLFxuICBQYXJzZWRMYXlvdXRcbn0gZnJvbSAnLi9pbnRlcmZhY2VzJztcblxuaW1wb3J0IHtcbiAgQVRUUlNfQkxPQ0ssXG4gIE1hY3JvcyxcbiAgQ29tcGlsZXJzLFxuICBleHByZXNzaW9uQ29tcGlsZXJcbn0gZnJvbSAnLi9zeW50YXgnO1xuXG5pbXBvcnQgQ29tcGlsYWJsZVRlbXBsYXRlLCB7IElDb21waWxhYmxlVGVtcGxhdGUgfSBmcm9tICcuL2NvbXBpbGFibGUtdGVtcGxhdGUnO1xuXG5pbXBvcnQge1xuICBDb21wb25lbnRCdWlsZGVyXG59IGZyb20gJy4vd3JhcHBlZC1jb21wb25lbnQnO1xuaW1wb3J0IHsgSW5zdHJ1Y3Rpb25FbmNvZGVyIH0gZnJvbSBcIkBnbGltbWVyL2VuY29kZXJcIjtcblxuZXhwb3J0IHR5cGUgTGFiZWwgPSBzdHJpbmc7XG5cbnR5cGUgVGFyZ2V0T3Bjb2RlID0gT3AuSnVtcCB8IE9wLkp1bXBJZiB8IE9wLkp1bXBVbmxlc3MgfCBPcC5FbnRlckxpc3QgfCBPcC5JdGVyYXRlIHwgT3AuUmV0dXJuVG87XG5cbmNsYXNzIExhYmVscyB7XG4gIGxhYmVscyA9IGRpY3Q8bnVtYmVyPigpO1xuICB0YXJnZXRzOiBBcnJheTx7IGF0OiBudW1iZXIsIFRhcmdldDogVGFyZ2V0T3Bjb2RlLCB0YXJnZXQ6IHN0cmluZyB9PiA9IFtdO1xuXG4gIGxhYmVsKG5hbWU6IHN0cmluZywgaW5kZXg6IG51bWJlcikge1xuICAgIHRoaXMubGFiZWxzW25hbWVdID0gaW5kZXg7XG4gIH1cblxuICB0YXJnZXQoYXQ6IG51bWJlciwgVGFyZ2V0OiBUYXJnZXRPcGNvZGUsIHRhcmdldDogc3RyaW5nKSB7XG4gICAgdGhpcy50YXJnZXRzLnB1c2goeyBhdCwgVGFyZ2V0LCB0YXJnZXQgfSk7XG4gIH1cblxuICBwYXRjaChlbmNvZGVyOiBJbnN0cnVjdGlvbkVuY29kZXIpOiB2b2lkIHtcbiAgICBsZXQgeyB0YXJnZXRzLCBsYWJlbHMgfSA9IHRoaXM7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0YXJnZXRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgeyBhdCwgdGFyZ2V0IH0gPSB0YXJnZXRzW2ldO1xuICAgICAgbGV0IGFkZHJlc3MgPSBsYWJlbHNbdGFyZ2V0XSAtIGF0O1xuICAgICAgZW5jb2Rlci5wYXRjaChhdCwgYWRkcmVzcyk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQWJzdHJhY3RUZW1wbGF0ZTxTIGV4dGVuZHMgU3ltYm9sVGFibGUgPSBTeW1ib2xUYWJsZT4ge1xuICBzeW1ib2xUYWJsZTogUztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDb21waWxlVGltZUxvb2t1cDxTcGVjaWZpZXI+IHtcbiAgZ2V0Q2FwYWJpbGl0aWVzKGhhbmRsZTogbnVtYmVyKTogQ29tcG9uZW50Q2FwYWJpbGl0aWVzO1xuICBnZXRMYXlvdXQoaGFuZGxlOiBudW1iZXIpOiBPcHRpb248SUNvbXBpbGFibGVUZW1wbGF0ZTxQcm9ncmFtU3ltYm9sVGFibGU+PjtcblxuICAvLyBUaGlzIGludGVyZmFjZSBwcm9kdWNlcyBzcGVjaWZpZXJzIChhbmQgaW5kaWNhdGVzIGlmIGEgbmFtZSBpcyBwcmVzZW50KSwgYnV0IGRvZXMgbm90XG4gIC8vIHByb2R1Y2UgYW55IGFjdHVhbCBvYmplY3RzLiBUaGUgbWFpbiB1c2UtY2FzZSBmb3IgcHJvZHVjaW5nIG9iamVjdHMgaXMgaGFuZGxlZCBhYm92ZSxcbiAgLy8gd2l0aCBnZXRDYXBhYmlsaXRpZXMgYW5kIGdldExheW91dCwgd2hpY2ggZHJhc3RpY2FsbHkgc2hyaW5rcyB0aGUgc2l6ZSBvZiB0aGUgb2JqZWN0XG4gIC8vIHRoYXQgdGhlIGNvcmUgaW50ZXJmYWNlIGlzIGZvcmNlZCB0byByZWlmeS5cbiAgbG9va3VwSGVscGVyKG5hbWU6IHN0cmluZywgcmVmZXJyZXI6IFNwZWNpZmllcik6IE9wdGlvbjxudW1iZXI+O1xuICBsb29rdXBNb2RpZmllcihuYW1lOiBzdHJpbmcsIHJlZmVycmVyOiBTcGVjaWZpZXIpOiBPcHRpb248bnVtYmVyPjtcbiAgbG9va3VwQ29tcG9uZW50U3BlYyhuYW1lOiBzdHJpbmcsIHJlZmVycmVyOiBTcGVjaWZpZXIpOiBPcHRpb248bnVtYmVyPjtcbiAgbG9va3VwUGFydGlhbChuYW1lOiBzdHJpbmcsIHJlZmVycmVyOiBTcGVjaWZpZXIpOiBPcHRpb248bnVtYmVyPjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBCbG9ja3Mge1xuICBtYWluOiBPcHRpb248Q29tcGlsYWJsZUJsb2NrPjtcbiAgZWxzZTogT3B0aW9uPENvbXBpbGFibGVCbG9jaz47XG4gIGF0dHJzOiBPcHRpb248Q29tcGlsYWJsZUJsb2NrPjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBPcGNvZGVCdWlsZGVyQ29uc3RydWN0b3Ige1xuICBuZXc8U3BlY2lmaWVyPihwcm9ncmFtOiBDb21waWxlVGltZVByb2dyYW0sXG4gICAgICBsb29rdXA6IENvbXBpbGVUaW1lTG9va3VwPFNwZWNpZmllcj4sXG4gICAgICBtZXRhOiBPcGFxdWUsXG4gICAgICBtYWNyb3M6IE1hY3JvcyxcbiAgICAgIGNvbnRhaW5pbmdMYXlvdXQ6IFBhcnNlZExheW91dCxcbiAgICAgIGFzUGFydGlhbDogYm9vbGVhbik6IE9wY29kZUJ1aWxkZXI8U3BlY2lmaWVyPjtcbn1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIE9wY29kZUJ1aWxkZXI8U3BlY2lmaWVyPiB7XG4gIHB1YmxpYyBjb25zdGFudHM6IENvbXBpbGVUaW1lQ29uc3RhbnRzO1xuXG4gIHByaXZhdGUgZW5jb2RlciA9IG5ldyBJbnN0cnVjdGlvbkVuY29kZXIoW10pO1xuICBwcml2YXRlIGxhYmVsc1N0YWNrID0gbmV3IFN0YWNrPExhYmVscz4oKTtcbiAgcHJpdmF0ZSBpc0NvbXBvbmVudEF0dHJzID0gZmFsc2U7XG4gIHByaXZhdGUgZXhwcmVzc2lvbkNvbXBpbGVyOiBDb21waWxlcnM8V2lyZUZvcm1hdC5UdXBsZUV4cHJlc3Npb24+O1xuICBwdWJsaWMgY29tcG9uZW50OiBDb21wb25lbnRCdWlsZGVyPFNwZWNpZmllcj4gPSBuZXcgQ29tcG9uZW50QnVpbGRlcih0aGlzKTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwdWJsaWMgcHJvZ3JhbTogQ29tcGlsZVRpbWVQcm9ncmFtLFxuICAgIHB1YmxpYyBsb29rdXA6IENvbXBpbGVUaW1lTG9va3VwPFNwZWNpZmllcj4sXG4gICAgcHVibGljIHJlZmVycmVyOiBTcGVjaWZpZXIsXG4gICAgcHVibGljIG1hY3JvczogTWFjcm9zLFxuICAgIHB1YmxpYyBjb250YWluaW5nTGF5b3V0OiBQYXJzZWRMYXlvdXQsXG4gICAgcHVibGljIGFzUGFydGlhbDogYm9vbGVhblxuICApIHtcbiAgICB0aGlzLmNvbnN0YW50cyA9IHByb2dyYW0uY29uc3RhbnRzO1xuICAgIHRoaXMuZXhwcmVzc2lvbkNvbXBpbGVyID0gZXhwcmVzc2lvbkNvbXBpbGVyKCk7XG4gIH1cblxuICBwcml2YXRlIGdldCBwb3MoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5lbmNvZGVyLnR5cGVQb3M7XG4gIH1cblxuICBwcml2YXRlIGdldCBuZXh0UG9zKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuZW5jb2Rlci5zaXplO1xuICB9XG5cbiAgZXhwcihleHByZXNzaW9uOiBXaXJlRm9ybWF0LkV4cHJlc3Npb24pIHtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShleHByZXNzaW9uKSkge1xuICAgICAgdGhpcy5leHByZXNzaW9uQ29tcGlsZXIuY29tcGlsZShleHByZXNzaW9uLCB0aGlzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5wdXNoUHJpbWl0aXZlUmVmZXJlbmNlKGV4cHJlc3Npb24pO1xuICAgIH1cbiAgfVxuXG4gIHVwdmFyczxUIGV4dGVuZHMgW09wYXF1ZV0+KGNvdW50OiBudW1iZXIpOiBUIHtcbiAgICByZXR1cm4gZmlsbE51bGxzKGNvdW50KSBhcyBUO1xuICB9XG5cbiAgcmVzZXJ2ZShuYW1lOiBPcCwgc2l6ZSA9IDEpIHtcbiAgICBsZXQgcmVzZXJ2ZWRPcGVyYW5kcyA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2l6ZTsgaSsrKSB7XG4gICAgICByZXNlcnZlZE9wZXJhbmRzW2ldID0gLTE7XG4gICAgfVxuXG4gICAgdGhpcy5wdXNoKG5hbWUsIC4uLnJlc2VydmVkT3BlcmFuZHMpO1xuICB9XG5cbiAgcHVzaChuYW1lOiBPcCwgLi4ub3BzOiBudW1iZXJbXSkge1xuICAgIGxldCB7IGVuY29kZXIgfSA9IHRoaXM7XG4gICAgZW5jb2Rlci5lbmNvZGUobmFtZSwgLi4ub3BzKTtcbiAgfVxuXG4gIGNvbW1pdChoZWFwOiBDb21waWxlVGltZUhlYXApOiBWTUhhbmRsZSB7XG4gICAgdGhpcy5wdXNoKE9wLlJldHVybik7XG5cbiAgICBsZXQgeyBidWZmZXIgfSA9IHRoaXMuZW5jb2RlcjtcblxuICAgIC8vIFRPRE86IGNoYW5nZSB0aGUgd2hvbGUgbWFsbG9jIEFQSSBhbmQgZG8gc29tZXRoaW5nIG1vcmUgZWZmaWNpZW50XG4gICAgbGV0IGhhbmRsZSA9IGhlYXAubWFsbG9jKCk7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJ1ZmZlci5sZW5ndGg7IGkrKykge1xuICAgICAgaGVhcC5wdXNoKGJ1ZmZlcltpXSk7XG4gICAgfVxuXG4gICAgaGVhcC5maW5pc2hNYWxsb2MoaGFuZGxlLCB0aGlzLmNvbnRhaW5pbmdMYXlvdXQuYmxvY2suc3ltYm9scy5sZW5ndGgpO1xuXG4gICAgcmV0dXJuIGhhbmRsZTtcbiAgfVxuXG4gIHNldENvbXBvbmVudEF0dHJzKGVuYWJsZWQ6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICB0aGlzLmlzQ29tcG9uZW50QXR0cnMgPSBlbmFibGVkO1xuICB9XG5cbiAgLy8gYXJnc1xuXG4gIHB1c2hBcmdzKG5hbWVzOiBzdHJpbmdbXSwgZmxhZ3M6IG51bWJlcikge1xuICAgIGxldCBzZXJpYWxpemVkID0gdGhpcy5jb25zdGFudHMuc3RyaW5nQXJyYXkobmFtZXMpO1xuICAgIHRoaXMucHVzaChPcC5QdXNoQXJncywgc2VyaWFsaXplZCwgZmxhZ3MpO1xuICB9XG5cbiAgLy8gaGVscGVyc1xuXG4gIHByaXZhdGUgZ2V0IGxhYmVscygpOiBMYWJlbHMge1xuICAgIHJldHVybiBleHBlY3QodGhpcy5sYWJlbHNTdGFjay5jdXJyZW50LCAnYnVnOiBub3QgaW4gYSBsYWJlbCBzdGFjaycpO1xuICB9XG5cbiAgc3RhcnRMYWJlbHMoKSB7XG4gICAgdGhpcy5sYWJlbHNTdGFjay5wdXNoKG5ldyBMYWJlbHMoKSk7XG4gIH1cblxuICBzdG9wTGFiZWxzKCkge1xuICAgIGxldCBsYWJlbCA9IGV4cGVjdCh0aGlzLmxhYmVsc1N0YWNrLnBvcCgpLCAndW5iYWxhbmNlZCBwdXNoIGFuZCBwb3AgbGFiZWxzJyk7XG4gICAgbGFiZWwucGF0Y2godGhpcy5lbmNvZGVyKTtcbiAgfVxuXG4gIC8vIGNvbXBvbmVudHNcblxuICBwdXNoQ29tcG9uZW50RGVmaW5pdGlvbihoYW5kbGU6IG51bWJlcikge1xuICAgIHRoaXMucHVzaChPcC5QdXNoQ29tcG9uZW50RGVmaW5pdGlvbiwgdGhpcy5jb25zdGFudHMuaGFuZGxlKGhhbmRsZSkpO1xuICB9XG5cbiAgcHVzaER5bmFtaWNDb21wb25lbnRNYW5hZ2VyKHJlZmVycmVyOiBTcGVjaWZpZXIpIHtcbiAgICB0aGlzLnB1c2goT3AuUHVzaER5bmFtaWNDb21wb25lbnRNYW5hZ2VyLCB0aGlzLmNvbnN0YW50cy5zZXJpYWxpemFibGUocmVmZXJyZXIpKTtcbiAgfVxuXG4gIHByZXBhcmVBcmdzKHN0YXRlOiBSZWdpc3Rlcikge1xuICAgIHRoaXMucHVzaChPcC5QcmVwYXJlQXJncywgc3RhdGUpO1xuICB9XG5cbiAgY3JlYXRlQ29tcG9uZW50KHN0YXRlOiBSZWdpc3RlciwgaGFzRGVmYXVsdDogYm9vbGVhbiwgaGFzSW52ZXJzZTogYm9vbGVhbikge1xuICAgIGxldCBmbGFnID0gKGhhc0RlZmF1bHQgPT09IHRydWUgPyAxIDogMCkgfCAoKGhhc0ludmVyc2UgPT09IHRydWUgPyAxIDogMCkgPDwgMSk7XG4gICAgdGhpcy5wdXNoKE9wLkNyZWF0ZUNvbXBvbmVudCwgZmxhZywgc3RhdGUpO1xuICB9XG5cbiAgcmVnaXN0ZXJDb21wb25lbnREZXN0cnVjdG9yKHN0YXRlOiBSZWdpc3Rlcikge1xuICAgIHRoaXMucHVzaChPcC5SZWdpc3RlckNvbXBvbmVudERlc3RydWN0b3IsIHN0YXRlKTtcbiAgfVxuXG4gIGJlZ2luQ29tcG9uZW50VHJhbnNhY3Rpb24oKSB7XG4gICAgdGhpcy5wdXNoKE9wLkJlZ2luQ29tcG9uZW50VHJhbnNhY3Rpb24pO1xuICB9XG5cbiAgY29tbWl0Q29tcG9uZW50VHJhbnNhY3Rpb24oKSB7XG4gICAgdGhpcy5wdXNoKE9wLkNvbW1pdENvbXBvbmVudFRyYW5zYWN0aW9uKTtcbiAgfVxuXG4gIHB1dENvbXBvbmVudE9wZXJhdGlvbnMoKSB7XG4gICAgdGhpcy5wdXNoKE9wLlB1dENvbXBvbmVudE9wZXJhdGlvbnMpO1xuICB9XG5cbiAgZ2V0Q29tcG9uZW50U2VsZihzdGF0ZTogUmVnaXN0ZXIpIHtcbiAgICB0aGlzLnB1c2goT3AuR2V0Q29tcG9uZW50U2VsZiwgc3RhdGUpO1xuICB9XG5cbiAgZ2V0Q29tcG9uZW50VGFnTmFtZShzdGF0ZTogUmVnaXN0ZXIpIHtcbiAgICB0aGlzLnB1c2goT3AuR2V0Q29tcG9uZW50VGFnTmFtZSwgc3RhdGUpO1xuICB9XG5cbiAgZ2V0Q29tcG9uZW50TGF5b3V0KHN0YXRlOiBSZWdpc3Rlcikge1xuICAgIHRoaXMucHVzaChPcC5HZXRDb21wb25lbnRMYXlvdXQsIHN0YXRlKTtcbiAgfVxuXG4gIGludm9rZUNvbXBvbmVudExheW91dCgpIHtcbiAgICB0aGlzLnB1c2goT3AuSW52b2tlQ29tcG9uZW50TGF5b3V0KTtcbiAgfVxuXG4gIGRpZENyZWF0ZUVsZW1lbnQoc3RhdGU6IFJlZ2lzdGVyKSB7XG4gICAgdGhpcy5wdXNoKE9wLkRpZENyZWF0ZUVsZW1lbnQsIHN0YXRlKTtcbiAgfVxuXG4gIGRpZFJlbmRlckxheW91dChzdGF0ZTogUmVnaXN0ZXIpIHtcbiAgICB0aGlzLnB1c2goT3AuRGlkUmVuZGVyTGF5b3V0LCBzdGF0ZSk7XG4gIH1cblxuICAvLyBwYXJ0aWFsXG5cbiAgaW52b2tlUGFydGlhbChyZWZlcnJlcjogU3BlY2lmaWVyLCBzeW1ib2xzOiBzdHJpbmdbXSwgZXZhbEluZm86IG51bWJlcltdKSB7XG4gICAgbGV0IF9tZXRhID0gdGhpcy5jb25zdGFudHMuc2VyaWFsaXphYmxlKHJlZmVycmVyKTtcbiAgICBsZXQgX3N5bWJvbHMgPSB0aGlzLmNvbnN0YW50cy5zdHJpbmdBcnJheShzeW1ib2xzKTtcbiAgICBsZXQgX2V2YWxJbmZvID0gdGhpcy5jb25zdGFudHMuYXJyYXkoZXZhbEluZm8pO1xuXG4gICAgdGhpcy5wdXNoKE9wLkludm9rZVBhcnRpYWwsIF9tZXRhLCBfc3ltYm9scywgX2V2YWxJbmZvKTtcbiAgfVxuXG4gIHJlc29sdmVNYXliZUxvY2FsKG5hbWU6IHN0cmluZykge1xuICAgIHRoaXMucHVzaChPcC5SZXNvbHZlTWF5YmVMb2NhbCwgdGhpcy5zdHJpbmcobmFtZSkpO1xuICB9XG5cbiAgLy8gZGVidWdnZXJcblxuICBkZWJ1Z2dlcihzeW1ib2xzOiBzdHJpbmdbXSwgZXZhbEluZm86IG51bWJlcltdKSB7XG4gICAgdGhpcy5wdXNoKE9wLkRlYnVnZ2VyLCB0aGlzLmNvbnN0YW50cy5zdHJpbmdBcnJheShzeW1ib2xzKSwgdGhpcy5jb25zdGFudHMuYXJyYXkoZXZhbEluZm8pKTtcbiAgfVxuXG4gIC8vIGNvbnRlbnRcblxuICBkeW5hbWljQ29udGVudChpc1RydXN0aW5nOiBib29sZWFuKSB7XG4gICAgdGhpcy5wdXNoKE9wLkR5bmFtaWNDb250ZW50LCBpc1RydXN0aW5nID8gMSA6IDApO1xuICB9XG5cbiAgLy8gZG9tXG5cbiAgdGV4dCh0ZXh0OiBzdHJpbmcpIHtcbiAgICB0aGlzLnB1c2goT3AuVGV4dCwgdGhpcy5jb25zdGFudHMuc3RyaW5nKHRleHQpKTtcbiAgfVxuXG4gIG9wZW5QcmltaXRpdmVFbGVtZW50KHRhZzogc3RyaW5nKSB7XG4gICAgdGhpcy5wdXNoKE9wLk9wZW5FbGVtZW50LCB0aGlzLmNvbnN0YW50cy5zdHJpbmcodGFnKSk7XG4gIH1cblxuICBvcGVuRWxlbWVudFdpdGhPcGVyYXRpb25zKHRhZzogc3RyaW5nKSB7XG4gICAgdGhpcy5wdXNoKE9wLk9wZW5FbGVtZW50V2l0aE9wZXJhdGlvbnMsIHRoaXMuY29uc3RhbnRzLnN0cmluZyh0YWcpKTtcbiAgfVxuXG4gIG9wZW5EeW5hbWljRWxlbWVudCgpIHtcbiAgICB0aGlzLnB1c2goT3AuT3BlbkR5bmFtaWNFbGVtZW50KTtcbiAgfVxuXG4gIGZsdXNoRWxlbWVudCgpIHtcbiAgICB0aGlzLnB1c2goT3AuRmx1c2hFbGVtZW50KTtcbiAgfVxuXG4gIGNsb3NlRWxlbWVudCgpIHtcbiAgICB0aGlzLnB1c2goT3AuQ2xvc2VFbGVtZW50KTtcbiAgfVxuXG4gIHN0YXRpY0F0dHIoX25hbWU6IHN0cmluZywgX25hbWVzcGFjZTogT3B0aW9uPHN0cmluZz4sIF92YWx1ZTogc3RyaW5nKSB7XG4gICAgbGV0IG5hbWUgPSB0aGlzLmNvbnN0YW50cy5zdHJpbmcoX25hbWUpO1xuICAgIGxldCBuYW1lc3BhY2UgPSBfbmFtZXNwYWNlID8gdGhpcy5jb25zdGFudHMuc3RyaW5nKF9uYW1lc3BhY2UpIDogMDtcblxuICAgIGlmICh0aGlzLmlzQ29tcG9uZW50QXR0cnMpIHtcbiAgICAgIHRoaXMucHVzaFByaW1pdGl2ZVJlZmVyZW5jZShfdmFsdWUpO1xuICAgICAgdGhpcy5wdXNoKE9wLkNvbXBvbmVudEF0dHIsIG5hbWUsIDEsIG5hbWVzcGFjZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCB2YWx1ZSA9IHRoaXMuY29uc3RhbnRzLnN0cmluZyhfdmFsdWUpO1xuICAgICAgdGhpcy5wdXNoKE9wLlN0YXRpY0F0dHIsIG5hbWUsIHZhbHVlLCBuYW1lc3BhY2UpO1xuICAgIH1cbiAgfVxuXG4gIGR5bmFtaWNBdHRyKF9uYW1lOiBzdHJpbmcsIF9uYW1lc3BhY2U6IE9wdGlvbjxzdHJpbmc+LCB0cnVzdGluZzogYm9vbGVhbikge1xuICAgIGxldCBuYW1lID0gdGhpcy5jb25zdGFudHMuc3RyaW5nKF9uYW1lKTtcbiAgICBsZXQgbmFtZXNwYWNlID0gX25hbWVzcGFjZSA/IHRoaXMuY29uc3RhbnRzLnN0cmluZyhfbmFtZXNwYWNlKSA6IDA7XG5cbiAgICBpZiAodGhpcy5pc0NvbXBvbmVudEF0dHJzKSB7XG4gICAgICB0aGlzLnB1c2goT3AuQ29tcG9uZW50QXR0ciwgbmFtZSwgKHRydXN0aW5nID09PSB0cnVlID8gMSA6IDApLCBuYW1lc3BhY2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnB1c2goT3AuRHluYW1pY0F0dHIsIG5hbWUsICh0cnVzdGluZyA9PT0gdHJ1ZSA/IDEgOiAwKSwgbmFtZXNwYWNlKTtcbiAgICB9XG4gIH1cblxuICBjb21tZW50KF9jb21tZW50OiBzdHJpbmcpIHtcbiAgICBsZXQgY29tbWVudCA9IHRoaXMuY29uc3RhbnRzLnN0cmluZyhfY29tbWVudCk7XG4gICAgdGhpcy5wdXNoKE9wLkNvbW1lbnQsIGNvbW1lbnQpO1xuICB9XG5cbiAgbW9kaWZpZXIoc3BlY2lmaWVyOiBTcGVjaWZpZXIsIHBhcmFtczogT3B0aW9uPFdpcmVGb3JtYXQuQ29yZS5QYXJhbXM+LCBoYXNoOiBPcHRpb248V2lyZUZvcm1hdC5Db3JlLkhhc2g+KSB7XG4gICAgdGhpcy5wdXNoRnJhbWUoKTtcbiAgICB0aGlzLmNvbXBpbGVBcmdzKHBhcmFtcywgaGFzaCwgbnVsbCwgdHJ1ZSk7XG4gICAgdGhpcy5wdXNoKE9wLk1vZGlmaWVyLCB0aGlzLmNvbnN0YW50cy5oYW5kbGUoc3BlY2lmaWVyKSk7XG4gICAgdGhpcy5wb3BGcmFtZSgpO1xuICB9XG5cbiAgLy8gbGlzdHNcblxuICBwdXRJdGVyYXRvcigpIHtcbiAgICB0aGlzLnB1c2goT3AuUHV0SXRlcmF0b3IpO1xuICB9XG5cbiAgZW50ZXJMaXN0KHN0YXJ0OiBzdHJpbmcpIHtcbiAgICB0aGlzLnJlc2VydmUoT3AuRW50ZXJMaXN0KTtcbiAgICB0aGlzLmxhYmVscy50YXJnZXQodGhpcy5wb3MsIE9wLkVudGVyTGlzdCwgc3RhcnQpO1xuICB9XG5cbiAgZXhpdExpc3QoKSB7XG4gICAgdGhpcy5wdXNoKE9wLkV4aXRMaXN0KTtcbiAgfVxuXG4gIGl0ZXJhdGUoYnJlYWtzOiBzdHJpbmcpIHtcbiAgICB0aGlzLnJlc2VydmUoT3AuSXRlcmF0ZSk7XG4gICAgdGhpcy5sYWJlbHMudGFyZ2V0KHRoaXMucG9zLCBPcC5JdGVyYXRlLCBicmVha3MpO1xuICB9XG5cbiAgLy8gZXhwcmVzc2lvbnNcblxuICBzZXRWYXJpYWJsZShzeW1ib2w6IG51bWJlcikge1xuICAgIHRoaXMucHVzaChPcC5TZXRWYXJpYWJsZSwgc3ltYm9sKTtcbiAgfVxuXG4gIHNldEJsb2NrKHN5bWJvbDogbnVtYmVyKSB7XG4gICAgdGhpcy5wdXNoKE9wLlNldEJsb2NrLCBzeW1ib2wpO1xuICB9XG5cbiAgZ2V0VmFyaWFibGUoc3ltYm9sOiBudW1iZXIpIHtcbiAgICB0aGlzLnB1c2goT3AuR2V0VmFyaWFibGUsIHN5bWJvbCk7XG4gIH1cblxuICBnZXRQcm9wZXJ0eShrZXk6IHN0cmluZykge1xuICAgIHRoaXMucHVzaChPcC5HZXRQcm9wZXJ0eSwgdGhpcy5zdHJpbmcoa2V5KSk7XG4gIH1cblxuICBnZXRCbG9jayhzeW1ib2w6IG51bWJlcikge1xuICAgIHRoaXMucHVzaChPcC5HZXRCbG9jaywgc3ltYm9sKTtcbiAgfVxuXG4gIGhhc0Jsb2NrKHN5bWJvbDogbnVtYmVyKSB7XG4gICAgdGhpcy5wdXNoKE9wLkhhc0Jsb2NrLCBzeW1ib2wpO1xuICB9XG5cbiAgaGFzQmxvY2tQYXJhbXModG86IG51bWJlcikge1xuICAgIHRoaXMuZ2V0QmxvY2sodG8pO1xuICAgIHRoaXMucmVzb2x2ZUJsb2NrKCk7XG4gICAgdGhpcy5wdXNoKE9wLkhhc0Jsb2NrUGFyYW1zKTtcbiAgfVxuXG4gIGNvbmNhdChzaXplOiBudW1iZXIpIHtcbiAgICB0aGlzLnB1c2goT3AuQ29uY2F0LCBzaXplKTtcbiAgfVxuXG4gIGxvYWQocmVnaXN0ZXI6IFJlZ2lzdGVyKSB7XG4gICAgdGhpcy5wdXNoKE9wLkxvYWQsIHJlZ2lzdGVyKTtcbiAgfVxuXG4gIGZldGNoKHJlZ2lzdGVyOiBSZWdpc3Rlcikge1xuICAgIHRoaXMucHVzaChPcC5GZXRjaCwgcmVnaXN0ZXIpO1xuICB9XG5cbiAgZHVwKHJlZ2lzdGVyID0gUmVnaXN0ZXIuc3AsIG9mZnNldCA9IDApIHtcbiAgICByZXR1cm4gdGhpcy5wdXNoKE9wLkR1cCwgcmVnaXN0ZXIsIG9mZnNldCk7XG4gIH1cblxuICBwb3AoY291bnQgPSAxKSB7XG4gICAgcmV0dXJuIHRoaXMucHVzaChPcC5Qb3AsIGNvdW50KTtcbiAgfVxuXG4gIC8vIHZtXG5cbiAgcHVzaFJlbW90ZUVsZW1lbnQoKSB7XG4gICAgdGhpcy5wdXNoKE9wLlB1c2hSZW1vdGVFbGVtZW50KTtcbiAgfVxuXG4gIHBvcFJlbW90ZUVsZW1lbnQoKSB7XG4gICAgdGhpcy5wdXNoKE9wLlBvcFJlbW90ZUVsZW1lbnQpO1xuICB9XG5cbiAgbGFiZWwobmFtZTogc3RyaW5nKSB7XG4gICAgdGhpcy5sYWJlbHMubGFiZWwobmFtZSwgdGhpcy5uZXh0UG9zKTtcbiAgfVxuXG4gIHB1c2hSb290U2NvcGUoc3ltYm9sczogbnVtYmVyLCBiaW5kQ2FsbGVyU2NvcGU6IGJvb2xlYW4pIHtcbiAgICB0aGlzLnB1c2goT3AuUm9vdFNjb3BlLCBzeW1ib2xzLCAoYmluZENhbGxlclNjb3BlID8gMSA6IDApKTtcbiAgfVxuXG4gIHB1c2hDaGlsZFNjb3BlKCkge1xuICAgIHRoaXMucHVzaChPcC5DaGlsZFNjb3BlKTtcbiAgfVxuXG4gIHBvcFNjb3BlKCkge1xuICAgIHRoaXMucHVzaChPcC5Qb3BTY29wZSk7XG4gIH1cblxuICByZXR1cm5UbyhsYWJlbDogc3RyaW5nKSB7XG4gICAgdGhpcy5yZXNlcnZlKE9wLlJldHVyblRvKTtcbiAgICB0aGlzLmxhYmVscy50YXJnZXQodGhpcy5wb3MsIE9wLlJldHVyblRvLCBsYWJlbCk7XG4gIH1cblxuICBwdXNoRHluYW1pY1Njb3BlKCkge1xuICAgIHRoaXMucHVzaChPcC5QdXNoRHluYW1pY1Njb3BlKTtcbiAgfVxuXG4gIHBvcER5bmFtaWNTY29wZSgpIHtcbiAgICB0aGlzLnB1c2goT3AuUG9wRHluYW1pY1Njb3BlKTtcbiAgfVxuXG4gIHByaW1pdGl2ZShfcHJpbWl0aXZlOiBQcmltaXRpdmUpIHtcbiAgICBsZXQgdHlwZTogUHJpbWl0aXZlVHlwZSA9IFByaW1pdGl2ZVR5cGUuTlVNQkVSO1xuICAgIGxldCBwcmltaXRpdmU6IG51bWJlcjtcbiAgICBzd2l0Y2ggKHR5cGVvZiBfcHJpbWl0aXZlKSB7XG4gICAgICBjYXNlICdudW1iZXInOlxuICAgICAgICBpZiAoX3ByaW1pdGl2ZSBhcyBudW1iZXIgJSAxID09PSAwKSB7XG4gICAgICAgICAgaWYgKF9wcmltaXRpdmUgYXMgbnVtYmVyID4gLTEpIHtcbiAgICAgICAgICAgIHByaW1pdGl2ZSA9IF9wcmltaXRpdmUgYXMgbnVtYmVyO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwcmltaXRpdmUgPSB0aGlzLm5lZ2F0aXZlKF9wcmltaXRpdmUgYXMgbnVtYmVyKTtcbiAgICAgICAgICAgIHR5cGUgPSBQcmltaXRpdmVUeXBlLk5FR0FUSVZFO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBwcmltaXRpdmUgPSB0aGlzLmZsb2F0KF9wcmltaXRpdmUgYXMgbnVtYmVyKTtcbiAgICAgICAgICB0eXBlID0gUHJpbWl0aXZlVHlwZS5GTE9BVDtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3N0cmluZyc6XG4gICAgICAgIHByaW1pdGl2ZSA9IHRoaXMuc3RyaW5nKF9wcmltaXRpdmUgYXMgc3RyaW5nKTtcbiAgICAgICAgdHlwZSA9IFByaW1pdGl2ZVR5cGUuU1RSSU5HO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2Jvb2xlYW4nOlxuICAgICAgICBwcmltaXRpdmUgPSAoX3ByaW1pdGl2ZSBhcyBhbnkpIHwgMDtcbiAgICAgICAgdHlwZSA9IFByaW1pdGl2ZVR5cGUuQk9PTEVBTl9PUl9WT0lEO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ29iamVjdCc6XG4gICAgICAgIC8vIGFzc3VtZSBudWxsXG4gICAgICAgIHByaW1pdGl2ZSA9IDI7XG4gICAgICAgIHR5cGUgPSBQcmltaXRpdmVUeXBlLkJPT0xFQU5fT1JfVk9JRDtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICd1bmRlZmluZWQnOlxuICAgICAgICBwcmltaXRpdmUgPSAzO1xuICAgICAgICB0eXBlID0gUHJpbWl0aXZlVHlwZS5CT09MRUFOX09SX1ZPSUQ7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHByaW1pdGl2ZSBwYXNzZWQgdG8gcHVzaFByaW1pdGl2ZScpO1xuICAgIH1cblxuICAgIHRoaXMucHVzaChPcC5QcmltaXRpdmUsIHByaW1pdGl2ZSA8PCAzIHwgdHlwZSk7XG4gIH1cblxuICBmbG9hdChudW06IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuY29uc3RhbnRzLmZsb2F0KG51bSk7XG4gIH1cblxuICBuZWdhdGl2ZShudW06IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuY29uc3RhbnRzLm5lZ2F0aXZlKG51bSk7XG4gIH1cblxuICBwdXNoUHJpbWl0aXZlUmVmZXJlbmNlKHByaW1pdGl2ZTogUHJpbWl0aXZlKSB7XG4gICAgdGhpcy5wcmltaXRpdmUocHJpbWl0aXZlKTtcbiAgICB0aGlzLnByaW1pdGl2ZVJlZmVyZW5jZSgpO1xuICB9XG5cbiAgcHJpbWl0aXZlUmVmZXJlbmNlKCkge1xuICAgIHRoaXMucHVzaChPcC5QcmltaXRpdmVSZWZlcmVuY2UpO1xuICB9XG5cbiAgaGVscGVyKGhlbHBlcjogU3BlY2lmaWVyLCBwYXJhbXM6IE9wdGlvbjxXaXJlRm9ybWF0LkNvcmUuUGFyYW1zPiwgaGFzaDogT3B0aW9uPFdpcmVGb3JtYXQuQ29yZS5IYXNoPikge1xuICAgIHRoaXMucHVzaEZyYW1lKCk7XG4gICAgdGhpcy5jb21waWxlQXJncyhwYXJhbXMsIGhhc2gsIG51bGwsIHRydWUpO1xuICAgIHRoaXMucHVzaChPcC5IZWxwZXIsIHRoaXMuY29uc3RhbnRzLmhhbmRsZShoZWxwZXIpKTtcbiAgICB0aGlzLnBvcEZyYW1lKCk7XG4gICAgdGhpcy5mZXRjaChSZWdpc3Rlci52MCk7XG4gIH1cblxuICBiaW5kRHluYW1pY1Njb3BlKF9uYW1lczogc3RyaW5nW10pIHtcbiAgICB0aGlzLnB1c2goT3AuQmluZER5bmFtaWNTY29wZSwgdGhpcy5uYW1lcyhfbmFtZXMpKTtcbiAgfVxuXG4gIGVudGVyKGFyZ3M6IG51bWJlcikge1xuICAgIHRoaXMucHVzaChPcC5FbnRlciwgYXJncyk7XG4gIH1cblxuICBleGl0KCkge1xuICAgIHRoaXMucHVzaChPcC5FeGl0KTtcbiAgfVxuXG4gIHJldHVybigpIHtcbiAgICB0aGlzLnB1c2goT3AuUmV0dXJuKTtcbiAgfVxuXG4gIHB1c2hGcmFtZSgpIHtcbiAgICB0aGlzLnB1c2goT3AuUHVzaEZyYW1lKTtcbiAgfVxuXG4gIHBvcEZyYW1lKCkge1xuICAgIHRoaXMucHVzaChPcC5Qb3BGcmFtZSk7XG4gIH1cblxuICBpbnZva2VWaXJ0dWFsKCk6IHZvaWQge1xuICAgIHRoaXMucHVzaChPcC5JbnZva2VWaXJ0dWFsKTtcbiAgfVxuXG4gIGludm9rZVlpZWxkKCk6IHZvaWQge1xuICAgIHRoaXMucHVzaChPcC5JbnZva2VZaWVsZCk7XG4gIH1cblxuICB0b0Jvb2xlYW4oKSB7XG4gICAgdGhpcy5wdXNoKE9wLlRvQm9vbGVhbik7XG4gIH1cblxuICBqdW1wKHRhcmdldDogc3RyaW5nKSB7XG4gICAgdGhpcy5yZXNlcnZlKE9wLkp1bXApO1xuICAgIHRoaXMubGFiZWxzLnRhcmdldCh0aGlzLnBvcywgT3AuSnVtcCwgdGFyZ2V0KTtcbiAgfVxuXG4gIGp1bXBJZih0YXJnZXQ6IHN0cmluZykge1xuICAgIHRoaXMucmVzZXJ2ZShPcC5KdW1wSWYpO1xuICAgIHRoaXMubGFiZWxzLnRhcmdldCh0aGlzLnBvcywgT3AuSnVtcElmLCB0YXJnZXQpO1xuICB9XG5cbiAganVtcFVubGVzcyh0YXJnZXQ6IHN0cmluZykge1xuICAgIHRoaXMucmVzZXJ2ZShPcC5KdW1wVW5sZXNzKTtcbiAgICB0aGlzLmxhYmVscy50YXJnZXQodGhpcy5wb3MsIE9wLkp1bXBVbmxlc3MsIHRhcmdldCk7XG4gIH1cblxuICAvLyBpbnRlcm5hbCBoZWxwZXJzXG5cbiAgc3RyaW5nKF9zdHJpbmc6IHN0cmluZyk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuY29uc3RhbnRzLnN0cmluZyhfc3RyaW5nKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBuYW1lcyhfbmFtZXM6IHN0cmluZ1tdKTogbnVtYmVyIHtcbiAgICBsZXQgbmFtZXM6IG51bWJlcltdID0gW107XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IF9uYW1lcy5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IG4gPSBfbmFtZXNbaV07XG4gICAgICBuYW1lc1tpXT0gdGhpcy5jb25zdGFudHMuc3RyaW5nKG4pO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmNvbnN0YW50cy5hcnJheShuYW1lcyk7XG4gIH1cblxuICBwcm90ZWN0ZWQgc3ltYm9scyhzeW1ib2xzOiBudW1iZXJbXSk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuY29uc3RhbnRzLmFycmF5KHN5bWJvbHMpO1xuICB9XG5cbiAgLy8gY29udmVuaWVuY2UgbWV0aG9kc1xuXG4gIGlubGluZUJsb2NrKGJsb2NrOiBTZXJpYWxpemVkSW5saW5lQmxvY2spOiBDb21waWxhYmxlQmxvY2sge1xuICAgIGxldCB7IHBhcmFtZXRlcnMsIHN0YXRlbWVudHMgfSA9IGJsb2NrO1xuICAgIGxldCBzeW1ib2xUYWJsZSA9IHsgcGFyYW1ldGVycywgcmVmZXJyZXI6IHRoaXMuY29udGFpbmluZ0xheW91dC5yZWZlcnJlciB9O1xuICAgIGxldCBvcHRpb25zID0ge1xuICAgICAgcHJvZ3JhbTogdGhpcy5wcm9ncmFtLFxuICAgICAgbWFjcm9zOiB0aGlzLm1hY3JvcyxcbiAgICAgIEJ1aWxkZXI6IHRoaXMuY29uc3RydWN0b3IgYXMgT3Bjb2RlQnVpbGRlckNvbnN0cnVjdG9yLFxuICAgICAgbG9va3VwOiB0aGlzLmxvb2t1cCxcbiAgICAgIGFzUGFydGlhbDogdGhpcy5hc1BhcnRpYWwsXG4gICAgICByZWZlcnJlcjogdGhpcy5yZWZlcnJlclxuICAgIH07XG5cbiAgICByZXR1cm4gbmV3IENvbXBpbGFibGVUZW1wbGF0ZShzdGF0ZW1lbnRzLCB0aGlzLmNvbnRhaW5pbmdMYXlvdXQsIG9wdGlvbnMsIHN5bWJvbFRhYmxlKTtcbiAgfVxuXG4gIGV2YWxTeW1ib2xzKCk6IE9wdGlvbjxzdHJpbmdbXT4ge1xuICAgIGxldCB7IGNvbnRhaW5pbmdMYXlvdXQ6IHsgYmxvY2sgfSB9ID0gdGhpcztcblxuICAgIHJldHVybiBibG9jay5oYXNFdmFsID8gYmxvY2suc3ltYm9scyA6IG51bGw7XG4gIH1cblxuICBjb21waWxlUGFyYW1zKHBhcmFtczogT3B0aW9uPFdpcmVGb3JtYXQuQ29yZS5QYXJhbXM+KSB7XG4gICAgaWYgKCFwYXJhbXMpIHJldHVybiAwO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXJhbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHRoaXMuZXhwcihwYXJhbXNbaV0pO1xuICAgIH1cblxuICAgIHJldHVybiBwYXJhbXMubGVuZ3RoO1xuICB9XG5cbiAgY29tcGlsZUFyZ3MocGFyYW1zOiBPcHRpb248V2lyZUZvcm1hdC5Db3JlLlBhcmFtcz4sIGhhc2g6IE9wdGlvbjxXaXJlRm9ybWF0LkNvcmUuSGFzaD4sIGJsb2NrczogT3B0aW9uPEJsb2Nrcz4sIHN5bnRoZXRpYzogYm9vbGVhbikge1xuICAgIGlmIChibG9ja3MpIHtcbiAgICAgIHRoaXMucHVzaFlpZWxkYWJsZUJsb2NrKGJsb2Nrcy5tYWluKTtcbiAgICAgIHRoaXMucHVzaFlpZWxkYWJsZUJsb2NrKGJsb2Nrcy5lbHNlKTtcbiAgICAgIHRoaXMucHVzaFlpZWxkYWJsZUJsb2NrKGJsb2Nrcy5hdHRycyk7XG4gICAgfVxuXG4gICAgbGV0IGNvdW50ID0gdGhpcy5jb21waWxlUGFyYW1zKHBhcmFtcyk7XG5cbiAgICBsZXQgZmxhZ3MgPSBjb3VudCA8PCA0O1xuXG4gICAgaWYgKHN5bnRoZXRpYykgZmxhZ3MgfD0gMGIxMDAwO1xuXG4gICAgaWYgKGJsb2Nrcykge1xuICAgICAgZmxhZ3MgfD0gMGIxMTE7XG4gICAgfVxuXG4gICAgbGV0IG5hbWVzOiBzdHJpbmdbXSA9IEVNUFRZX0FSUkFZO1xuXG4gICAgaWYgKGhhc2gpIHtcbiAgICAgIG5hbWVzID0gaGFzaFswXTtcbiAgICAgIGxldCB2YWwgPSBoYXNoWzFdO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2YWwubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdGhpcy5leHByKHZhbFtpXSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5wdXNoQXJncyhuYW1lcywgZmxhZ3MpO1xuICB9XG5cbiAgaW52b2tlU3RhdGljQmxvY2soYmxvY2s6IENvbXBpbGFibGVCbG9jaywgY2FsbGVyQ291bnQgPSAwKTogdm9pZCB7XG4gICAgbGV0IHsgcGFyYW1ldGVycyB9ID0gYmxvY2suc3ltYm9sVGFibGU7XG4gICAgbGV0IGNhbGxlZUNvdW50ID0gcGFyYW1ldGVycy5sZW5ndGg7XG4gICAgbGV0IGNvdW50ID0gTWF0aC5taW4oY2FsbGVyQ291bnQsIGNhbGxlZUNvdW50KTtcblxuICAgIHRoaXMucHVzaEZyYW1lKCk7XG5cbiAgICBpZiAoY291bnQpIHtcbiAgICAgIHRoaXMucHVzaENoaWxkU2NvcGUoKTtcblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7XG4gICAgICAgIHRoaXMuZHVwKFJlZ2lzdGVyLmZwLCBjYWxsZXJDb3VudCAtIGkpO1xuICAgICAgICB0aGlzLnNldFZhcmlhYmxlKHBhcmFtZXRlcnNbaV0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMucHVzaEJsb2NrKGJsb2NrKTtcbiAgICB0aGlzLnJlc29sdmVCbG9jaygpO1xuICAgIHRoaXMuaW52b2tlVmlydHVhbCgpO1xuXG4gICAgaWYgKGNvdW50KSB7XG4gICAgICB0aGlzLnBvcFNjb3BlKCk7XG4gICAgfVxuXG4gICAgdGhpcy5wb3BGcmFtZSgpO1xuICB9XG5cbiAgZ3VhcmRlZEFwcGVuZChleHByZXNzaW9uOiBXaXJlRm9ybWF0LkV4cHJlc3Npb24sIHRydXN0aW5nOiBib29sZWFuKSB7XG4gICAgdGhpcy5zdGFydExhYmVscygpO1xuXG4gICAgdGhpcy5wdXNoRnJhbWUoKTtcblxuICAgIHRoaXMucmV0dXJuVG8oJ0VORCcpO1xuXG4gICAgdGhpcy5leHByKGV4cHJlc3Npb24pO1xuXG4gICAgdGhpcy5kdXAoKTtcbiAgICB0aGlzLmlzQ29tcG9uZW50KCk7XG5cbiAgICB0aGlzLmVudGVyKDIpO1xuXG4gICAgdGhpcy5qdW1wVW5sZXNzKCdFTFNFJyk7XG5cbiAgICB0aGlzLnB1c2hEeW5hbWljQ29tcG9uZW50TWFuYWdlcih0aGlzLnJlZmVycmVyKTtcbiAgICB0aGlzLmludm9rZUNvbXBvbmVudChudWxsLCBudWxsLCBudWxsLCBmYWxzZSwgbnVsbCwgbnVsbCk7XG5cbiAgICB0aGlzLmV4aXQoKTtcblxuICAgIHRoaXMucmV0dXJuKCk7XG5cbiAgICB0aGlzLmxhYmVsKCdFTFNFJyk7XG5cbiAgICB0aGlzLmR5bmFtaWNDb250ZW50KHRydXN0aW5nKTtcblxuICAgIHRoaXMuZXhpdCgpO1xuXG4gICAgdGhpcy5yZXR1cm4oKTtcblxuICAgIHRoaXMubGFiZWwoJ0VORCcpO1xuXG4gICAgdGhpcy5wb3BGcmFtZSgpO1xuXG4gICAgdGhpcy5zdG9wTGFiZWxzKCk7XG4gIH1cblxuICB5aWVsZCh0bzogbnVtYmVyLCBwYXJhbXM6IE9wdGlvbjxXaXJlRm9ybWF0LkNvcmUuUGFyYW1zPikge1xuICAgIHRoaXMuY29tcGlsZUFyZ3MocGFyYW1zLCBudWxsLCBudWxsLCBmYWxzZSk7XG4gICAgdGhpcy5nZXRCbG9jayh0byk7XG4gICAgdGhpcy5yZXNvbHZlQmxvY2soKTtcbiAgICB0aGlzLmludm9rZVlpZWxkKCk7XG4gICAgdGhpcy5wb3BTY29wZSgpO1xuICAgIHRoaXMucG9wRnJhbWUoKTtcbiAgfVxuXG4gIGludm9rZUNvbXBvbmVudChhdHRyczogT3B0aW9uPENvbXBpbGFibGVCbG9jaz4sIHBhcmFtczogT3B0aW9uPFdpcmVGb3JtYXQuQ29yZS5QYXJhbXM+LCBoYXNoOiBXaXJlRm9ybWF0LkNvcmUuSGFzaCwgc3ludGhldGljOiBib29sZWFuLCBibG9jazogT3B0aW9uPENvbXBpbGFibGVCbG9jaz4sIGludmVyc2U6IE9wdGlvbjxDb21waWxhYmxlQmxvY2s+ID0gbnVsbCwgbGF5b3V0PzogSUNvbXBpbGFibGVUZW1wbGF0ZTxQcm9ncmFtU3ltYm9sVGFibGU+KSB7XG4gICAgdGhpcy5mZXRjaChSZWdpc3Rlci5zMCk7XG4gICAgdGhpcy5kdXAoUmVnaXN0ZXIuc3AsIDEpO1xuICAgIHRoaXMubG9hZChSZWdpc3Rlci5zMCk7XG5cbiAgICB0aGlzLnB1c2hGcmFtZSgpO1xuXG4gICAgbGV0IGJsb2NrcyA9IHsgbWFpbjogYmxvY2ssIGVsc2U6IGludmVyc2UsIGF0dHJzIH07XG5cbiAgICB0aGlzLmNvbXBpbGVBcmdzKHBhcmFtcywgaGFzaCwgYmxvY2tzLCBzeW50aGV0aWMpO1xuICAgIHRoaXMucHJlcGFyZUFyZ3MoUmVnaXN0ZXIuczApO1xuXG4gICAgdGhpcy5iZWdpbkNvbXBvbmVudFRyYW5zYWN0aW9uKCk7XG4gICAgdGhpcy5wdXNoRHluYW1pY1Njb3BlKCk7XG4gICAgdGhpcy5jcmVhdGVDb21wb25lbnQoUmVnaXN0ZXIuczAsIGJsb2NrICE9PSBudWxsLCBpbnZlcnNlICE9PSBudWxsKTtcbiAgICB0aGlzLnJlZ2lzdGVyQ29tcG9uZW50RGVzdHJ1Y3RvcihSZWdpc3Rlci5zMCk7XG5cbiAgICB0aGlzLmdldENvbXBvbmVudFNlbGYoUmVnaXN0ZXIuczApO1xuXG4gICAgaWYgKGxheW91dCkge1xuICAgICAgdGhpcy5wdXNoU3ltYm9sVGFibGUobGF5b3V0LnN5bWJvbFRhYmxlKTtcbiAgICAgIHRoaXMucHVzaExheW91dChsYXlvdXQpO1xuICAgICAgdGhpcy5yZXNvbHZlTGF5b3V0KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZ2V0Q29tcG9uZW50TGF5b3V0KFJlZ2lzdGVyLnMwKTtcbiAgICB9XG5cbiAgICB0aGlzLmludm9rZUNvbXBvbmVudExheW91dCgpO1xuICAgIHRoaXMuZGlkUmVuZGVyTGF5b3V0KFJlZ2lzdGVyLnMwKTtcbiAgICB0aGlzLnBvcEZyYW1lKCk7XG5cbiAgICB0aGlzLnBvcFNjb3BlKCk7XG4gICAgdGhpcy5wb3BEeW5hbWljU2NvcGUoKTtcbiAgICB0aGlzLmNvbW1pdENvbXBvbmVudFRyYW5zYWN0aW9uKCk7XG5cbiAgICB0aGlzLmxvYWQoUmVnaXN0ZXIuczApO1xuICB9XG5cbiAgaW52b2tlU3RhdGljQ29tcG9uZW50KGNhcGFiaWxpdGllczogQ29tcG9uZW50Q2FwYWJpbGl0aWVzLCBsYXlvdXQ6IElDb21waWxhYmxlVGVtcGxhdGU8UHJvZ3JhbVN5bWJvbFRhYmxlPiwgYXR0cnM6IE9wdGlvbjxDb21waWxhYmxlQmxvY2s+LCBwYXJhbXM6IE9wdGlvbjxXaXJlRm9ybWF0LkNvcmUuUGFyYW1zPiwgaGFzaDogV2lyZUZvcm1hdC5Db3JlLkhhc2gsIHN5bnRoZXRpYzogYm9vbGVhbiwgYmxvY2s6IE9wdGlvbjxDb21waWxhYmxlQmxvY2s+LCBpbnZlcnNlOiBPcHRpb248Q29tcGlsYWJsZUJsb2NrPiA9IG51bGwpIHtcbiAgICBsZXQgeyBzeW1ib2xUYWJsZSB9ID0gbGF5b3V0O1xuXG4gICAgbGV0IGJhaWxPdXQgPVxuICAgICAgc3ltYm9sVGFibGUuaGFzRXZhbCB8fFxuICAgICAgY2FwYWJpbGl0aWVzLnByZXBhcmVBcmdzO1xuXG4gICAgaWYgKGJhaWxPdXQpIHtcbiAgICAgIHRoaXMuaW52b2tlQ29tcG9uZW50KGF0dHJzLCBwYXJhbXMsIGhhc2gsIHN5bnRoZXRpYywgYmxvY2ssIGludmVyc2UsIGxheW91dCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5mZXRjaChSZWdpc3Rlci5zMCk7XG4gICAgdGhpcy5kdXAoUmVnaXN0ZXIuc3AsIDEpO1xuICAgIHRoaXMubG9hZChSZWdpc3Rlci5zMCk7XG5cbiAgICBsZXQgeyBzeW1ib2xzIH0gPSBzeW1ib2xUYWJsZTtcblxuICAgIGlmIChjYXBhYmlsaXRpZXMuY3JlYXRlQXJncykge1xuICAgICAgdGhpcy5wdXNoRnJhbWUoKTtcbiAgICAgIHRoaXMuY29tcGlsZUFyZ3MobnVsbCwgaGFzaCwgbnVsbCwgc3ludGhldGljKTtcbiAgICB9XG5cbiAgICB0aGlzLmJlZ2luQ29tcG9uZW50VHJhbnNhY3Rpb24oKTtcbiAgICB0aGlzLnB1c2hEeW5hbWljU2NvcGUoKTtcbiAgICB0aGlzLmNyZWF0ZUNvbXBvbmVudChSZWdpc3Rlci5zMCwgYmxvY2sgIT09IG51bGwsIGludmVyc2UgIT09IG51bGwpO1xuXG4gICAgaWYgKGNhcGFiaWxpdGllcy5jcmVhdGVBcmdzKSB7XG4gICAgICB0aGlzLnBvcEZyYW1lKCk7XG4gICAgfVxuXG4gICAgdGhpcy5yZWdpc3RlckNvbXBvbmVudERlc3RydWN0b3IoUmVnaXN0ZXIuczApO1xuXG4gICAgbGV0IGJpbmRpbmdzOiB7IHN5bWJvbDogbnVtYmVyLCBpc0Jsb2NrOiBib29sZWFuIH1bXSA9IFtdO1xuXG4gICAgdGhpcy5nZXRDb21wb25lbnRTZWxmKFJlZ2lzdGVyLnMwKTtcbiAgICBiaW5kaW5ncy5wdXNoKHsgc3ltYm9sOiAwLCBpc0Jsb2NrOiBmYWxzZSB9KTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3ltYm9scy5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IHN5bWJvbCA9IHN5bWJvbHNbaV07XG5cbiAgICAgIHN3aXRjaCAoc3ltYm9sLmNoYXJBdCgwKSkge1xuICAgICAgICBjYXNlICcmJzpcbiAgICAgICAgICBsZXQgY2FsbGVyQmxvY2s6IE9wdGlvbjxDb21waWxhYmxlQmxvY2s+ID0gbnVsbDtcblxuICAgICAgICAgIGlmIChzeW1ib2wgPT09ICcmZGVmYXVsdCcpIHtcbiAgICAgICAgICAgIGNhbGxlckJsb2NrID0gYmxvY2s7XG4gICAgICAgICAgfSBlbHNlIGlmIChzeW1ib2wgPT09ICcmaW52ZXJzZScpIHtcbiAgICAgICAgICAgIGNhbGxlckJsb2NrID0gaW52ZXJzZTtcbiAgICAgICAgICB9IGVsc2UgaWYgKHN5bWJvbCA9PT0gQVRUUlNfQkxPQ0spIHtcbiAgICAgICAgICAgIGNhbGxlckJsb2NrID0gYXR0cnM7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IHVucmVhY2hhYmxlKCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGNhbGxlckJsb2NrKSB7XG4gICAgICAgICAgICB0aGlzLnB1c2hZaWVsZGFibGVCbG9jayhjYWxsZXJCbG9jayk7XG4gICAgICAgICAgICBiaW5kaW5ncy5wdXNoKHsgc3ltYm9sOiBpICsgMSwgaXNCbG9jazogdHJ1ZSB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5wdXNoWWllbGRhYmxlQmxvY2sobnVsbCk7XG4gICAgICAgICAgICBiaW5kaW5ncy5wdXNoKHsgc3ltYm9sOiBpICsgMSwgaXNCbG9jazogdHJ1ZSB9KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdAJzpcbiAgICAgICAgICBpZiAoIWhhc2gpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGxldCBba2V5cywgdmFsdWVzXSA9IGhhc2g7XG4gICAgICAgICAgbGV0IGxvb2t1cE5hbWUgPSBzeW1ib2w7XG5cbiAgICAgICAgICBpZiAoc3ludGhldGljKSB7XG4gICAgICAgICAgICBsb29rdXBOYW1lID0gc3ltYm9sLnNsaWNlKDEpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGxldCBpbmRleCA9IGtleXMuaW5kZXhPZihsb29rdXBOYW1lKTtcblxuICAgICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICAgIHRoaXMuZXhwcih2YWx1ZXNbaW5kZXhdKTtcbiAgICAgICAgICAgIGJpbmRpbmdzLnB1c2goeyBzeW1ib2w6IGkgKyAxLCBpc0Jsb2NrOiBmYWxzZSB9KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLnB1c2hSb290U2NvcGUoc3ltYm9scy5sZW5ndGggKyAxLCAhIShibG9jayB8fCBpbnZlcnNlIHx8IGF0dHJzKSk7XG5cbiAgICBmb3IgKGxldCBpID0gYmluZGluZ3MubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIGxldCB7IHN5bWJvbCwgaXNCbG9jayB9ID0gYmluZGluZ3NbaV07XG5cbiAgICAgIGlmIChpc0Jsb2NrKSB7XG4gICAgICAgIHRoaXMuc2V0QmxvY2soc3ltYm9sKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuc2V0VmFyaWFibGUoc3ltYm9sKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLnB1c2hGcmFtZSgpO1xuXG4gICAgdGhpcy5pbnZva2VTdGF0aWMobGF5b3V0KTtcbiAgICB0aGlzLmRpZFJlbmRlckxheW91dChSZWdpc3Rlci5zMCk7XG4gICAgdGhpcy5wb3BGcmFtZSgpO1xuXG4gICAgdGhpcy5wb3BTY29wZSgpO1xuICAgIHRoaXMucG9wRHluYW1pY1Njb3BlKCk7XG4gICAgdGhpcy5jb21taXRDb21wb25lbnRUcmFuc2FjdGlvbigpO1xuXG4gICAgdGhpcy5sb2FkKFJlZ2lzdGVyLnMwKTtcbiAgfVxuXG4gIGR5bmFtaWNDb21wb25lbnQoZGVmaW5pdGlvbjogV2lyZUZvcm1hdC5FeHByZXNzaW9uLCAvKiBUT0RPOiBhdHRyczogT3B0aW9uPFJhd0lubGluZUJsb2NrPiwgKi8gcGFyYW1zOiBPcHRpb248V2lyZUZvcm1hdC5Db3JlLlBhcmFtcz4sIGhhc2g6IFdpcmVGb3JtYXQuQ29yZS5IYXNoLCBzeW50aGV0aWM6IGJvb2xlYW4sIGJsb2NrOiBPcHRpb248Q29tcGlsYWJsZUJsb2NrPiwgaW52ZXJzZTogT3B0aW9uPENvbXBpbGFibGVCbG9jaz4gPSBudWxsKSB7XG4gICAgdGhpcy5zdGFydExhYmVscygpO1xuXG4gICAgdGhpcy5wdXNoRnJhbWUoKTtcblxuICAgIHRoaXMucmV0dXJuVG8oJ0VORCcpO1xuXG4gICAgdGhpcy5leHByKGRlZmluaXRpb24pO1xuXG4gICAgdGhpcy5kdXAoKTtcblxuICAgIHRoaXMuZW50ZXIoMik7XG5cbiAgICB0aGlzLmp1bXBVbmxlc3MoJ0VMU0UnKTtcblxuICAgIHRoaXMucHVzaER5bmFtaWNDb21wb25lbnRNYW5hZ2VyKHRoaXMucmVmZXJyZXIpO1xuICAgIHRoaXMuaW52b2tlQ29tcG9uZW50KG51bGwsIHBhcmFtcywgaGFzaCwgc3ludGhldGljLCBibG9jaywgaW52ZXJzZSk7XG5cbiAgICB0aGlzLmxhYmVsKCdFTFNFJyk7XG4gICAgdGhpcy5leGl0KCk7XG4gICAgdGhpcy5yZXR1cm4oKTtcblxuICAgIHRoaXMubGFiZWwoJ0VORCcpO1xuICAgIHRoaXMucG9wRnJhbWUoKTtcblxuICAgIHRoaXMuc3RvcExhYmVscygpO1xuICB9XG5cbiAgaXNDb21wb25lbnQoKSB7XG4gICAgdGhpcy5wdXNoKE9wLklzQ29tcG9uZW50KTtcbiAgfVxuXG4gIGN1cnJ5Q29tcG9uZW50KGRlZmluaXRpb246IFdpcmVGb3JtYXQuRXhwcmVzc2lvbiwgLyogVE9ETzogYXR0cnM6IE9wdGlvbjxSYXdJbmxpbmVCbG9jaz4sICovIHBhcmFtczogT3B0aW9uPFdpcmVGb3JtYXQuQ29yZS5QYXJhbXM+LCBoYXNoOiBXaXJlRm9ybWF0LkNvcmUuSGFzaCwgc3ludGhldGljOiBib29sZWFuKSB7XG4gICAgbGV0IHJlZmVycmVyID0gdGhpcy5yZWZlcnJlcjtcblxuICAgIHRoaXMucHVzaEZyYW1lKCk7XG4gICAgdGhpcy5jb21waWxlQXJncyhwYXJhbXMsIGhhc2gsIG51bGwsIHN5bnRoZXRpYyk7XG4gICAgdGhpcy5leHByKGRlZmluaXRpb24pO1xuICAgIHRoaXMucHVzaChPcC5DdXJyeUNvbXBvbmVudCwgdGhpcy5jb25zdGFudHMuc2VyaWFsaXphYmxlKHJlZmVycmVyKSk7XG4gICAgdGhpcy5wb3BGcmFtZSgpO1xuICAgIHRoaXMuZmV0Y2goUmVnaXN0ZXIudjApO1xuICB9XG5cbiAgYWJzdHJhY3QgcHVzaEJsb2NrKGJsb2NrOiBPcHRpb248Q29tcGlsYWJsZUJsb2NrPik6IHZvaWQ7XG4gIGFic3RyYWN0IHJlc29sdmVCbG9jaygpOiB2b2lkO1xuICBhYnN0cmFjdCBwdXNoTGF5b3V0KGxheW91dDogT3B0aW9uPElDb21waWxhYmxlVGVtcGxhdGU8UHJvZ3JhbVN5bWJvbFRhYmxlPj4pOiB2b2lkO1xuICBhYnN0cmFjdCBpbnZva2VTdGF0aWMoYmxvY2s6IElDb21waWxhYmxlVGVtcGxhdGU8U3ltYm9sVGFibGU+KTogdm9pZDtcbiAgYWJzdHJhY3QgcmVzb2x2ZUxheW91dCgpOiB2b2lkO1xuXG4gIHB1c2hTeW1ib2xUYWJsZSh0YWJsZTogT3B0aW9uPFN5bWJvbFRhYmxlPik6IHZvaWQge1xuICAgIGlmICh0YWJsZSkge1xuICAgICAgbGV0IGNvbnN0YW50ID0gdGhpcy5jb25zdGFudHMudGFibGUodGFibGUpO1xuICAgICAgdGhpcy5wdXNoKE9wLlB1c2hTeW1ib2xUYWJsZSwgY29uc3RhbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnByaW1pdGl2ZShudWxsKTtcbiAgICB9XG4gIH1cblxuICBwdXNoQmxvY2tTY29wZSgpOiB2b2lkIHtcbiAgICB0aGlzLnB1c2goT3AuUHVzaEJsb2NrU2NvcGUpO1xuICB9XG5cbiAgcHVzaFlpZWxkYWJsZUJsb2NrKGJsb2NrOiBPcHRpb248Q29tcGlsYWJsZUJsb2NrPik6IHZvaWQge1xuICAgIHRoaXMucHVzaFN5bWJvbFRhYmxlKGJsb2NrICYmIGJsb2NrLnN5bWJvbFRhYmxlKTtcbiAgICB0aGlzLnB1c2hCbG9ja1Njb3BlKCk7XG4gICAgdGhpcy5wdXNoQmxvY2soYmxvY2spO1xuICB9XG5cbiAgdGVtcGxhdGUoYmxvY2s6IE9wdGlvbjxXaXJlRm9ybWF0LlNlcmlhbGl6ZWRJbmxpbmVCbG9jaz4pOiBPcHRpb248Q29tcGlsYWJsZUJsb2NrPiB7XG4gICAgaWYgKCFibG9jaykgcmV0dXJuIG51bGw7XG5cbiAgICByZXR1cm4gdGhpcy5pbmxpbmVCbG9jayhibG9jayk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgT3Bjb2RlQnVpbGRlcjtcblxuZXhwb3J0IGNsYXNzIExhenlPcGNvZGVCdWlsZGVyPFNwZWNpZmllcj4gZXh0ZW5kcyBPcGNvZGVCdWlsZGVyPFNwZWNpZmllcj4ge1xuICBwdWJsaWMgY29uc3RhbnRzOiBDb21waWxlVGltZUxhenlDb25zdGFudHM7XG5cbiAgcHVzaEJsb2NrKGJsb2NrOiBPcHRpb248Q29tcGlsYWJsZUJsb2NrPik6IHZvaWQge1xuICAgIGlmIChibG9jaykge1xuICAgICAgdGhpcy5wdXNoT3RoZXIoYmxvY2spO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnByaW1pdGl2ZShudWxsKTtcbiAgICB9XG4gIH1cblxuICByZXNvbHZlQmxvY2soKTogdm9pZCB7XG4gICAgdGhpcy5wdXNoKE9wLkNvbXBpbGVCbG9jayk7XG4gIH1cblxuICBwdXNoTGF5b3V0KGxheW91dDogT3B0aW9uPENvbXBpbGFibGVUZW1wbGF0ZTxQcm9ncmFtU3ltYm9sVGFibGUsIFNwZWNpZmllcj4+KSB7XG4gICAgaWYgKGxheW91dCkge1xuICAgICAgdGhpcy5wdXNoT3RoZXIobGF5b3V0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5wcmltaXRpdmUobnVsbCk7XG4gICAgfVxuICB9XG5cbiAgcmVzb2x2ZUxheW91dCgpOiB2b2lkIHtcbiAgICB0aGlzLnB1c2goT3AuQ29tcGlsZUJsb2NrKTtcbiAgfVxuXG4gIGludm9rZVN0YXRpYyhjb21waWxhYmxlOiBJQ29tcGlsYWJsZVRlbXBsYXRlPFN5bWJvbFRhYmxlPik6IHZvaWQge1xuICAgIHRoaXMucHVzaE90aGVyKGNvbXBpbGFibGUpO1xuICAgIHRoaXMucHVzaChPcC5Db21waWxlQmxvY2spO1xuICAgIHRoaXMucHVzaChPcC5JbnZva2VWaXJ0dWFsKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBwdXNoT3RoZXI8VD4odmFsdWU6IFQpIHtcbiAgICB0aGlzLnB1c2goT3AuQ29uc3RhbnQsIHRoaXMub3RoZXIodmFsdWUpKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBvdGhlcih2YWx1ZTogT3BhcXVlKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5jb25zdGFudHMub3RoZXIodmFsdWUpO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBFYWdlck9wY29kZUJ1aWxkZXI8U3BlY2lmaWVyPiBleHRlbmRzIE9wY29kZUJ1aWxkZXI8U3BlY2lmaWVyPiB7XG4gIHB1c2hCbG9jayhibG9jazogT3B0aW9uPElDb21waWxhYmxlVGVtcGxhdGU8QmxvY2tTeW1ib2xUYWJsZT4+KTogdm9pZCB7XG4gICAgbGV0IGhhbmRsZSA9IGJsb2NrID8gYmxvY2suY29tcGlsZSgpIGFzIFJlY2FzdDxWTUhhbmRsZSwgbnVtYmVyPiA6IG51bGw7XG4gICAgdGhpcy5wcmltaXRpdmUoaGFuZGxlKTtcbiAgfVxuXG4gIHJlc29sdmVCbG9jaygpOiB2b2lkIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBwdXNoTGF5b3V0KGxheW91dDogT3B0aW9uPENvbXBpbGFibGVUZW1wbGF0ZTxQcm9ncmFtU3ltYm9sVGFibGUsIFNwZWNpZmllcj4+KTogdm9pZCB7XG4gICAgaWYgKGxheW91dCkge1xuICAgICAgdGhpcy5wcmltaXRpdmUobGF5b3V0LmNvbXBpbGUoKSBhcyBSZWNhc3Q8Vk1IYW5kbGUsIG51bWJlcj4pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnByaW1pdGl2ZShudWxsKTtcbiAgICB9XG4gIH1cblxuICByZXNvbHZlTGF5b3V0KCkge31cblxuICBpbnZva2VTdGF0aWMoY29tcGlsYWJsZTogSUNvbXBpbGFibGVUZW1wbGF0ZTxTeW1ib2xUYWJsZT4pOiB2b2lkIHtcbiAgICBsZXQgaGFuZGxlID0gY29tcGlsYWJsZS5jb21waWxlKCk7XG4gICAgdGhpcy5wdXNoKE9wLkludm9rZVN0YXRpYywgaGFuZGxlIGFzIFJlY2FzdDxWTUhhbmRsZSwgbnVtYmVyPik7XG4gIH1cbn1cbiJdfQ==","import { dict, EMPTY_ARRAY } from '@glimmer/util';\nimport { combineTagged } from '@glimmer/reference';\nimport { CONSTANT_TAG } from '@glimmer/reference';\nimport { PrimitiveReference, UNDEFINED_REFERENCE } from '../references';\n\nexport class Arguments {\n    constructor() {\n        this.stack = null;\n        this.positional = new PositionalArguments();\n        this.named = new NamedArguments();\n        this.blocks = new BlockArguments();\n    }\n    setup(stack, names, blockNames, positionalCount, synthetic) {\n        this.stack = stack;\n        /*\n               | ... | blocks      | positional  | named |\n               | ... | b0    b1    | p0 p1 p2 p3 | n0 n1 |\n         index | ... | 4/5/6 7/8/9 | 10 11 12 13 | 14 15 |\n                       ^             ^             ^  ^\n                     bbase         pbase       nbase  sp\n        */\n        let named = this.named;\n        let namedCount = names.length;\n        let namedBase = stack.sp - namedCount + 1;\n        named.setup(stack, namedBase, namedCount, names, synthetic);\n        let positional = this.positional;\n        let positionalBase = namedBase - positionalCount;\n        positional.setup(stack, positionalBase, positionalCount);\n        let blocks = this.blocks;\n        let blocksCount = blockNames.length;\n        let blocksBase = positionalBase - blocksCount * 3;\n        blocks.setup(stack, blocksBase, blocksCount, blockNames);\n    }\n    get tag() {\n        return combineTagged([this.positional, this.named]);\n    }\n    get base() {\n        return this.blocks.base;\n    }\n    get length() {\n        return this.positional.length + this.named.length + this.blocks.length * 3;\n    }\n    at(pos) {\n        return this.positional.at(pos);\n    }\n    realloc(offset) {\n        if (offset > 0) {\n            let { positional, named, stack } = this;\n            let newBase = positional.base + offset;\n            let length = positional.length + named.length;\n            for (let i = length - 1; i >= 0; i--) {\n                stack.set(stack.get(i, positional.base), i, newBase);\n            }\n            positional.base += offset;\n            named.base += offset;\n            stack.sp += offset;\n        }\n    }\n    capture() {\n        let positional = this.positional.length === 0 ? EMPTY_POSITIONAL : this.positional.capture();\n        let named = this.named.length === 0 ? EMPTY_NAMED : this.named.capture();\n        return {\n            tag: this.tag,\n            length: this.length,\n            positional,\n            named\n        };\n    }\n    clear() {\n        let { stack, length } = this;\n        stack.pop(length);\n    }\n}\nexport class PositionalArguments {\n    constructor() {\n        this.base = 0;\n        this.length = 0;\n        this.stack = null;\n        this._tag = null;\n        this._references = null;\n    }\n    setup(stack, base, length) {\n        this.stack = stack;\n        this.base = base;\n        this.length = length;\n        if (length === 0) {\n            this._tag = CONSTANT_TAG;\n            this._references = EMPTY_ARRAY;\n        } else {\n            this._tag = null;\n            this._references = null;\n        }\n    }\n    get tag() {\n        let tag = this._tag;\n        if (!tag) {\n            tag = this._tag = combineTagged(this.references);\n        }\n        return tag;\n    }\n    at(position) {\n        let { base, length, stack } = this;\n        if (position < 0 || position >= length) {\n            return UNDEFINED_REFERENCE;\n        }\n        return stack.get(position, base);\n    }\n    capture() {\n        return new CapturedPositionalArguments(this.tag, this.references);\n    }\n    prepend(other) {\n        let additions = other.length;\n        if (additions > 0) {\n            let { base, length, stack } = this;\n            this.base = base = base - additions;\n            this.length = length + additions;\n            for (let i = 0; i < additions; i++) {\n                stack.set(other.at(i), i, base);\n            }\n            this._tag = null;\n            this._references = null;\n        }\n    }\n    get references() {\n        let references = this._references;\n        if (!references) {\n            let { stack, base, length } = this;\n            references = this._references = stack.slice(base, base + length);\n        }\n        return references;\n    }\n}\nclass CapturedPositionalArguments {\n    constructor(tag, references, length = references.length) {\n        this.tag = tag;\n        this.references = references;\n        this.length = length;\n    }\n    static empty() {\n        return new CapturedPositionalArguments(CONSTANT_TAG, EMPTY_ARRAY, 0);\n    }\n    at(position) {\n        return this.references[position];\n    }\n    value() {\n        return this.references.map(this.valueOf);\n    }\n    get(name) {\n        let { references, length } = this;\n        if (name === 'length') {\n            return PrimitiveReference.create(length);\n        } else {\n            let idx = parseInt(name, 10);\n            if (idx < 0 || idx >= length) {\n                return UNDEFINED_REFERENCE;\n            } else {\n                return references[idx];\n            }\n        }\n    }\n    valueOf(reference) {\n        return reference.value();\n    }\n}\nexport class NamedArguments {\n    constructor() {\n        this.base = 0;\n        this.length = 0;\n        this._tag = null;\n        this._references = null;\n        this._names = EMPTY_ARRAY;\n        this._atNames = EMPTY_ARRAY;\n    }\n    setup(stack, base, length, names, synthetic) {\n        this.stack = stack;\n        this.base = base;\n        this.length = length;\n        if (length === 0) {\n            this._tag = CONSTANT_TAG;\n            this._references = EMPTY_ARRAY;\n            this._names = EMPTY_ARRAY;\n            this._atNames = EMPTY_ARRAY;\n        } else {\n            this._tag = null;\n            this._references = null;\n            if (synthetic) {\n                this._names = names;\n                this._atNames = null;\n            } else {\n                this._names = null;\n                this._atNames = names;\n            }\n        }\n    }\n    get tag() {\n        return combineTagged(this.references);\n    }\n    get names() {\n        let names = this._names;\n        if (!names) {\n            names = this._names = this._atNames.map(this.toSyntheticName);\n        }\n        return names;\n    }\n    get atNames() {\n        let atNames = this._atNames;\n        if (!atNames) {\n            atNames = this._atNames = this._names.map(this.toAtName);\n        }\n        return atNames;\n    }\n    has(name) {\n        return this.names.indexOf(name) !== -1;\n    }\n    get(name, synthetic = true) {\n        let { base, stack } = this;\n        let names = synthetic ? this.names : this.atNames;\n        let idx = names.indexOf(name);\n        if (idx === -1) {\n            return UNDEFINED_REFERENCE;\n        }\n        return stack.get(idx, base);\n    }\n    capture() {\n        return new CapturedNamedArguments(this.tag, this.names, this.references);\n    }\n    merge(other) {\n        let { length: extras } = other;\n        if (extras > 0) {\n            let { names, length, stack } = this;\n            let { names: extraNames } = other;\n            if (Object.isFrozen(names) && names.length === 0) {\n                names = [];\n            }\n            for (let i = 0; i < extras; i++) {\n                let name = extraNames[i];\n                let idx = names.indexOf(name);\n                if (idx === -1) {\n                    length = names.push(name);\n                    stack.push(other.references[i]);\n                }\n            }\n            this.length = length;\n            this._tag = null;\n            this._references = null;\n            this._names = names;\n            this._atNames = null;\n        }\n    }\n    get references() {\n        let references = this._references;\n        if (!references) {\n            let { base, length, stack } = this;\n            references = this._references = stack.slice(base, base + length);\n        }\n        return references;\n    }\n    toSyntheticName(name) {\n        return name.slice(1);\n    }\n    toAtName(name) {\n        return `@${name}`;\n    }\n}\nclass CapturedNamedArguments {\n    constructor(tag, names, references) {\n        this.tag = tag;\n        this.names = names;\n        this.references = references;\n        this.length = names.length;\n        this._map = null;\n    }\n    get map() {\n        let map = this._map;\n        if (!map) {\n            let { names, references } = this;\n            map = this._map = dict();\n            for (let i = 0; i < names.length; i++) {\n                let name = names[i];\n                map[name] = references[i];\n            }\n        }\n        return map;\n    }\n    has(name) {\n        return this.names.indexOf(name) !== -1;\n    }\n    get(name) {\n        let { names, references } = this;\n        let idx = names.indexOf(name);\n        if (idx === -1) {\n            return UNDEFINED_REFERENCE;\n        } else {\n            return references[idx];\n        }\n    }\n    value() {\n        let { names, references } = this;\n        let out = dict();\n        for (let i = 0; i < names.length; i++) {\n            let name = names[i];\n            out[name] = references[i].value();\n        }\n        return out;\n    }\n}\nexport class BlockArguments {\n    constructor() {\n        this.internalValues = null;\n        this.internalTag = null;\n        this.names = EMPTY_ARRAY;\n        this.length = 0;\n        this.base = 0;\n    }\n    setup(stack, base, length, names) {\n        this.stack = stack;\n        this.names = names;\n        this.base = base;\n        this.length = length;\n        if (length === 0) {\n            this.internalTag = CONSTANT_TAG;\n            this.internalValues = EMPTY_ARRAY;\n        } else {\n            this.internalTag = null;\n            this.internalValues = null;\n        }\n    }\n    get values() {\n        let values = this.internalValues;\n        if (!values) {\n            let { base, length, stack } = this;\n            values = this.internalValues = stack.slice(base, base + length * 3);\n        }\n        return values;\n    }\n    has(name) {\n        return this.names.indexOf(name) !== -1;\n    }\n    get(name) {\n        let { base, stack, names } = this;\n        let idx = names.indexOf(name);\n        if (names.indexOf(name) === -1) {\n            return null;\n        }\n        let table = stack.get(idx * 3, base);\n        let scope = stack.get(idx * 3 + 1, base); // FIXME(mmun): shouldn't need to cast this\n        let handle = stack.get(idx * 3 + 2, base);\n        return handle === null ? null : [handle, scope, table];\n    }\n    capture() {\n        return new CapturedBlockArguments(this.names, this.values);\n    }\n}\nclass CapturedBlockArguments {\n    constructor(names, values) {\n        this.names = names;\n        this.values = values;\n        this.length = names.length;\n    }\n    has(name) {\n        return this.names.indexOf(name) !== -1;\n    }\n    get(name) {\n        let idx = this.names.indexOf(name);\n        if (idx === -1) return null;\n        return [this.values[idx * 3 + 2], this.values[idx * 3 + 1], this.values[idx * 3]];\n    }\n}\nconst EMPTY_NAMED = new CapturedNamedArguments(CONSTANT_TAG, EMPTY_ARRAY, EMPTY_ARRAY);\nconst EMPTY_POSITIONAL = new CapturedPositionalArguments(CONSTANT_TAG, EMPTY_ARRAY);\nexport const EMPTY_ARGS = { tag: CONSTANT_TAG, length: 0, positional: EMPTY_POSITIONAL, named: EMPTY_NAMED };\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXJndW1lbnRzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcGFja2FnZXMvQGdsaW1tZXIvcnVudGltZS9saWIvdm0vYXJndW1lbnRzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLEFBQU8sU0FBRSxBQUFJLE1BQUUsQUFBVyxBQUFFLG1CQUFNLEFBQWUsQUFBQztBQUNsRCxBQUFPLFNBQUUsQUFBYSxBQUFFLHFCQUFNLEFBQW9CLEFBQUM7QUFFbkQsQUFBTyxTQUErQixBQUFZLEFBQUUsb0JBQU0sQUFBb0IsQUFBQztBQUMvRSxBQUFPLFNBQUUsQUFBa0Isb0JBQUUsQUFBbUIsQUFBRSwyQkFBTSxBQUFlLEFBQUMsQUFFeEUsQUFBTyxBQUFFLEFBQXFCLEFBQUUsQUFBSyxBQUFFLEFBQVcsQUFBRSxBQUFXLEFBQUUsQUFBTyxBQUFFLEFBQU0sQUFBZ0IsQUFBQyxBQUNqRyxBQUFPLEFBQUUsQUFBa0IsQUFBRSxBQUFvQixBQUFFLEFBQVUsQUFBRSxBQUFNLEFBQWtDLEFBQUM7O0FBNkV4RyxBQUFNO0FBQU47QUFDVSxhQUFLLFFBQW9CLEFBQVcsQUFBQztBQUN0QyxhQUFVLGFBQUcsSUFBSSxBQUFtQixBQUFFLEFBQUM7QUFDdkMsYUFBSyxRQUFHLElBQUksQUFBYyxBQUFFLEFBQUM7QUFDN0IsYUFBTSxTQUFHLElBQUksQUFBYyxBQUFFLEFBQUMsQUE4RXZDO0FBQUM7QUE1RUMsQUFBSyxVQUFDLEFBQXNCLE9BQUUsQUFBZSxPQUFFLEFBQW9CLFlBQUUsQUFBdUIsaUJBQUUsQUFBa0I7QUFDOUcsQUFBSSxhQUFDLEFBQUssUUFBRyxBQUFLLEFBQUM7QUFFbkIsQUFNRTs7Ozs7OztBQUVGLFlBQUksQUFBSyxRQUFHLEFBQUksS0FBQyxBQUFLLEFBQUM7QUFDdkIsWUFBSSxBQUFVLGFBQUcsQUFBSyxNQUFDLEFBQU0sQUFBQztBQUM5QixZQUFJLEFBQVMsWUFBSSxBQUFLLE1BQUMsQUFBRSxLQUFHLEFBQVUs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LFFBQUMsQUFBWTtBQUNkLEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBTSxNQUFDLEFBQU8sUUFBQyxBQUFJLEFBQUMsVUFBSyxDQUFDLEFBQUMsQUFBQyxBQUMxQztBQUFDO0FBRUQsQUFBRyxRQUFDLEFBQVk7QUFDZCxZQUFJLEVBQUUsQUFBSSxNQUFFLEFBQUssT0FBRSxBQUFLLEFBQUUsVUFBRyxBQUFJLEFBQUM7QUFFbEMsWUFBSSxBQUFHLE1BQUcsQUFBTSxNQUFDLEFBQU8sUUFBQyxBQUFJLEFBQUMsQUFBQztBQUUvQixBQUFFLEFBQUMsWUFBQyxBQUFNLE1BQUMsQUFBTyxRQUFDLEFBQUksQUFBQyxVQUFLLENBQUMsQUFBQyxBQUFDLEdBQUMsQUFBQztBQUNoQyxBQUFNLG1CQUFDLEFBQUksQUFBQyxBQUNkO0FBQUM7QUFFRCxZQUFJLEFBQUssQUFBRyxBQUFLLFFBQUMsQUFBSyxNQUFDLEFBQUcsSUFBQyxBQUFHLE1BQUcsQUFBQyxHQUFFLEFBQUksQUFBQyxBQUFFLEFBQVcsQUFBQyxBQUFxQixBQUFDLEFBQUMsQUFBQztBQUNoRixZQUFJLEFBQUssQUFBRyxBQUFLLFFBQUMsQUFBSyxNQUFDLEFBQUcsSUFBQyxBQUFHLE1BQUcsQUFBQyxJQUFHLEFBQUMsR0FBRSxBQUFJLEFBQUMsQUFBRSxBQUFXLEFBQUMsQUFBVSxBQUFDLEFBQWtCLEFBQUMsT0FBQyxBQUEyQztBQUN0SSxZQUFJLEFBQU0sQUFBRyxBQUFLLFNBQUMsQUFBSyxNQUFDLEFBQUcsSUFBQyxBQUFHLE1BQUcsQUFBQyxJQUFHLEFBQUMsR0FBRSxBQUFJLEFBQUMsQUFBRSxBQUFXLEFBQUMsQUFBTyxBQUFDLEFBQVcsQUFBRSxBQUFvQixBQUFDLEFBQUMsQUFBQyxBQUFDO0FBRTFHLEFBQU0sZUFBQyxBQUFNLFdBQUssQUFBSSxPQUFHLEFBQUksT0FBRyxDQUFDLEFBQU0sUUFBRSxBQUFNLE9BQUUsQUFBTSxBQUFDLEFBQUMsQUFDM0Q7QUFBQztBQUVELEFBQU87QUFDTCxBQUFNLGVBQUMsSUFBSSxBQUFzQix1QkFBQyxBQUFJLEtBQUMsQUFBSyxPQUFFLEFBQUksS0FBQyxBQUFNLEFBQUMsQUFBQyxBQUM3RDtBQUFDLEFBRUY7O0FBRUQ7QUFHRSxnQkFDUyxBQUFlLE9BQ2YsQUFBb0I7QUFEcEIsYUFBSyxRQUFMLEFBQUssQUFBVTtBQUNmLGFBQU0sU0FBTixBQUFNLEFBQWM7QUFFM0IsQUFBSSxhQUFDLEFBQU0sU0FBRyxBQUFLLE1BQUMsQUFBTSxBQUFDLEFBQzdCO0FBQUM7QUFFRCxBQUFHLFFBQUMsQUFBWTtBQUNkLEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBSyxNQUFDLEFBQU8sUUFBQyxBQUFJLEFBQUMsVUFBSyxDQUFDLEFBQUMsQUFBQyxBQUN6QztBQUFDO0FBRUQsQUFBRyxRQUFDLEFBQVk7QUFDZCxZQUFJLEFBQUcsTUFBRyxBQUFJLEtBQUMsQUFBSyxNQUFDLEFBQU8sUUFBQyxBQUFJLEFBQUMsQUFBQztBQUVuQyxBQUFFLEFBQUMsWUFBQyxBQUFHLFFBQUssQ0FBQyxBQUFDLEFBQUMsR0FBQyxBQUFNLE9BQUMsQUFBSSxBQUFDO0FBRTVCLEFBQU0sZUFBQyxDQUNMLEFBQUksS0FBQyxBQUFNLE9BQUMsQUFBRyxNQUFHLEFBQUMsSUFBRyxBQUFDLEFBQWEsSUFDcEMsQUFBSSxLQUFDLEFBQU0sT0FBQyxBQUFHLE1BQUcsQUFBQyxJQUFHLEFBQUMsQUFBVSxJQUNqQyxBQUFJLEtBQUMsQUFBTSxPQUFDLEFBQUcsTUFBRyxBQUFDLEFBQXFCLEFBQ3pDLEFBQUMsQUFDSjtBQUFDLEFBQ0Y7O0FBRUQsTUFBTSxBQUFXLGNBQUcsSUFBSSxBQUFzQix1QkFBQyxBQUFZLGNBQUUsQUFBVyxhQUFFLEFBQVcsQUFBQyxBQUFDO0FBQ3ZGLE1BQU0sQUFBZ0IsbUJBQUcsSUFBSSxBQUEyQiw0QkFBQyxBQUFZLGNBQUUsQUFBVyxBQUFDLEFBQUM7QUFDcEYsQUFBTSxPQUFDLE1BQU0sQUFBVSxhQUF1QixFQUFFLEFBQUcsS0FBRSxBQUFZLGNBQUUsQUFBTSxRQUFFLEFBQUMsR0FBRSxBQUFVLFlBQUUsQUFBZ0Isa0JBQUUsQUFBSyxPQUFFLEFBQVcsQUFBRSxBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRXZhbHVhdGlvblN0YWNrIH0gZnJvbSAnLi9hcHBlbmQnO1xuaW1wb3J0IHsgZGljdCwgRU1QVFlfQVJSQVkgfSBmcm9tICdAZ2xpbW1lci91dGlsJztcbmltcG9ydCB7IGNvbWJpbmVUYWdnZWQgfSBmcm9tICdAZ2xpbW1lci9yZWZlcmVuY2UnO1xuaW1wb3J0IHsgRGljdCwgT3BhcXVlLCBPcHRpb24sIHVuc2FmZSwgQmxvY2tTeW1ib2xUYWJsZSwgVk1IYW5kbGUgfSBmcm9tICdAZ2xpbW1lci9pbnRlcmZhY2VzJztcbmltcG9ydCB7IFRhZywgVmVyc2lvbmVkUGF0aFJlZmVyZW5jZSwgQ09OU1RBTlRfVEFHIH0gZnJvbSAnQGdsaW1tZXIvcmVmZXJlbmNlJztcbmltcG9ydCB7IFByaW1pdGl2ZVJlZmVyZW5jZSwgVU5ERUZJTkVEX1JFRkVSRU5DRSB9IGZyb20gJy4uL3JlZmVyZW5jZXMnO1xuaW1wb3J0IHsgU2NvcGVCbG9jaywgU2NvcGUsIEJsb2NrVmFsdWUgfSBmcm9tICcuLi9lbnZpcm9ubWVudCc7XG5pbXBvcnQgeyBDaGVja0Jsb2NrU3ltYm9sVGFibGUsIGNoZWNrLCBDaGVja0hhbmRsZSwgQ2hlY2tPcHRpb24sIENoZWNrT3IgfSBmcm9tICdAZ2xpbW1lci9kZWJ1Zyc7XG5pbXBvcnQgeyBDaGVja1BhdGhSZWZlcmVuY2UsIENoZWNrQ29tcGlsYWJsZUJsb2NrLCBDaGVja1Njb3BlIH0gZnJvbSAnLi4vY29tcGlsZWQvb3Bjb2Rlcy8tZGVidWctc3RyaXAnO1xuXG4vKlxuICBUaGUgY2FsbGluZyBjb252ZW50aW9uIGlzOlxuXG4gICogMC1OIGJsb2NrIGFyZ3VtZW50cyBhdCB0aGUgYm90dG9tXG4gICogMC1OIHBvc2l0aW9uYWwgYXJndW1lbnRzIG5leHQgKGxlZnQtdG8tcmlnaHQpXG4gICogMC1OIG5hbWVkIGFyZ3VtZW50cyBuZXh0XG4qL1xuXG5leHBvcnQgaW50ZXJmYWNlIElBcmd1bWVudHMge1xuICB0YWc6IFRhZztcbiAgbGVuZ3RoOiBudW1iZXI7XG4gIHBvc2l0aW9uYWw6IElQb3NpdGlvbmFsQXJndW1lbnRzO1xuICBuYW1lZDogSU5hbWVkQXJndW1lbnRzO1xuXG4gIGF0PFQgZXh0ZW5kcyBWZXJzaW9uZWRQYXRoUmVmZXJlbmNlPE9wYXF1ZT4+KHBvczogbnVtYmVyKTogVDtcbiAgY2FwdHVyZSgpOiBJQ2FwdHVyZWRBcmd1bWVudHM7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUNhcHR1cmVkQXJndW1lbnRzIHtcbiAgdGFnOiBUYWc7XG4gIGxlbmd0aDogbnVtYmVyO1xuICBwb3NpdGlvbmFsOiBJQ2FwdHVyZWRQb3NpdGlvbmFsQXJndW1lbnRzO1xuICBuYW1lZDogSUNhcHR1cmVkTmFtZWRBcmd1bWVudHM7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVBvc2l0aW9uYWxBcmd1bWVudHMge1xuICB0YWc6IFRhZztcbiAgbGVuZ3RoOiBudW1iZXI7XG4gIGF0PFQgZXh0ZW5kcyBWZXJzaW9uZWRQYXRoUmVmZXJlbmNlPE9wYXF1ZT4+KHBvc2l0aW9uOiBudW1iZXIpOiBUO1xuICBjYXB0dXJlKCk6IElDYXB0dXJlZFBvc2l0aW9uYWxBcmd1bWVudHM7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUNhcHR1cmVkUG9zaXRpb25hbEFyZ3VtZW50cyBleHRlbmRzIFZlcnNpb25lZFBhdGhSZWZlcmVuY2U8T3BhcXVlW10+IHtcbiAgdGFnOiBUYWc7XG4gIGxlbmd0aDogbnVtYmVyO1xuICByZWZlcmVuY2VzOiBWZXJzaW9uZWRQYXRoUmVmZXJlbmNlPE9wYXF1ZT5bXTtcbiAgYXQ8VCBleHRlbmRzIFZlcnNpb25lZFBhdGhSZWZlcmVuY2U8T3BhcXVlPj4ocG9zaXRpb246IG51bWJlcik6IFQ7XG4gIHZhbHVlKCk6IE9wYXF1ZVtdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElOYW1lZEFyZ3VtZW50cyB7XG4gIHRhZzogVGFnO1xuICBuYW1lczogc3RyaW5nW107XG4gIGxlbmd0aDogbnVtYmVyO1xuICBoYXMobmFtZTogc3RyaW5nKTogYm9vbGVhbjtcbiAgZ2V0PFQgZXh0ZW5kcyBWZXJzaW9uZWRQYXRoUmVmZXJlbmNlPE9wYXF1ZT4+KG5hbWU6IHN0cmluZyk6IFQ7XG4gIGNhcHR1cmUoKTogSUNhcHR1cmVkTmFtZWRBcmd1bWVudHM7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUJsb2NrQXJndW1lbnRzIHtcbiAgbmFtZXM6IHN0cmluZ1tdO1xuICBsZW5ndGg6IG51bWJlcjtcbiAgaGFzKG5hbWU6IHN0cmluZyk6IGJvb2xlYW47XG4gIGdldChuYW1lOiBzdHJpbmcpOiBPcHRpb248U2NvcGVCbG9jaz47XG4gIGNhcHR1cmUoKTogSUNhcHR1cmVkQmxvY2tBcmd1bWVudHM7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUNhcHR1cmVkQmxvY2tBcmd1bWVudHMge1xuICBuYW1lczogc3RyaW5nW107XG4gIGxlbmd0aDogbnVtYmVyO1xuICBoYXMobmFtZTogc3RyaW5nKTogYm9vbGVhbjtcbiAgZ2V0KG5hbWU6IHN0cmluZyk6IE9wdGlvbjxTY29wZUJsb2NrPjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJQ2FwdHVyZWROYW1lZEFyZ3VtZW50cyBleHRlbmRzIFZlcnNpb25lZFBhdGhSZWZlcmVuY2U8RGljdDxPcGFxdWU+PiB7XG4gIHRhZzogVGFnO1xuICBtYXA6IERpY3Q8VmVyc2lvbmVkUGF0aFJlZmVyZW5jZTxPcGFxdWU+PjtcbiAgbmFtZXM6IHN0cmluZ1tdO1xuICBsZW5ndGg6IG51bWJlcjtcbiAgcmVmZXJlbmNlczogVmVyc2lvbmVkUGF0aFJlZmVyZW5jZTxPcGFxdWU+W107XG4gIGhhcyhuYW1lOiBzdHJpbmcpOiBib29sZWFuO1xuICBnZXQ8VCBleHRlbmRzIFZlcnNpb25lZFBhdGhSZWZlcmVuY2U8T3BhcXVlPj4obmFtZTogc3RyaW5nKTogVDtcbiAgdmFsdWUoKTogRGljdDxPcGFxdWU+O1xufVxuXG5leHBvcnQgY2xhc3MgQXJndW1lbnRzIGltcGxlbWVudHMgSUFyZ3VtZW50cyB7XG4gIHByaXZhdGUgc3RhY2s6IEV2YWx1YXRpb25TdGFjayA9IG51bGwgYXMgYW55O1xuICBwdWJsaWMgcG9zaXRpb25hbCA9IG5ldyBQb3NpdGlvbmFsQXJndW1lbnRzKCk7XG4gIHB1YmxpYyBuYW1lZCA9IG5ldyBOYW1lZEFyZ3VtZW50cygpO1xuICBwdWJsaWMgYmxvY2tzID0gbmV3IEJsb2NrQXJndW1lbnRzKCk7XG5cbiAgc2V0dXAoc3RhY2s6IEV2YWx1YXRpb25TdGFjaywgbmFtZXM6IHN0cmluZ1tdLCBibG9ja05hbWVzOiBzdHJpbmdbXSwgcG9zaXRpb25hbENvdW50OiBudW1iZXIsIHN5bnRoZXRpYzogYm9vbGVhbikge1xuICAgIHRoaXMuc3RhY2sgPSBzdGFjaztcblxuICAgIC8qXG4gICAgICAgICAgIHwgLi4uIHwgYmxvY2tzICAgICAgfCBwb3NpdGlvbmFsICB8IG5hbWVkIHxcbiAgICAgICAgICAgfCAuLi4gfCBiMCAgICBiMSAgICB8IHAwIHAxIHAyIHAzIHwgbjAgbjEgfFxuICAgICBpbmRleCB8IC4uLiB8IDQvNS82IDcvOC85IHwgMTAgMTEgMTIgMTMgfCAxNCAxNSB8XG4gICAgICAgICAgICAgICAgICAgXiAgICAgICAgICAgICBeICAgICAgICAgICAgIF4gIF5cbiAgICAgICAgICAgICAgICAgYmJhc2UgICAgICAgICBwYmFzZSAgICAgICBuYmFzZSAgc3BcbiAgICAqL1xuXG4gICAgbGV0IG5hbWVkID0gdGhpcy5uYW1lZDtcbiAgICBsZXQgbmFtZWRDb3VudCA9IG5hbWVzLmxlbmd0aDtcbiAgICBsZXQgbmFtZWRCYXNlICA9IHN0YWNrLnNwIC0gbmFtZWRDb3VudCArIDE7XG5cbiAgICBuYW1lZC5zZXR1cChzdGFjaywgbmFtZWRCYXNlLCBuYW1lZENvdW50LCBuYW1lcywgc3ludGhldGljKTtcblxuICAgIGxldCBwb3NpdGlvbmFsID0gdGhpcy5wb3NpdGlvbmFsO1xuICAgIGxldCBwb3NpdGlvbmFsQmFzZSA9IG5hbWVkQmFzZSAtIHBvc2l0aW9uYWxDb3VudDtcblxuICAgIHBvc2l0aW9uYWwuc2V0dXAoc3RhY2ssIHBvc2l0aW9uYWxCYXNlLCBwb3NpdGlvbmFsQ291bnQpO1xuXG4gICAgbGV0IGJsb2NrcyA9IHRoaXMuYmxvY2tzO1xuICAgIGxldCBibG9ja3NDb3VudCA9IGJsb2NrTmFtZXMubGVuZ3RoO1xuICAgIGxldCBibG9ja3NCYXNlID0gcG9zaXRpb25hbEJhc2UgLSAoYmxvY2tzQ291bnQgKiAzKTtcblxuICAgIGJsb2Nrcy5zZXR1cChzdGFjaywgYmxvY2tzQmFzZSwgYmxvY2tzQ291bnQsIGJsb2NrTmFtZXMpO1xuICB9XG5cbiAgZ2V0IHRhZygpOiBUYWcge1xuICAgIHJldHVybiBjb21iaW5lVGFnZ2VkKFt0aGlzLnBvc2l0aW9uYWwsIHRoaXMubmFtZWRdKTtcbiAgfVxuXG4gIGdldCBiYXNlKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuYmxvY2tzLmJhc2U7XG4gIH1cblxuICBnZXQgbGVuZ3RoKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMucG9zaXRpb25hbC5sZW5ndGggKyB0aGlzLm5hbWVkLmxlbmd0aCArICh0aGlzLmJsb2Nrcy5sZW5ndGggKiAzKTtcbiAgfVxuXG4gIGF0PFQgZXh0ZW5kcyBWZXJzaW9uZWRQYXRoUmVmZXJlbmNlPE9wYXF1ZT4+KHBvczogbnVtYmVyKTogVCB7XG4gICAgcmV0dXJuIHRoaXMucG9zaXRpb25hbC5hdDxUPihwb3MpO1xuICB9XG5cbiAgcmVhbGxvYyhvZmZzZXQ6IG51bWJlcikge1xuICAgIGlmIChvZmZzZXQgPiAwKSB7XG4gICAgICBsZXQgeyBwb3NpdGlvbmFsLCBuYW1lZCwgc3RhY2sgfSA9IHRoaXM7XG4gICAgICBsZXQgbmV3QmFzZSA9IHBvc2l0aW9uYWwuYmFzZSArIG9mZnNldDtcbiAgICAgIGxldCBsZW5ndGggPSBwb3NpdGlvbmFsLmxlbmd0aCArIG5hbWVkLmxlbmd0aDtcblxuICAgICAgZm9yKGxldCBpPWxlbmd0aC0xOyBpPj0wOyBpLS0pIHtcbiAgICAgICAgc3RhY2suc2V0KHN0YWNrLmdldChpLCBwb3NpdGlvbmFsLmJhc2UpLCBpLCBuZXdCYXNlKTtcbiAgICAgIH1cblxuICAgICAgcG9zaXRpb25hbC5iYXNlICs9IG9mZnNldDtcbiAgICAgIG5hbWVkLmJhc2UgKz0gb2Zmc2V0O1xuICAgICAgc3RhY2suc3AgKz0gb2Zmc2V0O1xuICAgIH1cbiAgfVxuXG4gIGNhcHR1cmUoKTogSUNhcHR1cmVkQXJndW1lbnRzIHtcbiAgICBsZXQgcG9zaXRpb25hbCA9IHRoaXMucG9zaXRpb25hbC5sZW5ndGggPT09IDAgPyBFTVBUWV9QT1NJVElPTkFMIDogdGhpcy5wb3NpdGlvbmFsLmNhcHR1cmUoKTtcbiAgICBsZXQgbmFtZWQgPSB0aGlzLm5hbWVkLmxlbmd0aCA9PT0gMCA/IEVNUFRZX05BTUVEIDogdGhpcy5uYW1lZC5jYXB0dXJlKCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRhZzogdGhpcy50YWcsXG4gICAgICBsZW5ndGg6IHRoaXMubGVuZ3RoLFxuICAgICAgcG9zaXRpb25hbCxcbiAgICAgIG5hbWVkXG4gICAgfTtcbiAgfVxuXG4gIGNsZWFyKCk6IHZvaWQge1xuICAgIGxldCB7IHN0YWNrLCBsZW5ndGggfSA9IHRoaXM7XG4gICAgc3RhY2sucG9wKGxlbmd0aCk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFBvc2l0aW9uYWxBcmd1bWVudHMgaW1wbGVtZW50cyBJUG9zaXRpb25hbEFyZ3VtZW50cyB7XG4gIHB1YmxpYyBiYXNlID0gMDtcbiAgcHVibGljIGxlbmd0aCA9IDA7XG5cbiAgcHJpdmF0ZSBzdGFjazogRXZhbHVhdGlvblN0YWNrID0gbnVsbCBhcyBhbnk7XG5cbiAgcHJpdmF0ZSBfdGFnOiBPcHRpb248VGFnPiA9IG51bGw7XG4gIHByaXZhdGUgX3JlZmVyZW5jZXM6IE9wdGlvbjxWZXJzaW9uZWRQYXRoUmVmZXJlbmNlPE9wYXF1ZT5bXT4gPSBudWxsO1xuXG4gIHNldHVwKHN0YWNrOiBFdmFsdWF0aW9uU3RhY2ssIGJhc2U6IG51bWJlciwgbGVuZ3RoOiBudW1iZXIpIHtcbiAgICB0aGlzLnN0YWNrID0gc3RhY2s7XG4gICAgdGhpcy5iYXNlID0gYmFzZTtcbiAgICB0aGlzLmxlbmd0aCA9IGxlbmd0aDtcblxuICAgIGlmIChsZW5ndGggPT09IDApIHtcbiAgICAgIHRoaXMuX3RhZyA9IENPTlNUQU5UX1RBRztcbiAgICAgIHRoaXMuX3JlZmVyZW5jZXMgPSBFTVBUWV9BUlJBWTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fdGFnID0gbnVsbDtcbiAgICAgIHRoaXMuX3JlZmVyZW5jZXMgPSBudWxsO1xuICAgIH1cbiAgfVxuXG4gIGdldCB0YWcoKTogVGFnIHtcbiAgICBsZXQgdGFnID0gdGhpcy5fdGFnO1xuXG4gICAgaWYgKCF0YWcpIHtcbiAgICAgIHRhZyA9IHRoaXMuX3RhZyA9IGNvbWJpbmVUYWdnZWQodGhpcy5yZWZlcmVuY2VzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGFnO1xuICB9XG5cbiAgYXQ8VCBleHRlbmRzIFZlcnNpb25lZFBhdGhSZWZlcmVuY2U8T3BhcXVlPj4ocG9zaXRpb246IG51bWJlcik6IFQge1xuICAgIGxldCB7IGJhc2UsIGxlbmd0aCwgc3RhY2sgfSA9IHRoaXM7XG5cbiAgICBpZiAocG9zaXRpb24gPCAwIHx8IHBvc2l0aW9uID49IGxlbmd0aCkge1xuICAgICAgcmV0dXJuIFVOREVGSU5FRF9SRUZFUkVOQ0UgYXMgdW5zYWZlIGFzIFQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNoZWNrKHN0YWNrLmdldChwb3NpdGlvbiwgYmFzZSksIENoZWNrUGF0aFJlZmVyZW5jZSkgYXMgVDtcbiAgfVxuXG4gIGNhcHR1cmUoKTogSUNhcHR1cmVkUG9zaXRpb25hbEFyZ3VtZW50cyB7XG4gICAgcmV0dXJuIG5ldyBDYXB0dXJlZFBvc2l0aW9uYWxBcmd1bWVudHModGhpcy50YWcsIHRoaXMucmVmZXJlbmNlcyk7XG4gIH1cblxuICBwcmVwZW5kKG90aGVyOiBJQ2FwdHVyZWRQb3NpdGlvbmFsQXJndW1lbnRzKSB7XG4gICAgbGV0IGFkZGl0aW9ucyA9IG90aGVyLmxlbmd0aDtcblxuICAgIGlmIChhZGRpdGlvbnMgPiAwKSB7XG4gICAgICBsZXQgeyBiYXNlLCBsZW5ndGgsIHN0YWNrIH0gPSB0aGlzO1xuXG4gICAgICB0aGlzLmJhc2UgPSBiYXNlID0gYmFzZSAtIGFkZGl0aW9ucztcbiAgICAgIHRoaXMubGVuZ3RoID0gbGVuZ3RoICsgYWRkaXRpb25zO1xuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFkZGl0aW9uczsgaSsrKSB7XG4gICAgICAgIHN0YWNrLnNldChvdGhlci5hdChpKSwgaSwgYmFzZSk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuX3RhZyA9IG51bGw7XG4gICAgICB0aGlzLl9yZWZlcmVuY2VzID0gbnVsbDtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldCByZWZlcmVuY2VzKCk6IFZlcnNpb25lZFBhdGhSZWZlcmVuY2U8T3BhcXVlPltdIHtcbiAgICBsZXQgcmVmZXJlbmNlcyA9IHRoaXMuX3JlZmVyZW5jZXM7XG5cbiAgICBpZiAoIXJlZmVyZW5jZXMpIHtcbiAgICAgIGxldCB7IHN0YWNrLCBiYXNlLCBsZW5ndGggfSA9IHRoaXM7XG4gICAgICByZWZlcmVuY2VzID0gdGhpcy5fcmVmZXJlbmNlcyA9IHN0YWNrLnNsaWNlPFZlcnNpb25lZFBhdGhSZWZlcmVuY2U8T3BhcXVlPj4oYmFzZSwgYmFzZSArIGxlbmd0aCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlZmVyZW5jZXM7XG4gIH1cbn1cblxuY2xhc3MgQ2FwdHVyZWRQb3NpdGlvbmFsQXJndW1lbnRzIGltcGxlbWVudHMgSUNhcHR1cmVkUG9zaXRpb25hbEFyZ3VtZW50cyB7XG4gIHN0YXRpYyBlbXB0eSgpOiBDYXB0dXJlZFBvc2l0aW9uYWxBcmd1bWVudHMge1xuICAgIHJldHVybiBuZXcgQ2FwdHVyZWRQb3NpdGlvbmFsQXJndW1lbnRzKENPTlNUQU5UX1RBRywgRU1QVFlfQVJSQVksIDApO1xuICB9XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHVibGljIHRhZzogVGFnLFxuICAgIHB1YmxpYyByZWZlcmVuY2VzOiBWZXJzaW9uZWRQYXRoUmVmZXJlbmNlPE9wYXF1ZT5bXSxcbiAgICBwdWJsaWMgbGVuZ3RoID0gcmVmZXJlbmNlcy5sZW5ndGhcbiAgKSB7fVxuXG4gIGF0PFQgZXh0ZW5kcyBWZXJzaW9uZWRQYXRoUmVmZXJlbmNlPE9wYXF1ZT4+KHBvc2l0aW9uOiBudW1iZXIpOiBUIHtcbiAgICByZXR1cm4gdGhpcy5yZWZlcmVuY2VzW3Bvc2l0aW9uXSBhcyBUO1xuICB9XG5cbiAgdmFsdWUoKTogT3BhcXVlW10ge1xuICAgIHJldHVybiB0aGlzLnJlZmVyZW5jZXMubWFwKHRoaXMudmFsdWVPZik7XG4gIH1cblxuICBnZXQobmFtZTogc3RyaW5nKTogVmVyc2lvbmVkUGF0aFJlZmVyZW5jZTxPcGFxdWU+IHtcbiAgICBsZXQgeyByZWZlcmVuY2VzLCBsZW5ndGggfSA9IHRoaXM7XG5cbiAgICBpZiAobmFtZSA9PT0gJ2xlbmd0aCcpIHtcbiAgICAgIHJldHVybiBQcmltaXRpdmVSZWZlcmVuY2UuY3JlYXRlKGxlbmd0aCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBpZHggPSBwYXJzZUludChuYW1lLCAxMCk7XG5cbiAgICAgIGlmIChpZHggPCAwIHx8IGlkeCA+PSBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIFVOREVGSU5FRF9SRUZFUkVOQ0U7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gcmVmZXJlbmNlc1tpZHhdO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgdmFsdWVPZih0aGlzOiB2b2lkLCByZWZlcmVuY2U6IFZlcnNpb25lZFBhdGhSZWZlcmVuY2U8T3BhcXVlPik6IE9wYXF1ZSB7XG4gICAgcmV0dXJuIHJlZmVyZW5jZS52YWx1ZSgpO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBOYW1lZEFyZ3VtZW50cyBpbXBsZW1lbnRzIElOYW1lZEFyZ3VtZW50cyB7XG4gIHB1YmxpYyBiYXNlID0gMDtcbiAgcHVibGljIGxlbmd0aCA9IDA7XG5cbiAgcHJpdmF0ZSBzdGFjazogRXZhbHVhdGlvblN0YWNrO1xuXG4gIHByaXZhdGUgX3RhZzogT3B0aW9uPFRhZz4gPSBudWxsO1xuICBwcml2YXRlIF9yZWZlcmVuY2VzOiBPcHRpb248VmVyc2lvbmVkUGF0aFJlZmVyZW5jZTxPcGFxdWU+W10+ID0gbnVsbDtcblxuICBwcml2YXRlIF9uYW1lczogT3B0aW9uPHN0cmluZ1tdPiA9IEVNUFRZX0FSUkFZO1xuICBwcml2YXRlIF9hdE5hbWVzOiBPcHRpb248c3RyaW5nW10+ID0gRU1QVFlfQVJSQVk7XG5cbiAgc2V0dXAoc3RhY2s6IEV2YWx1YXRpb25TdGFjaywgYmFzZTogbnVtYmVyLCBsZW5ndGg6IG51bWJlciwgbmFtZXM6IHN0cmluZ1tdLCBzeW50aGV0aWM6IGJvb2xlYW4pIHtcbiAgICB0aGlzLnN0YWNrID0gc3RhY2s7XG4gICAgdGhpcy5iYXNlID0gYmFzZTtcbiAgICB0aGlzLmxlbmd0aCA9IGxlbmd0aDtcblxuICAgIGlmIChsZW5ndGggPT09IDApIHtcbiAgICAgIHRoaXMuX3RhZyA9IENPTlNUQU5UX1RBRztcbiAgICAgIHRoaXMuX3JlZmVyZW5jZXMgPSBFTVBUWV9BUlJBWTtcbiAgICAgIHRoaXMuX25hbWVzID0gRU1QVFlfQVJSQVk7XG4gICAgICB0aGlzLl9hdE5hbWVzID0gRU1QVFlfQVJSQVk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3RhZyA9IG51bGw7XG4gICAgICB0aGlzLl9yZWZlcmVuY2VzID0gbnVsbDtcblxuICAgICAgaWYgKHN5bnRoZXRpYykge1xuICAgICAgICB0aGlzLl9uYW1lcyA9IG5hbWVzO1xuICAgICAgICB0aGlzLl9hdE5hbWVzID0gbnVsbDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX25hbWVzID0gbnVsbDtcbiAgICAgICAgdGhpcy5fYXROYW1lcyA9IG5hbWVzO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGdldCB0YWcoKTogVGFnIHtcbiAgICByZXR1cm4gY29tYmluZVRhZ2dlZCh0aGlzLnJlZmVyZW5jZXMpO1xuICB9XG5cbiAgZ2V0IG5hbWVzKCk6IHN0cmluZ1tdIHtcbiAgICBsZXQgbmFtZXMgPSB0aGlzLl9uYW1lcztcblxuICAgIGlmICghbmFtZXMpIHtcbiAgICAgIG5hbWVzID0gdGhpcy5fbmFtZXMgPSB0aGlzLl9hdE5hbWVzIS5tYXAodGhpcy50b1N5bnRoZXRpY05hbWUpO1xuICAgIH1cblxuICAgIHJldHVybiBuYW1lcyE7XG4gIH1cblxuICBnZXQgYXROYW1lcygpOiBzdHJpbmdbXSB7XG4gICAgbGV0IGF0TmFtZXMgPSB0aGlzLl9hdE5hbWVzO1xuXG4gICAgaWYgKCFhdE5hbWVzKSB7XG4gICAgICBhdE5hbWVzID0gdGhpcy5fYXROYW1lcyA9IHRoaXMuX25hbWVzIS5tYXAodGhpcy50b0F0TmFtZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGF0TmFtZXMhO1xuICB9XG5cbiAgaGFzKG5hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLm5hbWVzLmluZGV4T2YobmFtZSkgIT09IC0xO1xuICB9XG5cbiAgZ2V0PFQgZXh0ZW5kcyBWZXJzaW9uZWRQYXRoUmVmZXJlbmNlPE9wYXF1ZT4+KG5hbWU6IHN0cmluZywgc3ludGhldGljID0gdHJ1ZSk6IFQge1xuICAgIGxldCB7IGJhc2UsIHN0YWNrIH0gPSB0aGlzO1xuXG4gICAgbGV0IG5hbWVzID0gc3ludGhldGljID8gdGhpcy5uYW1lcyA6IHRoaXMuYXROYW1lcztcblxuICAgIGxldCBpZHggPSBuYW1lcy5pbmRleE9mKG5hbWUpO1xuXG4gICAgaWYgKGlkeCA9PT0gLTEpIHtcbiAgICAgIHJldHVybiBVTkRFRklORURfUkVGRVJFTkNFIGFzIHVuc2FmZSBhcyBUO1xuICAgIH1cblxuICAgIHJldHVybiBzdGFjay5nZXQ8VD4oaWR4LCBiYXNlKTtcbiAgfVxuXG4gIGNhcHR1cmUoKTogSUNhcHR1cmVkTmFtZWRBcmd1bWVudHMge1xuICAgIHJldHVybiBuZXcgQ2FwdHVyZWROYW1lZEFyZ3VtZW50cyh0aGlzLnRhZywgdGhpcy5uYW1lcywgdGhpcy5yZWZlcmVuY2VzKTtcbiAgfVxuXG4gIG1lcmdlKG90aGVyOiBJQ2FwdHVyZWROYW1lZEFyZ3VtZW50cykge1xuICAgIGxldCB7IGxlbmd0aDogZXh0cmFzIH0gPSBvdGhlcjtcblxuICAgIGlmIChleHRyYXMgPiAwKSB7XG4gICAgICBsZXQgeyBuYW1lcywgbGVuZ3RoLCBzdGFjayB9ID0gdGhpcztcbiAgICAgIGxldCB7IG5hbWVzOiBleHRyYU5hbWVzIH0gPSBvdGhlcjtcblxuICAgICAgaWYgKE9iamVjdC5pc0Zyb3plbihuYW1lcykgJiYgbmFtZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIG5hbWVzID0gW107XG4gICAgICB9XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZXh0cmFzOyBpKyspIHtcbiAgICAgICAgbGV0IG5hbWUgPSBleHRyYU5hbWVzW2ldO1xuICAgICAgICBsZXQgaWR4ID0gbmFtZXMuaW5kZXhPZihuYW1lKTtcblxuICAgICAgICBpZiAoaWR4ID09PSAtMSkge1xuICAgICAgICAgIGxlbmd0aCA9IG5hbWVzLnB1c2gobmFtZSk7XG4gICAgICAgICAgc3RhY2sucHVzaChvdGhlci5yZWZlcmVuY2VzW2ldKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0aGlzLmxlbmd0aCA9IGxlbmd0aDtcbiAgICAgIHRoaXMuX3RhZyA9IG51bGw7XG4gICAgICB0aGlzLl9yZWZlcmVuY2VzID0gbnVsbDtcbiAgICAgIHRoaXMuX25hbWVzID0gbmFtZXM7XG4gICAgICB0aGlzLl9hdE5hbWVzID0gbnVsbDtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldCByZWZlcmVuY2VzKCk6IFZlcnNpb25lZFBhdGhSZWZlcmVuY2U8T3BhcXVlPltdIHtcbiAgICBsZXQgcmVmZXJlbmNlcyA9IHRoaXMuX3JlZmVyZW5jZXM7XG5cbiAgICBpZiAoIXJlZmVyZW5jZXMpIHtcbiAgICAgIGxldCB7IGJhc2UsIGxlbmd0aCwgc3RhY2sgfSA9IHRoaXM7XG4gICAgICByZWZlcmVuY2VzID0gdGhpcy5fcmVmZXJlbmNlcyA9IHN0YWNrLnNsaWNlPFZlcnNpb25lZFBhdGhSZWZlcmVuY2U8T3BhcXVlPj4oYmFzZSwgYmFzZSArIGxlbmd0aCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlZmVyZW5jZXM7XG4gIH1cblxuICBwcml2YXRlIHRvU3ludGhldGljTmFtZSh0aGlzOiB2b2lkLCBuYW1lOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiBuYW1lLnNsaWNlKDEpO1xuICB9XG5cbiAgcHJpdmF0ZSB0b0F0TmFtZSh0aGlzOiB2b2lkLCBuYW1lOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiBgQCR7bmFtZX1gO1xuICB9XG59XG5cbmNsYXNzIENhcHR1cmVkTmFtZWRBcmd1bWVudHMgaW1wbGVtZW50cyBJQ2FwdHVyZWROYW1lZEFyZ3VtZW50cyB7XG4gIHB1YmxpYyBsZW5ndGg6IG51bWJlcjtcbiAgcHJpdmF0ZSBfbWFwOiBPcHRpb248RGljdDxWZXJzaW9uZWRQYXRoUmVmZXJlbmNlPE9wYXF1ZT4+PjtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwdWJsaWMgdGFnOiBUYWcsXG4gICAgcHVibGljIG5hbWVzOiBzdHJpbmdbXSxcbiAgICBwdWJsaWMgcmVmZXJlbmNlczogVmVyc2lvbmVkUGF0aFJlZmVyZW5jZTxPcGFxdWU+W11cbiAgKSB7XG4gICAgdGhpcy5sZW5ndGggPSBuYW1lcy5sZW5ndGg7XG4gICAgdGhpcy5fbWFwID0gbnVsbDtcbiAgfVxuXG4gIGdldCBtYXAoKSB7XG4gICAgbGV0IG1hcCA9IHRoaXMuX21hcDtcblxuICAgIGlmICghbWFwKSB7XG4gICAgICBsZXQgeyBuYW1lcywgcmVmZXJlbmNlcyB9ID0gdGhpcztcbiAgICAgIG1hcCA9IHRoaXMuX21hcCA9IGRpY3Q8VmVyc2lvbmVkUGF0aFJlZmVyZW5jZTxPcGFxdWU+PigpO1xuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5hbWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGxldCBuYW1lID0gbmFtZXNbaV07XG4gICAgICAgIG1hcCFbbmFtZV0gPSByZWZlcmVuY2VzW2ldO1xuICAgICAgfVxuXG4gICAgfVxuXG4gICAgcmV0dXJuIG1hcDtcbiAgfVxuXG4gIGhhcyhuYW1lOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5uYW1lcy5pbmRleE9mKG5hbWUpICE9PSAtMTtcbiAgfVxuXG4gIGdldDxUIGV4dGVuZHMgVmVyc2lvbmVkUGF0aFJlZmVyZW5jZTxPcGFxdWU+PihuYW1lOiBzdHJpbmcpOiBUIHtcbiAgICBsZXQgeyBuYW1lcywgcmVmZXJlbmNlcyB9ID0gdGhpcztcbiAgICBsZXQgaWR4ID0gbmFtZXMuaW5kZXhPZihuYW1lKTtcblxuICAgIGlmIChpZHggPT09IC0xKSB7XG4gICAgICByZXR1cm4gVU5ERUZJTkVEX1JFRkVSRU5DRSBhcyB1bnNhZmUgYXMgVDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHJlZmVyZW5jZXNbaWR4XSBhcyBUO1xuICAgIH1cbiAgfVxuXG4gIHZhbHVlKCk6IERpY3Q8T3BhcXVlPiB7XG4gICAgbGV0IHsgbmFtZXMsIHJlZmVyZW5jZXMgfSA9IHRoaXM7XG4gICAgbGV0IG91dCA9IGRpY3Q8T3BhcXVlPigpO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuYW1lcy5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IG5hbWUgPSBuYW1lc1tpXTtcbiAgICAgIG91dFtuYW1lXSA9IHJlZmVyZW5jZXNbaV0udmFsdWUoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gb3V0O1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBCbG9ja0FyZ3VtZW50cyBpbXBsZW1lbnRzIElCbG9ja0FyZ3VtZW50cyB7XG4gIHByaXZhdGUgc3RhY2s6IEV2YWx1YXRpb25TdGFjaztcbiAgcHJpdmF0ZSBpbnRlcm5hbFZhbHVlczogT3B0aW9uPFZNSGFuZGxlW10+ID0gbnVsbDtcblxuICBwdWJsaWMgaW50ZXJuYWxUYWc6IE9wdGlvbjxUYWc+ID0gbnVsbDtcbiAgcHVibGljIG5hbWVzOiBzdHJpbmdbXSA9IEVNUFRZX0FSUkFZO1xuXG4gIHB1YmxpYyBsZW5ndGggPSAwO1xuICBwdWJsaWMgYmFzZSA9IDA7XG5cbiAgc2V0dXAoc3RhY2s6IEV2YWx1YXRpb25TdGFjaywgYmFzZTogbnVtYmVyLCBsZW5ndGg6IG51bWJlciwgbmFtZXM6IHN0cmluZ1tdKSB7XG4gICAgdGhpcy5zdGFjayA9IHN0YWNrO1xuICAgIHRoaXMubmFtZXMgPSBuYW1lcztcbiAgICB0aGlzLmJhc2UgPSBiYXNlO1xuICAgIHRoaXMubGVuZ3RoID0gbGVuZ3RoO1xuXG4gICAgaWYgKGxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhpcy5pbnRlcm5hbFRhZyA9IENPTlNUQU5UX1RBRztcbiAgICAgIHRoaXMuaW50ZXJuYWxWYWx1ZXMgPSBFTVBUWV9BUlJBWTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5pbnRlcm5hbFRhZyA9IG51bGw7XG4gICAgICB0aGlzLmludGVybmFsVmFsdWVzID0gbnVsbDtcbiAgICB9XG4gIH1cblxuICBnZXQgdmFsdWVzKCk6IEJsb2NrVmFsdWVbXSB7XG4gICAgbGV0IHZhbHVlcyA9IHRoaXMuaW50ZXJuYWxWYWx1ZXM7XG5cbiAgICBpZiAoIXZhbHVlcykge1xuICAgICAgbGV0IHsgYmFzZSwgbGVuZ3RoLCBzdGFjayB9ID0gdGhpcztcbiAgICAgIHZhbHVlcyA9IHRoaXMuaW50ZXJuYWxWYWx1ZXMgPSBzdGFjay5zbGljZTxWTUhhbmRsZT4oYmFzZSwgYmFzZSArIGxlbmd0aCAqIDMpO1xuICAgIH1cblxuICAgIHJldHVybiB2YWx1ZXM7XG4gIH1cblxuICBoYXMobmFtZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMubmFtZXMhLmluZGV4T2YobmFtZSkgIT09IC0xO1xuICB9XG5cbiAgZ2V0KG5hbWU6IHN0cmluZyk6IE9wdGlvbjxTY29wZUJsb2NrPiB7XG4gICAgbGV0IHsgYmFzZSwgc3RhY2ssIG5hbWVzIH0gPSB0aGlzO1xuXG4gICAgbGV0IGlkeCA9IG5hbWVzIS5pbmRleE9mKG5hbWUpO1xuXG4gICAgaWYgKG5hbWVzIS5pbmRleE9mKG5hbWUpID09PSAtMSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgbGV0IHRhYmxlID0gY2hlY2soc3RhY2suZ2V0KGlkeCAqIDMsIGJhc2UpLCBDaGVja09wdGlvbihDaGVja0Jsb2NrU3ltYm9sVGFibGUpKTtcbiAgICBsZXQgc2NvcGUgPSBjaGVjayhzdGFjay5nZXQoaWR4ICogMyArIDEsIGJhc2UpLCBDaGVja09wdGlvbihDaGVja1Njb3BlKSkgYXMgT3B0aW9uPFNjb3BlPjsgLy8gRklYTUUobW11bik6IHNob3VsZG4ndCBuZWVkIHRvIGNhc3QgdGhpc1xuICAgIGxldCBoYW5kbGUgPSBjaGVjayhzdGFjay5nZXQoaWR4ICogMyArIDIsIGJhc2UpLCBDaGVja09wdGlvbihDaGVja09yKENoZWNrSGFuZGxlLCBDaGVja0NvbXBpbGFibGVCbG9jaykpKTtcblxuICAgIHJldHVybiBoYW5kbGUgPT09IG51bGwgPyBudWxsIDogW2hhbmRsZSwgc2NvcGUhLCB0YWJsZSFdO1xuICB9XG5cbiAgY2FwdHVyZSgpOiBJQ2FwdHVyZWRCbG9ja0FyZ3VtZW50cyB7XG4gICAgcmV0dXJuIG5ldyBDYXB0dXJlZEJsb2NrQXJndW1lbnRzKHRoaXMubmFtZXMsIHRoaXMudmFsdWVzKTtcbiAgfVxuXG59XG5cbmNsYXNzIENhcHR1cmVkQmxvY2tBcmd1bWVudHMgaW1wbGVtZW50cyBJQ2FwdHVyZWRCbG9ja0FyZ3VtZW50cyB7XG4gIHB1YmxpYyBsZW5ndGg6IG51bWJlcjtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwdWJsaWMgbmFtZXM6IHN0cmluZ1tdLFxuICAgIHB1YmxpYyB2YWx1ZXM6IEJsb2NrVmFsdWVbXVxuICApIHtcbiAgICB0aGlzLmxlbmd0aCA9IG5hbWVzLmxlbmd0aDtcbiAgfVxuXG4gIGhhcyhuYW1lOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5uYW1lcy5pbmRleE9mKG5hbWUpICE9PSAtMTtcbiAgfVxuXG4gIGdldChuYW1lOiBzdHJpbmcpOiBPcHRpb248U2NvcGVCbG9jaz4ge1xuICAgIGxldCBpZHggPSB0aGlzLm5hbWVzLmluZGV4T2YobmFtZSk7XG5cbiAgICBpZiAoaWR4ID09PSAtMSkgcmV0dXJuIG51bGw7XG5cbiAgICByZXR1cm4gW1xuICAgICAgdGhpcy52YWx1ZXNbaWR4ICogMyArIDJdIGFzIFZNSGFuZGxlLFxuICAgICAgdGhpcy52YWx1ZXNbaWR4ICogMyArIDFdIGFzIFNjb3BlLFxuICAgICAgdGhpcy52YWx1ZXNbaWR4ICogM10gYXMgQmxvY2tTeW1ib2xUYWJsZVxuICAgIF07XG4gIH1cbn1cblxuY29uc3QgRU1QVFlfTkFNRUQgPSBuZXcgQ2FwdHVyZWROYW1lZEFyZ3VtZW50cyhDT05TVEFOVF9UQUcsIEVNUFRZX0FSUkFZLCBFTVBUWV9BUlJBWSk7XG5jb25zdCBFTVBUWV9QT1NJVElPTkFMID0gbmV3IENhcHR1cmVkUG9zaXRpb25hbEFyZ3VtZW50cyhDT05TVEFOVF9UQUcsIEVNUFRZX0FSUkFZKTtcbmV4cG9ydCBjb25zdCBFTVBUWV9BUkdTOiBJQ2FwdHVyZWRBcmd1bWVudHMgPSB7IHRhZzogQ09OU1RBTlRfVEFHLCBsZW5ndGg6IDAsIHBvc2l0aW9uYWw6IEVNUFRZX1BPU0lUSU9OQUwsIG5hbWVkOiBFTVBUWV9OQU1FRCB9O1xuIl19","const CURRIED_COMPONENT_DEFINITION_BRAND = 'CURRIED COMPONENT DEFINITION [id=6f00feb9-a0ef-4547-99ea-ac328f80acea]';\nexport function isCurriedComponentDefinition(definition) {\n    return !!(definition && definition[CURRIED_COMPONENT_DEFINITION_BRAND]);\n}\nexport function isComponentDefinition(definition) {\n    return definition && definition[CURRIED_COMPONENT_DEFINITION_BRAND];\n}\nexport class CurriedComponentDefinition {\n    /** @internal */\n    constructor(inner, args) {\n        this.inner = inner;\n        this.args = args;\n        this[CURRIED_COMPONENT_DEFINITION_BRAND] = true;\n    }\n    unwrap(args) {\n        args.realloc(this.offset);\n        let definition = this;\n        while (true) {\n            let { args: curriedArgs, inner } = definition;\n            if (curriedArgs) {\n                args.positional.prepend(curriedArgs.positional);\n                args.named.merge(curriedArgs.named);\n            }\n            if (!isCurriedComponentDefinition(inner)) {\n                return inner;\n            }\n            definition = inner;\n        }\n    }\n    /** @internal */\n    get offset() {\n        let { inner, args } = this;\n        let length = args ? args.positional.length : 0;\n        return isCurriedComponentDefinition(inner) ? length + inner.offset : length;\n    }\n}\nexport function curry(spec, args = null) {\n    return new CurriedComponentDefinition(spec, args);\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3VycmllZC1jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci9ydW50aW1lL2xpYi9jb21wb25lbnQvY3VycmllZC1jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBS0EsTUFBTSxBQUFrQyxxQ0FBRyxBQUF3RSxBQUFDO0FBRXBILEFBQU0sNkNBQXVDLEFBQWtCO0FBQzdELEFBQU0sV0FBQyxDQUFDLEFBQUMsRUFBQyxBQUFVLGNBQUksQUFBVSxXQUFDLEFBQWtDLEFBQUMsQUFBQyxBQUFDLEFBQzFFO0FBQUM7QUFFRCxBQUFNLHNDQUFnQyxBQUFrQjtBQUN0RCxBQUFNLFdBQUMsQUFBVSxjQUFJLEFBQVUsV0FBQyxBQUFrQyxBQUFDLEFBQUMsQUFDdEU7QUFBQztBQUVELEFBQU07QUFDSixBQUFnQjtBQUNoQixnQkFBc0IsQUFBdUQsT0FBWSxBQUFnQztBQUFuRyxhQUFLLFFBQUwsQUFBSyxBQUFrRDtBQUFZLGFBQUksT0FBSixBQUFJLEFBQTRCO0FBQ3ZILEFBQUksYUFBQyxBQUFrQyxBQUFDLHNDQUFHLEFBQUksQUFBQyxBQUNsRDtBQUFDO0FBRUQsQUFBTSxXQUFDLEFBQWU7QUFDcEIsQUFBSSxhQUFDLEFBQU8sUUFBQyxBQUFJLEtBQUMsQUFBTSxBQUFDLEFBQUM7QUFFMUIsWUFBSSxBQUFVLGFBQStCLEFBQUksQUFBQztBQUVsRCxlQUFPLEFBQUksTUFBRSxBQUFDO0FBQ1osZ0JBQUksRUFBRSxBQUFJLE1BQUUsQUFBVyxhQUFFLEFBQUssQUFBRSxVQUFHLEFBQVUsQUFBQztBQUU5QyxBQUFFLEFBQUMsZ0JBQUMsQUFBVyxBQUFDLGFBQUMsQUFBQztBQUNoQixBQUFJLHFCQUFDLEFBQVUsV0FBQyxBQUFPLFFBQUMsQUFBVyxZQUFDLEFBQVUsQUFBQyxBQUFDO0FBQ2hELEFBQUkscUJBQUMsQUFBSyxNQUFDLEFBQUssTUFBQyxBQUFXLFlBQUMsQUFBSyxBQUFDLEFBQUMsQUFDdEM7QUFBQztBQUVELEFBQUUsQUFBQyxnQkFBQyxDQUFDLEFBQTRCLDZCQUFDLEFBQUssQUFBQyxBQUFDLFFBQUMsQUFBQztBQUN6QyxBQUFNLHVCQUFDLEFBQUssQUFBQyxBQUNmO0FBQUM7QUFFRCxBQUFVLHlCQUFHLEFBQUssQUFBQyxBQUNyQjtBQUFDLEFBQ0g7QUFBQztBQUVELEFBQWdCO0FBQ2hCLFFBQUksQUFBTTtBQUNSLFlBQUksRUFBRSxBQUFLLE9BQUUsQUFBSSxBQUFFLFNBQUcsQUFBSSxBQUFDO0FBQzNCLFlBQUksQUFBTSxTQUFHLEFBQUksT0FBRyxBQUFJLEtBQUMsQUFBVSxXQUFDLEFBQU0sU0FBRyxBQUFDLEFBQUM7QUFDL0MsQUFBTSxlQUFDLEFBQTRCLDZCQUFDLEFBQUssQUFBQyxTQUFHLEFBQU0sU0FBRyxBQUFLLE1BQUMsQUFBTSxTQUFHLEFBQU0sQUFBQyxBQUM5RTtBQUFDLEFBQ0Y7O0FBRUQsQUFBTSxzQkFBZ0IsQUFBK0IsTUFBRSxPQUFtQyxBQUFJO0FBQzVGLEFBQU0sV0FBQyxJQUFJLEFBQTBCLDJCQUFDLEFBQTJCLE1BQUUsQUFBSSxBQUFDLEFBQUMsQUFDM0U7QUFBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE9wYXF1ZSwgT3B0aW9uIH0gZnJvbSAnQGdsaW1tZXIvdXRpbCc7XG5cbmltcG9ydCB7IENvbXBvbmVudERlZmluaXRpb24sIFB1YmxpY0NvbXBvbmVudERlZmluaXRpb24gfSBmcm9tICcuL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgSUNhcHR1cmVkQXJndW1lbnRzLCBBcmd1bWVudHMgfSBmcm9tICcuLi92bS9hcmd1bWVudHMnO1xuXG5jb25zdCBDVVJSSUVEX0NPTVBPTkVOVF9ERUZJTklUSU9OX0JSQU5EID0gJ0NVUlJJRUQgQ09NUE9ORU5UIERFRklOSVRJT04gW2lkPTZmMDBmZWI5LWEwZWYtNDU0Ny05OWVhLWFjMzI4ZjgwYWNlYV0nO1xuXG5leHBvcnQgZnVuY3Rpb24gaXNDdXJyaWVkQ29tcG9uZW50RGVmaW5pdGlvbihkZWZpbml0aW9uOiBPcGFxdWUpOiBkZWZpbml0aW9uIGlzIEN1cnJpZWRDb21wb25lbnREZWZpbml0aW9uIHtcbiAgcmV0dXJuICEhKGRlZmluaXRpb24gJiYgZGVmaW5pdGlvbltDVVJSSUVEX0NPTVBPTkVOVF9ERUZJTklUSU9OX0JSQU5EXSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0NvbXBvbmVudERlZmluaXRpb24oZGVmaW5pdGlvbjogT3BhcXVlKTogZGVmaW5pdGlvbiBpcyBDdXJyaWVkQ29tcG9uZW50RGVmaW5pdGlvbiB7XG4gIHJldHVybiBkZWZpbml0aW9uICYmIGRlZmluaXRpb25bQ1VSUklFRF9DT01QT05FTlRfREVGSU5JVElPTl9CUkFORF07XG59XG5cbmV4cG9ydCBjbGFzcyBDdXJyaWVkQ29tcG9uZW50RGVmaW5pdGlvbiB7XG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgY29uc3RydWN0b3IocHJvdGVjdGVkIGlubmVyOiBDb21wb25lbnREZWZpbml0aW9uIHwgQ3VycmllZENvbXBvbmVudERlZmluaXRpb24sIHByb3RlY3RlZCBhcmdzOiBPcHRpb248SUNhcHR1cmVkQXJndW1lbnRzPikge1xuICAgIHRoaXNbQ1VSUklFRF9DT01QT05FTlRfREVGSU5JVElPTl9CUkFORF0gPSB0cnVlO1xuICB9XG5cbiAgdW53cmFwKGFyZ3M6IEFyZ3VtZW50cyk6IENvbXBvbmVudERlZmluaXRpb24ge1xuICAgIGFyZ3MucmVhbGxvYyh0aGlzLm9mZnNldCk7XG5cbiAgICBsZXQgZGVmaW5pdGlvbjogQ3VycmllZENvbXBvbmVudERlZmluaXRpb24gPSB0aGlzO1xuXG4gICAgd2hpbGUgKHRydWUpIHtcbiAgICAgIGxldCB7IGFyZ3M6IGN1cnJpZWRBcmdzLCBpbm5lciB9ID0gZGVmaW5pdGlvbjtcblxuICAgICAgaWYgKGN1cnJpZWRBcmdzKSB7XG4gICAgICAgIGFyZ3MucG9zaXRpb25hbC5wcmVwZW5kKGN1cnJpZWRBcmdzLnBvc2l0aW9uYWwpO1xuICAgICAgICBhcmdzLm5hbWVkLm1lcmdlKGN1cnJpZWRBcmdzLm5hbWVkKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFpc0N1cnJpZWRDb21wb25lbnREZWZpbml0aW9uKGlubmVyKSkge1xuICAgICAgICByZXR1cm4gaW5uZXI7XG4gICAgICB9XG5cbiAgICAgIGRlZmluaXRpb24gPSBpbm5lcjtcbiAgICB9XG4gIH1cblxuICAvKiogQGludGVybmFsICovXG4gIGdldCBvZmZzZXQoKTogbnVtYmVyIHtcbiAgICBsZXQgeyBpbm5lciwgYXJncyB9ID0gdGhpcztcbiAgICBsZXQgbGVuZ3RoID0gYXJncyA/IGFyZ3MucG9zaXRpb25hbC5sZW5ndGggOiAwO1xuICAgIHJldHVybiBpc0N1cnJpZWRDb21wb25lbnREZWZpbml0aW9uKGlubmVyKSA/IGxlbmd0aCArIGlubmVyLm9mZnNldCA6IGxlbmd0aDtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY3Vycnkoc3BlYzogUHVibGljQ29tcG9uZW50RGVmaW5pdGlvbiwgYXJnczogT3B0aW9uPElDYXB0dXJlZEFyZ3VtZW50cz4gPSBudWxsKTogQ3VycmllZENvbXBvbmVudERlZmluaXRpb24ge1xuICByZXR1cm4gbmV3IEN1cnJpZWRDb21wb25lbnREZWZpbml0aW9uKHNwZWMgYXMgQ29tcG9uZW50RGVmaW5pdGlvbiwgYXJncyk7XG59XG4iXX0=","import { isConst } from '@glimmer/reference';\n\nimport { APPEND_OPCODES, UpdatingOpcode } from '../../opcodes';\nimport { ConditionalReference } from '../../references';\nimport { isCurriedComponentDefinition } from '../../component/curried-component';\n\nexport class IsCurriedComponentDefinitionReference extends ConditionalReference {\n    static create(inner) {\n        return new IsCurriedComponentDefinitionReference(inner);\n    }\n    toBool(value) {\n        return isCurriedComponentDefinition(value);\n    }\n}\nAPPEND_OPCODES.add(24 /* DynamicContent */, (vm, { op1: isTrusting }) => {\n    let reference = vm.stack.pop();\n    let value = reference.value();\n    let content;\n    if (isTrusting) {\n        content = vm.elements().appendTrustingDynamicContent(value);\n    } else {\n        content = vm.elements().appendCautiousDynamicContent(value);\n    }\n    if (!isConst(reference)) {\n        vm.updateWith(new UpdateDynamicContentOpcode(reference, content));\n    }\n});\nclass UpdateDynamicContentOpcode extends UpdatingOpcode {\n    constructor(reference, content) {\n        super();\n        this.reference = reference;\n        this.content = content;\n        this.tag = reference.tag;\n    }\n    evaluate(vm) {\n        let { content, reference } = this;\n        content.update(vm.env, reference.value());\n    }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udGVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3J1bnRpbWUvbGliL2NvbXBpbGVkL29wY29kZXMvY29udGVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxBQUFPLFNBQUUsQUFBTyxBQUFzQyxlQUFNLEFBQW9CLEFBQUMsQUFFakYsQUFBTyxBQUFFLEFBQUssQUFBRSxBQUFpQixBQUFFLEFBQU0sQUFBZ0IsQUFBQzs7QUFJMUQsQUFBTyxTQUFFLEFBQWMsZ0JBQUUsQUFBYyxBQUFFLHNCQUFNLEFBQWUsQUFBQztBQUUvRCxBQUFPLFNBQUUsQUFBb0IsQUFBRSw0QkFBTSxBQUFrQixBQUFDO0FBQ3hELEFBQU8sU0FBRSxBQUE0QixBQUFFLG9DQUFNLEFBQW1DLEFBQUMsQUFDakYsQUFBTyxBQUFFLEFBQWtCLEFBQUUsQUFBTSxBQUFnQixBQUFDOztBQUVwRCxBQUFNLGFBQTZDLDhDQUFRLEFBQW9CO0FBQzdFLEFBQU0sV0FBQyxBQUFNLE9BQUMsQUFBd0I7QUFDcEMsQUFBTSxlQUFDLElBQUksQUFBcUMsc0NBQUMsQUFBSyxBQUFDLEFBQUMsQUFDMUQ7QUFBQztBQUVELEFBQU0sV0FBQyxBQUFhO0FBQ2xCLEFBQU0sZUFBQyxBQUE0Qiw2QkFBQyxBQUFLLEFBQUMsQUFBQyxBQUM3QztBQUFDLEFBQ0Y7O0FBRUQsQUFBYyxlQUFDLEFBQUcsNkJBQW9CLENBQUMsQUFBRSxJQUFFLEVBQUUsQUFBRyxLQUFFLEFBQVUsQUFBRTtBQUM1RCxRQUFJLEFBQVMsQUFBRyxBQUFLLFlBQUMsQUFBRSxHQUFDLEFBQUssTUFBQyxBQUFHLEFBQUUsQUFBRSxBQUFrQixBQUFDLEFBQUM7QUFDMUQsUUFBSSxBQUFLLFFBQUcsQUFBUyxVQUFDLEFBQUssQUFBRSxBQUFDO0FBQzlCLFFBQUksQUFBOEIsQUFBQztBQUVuQyxBQUFFLEFBQUMsUUFBQyxBQUFVLEFBQUMsWUFBQyxBQUFDO0FBQ2YsQUFBTyxrQkFBRyxBQUFFLEdBQUMsQUFBUSxBQUFFLFdBQUMsQUFBNEIsNkJBQUMsQUFBSyxBQUFDLEFBQUMsQUFDOUQ7QUFBQyxBQUFDLEFBQUksV0FBQyxBQUFDO0FBQ04sQUFBTyxrQkFBRyxBQUFFLEdBQUMsQUFBUSxBQUFFLFdBQUMsQUFBNEIsNkJBQUMsQUFBSyxBQUFDLEFBQUMsQUFDOUQ7QUFBQztBQUVELEFBQUUsQUFBQyxRQUFDLENBQUMsQUFBTyxRQUFDLEFBQVMsQUFBQyxBQUFDLFlBQUMsQUFBQztBQUN4QixBQUFFLFdBQUMsQUFBVSxXQUFDLElBQUksQUFBMEIsMkJBQUMsQUFBUyxXQUFFLEFBQU8sQUFBQyxBQUFDLEFBQUMsQUFDcEU7QUFBQyxBQUVELEFBQWlCLEFBQUMsQUFBRSxBQUFDLEFBQUssQUFBRSxBQUFDLEFBQUMsQUFBRSxBQUFnQixBQUFDLEFBQUMsQUFDcEQ7QUFBQyxBQUFDLEFBQUM7QUFFSCxNQUFpQyxtQ0FBUSxBQUFjO0FBR3JELGdCQUFvQixBQUFxQyxXQUFVLEFBQThCO0FBQy9GLEFBQUssQUFBRSxBQUFDO0FBRFUsYUFBUyxZQUFULEFBQVMsQUFBNEI7QUFBVSxhQUFPLFVBQVAsQUFBTyxBQUF1QjtBQUUvRixBQUFJLGFBQUMsQUFBRyxNQUFHLEFBQVMsVUFBQyxBQUFHLEFBQUMsQUFDM0I7QUFBQztBQUVELEFBQVEsYUFBQyxBQUFjO0FBQ3JCLFlBQUksRUFBRSxBQUFPLFNBQUUsQUFBUyxBQUFFLGNBQUcsQUFBSSxBQUFDO0FBQ2xDLEFBQU8sZ0JBQUMsQUFBTSxPQUFDLEFBQUUsR0FBQyxBQUFHLEtBQUUsQUFBUyxVQUFDLEFBQUssQUFBRSxBQUFDLEFBQUMsQUFDNUM7QUFBQyxBQUNGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaXNDb25zdCwgUmVmZXJlbmNlLCBUYWcsIFZlcnNpb25lZFJlZmVyZW5jZSB9IGZyb20gJ0BnbGltbWVyL3JlZmVyZW5jZSc7XG5pbXBvcnQgeyBPcCB9IGZyb20gJ0BnbGltbWVyL3ZtJztcbmltcG9ydCB7IGNoZWNrLCBleHBlY3RTdGFja0NoYW5nZSB9IGZyb20gJ0BnbGltbWVyL2RlYnVnJztcbmltcG9ydCB7IE9wYXF1ZSB9IGZyb20gJ0BnbGltbWVyL3V0aWwnO1xuXG5pbXBvcnQgeyBEeW5hbWljQ29udGVudFdyYXBwZXIgfSBmcm9tICcuLi8uLi92bS9jb250ZW50L2R5bmFtaWMnO1xuaW1wb3J0IHsgQVBQRU5EX09QQ09ERVMsIFVwZGF0aW5nT3Bjb2RlIH0gZnJvbSAnLi4vLi4vb3Bjb2Rlcyc7XG5pbXBvcnQgeyBVcGRhdGluZ1ZNIH0gZnJvbSAnLi4vLi4vdm0nO1xuaW1wb3J0IHsgQ29uZGl0aW9uYWxSZWZlcmVuY2UgfSBmcm9tICcuLi8uLi9yZWZlcmVuY2VzJztcbmltcG9ydCB7IGlzQ3VycmllZENvbXBvbmVudERlZmluaXRpb24gfSBmcm9tICcuLi8uLi9jb21wb25lbnQvY3VycmllZC1jb21wb25lbnQnO1xuaW1wb3J0IHsgQ2hlY2tQYXRoUmVmZXJlbmNlIH0gZnJvbSAnLi8tZGVidWctc3RyaXAnO1xuXG5leHBvcnQgY2xhc3MgSXNDdXJyaWVkQ29tcG9uZW50RGVmaW5pdGlvblJlZmVyZW5jZSBleHRlbmRzIENvbmRpdGlvbmFsUmVmZXJlbmNlIHtcbiAgc3RhdGljIGNyZWF0ZShpbm5lcjogUmVmZXJlbmNlPE9wYXF1ZT4pOiBJc0N1cnJpZWRDb21wb25lbnREZWZpbml0aW9uUmVmZXJlbmNlIHtcbiAgICByZXR1cm4gbmV3IElzQ3VycmllZENvbXBvbmVudERlZmluaXRpb25SZWZlcmVuY2UoaW5uZXIpO1xuICB9XG5cbiAgdG9Cb29sKHZhbHVlOiBPcGFxdWUpOiBib29sZWFuIHtcbiAgICByZXR1cm4gaXNDdXJyaWVkQ29tcG9uZW50RGVmaW5pdGlvbih2YWx1ZSk7XG4gIH1cbn1cblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkR5bmFtaWNDb250ZW50LCAodm0sIHsgb3AxOiBpc1RydXN0aW5nIH0pID0+IHtcbiAgbGV0IHJlZmVyZW5jZSA9IGNoZWNrKHZtLnN0YWNrLnBvcCgpLCBDaGVja1BhdGhSZWZlcmVuY2UpO1xuICBsZXQgdmFsdWUgPSByZWZlcmVuY2UudmFsdWUoKTtcbiAgbGV0IGNvbnRlbnQ6IER5bmFtaWNDb250ZW50V3JhcHBlcjtcblxuICBpZiAoaXNUcnVzdGluZykge1xuICAgIGNvbnRlbnQgPSB2bS5lbGVtZW50cygpLmFwcGVuZFRydXN0aW5nRHluYW1pY0NvbnRlbnQodmFsdWUpO1xuICB9IGVsc2Uge1xuICAgIGNvbnRlbnQgPSB2bS5lbGVtZW50cygpLmFwcGVuZENhdXRpb3VzRHluYW1pY0NvbnRlbnQodmFsdWUpO1xuICB9XG5cbiAgaWYgKCFpc0NvbnN0KHJlZmVyZW5jZSkpIHtcbiAgICB2bS51cGRhdGVXaXRoKG5ldyBVcGRhdGVEeW5hbWljQ29udGVudE9wY29kZShyZWZlcmVuY2UsIGNvbnRlbnQpKTtcbiAgfVxuXG4gIGV4cGVjdFN0YWNrQ2hhbmdlKHZtLnN0YWNrLCAtMSwgJ0R5bmFtaWNDb250ZW50Jyk7XG59KTtcblxuY2xhc3MgVXBkYXRlRHluYW1pY0NvbnRlbnRPcGNvZGUgZXh0ZW5kcyBVcGRhdGluZ09wY29kZSB7XG4gIHB1YmxpYyB0YWc6IFRhZztcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlZmVyZW5jZTogVmVyc2lvbmVkUmVmZXJlbmNlPE9wYXF1ZT4sIHByaXZhdGUgY29udGVudDogRHluYW1pY0NvbnRlbnRXcmFwcGVyKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLnRhZyA9IHJlZmVyZW5jZS50YWc7XG4gIH1cblxuICBldmFsdWF0ZSh2bTogVXBkYXRpbmdWTSk6IHZvaWQge1xuICAgIGxldCB7IGNvbnRlbnQsIHJlZmVyZW5jZSB9ID0gdGhpcztcbiAgICBjb250ZW50LnVwZGF0ZSh2bS5lbnYsIHJlZmVyZW5jZS52YWx1ZSgpKTtcbiAgfVxufVxuIl19","import { CONSTANT_TAG, isConst, isModified, ReferenceCache } from '@glimmer/reference';\nimport { initializeGuid, assert } from '@glimmer/util';\n\nimport { stackAssert } from './assert';\nimport { APPEND_OPCODES, UpdatingOpcode } from '../../opcodes';\nimport { PrimitiveReference } from '../../references';\n\nAPPEND_OPCODES.add(18 /* ChildScope */, vm => vm.pushChildScope());\nAPPEND_OPCODES.add(19 /* PopScope */, vm => vm.popScope());\nAPPEND_OPCODES.add(37 /* PushDynamicScope */, vm => vm.pushDynamicScope());\nAPPEND_OPCODES.add(38 /* PopDynamicScope */, vm => vm.popDynamicScope());\nAPPEND_OPCODES.add(10 /* Constant */, (vm, { op1: other }) => {\n    vm.stack.push(vm.constants.getOther(other));\n});\nAPPEND_OPCODES.add(11 /* Primitive */, (vm, { op1: primitive }) => {\n    let stack = vm.stack;\n    let flag = primitive & 7; // 111\n    let value = primitive >> 3;\n    switch (flag) {\n        case 0 /* NUMBER */:\n            stack.push(value);\n            break;\n        case 1 /* FLOAT */:\n            stack.push(vm.constants.getFloat(value));\n            break;\n        case 2 /* STRING */:\n            stack.push(vm.constants.getString(value));\n            break;\n        case 3 /* BOOLEAN_OR_VOID */:\n            switch (value) {\n                case 0:\n                    stack.push(false);\n                    break;\n                case 1:\n                    stack.push(true);\n                    break;\n                case 2:\n                    stack.push(null);\n                    break;\n                case 3:\n                    stack.push(undefined);\n                    break;\n            }\n            break;\n        case 4 /* NEGATIVE */:\n            stack.push(vm.constants.getNegative(value));\n            break;\n    }\n});\nAPPEND_OPCODES.add(12 /* PrimitiveReference */, vm => {\n    let stack = vm.stack;\n    stack.push(PrimitiveReference.create(stack.pop()));\n});\nAPPEND_OPCODES.add(13 /* Dup */, (vm, { op1: register, op2: offset }) => {\n    let position = vm.fetchValue(register) - offset;\n    vm.stack.dup(position);\n});\nAPPEND_OPCODES.add(14 /* Pop */, (vm, { op1: count }) => {\n    vm.stack.pop(count);\n});\nAPPEND_OPCODES.add(15 /* Load */, (vm, { op1: register }) => {\n    vm.load(register);\n});\nAPPEND_OPCODES.add(16 /* Fetch */, (vm, { op1: register }) => {\n    vm.fetch(register);\n});\nAPPEND_OPCODES.add(36 /* BindDynamicScope */, (vm, { op1: _names }) => {\n    let names = vm.constants.getArray(_names);\n    vm.bindDynamicScope(names);\n});\nAPPEND_OPCODES.add(48 /* PushFrame */, vm => {\n    vm.pushFrame();\n});\nAPPEND_OPCODES.add(49 /* PopFrame */, vm => {\n    vm.popFrame();\n});\nAPPEND_OPCODES.add(50 /* Enter */, (vm, { op1: args }) => {\n    vm.enter(args);\n});\nAPPEND_OPCODES.add(51 /* Exit */, vm => {\n    vm.exit();\n});\nAPPEND_OPCODES.add(41 /* PushSymbolTable */, (vm, { op1: _table }) => {\n    let stack = vm.stack;\n    stack.push(vm.constants.getSymbolTable(_table));\n});\nAPPEND_OPCODES.add(40 /* PushBlockScope */, vm => {\n    let stack = vm.stack;\n    stack.push(vm.scope());\n});\nAPPEND_OPCODES.add(39 /* CompileBlock */, vm => {\n    let stack = vm.stack;\n    let block = stack.pop();\n    stack.push(block ? block.compile() : null);\n});\nAPPEND_OPCODES.add(42 /* InvokeVirtual */, vm => {\n    vm.call(vm.stack.pop());\n});\nAPPEND_OPCODES.add(43 /* InvokeStatic */, (vm, { op1: handle }) => {\n    vm.call(handle);\n});\nAPPEND_OPCODES.add(44 /* InvokeYield */, vm => {\n    let { stack } = vm;\n    let handle = stack.pop();\n    let scope = stack.pop(); // FIXME(mmun): shouldn't need to cast this\n    let table = stack.pop();\n    (false && assert(table === null || table && typeof table === 'object' && Array.isArray(table.parameters), stackAssert('Option<BlockSymbolTable>', table)));\n\n    let args = stack.pop();\n    if (table === null) {\n        // To balance the pop{Frame,Scope}\n        vm.pushFrame();\n        vm.pushScope(scope); // Could be null but it doesnt matter as it is immediatelly popped.\n        return;\n    }\n    let invokingScope = scope;\n    // If necessary, create a child scope\n    {\n        let locals = table.parameters;\n        let localsCount = locals.length;\n        if (localsCount > 0) {\n            invokingScope = invokingScope.child();\n            for (let i = 0; i < localsCount; i++) {\n                invokingScope.bindSymbol(locals[i], args.at(i));\n            }\n        }\n    }\n    vm.pushFrame();\n    vm.pushScope(invokingScope);\n    vm.call(handle);\n});\nAPPEND_OPCODES.add(45 /* Jump */, (vm, { op1: target }) => {\n    vm.goto(target);\n});\nAPPEND_OPCODES.add(46 /* JumpIf */, (vm, { op1: target }) => {\n    let reference = vm.stack.pop();\n    if (isConst(reference)) {\n        if (reference.value()) {\n            vm.goto(target);\n        }\n    } else {\n        let cache = new ReferenceCache(reference);\n        if (cache.peek()) {\n            vm.goto(target);\n        }\n        vm.updateWith(new Assert(cache));\n    }\n});\nAPPEND_OPCODES.add(47 /* JumpUnless */, (vm, { op1: target }) => {\n    let reference = vm.stack.pop();\n    if (isConst(reference)) {\n        if (!reference.value()) {\n            vm.goto(target);\n        }\n    } else {\n        let cache = new ReferenceCache(reference);\n        if (!cache.peek()) {\n            vm.goto(target);\n        }\n        vm.updateWith(new Assert(cache));\n    }\n});\nAPPEND_OPCODES.add(20 /* Return */, vm => {\n    vm.return();\n});\nAPPEND_OPCODES.add(21 /* ReturnTo */, (vm, { op1: relative }) => {\n    vm.returnTo(relative);\n});\nAPPEND_OPCODES.add(52 /* ToBoolean */, vm => {\n    let { env, stack } = vm;\n    stack.push(env.toConditionalReference(stack.pop()));\n});\nexport class Assert extends UpdatingOpcode {\n    constructor(cache) {\n        super();\n        this.type = 'assert';\n        this.tag = cache.tag;\n        this.cache = cache;\n    }\n    evaluate(vm) {\n        let { cache } = this;\n        if (isModified(cache.revalidate())) {\n            vm.throw();\n        }\n    }\n}\nexport class JumpIfNotModifiedOpcode extends UpdatingOpcode {\n    constructor(tag, target) {\n        super();\n        this.target = target;\n        this.type = 'jump-if-not-modified';\n        this.tag = tag;\n        this.lastRevision = tag.value();\n    }\n    evaluate(vm) {\n        let { tag, target, lastRevision } = this;\n        if (!vm.alwaysRevalidate && tag.validate(lastRevision)) {\n            vm.goto(target);\n        }\n    }\n    didModify() {\n        this.lastRevision = this.tag.value();\n    }\n}\nexport class DidModifyOpcode extends UpdatingOpcode {\n    constructor(target) {\n        super();\n        this.target = target;\n        this.type = 'did-modify';\n        this.tag = CONSTANT_TAG;\n    }\n    evaluate() {\n        this.target.didModify();\n    }\n}\nexport class LabelOpcode {\n    constructor(label) {\n        this.tag = CONSTANT_TAG;\n        this.type = 'label';\n        this.label = null;\n        this.prev = null;\n        this.next = null;\n        initializeGuid(this);\n        this.label = label;\n    }\n    evaluate() {}\n    inspect() {\n        return `${this.label} [${this._guid}]`;\n    }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidm0uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci9ydW50aW1lL2xpYi9jb21waWxlZC9vcGNvZGVzL3ZtLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLEFBQU8sU0FDTCxBQUFZLGNBQ1osQUFBTyxTQUNQLEFBQVUsWUFDVixBQUFjLEFBR2Ysc0JBQU0sQUFBb0IsQUFBQztBQUM1QixBQUFPLFNBQUUsQUFBYyxnQkFBRSxBQUFNLEFBQUUsY0FBTSxBQUFlLEFBQUMsQUFDdkQsQUFBTyxBQUFFLEFBQWlCLEFBQUUsQUFBVyxBQUFFLEFBQUssQUFBRSxBQUFlLEFBQUUsQUFBVyxBQUFFLEFBQXFCLEFBQUUsQUFBVyxBQUFFLEFBQWMsQUFBRSxBQUFNLEFBQWdCLEFBQUM7O0FBQ3pKLEFBQU8sU0FBRSxBQUFXLEFBQUUsbUJBQU0sQUFBVSxBQUFDO0FBQ3ZDLEFBQU8sU0FBRSxBQUFjLGdCQUFFLEFBQWMsQUFBRSxzQkFBTSxBQUFlLEFBQUM7QUFFL0QsQUFBTyxTQUFFLEFBQWtCLEFBQUUsMEJBQU0sQUFBa0IsQUFBQyxBQUd0RCxBQUFPLEFBQUUsQUFBUyxBQUFFLEFBQU0sQUFBb0IsQUFBQyxBQUUvQyxBQUFPLEFBQUUsQUFBYyxBQUFFLEFBQVUsQUFBRSxBQUFNLEFBQWdCLEFBQUM7O0FBRTVELEFBQWMsZUFBQyxBQUFHLHlCQUFnQixBQUFFLE1BQUksQUFBRSxHQUFDLEFBQWMsQUFBRSxBQUFDLEFBQUM7QUFFN0QsQUFBYyxlQUFDLEFBQUcsdUJBQWMsQUFBRSxNQUFJLEFBQUUsR0FBQyxBQUFRLEFBQUUsQUFBQyxBQUFDO0FBRXJELEFBQWMsZUFBQyxBQUFHLCtCQUFzQixBQUFFLE1BQUksQUFBRSxHQUFDLEFBQWdCLEFBQUUsQUFBQyxBQUFDO0FBRXJFLEFBQWMsZUFBQyxBQUFHLDhCQUFxQixBQUFFLE1BQUksQUFBRSxHQUFDLEFBQWUsQUFBRSxBQUFDLEFBQUM7QUFF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LEFBQUM7QUFHZixBQUFjLHVCQUFDLEFBQUksQUFBQyxBQUFDO0FBQ3JCLEFBQUksYUFBQyxBQUFLLFFBQUcsQUFBSyxBQUFDLEFBQ3JCO0FBQUM7QUFFRCxBQUFRLGVBQUksQ0FBQztBQUViLEFBQU87QUFDTCxBQUFNLEFBQUMsa0JBQUcsQUFBSSxLQUFDLEFBQUssVUFBSyxBQUFJLEtBQUMsQUFBSyxLQUFHLEFBQUMsQUFDekM7QUFBQyxBQUNGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgT3AgfSBmcm9tICdAZ2xpbW1lci92bSc7XG5pbXBvcnQgeyBPcGFxdWUsIE9wdGlvbiwgUmVjYXN0LCBWTUhhbmRsZSB9IGZyb20gJ0BnbGltbWVyL2ludGVyZmFjZXMnO1xuaW1wb3J0IHtcbiAgQ09OU1RBTlRfVEFHLFxuICBpc0NvbnN0LFxuICBpc01vZGlmaWVkLFxuICBSZWZlcmVuY2VDYWNoZSxcbiAgUmV2aXNpb24sXG4gIFRhZ1xufSBmcm9tICdAZ2xpbW1lci9yZWZlcmVuY2UnO1xuaW1wb3J0IHsgaW5pdGlhbGl6ZUd1aWQsIGFzc2VydCB9IGZyb20gJ0BnbGltbWVyL3V0aWwnO1xuaW1wb3J0IHsgZXhwZWN0U3RhY2tDaGFuZ2UsIENoZWNrTnVtYmVyLCBjaGVjaywgQ2hlY2tJbnN0YW5jZW9mLCBDaGVja09wdGlvbiwgQ2hlY2tCbG9ja1N5bWJvbFRhYmxlLCBDaGVja0hhbmRsZSwgQ2hlY2tQcmltaXRpdmUgfSBmcm9tICdAZ2xpbW1lci9kZWJ1Zyc7XG5pbXBvcnQgeyBzdGFja0Fzc2VydCB9IGZyb20gJy4vYXNzZXJ0JztcbmltcG9ydCB7IEFQUEVORF9PUENPREVTLCBVcGRhdGluZ09wY29kZSB9IGZyb20gJy4uLy4uL29wY29kZXMnO1xuaW1wb3J0IHsgU2NvcGUgfSBmcm9tICcuLi8uLi9lbnZpcm9ubWVudCc7XG5pbXBvcnQgeyBQcmltaXRpdmVSZWZlcmVuY2UgfSBmcm9tICcuLi8uLi9yZWZlcmVuY2VzJztcbmltcG9ydCB7IENvbXBpbGFibGVUZW1wbGF0ZSB9IGZyb20gJy4uLy4uL3N5bnRheC9pbnRlcmZhY2VzJztcbmltcG9ydCB7IFZNLCBVcGRhdGluZ1ZNIH0gZnJvbSAnLi4vLi4vdm0nO1xuaW1wb3J0IHsgQXJndW1lbnRzIH0gZnJvbSAnLi4vLi4vdm0vYXJndW1lbnRzJztcbmltcG9ydCB7IExhenlDb25zdGFudHMsIFByaW1pdGl2ZVR5cGUgfSBmcm9tIFwiQGdsaW1tZXIvcHJvZ3JhbVwiO1xuaW1wb3J0IHsgQ2hlY2tSZWZlcmVuY2UsIENoZWNrU2NvcGUgfSBmcm9tICcuLy1kZWJ1Zy1zdHJpcCc7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5DaGlsZFNjb3BlLCB2bSA9PiB2bS5wdXNoQ2hpbGRTY29wZSgpKTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLlBvcFNjb3BlLCB2bSA9PiB2bS5wb3BTY29wZSgpKTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLlB1c2hEeW5hbWljU2NvcGUsIHZtID0+IHZtLnB1c2hEeW5hbWljU2NvcGUoKSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5Qb3BEeW5hbWljU2NvcGUsIHZtID0+IHZtLnBvcER5bmFtaWNTY29wZSgpKTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkNvbnN0YW50LCAodm06IFZNPE9wYXF1ZT4gJiB7IGNvbnN0YW50czogTGF6eUNvbnN0YW50cyB9LCB7IG9wMTogb3RoZXIgfSkgPT4ge1xuICB2bS5zdGFjay5wdXNoKHZtLmNvbnN0YW50cy5nZXRPdGhlcihvdGhlcikpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5QcmltaXRpdmUsICh2bSwgeyBvcDE6IHByaW1pdGl2ZSB9KSA9PiB7XG4gIGxldCBzdGFjayA9IHZtLnN0YWNrO1xuICBsZXQgZmxhZyA9IHByaW1pdGl2ZSAmIDc7IC8vIDExMVxuICBsZXQgdmFsdWUgPSBwcmltaXRpdmUgPj4gMztcblxuICBzd2l0Y2ggKGZsYWcpIHtcbiAgICBjYXNlIFByaW1pdGl2ZVR5cGUuTlVNQkVSOlxuICAgICAgc3RhY2sucHVzaCh2YWx1ZSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIFByaW1pdGl2ZVR5cGUuRkxPQVQ6XG4gICAgICBzdGFjay5wdXNoKHZtLmNvbnN0YW50cy5nZXRGbG9hdCh2YWx1ZSkpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBQcmltaXRpdmVUeXBlLlNUUklORzpcbiAgICAgIHN0YWNrLnB1c2godm0uY29uc3RhbnRzLmdldFN0cmluZyh2YWx1ZSkpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBQcmltaXRpdmVUeXBlLkJPT0xFQU5fT1JfVk9JRDpcbiAgICAgIHN3aXRjaCAodmFsdWUpIHtcbiAgICAgICAgY2FzZSAwOiBzdGFjay5wdXNoKGZhbHNlKTsgYnJlYWs7XG4gICAgICAgIGNhc2UgMTogc3RhY2sucHVzaCh0cnVlKTsgYnJlYWs7XG4gICAgICAgIGNhc2UgMjogc3RhY2sucHVzaChudWxsKTsgYnJlYWs7XG4gICAgICAgIGNhc2UgMzogc3RhY2sucHVzaCh1bmRlZmluZWQpOyBicmVhaztcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgUHJpbWl0aXZlVHlwZS5ORUdBVElWRTpcbiAgICAgIHN0YWNrLnB1c2godm0uY29uc3RhbnRzLmdldE5lZ2F0aXZlKHZhbHVlKSk7XG4gICAgICBicmVhaztcbiAgfVxufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5QcmltaXRpdmVSZWZlcmVuY2UsIHZtID0+IHtcbiAgbGV0IHN0YWNrID0gdm0uc3RhY2s7XG4gIHN0YWNrLnB1c2goUHJpbWl0aXZlUmVmZXJlbmNlLmNyZWF0ZShjaGVjayhzdGFjay5wb3AoKSwgQ2hlY2tQcmltaXRpdmUpKSk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkR1cCwgKHZtLCB7IG9wMTogcmVnaXN0ZXIsIG9wMjogb2Zmc2V0IH0pID0+IHtcbiAgbGV0IHBvc2l0aW9uID0gY2hlY2sodm0uZmV0Y2hWYWx1ZShyZWdpc3RlciksIENoZWNrTnVtYmVyKSAtIG9mZnNldDtcbiAgdm0uc3RhY2suZHVwKHBvc2l0aW9uKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUG9wLCAodm0sIHsgb3AxOiBjb3VudCB9KSA9PiB7XG4gIHZtLnN0YWNrLnBvcChjb3VudCk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkxvYWQsICh2bSwgeyBvcDE6IHJlZ2lzdGVyIH0pID0+IHtcbiAgdm0ubG9hZChyZWdpc3Rlcik7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkZldGNoLCAodm0sIHsgb3AxOiByZWdpc3RlciB9KSA9PiB7XG4gIHZtLmZldGNoKHJlZ2lzdGVyKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuQmluZER5bmFtaWNTY29wZSwgKHZtLCB7IG9wMTogX25hbWVzIH0pID0+IHtcbiAgbGV0IG5hbWVzID0gdm0uY29uc3RhbnRzLmdldEFycmF5KF9uYW1lcyk7XG4gIHZtLmJpbmREeW5hbWljU2NvcGUobmFtZXMpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5QdXNoRnJhbWUsIHZtID0+IHtcbiAgdm0ucHVzaEZyYW1lKCk7XG5cbiAgY2hlY2sodm0uc3RhY2sucGVlaygpLCBDaGVja051bWJlcik7XG4gIGNoZWNrKHZtLnN0YWNrLnBlZWsoMSksIENoZWNrTnVtYmVyKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUG9wRnJhbWUsIHZtID0+IHtcbiAgdm0ucG9wRnJhbWUoKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuRW50ZXIsICh2bSwgeyBvcDE6IGFyZ3MgfSkgPT4ge1xuICB2bS5lbnRlcihhcmdzKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuRXhpdCwgdm0gPT4ge1xuICB2bS5leGl0KCk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLlB1c2hTeW1ib2xUYWJsZSwgKHZtLCB7IG9wMTogX3RhYmxlIH0pID0+IHtcbiAgbGV0IHN0YWNrID0gdm0uc3RhY2s7XG4gIHN0YWNrLnB1c2godm0uY29uc3RhbnRzLmdldFN5bWJvbFRhYmxlKF90YWJsZSkpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5QdXNoQmxvY2tTY29wZSwgKHZtKSA9PiB7XG4gIGxldCBzdGFjayA9IHZtLnN0YWNrO1xuICBzdGFjay5wdXNoKHZtLnNjb3BlKCkpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5Db21waWxlQmxvY2ssIHZtID0+IHtcbiAgbGV0IHN0YWNrID0gdm0uc3RhY2s7XG4gIGxldCBibG9jayA9IHN0YWNrLnBvcDxPcHRpb248Q29tcGlsYWJsZVRlbXBsYXRlPiB8IDA+KCk7XG4gIHN0YWNrLnB1c2goYmxvY2sgPyBibG9jay5jb21waWxlKCkgOiBudWxsKTtcblxuICBjaGVjayh2bS5zdGFjay5wZWVrKCksIENoZWNrT3B0aW9uKENoZWNrTnVtYmVyKSk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkludm9rZVZpcnR1YWwsIHZtID0+IHtcbiAgdm0uY2FsbChjaGVjayh2bS5zdGFjay5wb3AoKSwgQ2hlY2tIYW5kbGUpKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuSW52b2tlU3RhdGljLCAodm0sIHsgb3AxOiBoYW5kbGUgfSkgPT4ge1xuICB2bS5jYWxsKGhhbmRsZSBhcyBSZWNhc3Q8bnVtYmVyLCBWTUhhbmRsZT4pO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5JbnZva2VZaWVsZCwgdm0gPT4ge1xuICBsZXQgeyBzdGFjayB9ID0gdm07XG5cbiAgbGV0IGhhbmRsZSA9IGNoZWNrKHN0YWNrLnBvcCgpLCBDaGVja09wdGlvbihDaGVja0hhbmRsZSkpO1xuICBsZXQgc2NvcGUgPSBjaGVjayhzdGFjay5wb3AoKSwgQ2hlY2tPcHRpb24oQ2hlY2tTY29wZSkpIGFzIE9wdGlvbjxTY29wZT47IC8vIEZJWE1FKG1tdW4pOiBzaG91bGRuJ3QgbmVlZCB0byBjYXN0IHRoaXNcbiAgbGV0IHRhYmxlID0gY2hlY2soc3RhY2sucG9wKCksIENoZWNrT3B0aW9uKENoZWNrQmxvY2tTeW1ib2xUYWJsZSkpO1xuXG4gIGFzc2VydCh0YWJsZSA9PT0gbnVsbCB8fCAodGFibGUgJiYgdHlwZW9mIHRhYmxlID09PSAnb2JqZWN0JyAmJiBBcnJheS5pc0FycmF5KHRhYmxlLnBhcmFtZXRlcnMpKSwgc3RhY2tBc3NlcnQoJ09wdGlvbjxCbG9ja1N5bWJvbFRhYmxlPicsIHRhYmxlKSk7XG5cbiAgbGV0IGFyZ3MgPSBjaGVjayhzdGFjay5wb3AoKSwgQ2hlY2tJbnN0YW5jZW9mKEFyZ3VtZW50cykpO1xuXG4gIGlmICh0YWJsZSA9PT0gbnVsbCkge1xuXG4gICAgLy8gVG8gYmFsYW5jZSB0aGUgcG9we0ZyYW1lLFNjb3BlfVxuICAgIHZtLnB1c2hGcmFtZSgpO1xuICAgIHZtLnB1c2hTY29wZShzY29wZSEpOyAvLyBDb3VsZCBiZSBudWxsIGJ1dCBpdCBkb2VzbnQgbWF0dGVyIGFzIGl0IGlzIGltbWVkaWF0ZWxseSBwb3BwZWQuXG4gICAgcmV0dXJuO1xuICB9XG5cbiAgbGV0IGludm9raW5nU2NvcGUgPSBzY29wZSE7XG5cbiAgLy8gSWYgbmVjZXNzYXJ5LCBjcmVhdGUgYSBjaGlsZCBzY29wZVxuICB7XG4gICAgbGV0IGxvY2FscyA9IHRhYmxlLnBhcmFtZXRlcnM7XG4gICAgbGV0IGxvY2Fsc0NvdW50ID0gbG9jYWxzLmxlbmd0aDtcblxuICAgIGlmIChsb2NhbHNDb3VudCA+IDApIHtcbiAgICAgIGludm9raW5nU2NvcGUgPSBpbnZva2luZ1Njb3BlLmNoaWxkKCk7XG5cbiAgICAgIGZvciAobGV0IGk9MDsgaTxsb2NhbHNDb3VudDsgaSsrKSB7XG4gICAgICAgIGludm9raW5nU2NvcGUuYmluZFN5bWJvbChsb2NhbHMhW2ldLCBhcmdzLmF0KGkpKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB2bS5wdXNoRnJhbWUoKTtcbiAgdm0ucHVzaFNjb3BlKGludm9raW5nU2NvcGUpO1xuICB2bS5jYWxsKGhhbmRsZSEpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5KdW1wLCAodm0sIHsgb3AxOiB0YXJnZXQgfSkgPT4ge1xuICB2bS5nb3RvKHRhcmdldCk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkp1bXBJZiwgKHZtLCB7IG9wMTogdGFyZ2V0IH0pID0+IHtcbiAgbGV0IHJlZmVyZW5jZSA9IGNoZWNrKHZtLnN0YWNrLnBvcCgpLCBDaGVja1JlZmVyZW5jZSk7XG5cbiAgaWYgKGlzQ29uc3QocmVmZXJlbmNlKSkge1xuICAgIGlmIChyZWZlcmVuY2UudmFsdWUoKSkge1xuICAgICAgdm0uZ290byh0YXJnZXQpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBsZXQgY2FjaGUgPSBuZXcgUmVmZXJlbmNlQ2FjaGUocmVmZXJlbmNlKTtcblxuICAgIGlmIChjYWNoZS5wZWVrKCkpIHtcbiAgICAgIHZtLmdvdG8odGFyZ2V0KTtcbiAgICB9XG5cbiAgICB2bS51cGRhdGVXaXRoKG5ldyBBc3NlcnQoY2FjaGUpKTtcbiAgfVxufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5KdW1wVW5sZXNzLCAodm0sIHsgb3AxOiB0YXJnZXQgfSkgPT4ge1xuICBsZXQgcmVmZXJlbmNlID0gY2hlY2sodm0uc3RhY2sucG9wKCksIENoZWNrUmVmZXJlbmNlKTtcblxuICBpZiAoaXNDb25zdChyZWZlcmVuY2UpKSB7XG4gICAgaWYgKCFyZWZlcmVuY2UudmFsdWUoKSkge1xuICAgICAgdm0uZ290byh0YXJnZXQpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBsZXQgY2FjaGUgPSBuZXcgUmVmZXJlbmNlQ2FjaGUocmVmZXJlbmNlKTtcblxuICAgIGlmICghY2FjaGUucGVlaygpKSB7XG4gICAgICB2bS5nb3RvKHRhcmdldCk7XG4gICAgfVxuXG4gICAgdm0udXBkYXRlV2l0aChuZXcgQXNzZXJ0KGNhY2hlKSk7XG4gIH1cbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUmV0dXJuLCB2bSA9PiB7XG4gIHZtLnJldHVybigpO1xuXG4gIGV4cGVjdFN0YWNrQ2hhbmdlKHZtLnN0YWNrLCAwLCAnUmV0dXJuJyk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLlJldHVyblRvLCAodm0sIHsgb3AxOiByZWxhdGl2ZSB9KSA9PiB7XG4gIHZtLnJldHVyblRvKHJlbGF0aXZlKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuVG9Cb29sZWFuLCB2bSA9PiB7XG4gIGxldCB7IGVudiwgc3RhY2sgfSA9IHZtO1xuICBzdGFjay5wdXNoKGVudi50b0NvbmRpdGlvbmFsUmVmZXJlbmNlKGNoZWNrKHN0YWNrLnBvcCgpLCBDaGVja1JlZmVyZW5jZSkpKTtcbn0pO1xuXG5leHBvcnQgY2xhc3MgQXNzZXJ0IGV4dGVuZHMgVXBkYXRpbmdPcGNvZGUge1xuICBwdWJsaWMgdHlwZSA9ICdhc3NlcnQnO1xuXG4gIHB1YmxpYyB0YWc6IFRhZztcblxuICBwcml2YXRlIGNhY2hlOiBSZWZlcmVuY2VDYWNoZTxPcGFxdWU+O1xuXG4gIGNvbnN0cnVjdG9yKGNhY2hlOiBSZWZlcmVuY2VDYWNoZTxPcGFxdWU+KSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLnRhZyA9IGNhY2hlLnRhZztcbiAgICB0aGlzLmNhY2hlID0gY2FjaGU7XG4gIH1cblxuICBldmFsdWF0ZSh2bTogVXBkYXRpbmdWTTxPcGFxdWU+KSB7XG4gICAgbGV0IHsgY2FjaGUgfSA9IHRoaXM7XG5cbiAgICBpZiAoaXNNb2RpZmllZChjYWNoZS5yZXZhbGlkYXRlKCkpKSB7XG4gICAgICB2bS50aHJvdygpO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgSnVtcElmTm90TW9kaWZpZWRPcGNvZGUgZXh0ZW5kcyBVcGRhdGluZ09wY29kZSB7XG4gIHB1YmxpYyB0eXBlID0gJ2p1bXAtaWYtbm90LW1vZGlmaWVkJztcblxuICBwdWJsaWMgdGFnOiBUYWc7XG5cbiAgcHJpdmF0ZSBsYXN0UmV2aXNpb246IFJldmlzaW9uO1xuXG4gIGNvbnN0cnVjdG9yKHRhZzogVGFnLCBwcml2YXRlIHRhcmdldDogTGFiZWxPcGNvZGUpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMudGFnID0gdGFnO1xuICAgIHRoaXMubGFzdFJldmlzaW9uID0gdGFnLnZhbHVlKCk7XG4gIH1cblxuICBldmFsdWF0ZSh2bTogVXBkYXRpbmdWTSkge1xuICAgIGxldCB7IHRhZywgdGFyZ2V0LCBsYXN0UmV2aXNpb24gfSA9IHRoaXM7XG5cbiAgICBpZiAoIXZtLmFsd2F5c1JldmFsaWRhdGUgJiYgdGFnLnZhbGlkYXRlKGxhc3RSZXZpc2lvbikpIHtcbiAgICAgIHZtLmdvdG8odGFyZ2V0KTtcbiAgICB9XG4gIH1cblxuICBkaWRNb2RpZnkoKSB7XG4gICAgdGhpcy5sYXN0UmV2aXNpb24gPSB0aGlzLnRhZy52YWx1ZSgpO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBEaWRNb2RpZnlPcGNvZGUgZXh0ZW5kcyBVcGRhdGluZ09wY29kZSB7XG4gIHB1YmxpYyB0eXBlID0gJ2RpZC1tb2RpZnknO1xuXG4gIHB1YmxpYyB0YWc6IFRhZztcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHRhcmdldDogSnVtcElmTm90TW9kaWZpZWRPcGNvZGUpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMudGFnID0gQ09OU1RBTlRfVEFHO1xuICB9XG5cbiAgZXZhbHVhdGUoKSB7XG4gICAgdGhpcy50YXJnZXQuZGlkTW9kaWZ5KCk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIExhYmVsT3Bjb2RlIGltcGxlbWVudHMgVXBkYXRpbmdPcGNvZGUge1xuICBwdWJsaWMgdGFnOiBUYWcgPSBDT05TVEFOVF9UQUc7XG4gIHB1YmxpYyB0eXBlID0gJ2xhYmVsJztcbiAgcHVibGljIGxhYmVsOiBPcHRpb248c3RyaW5nPiA9IG51bGw7XG4gIHB1YmxpYyBfZ3VpZDogbnVtYmVyO1xuXG4gIHByZXY6IGFueSA9IG51bGw7XG4gIG5leHQ6IGFueSA9IG51bGw7XG5cbiAgY29uc3RydWN0b3IobGFiZWw6IHN0cmluZykge1xuICAgIGluaXRpYWxpemVHdWlkKHRoaXMpO1xuICAgIHRoaXMubGFiZWwgPSBsYWJlbDtcbiAgfVxuXG4gIGV2YWx1YXRlKCkge31cblxuICBpbnNwZWN0KCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGAke3RoaXMubGFiZWx9IFske3RoaXMuX2d1aWR9XWA7XG4gIH1cbn1cbiJdfQ==","import { ReferenceCache, isConst, isConstTag } from '@glimmer/reference';\n\nimport { Register } from '@glimmer/vm';\nimport { APPEND_OPCODES, UpdatingOpcode } from '../../opcodes';\nimport { Assert } from './vm';\n\nAPPEND_OPCODES.add(22 /* Text */, (vm, { op1: text }) => {\n    vm.elements().appendText(vm.constants.getString(text));\n});\nAPPEND_OPCODES.add(26 /* OpenElementWithOperations */, (vm, { op1: tag }) => {\n    let tagName = vm.constants.getString(tag);\n    vm.elements().openElement(tagName);\n});\nAPPEND_OPCODES.add(23 /* Comment */, (vm, { op1: text }) => {\n    vm.elements().appendComment(vm.constants.getString(text));\n});\nAPPEND_OPCODES.add(25 /* OpenElement */, (vm, { op1: tag }) => {\n    vm.elements().openElement(vm.constants.getString(tag));\n});\nAPPEND_OPCODES.add(27 /* OpenDynamicElement */, vm => {\n    let tagName = vm.stack.pop().value();\n    vm.elements().openElement(tagName);\n});\nAPPEND_OPCODES.add(34 /* PushRemoteElement */, vm => {\n    let elementRef = vm.stack.pop();\n    let nextSiblingRef = vm.stack.pop();\n    let guidRef = vm.stack.pop();\n    let element;\n    let nextSibling;\n    let guid = guidRef.value();\n    if (isConst(elementRef)) {\n        element = elementRef.value();\n    } else {\n        let cache = new ReferenceCache(elementRef);\n        element = cache.peek();\n        vm.updateWith(new Assert(cache));\n    }\n    if (isConst(nextSiblingRef)) {\n        nextSibling = nextSiblingRef.value();\n    } else {\n        let cache = new ReferenceCache(nextSiblingRef);\n        nextSibling = cache.peek();\n        vm.updateWith(new Assert(cache));\n    }\n    vm.elements().pushRemoteElement(element, guid, nextSibling);\n});\nAPPEND_OPCODES.add(35 /* PopRemoteElement */, vm => {\n    vm.elements().popRemoteElement();\n});\nAPPEND_OPCODES.add(31 /* FlushElement */, vm => {\n    let operations = vm.fetchValue(Register.t0);\n    if (operations) {\n        operations.flush(vm);\n        vm.loadValue(Register.t0, null);\n    }\n    vm.elements().flushElement();\n});\nAPPEND_OPCODES.add(32 /* CloseElement */, vm => {\n    vm.elements().closeElement();\n});\nAPPEND_OPCODES.add(33 /* Modifier */, (vm, { op1: handle }) => {\n    let manager = vm.constants.resolveHandle(handle);\n    let stack = vm.stack;\n    let args = stack.pop();\n    let { constructing: element, updateOperations } = vm.elements();\n    let dynamicScope = vm.dynamicScope();\n    let modifier = manager.create(element, args, dynamicScope, updateOperations);\n    vm.env.scheduleInstallModifier(modifier, manager);\n    let destructor = manager.getDestructor(modifier);\n    if (destructor) {\n        vm.newDestroyable(destructor);\n    }\n    let tag = manager.getTag(modifier);\n    if (!isConstTag(tag)) {\n        vm.updateWith(new UpdateModifierOpcode(tag, manager, modifier));\n    }\n});\nexport class UpdateModifierOpcode extends UpdatingOpcode {\n    constructor(tag, manager, modifier) {\n        super();\n        this.tag = tag;\n        this.manager = manager;\n        this.modifier = modifier;\n        this.type = 'update-modifier';\n        this.lastUpdated = tag.value();\n    }\n    evaluate(vm) {\n        let { manager, modifier, tag, lastUpdated } = this;\n        if (!tag.validate(lastUpdated)) {\n            vm.env.scheduleUpdateModifier(modifier, manager);\n            this.lastUpdated = tag.value();\n        }\n    }\n}\nAPPEND_OPCODES.add(28 /* StaticAttr */, (vm, { op1: _name, op2: _value, op3: _namespace }) => {\n    let name = vm.constants.getString(_name);\n    let value = vm.constants.getString(_value);\n    let namespace = _namespace ? vm.constants.getString(_namespace) : null;\n    vm.elements().setStaticAttribute(name, value, namespace);\n});\nAPPEND_OPCODES.add(29 /* DynamicAttr */, (vm, { op1: _name, op2: trusting, op3: _namespace }) => {\n    let name = vm.constants.getString(_name);\n    let reference = vm.stack.pop();\n    let value = reference.value();\n    let namespace = _namespace ? vm.constants.getString(_namespace) : null;\n    let attribute = vm.elements().setDynamicAttribute(name, value, !!trusting, namespace);\n    if (!isConst(reference)) {\n        vm.updateWith(new UpdateDynamicAttributeOpcode(reference, attribute));\n    }\n});\nexport class UpdateDynamicAttributeOpcode extends UpdatingOpcode {\n    constructor(reference, attribute) {\n        super();\n        this.reference = reference;\n        this.attribute = attribute;\n        this.type = 'patch-element';\n        this.tag = reference.tag;\n        this.lastRevision = this.tag.value();\n    }\n    evaluate(vm) {\n        let { attribute, reference, tag } = this;\n        if (!tag.validate(this.lastRevision)) {\n            this.lastRevision = tag.value();\n            attribute.update(reference.value(), vm.env);\n        }\n    }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZG9tLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vcGFja2FnZXMvQGdsaW1tZXIvcnVudGltZS9saWIvY29tcGlsZWQvb3Bjb2Rlcy9kb20udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsQUFBTyxTQUVMLEFBQWMsZ0JBSWQsQUFBTyxTQUNQLEFBQVUsQUFDWCxrQkFBTSxBQUFvQixBQUFDLEFBRTVCLEFBQU8sQUFBRSxBQUFpQixBQUFFLEFBQUssQUFBRSxBQUFXLEFBQUUsQUFBWSxBQUFFLEFBQVMsQUFBRSxBQUFXLEFBQUUsQUFBZSxBQUFFLEFBQU0sQUFBZ0IsQUFBQzs7QUFFOUgsQUFBTyxTQUFNLEFBQVEsQUFBRSxnQkFBTSxBQUFhLEFBQUM7QUFFM0MsQUFBTyxTQUFFLEFBQWMsZ0JBQUUsQUFBYyxBQUFFLHNCQUFNLEFBQWUsQUFBQztBQUUvRCxBQUFPLFNBQUUsQUFBTSxBQUFFLGNBQU0sQUFBTSxBQUFDLEFBRTlCLEFBQU8sQUFBRSxBQUEwQixBQUFFLEFBQU0sQUFBYSxBQUFDLEFBQ3pELEFBQU8sQUFBRSxBQUFjLEFBQUUsQUFBYyxBQUFFLEFBQU0sQUFBZ0IsQUFBQzs7QUFFaEUsQUFBYyxlQUFDLEFBQUcsbUJBQVUsQ0FBQyxBQUFFLElBQUUsRUFBRSxBQUFHLEtBQUUsQUFBSSxBQUFFO0FBQzVDLEFBQUUsT0FBQyxBQUFRLEFBQUUsV0FBQyxBQUFVLFdBQUMsQUFBRSxHQUFDLEFBQVMsVUFBQyxBQUFTLFVBQUMsQUFBSSxBQUFDLEFBQUMsQUFBQyxBQUN6RDtBQUFDLEFBQUMsQUFBQztBQUVILEFBQWMsZUFBQyxBQUFHLHdDQUErQixDQUFDLEFBQUUsSUFBRSxFQUFFLEFBQUcsS0FBRSxBQUFHLEFBQUU7QUFDaEUsUUFBSSxBQUFPLFVBQUcsQUFBRSxHQUFDLEFBQVMsVUFBQyxBQUFTLFVBQUMsQUFBRyxBQUFDLEFBQUM7QUFDMUMsQUFBRSxPQUFDLEFBQVEsQUFBRSxXQUFDLEFBQVcs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QUMsQUFBWSxBQUFDLEFBQUMsZUFBQyxBQUFDO0FBQ3JDLEFBQUksaUJBQUMsQUFBWSxlQUFHLEFBQUcsSUFBQyxBQUFLLEFBQUUsQUFBQztBQUNoQyxBQUFTLHNCQUFDLEFBQU0sT0FBQyxBQUFTLFVBQUMsQUFBSyxBQUFFLFNBQUUsQUFBRSxHQUFDLEFBQUcsQUFBQyxBQUFDLEFBQzlDO0FBQUMsQUFDSDtBQUFDLEFBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBSZWZlcmVuY2UsXG4gIFJlZmVyZW5jZUNhY2hlLFxuICBSZXZpc2lvbixcbiAgVGFnLFxuICBWZXJzaW9uZWRSZWZlcmVuY2UsXG4gIGlzQ29uc3QsXG4gIGlzQ29uc3RUYWdcbn0gZnJvbSAnQGdsaW1tZXIvcmVmZXJlbmNlJztcbmltcG9ydCB7IE9wYXF1ZSwgT3B0aW9uIH0gZnJvbSAnQGdsaW1tZXIvdXRpbCc7XG5pbXBvcnQgeyBleHBlY3RTdGFja0NoYW5nZSwgY2hlY2ssIENoZWNrU3RyaW5nLCBDaGVja0VsZW1lbnQsIENoZWNrTm9kZSwgQ2hlY2tPcHRpb24sIENoZWNrSW5zdGFuY2VvZiB9IGZyb20gJ0BnbGltbWVyL2RlYnVnJztcbmltcG9ydCB7IFNpbXBsZSB9IGZyb20gJ0BnbGltbWVyL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgT3AsIFJlZ2lzdGVyIH0gZnJvbSAnQGdsaW1tZXIvdm0nO1xuaW1wb3J0IHsgTW9kaWZpZXIsIE1vZGlmaWVyTWFuYWdlciB9IGZyb20gJy4uLy4uL21vZGlmaWVyL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgQVBQRU5EX09QQ09ERVMsIFVwZGF0aW5nT3Bjb2RlIH0gZnJvbSAnLi4vLi4vb3Bjb2Rlcyc7XG5pbXBvcnQgeyBVcGRhdGluZ1ZNIH0gZnJvbSAnLi4vLi4vdm0nO1xuaW1wb3J0IHsgQXNzZXJ0IH0gZnJvbSAnLi92bSc7XG5pbXBvcnQgeyBEeW5hbWljQXR0cmlidXRlIH0gZnJvbSAnLi4vLi4vdm0vYXR0cmlidXRlcy9keW5hbWljJztcbmltcG9ydCB7IENvbXBvbmVudEVsZW1lbnRPcGVyYXRpb25zIH0gZnJvbSAnLi9jb21wb25lbnQnO1xuaW1wb3J0IHsgQ2hlY2tSZWZlcmVuY2UsIENoZWNrQXJndW1lbnRzIH0gZnJvbSAnLi8tZGVidWctc3RyaXAnO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuVGV4dCwgKHZtLCB7IG9wMTogdGV4dCB9KSA9PiB7XG4gIHZtLmVsZW1lbnRzKCkuYXBwZW5kVGV4dCh2bS5jb25zdGFudHMuZ2V0U3RyaW5nKHRleHQpKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuT3BlbkVsZW1lbnRXaXRoT3BlcmF0aW9ucywgKHZtLCB7IG9wMTogdGFnIH0pID0+IHtcbiAgbGV0IHRhZ05hbWUgPSB2bS5jb25zdGFudHMuZ2V0U3RyaW5nKHRhZyk7XG4gIHZtLmVsZW1lbnRzKCkub3BlbkVsZW1lbnQodGFnTmFtZSk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkNvbW1lbnQsICh2bSwgeyBvcDE6IHRleHQgfSkgPT4ge1xuICB2bS5lbGVtZW50cygpLmFwcGVuZENvbW1lbnQodm0uY29uc3RhbnRzLmdldFN0cmluZyh0ZXh0KSk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLk9wZW5FbGVtZW50LCAodm0sIHsgb3AxOiB0YWcgfSkgPT4ge1xuICB2bS5lbGVtZW50cygpLm9wZW5FbGVtZW50KHZtLmNvbnN0YW50cy5nZXRTdHJpbmcodGFnKSk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLk9wZW5EeW5hbWljRWxlbWVudCwgdm0gPT4ge1xuICBsZXQgdGFnTmFtZSA9IGNoZWNrKGNoZWNrKHZtLnN0YWNrLnBvcCgpLCBDaGVja1JlZmVyZW5jZSkudmFsdWUoKSwgQ2hlY2tTdHJpbmcpO1xuICB2bS5lbGVtZW50cygpLm9wZW5FbGVtZW50KHRhZ05hbWUpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5QdXNoUmVtb3RlRWxlbWVudCwgdm0gPT4ge1xuICBsZXQgZWxlbWVudFJlZiA9IGNoZWNrKHZtLnN0YWNrLnBvcCgpLCBDaGVja1JlZmVyZW5jZSk7XG4gIGxldCBuZXh0U2libGluZ1JlZiA9IGNoZWNrKHZtLnN0YWNrLnBvcCgpLCBDaGVja1JlZmVyZW5jZSk7XG4gIGxldCBndWlkUmVmID0gY2hlY2sodm0uc3RhY2sucG9wKCksIENoZWNrUmVmZXJlbmNlKTtcblxuICBsZXQgZWxlbWVudDogU2ltcGxlLkVsZW1lbnQ7XG4gIGxldCBuZXh0U2libGluZzogT3B0aW9uPFNpbXBsZS5Ob2RlPjtcbiAgbGV0IGd1aWQgPSBndWlkUmVmLnZhbHVlKCkgYXMgc3RyaW5nO1xuXG4gIGlmIChpc0NvbnN0KGVsZW1lbnRSZWYpKSB7XG4gICAgZWxlbWVudCA9IGNoZWNrKGVsZW1lbnRSZWYudmFsdWUoKSwgQ2hlY2tFbGVtZW50KTtcbiAgfSBlbHNlIHtcbiAgICBsZXQgY2FjaGUgPSBuZXcgUmVmZXJlbmNlQ2FjaGUoZWxlbWVudFJlZiBhcyBSZWZlcmVuY2U8U2ltcGxlLkVsZW1lbnQ+KTtcbiAgICBlbGVtZW50ID0gY2hlY2soY2FjaGUucGVlaygpLCBDaGVja0VsZW1lbnQpO1xuICAgIHZtLnVwZGF0ZVdpdGgobmV3IEFzc2VydChjYWNoZSkpO1xuICB9XG5cbiAgaWYgKGlzQ29uc3QobmV4dFNpYmxpbmdSZWYpKSB7XG4gICAgbmV4dFNpYmxpbmcgPSBjaGVjayhuZXh0U2libGluZ1JlZi52YWx1ZSgpLCBDaGVja09wdGlvbihDaGVja05vZGUpKTtcbiAgfSBlbHNlIHtcbiAgICBsZXQgY2FjaGUgPSBuZXcgUmVmZXJlbmNlQ2FjaGUobmV4dFNpYmxpbmdSZWYgYXMgUmVmZXJlbmNlPE9wdGlvbjxTaW1wbGUuTm9kZT4+KTtcbiAgICBuZXh0U2libGluZyA9IGNoZWNrKGNhY2hlLnBlZWsoKSwgQ2hlY2tPcHRpb24oQ2hlY2tOb2RlKSk7XG4gICAgdm0udXBkYXRlV2l0aChuZXcgQXNzZXJ0KGNhY2hlKSk7XG4gIH1cblxuICB2bS5lbGVtZW50cygpLnB1c2hSZW1vdGVFbGVtZW50KGVsZW1lbnQsIGd1aWQsIG5leHRTaWJsaW5nKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUG9wUmVtb3RlRWxlbWVudCwgdm0gPT4ge1xuICB2bS5lbGVtZW50cygpLnBvcFJlbW90ZUVsZW1lbnQoKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuRmx1c2hFbGVtZW50LCB2bSA9PiB7XG4gIGxldCBvcGVyYXRpb25zID0gY2hlY2sodm0uZmV0Y2hWYWx1ZShSZWdpc3Rlci50MCksIENoZWNrT3B0aW9uKENoZWNrSW5zdGFuY2VvZihDb21wb25lbnRFbGVtZW50T3BlcmF0aW9ucykpKTtcblxuICBpZiAob3BlcmF0aW9ucykge1xuICAgIG9wZXJhdGlvbnMuZmx1c2godm0pO1xuICAgIHZtLmxvYWRWYWx1ZShSZWdpc3Rlci50MCwgbnVsbCk7XG4gIH1cblxuICB2bS5lbGVtZW50cygpLmZsdXNoRWxlbWVudCgpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5DbG9zZUVsZW1lbnQsIHZtID0+IHtcbiAgdm0uZWxlbWVudHMoKS5jbG9zZUVsZW1lbnQoKTtcblxuICBleHBlY3RTdGFja0NoYW5nZSh2bS5zdGFjaywgMCwgJ0Nsb3NlRWxlbWVudCcpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5Nb2RpZmllciwgKHZtLCB7IG9wMTogaGFuZGxlIH0pID0+IHtcbiAgbGV0IG1hbmFnZXIgPSB2bS5jb25zdGFudHMucmVzb2x2ZUhhbmRsZTxNb2RpZmllck1hbmFnZXI+KGhhbmRsZSk7XG4gIGxldCBzdGFjayA9IHZtLnN0YWNrO1xuICBsZXQgYXJncyA9IGNoZWNrKHN0YWNrLnBvcCgpLCBDaGVja0FyZ3VtZW50cyk7XG4gIGxldCB7IGNvbnN0cnVjdGluZzogZWxlbWVudCwgdXBkYXRlT3BlcmF0aW9ucyB9ID0gdm0uZWxlbWVudHMoKTtcbiAgbGV0IGR5bmFtaWNTY29wZSA9IHZtLmR5bmFtaWNTY29wZSgpO1xuICBsZXQgbW9kaWZpZXIgPSBtYW5hZ2VyLmNyZWF0ZShlbGVtZW50IGFzIFNpbXBsZS5GSVhfUkVJRklDQVRJT048RWxlbWVudD4sIGFyZ3MsIGR5bmFtaWNTY29wZSwgdXBkYXRlT3BlcmF0aW9ucyk7XG5cbiAgdm0uZW52LnNjaGVkdWxlSW5zdGFsbE1vZGlmaWVyKG1vZGlmaWVyLCBtYW5hZ2VyKTtcbiAgbGV0IGRlc3RydWN0b3IgPSBtYW5hZ2VyLmdldERlc3RydWN0b3IobW9kaWZpZXIpO1xuXG4gIGlmIChkZXN0cnVjdG9yKSB7XG4gICAgdm0ubmV3RGVzdHJveWFibGUoZGVzdHJ1Y3Rvcik7XG4gIH1cblxuICBsZXQgdGFnID0gbWFuYWdlci5nZXRUYWcobW9kaWZpZXIpO1xuXG4gIGlmICghaXNDb25zdFRhZyh0YWcpKSB7XG4gICAgdm0udXBkYXRlV2l0aChuZXcgVXBkYXRlTW9kaWZpZXJPcGNvZGUoXG4gICAgICB0YWcsXG4gICAgICBtYW5hZ2VyLFxuICAgICAgbW9kaWZpZXJcbiAgICApKTtcbiAgfVxufSk7XG5cbmV4cG9ydCBjbGFzcyBVcGRhdGVNb2RpZmllck9wY29kZSBleHRlbmRzIFVwZGF0aW5nT3Bjb2RlIHtcbiAgcHVibGljIHR5cGUgPSAndXBkYXRlLW1vZGlmaWVyJztcbiAgcHJpdmF0ZSBsYXN0VXBkYXRlZDogUmV2aXNpb247XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHVibGljIHRhZzogVGFnLFxuICAgIHByaXZhdGUgbWFuYWdlcjogTW9kaWZpZXJNYW5hZ2VyLFxuICAgIHByaXZhdGUgbW9kaWZpZXI6IE1vZGlmaWVyLFxuICApIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMubGFzdFVwZGF0ZWQgPSB0YWcudmFsdWUoKTtcbiAgfVxuXG4gIGV2YWx1YXRlKHZtOiBVcGRhdGluZ1ZNKSB7XG4gICAgbGV0IHsgbWFuYWdlciwgbW9kaWZpZXIsIHRhZywgbGFzdFVwZGF0ZWQgfSA9IHRoaXM7XG5cbiAgICBpZiAoIXRhZy52YWxpZGF0ZShsYXN0VXBkYXRlZCkpIHtcbiAgICAgIHZtLmVudi5zY2hlZHVsZVVwZGF0ZU1vZGlmaWVyKG1vZGlmaWVyLCBtYW5hZ2VyKTtcbiAgICAgIHRoaXMubGFzdFVwZGF0ZWQgPSB0YWcudmFsdWUoKTtcbiAgICB9XG4gIH1cbn1cblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLlN0YXRpY0F0dHIsICh2bSwgeyBvcDE6IF9uYW1lLCBvcDI6IF92YWx1ZSwgb3AzOiBfbmFtZXNwYWNlIH0pID0+IHtcbiAgbGV0IG5hbWUgPSB2bS5jb25zdGFudHMuZ2V0U3RyaW5nKF9uYW1lKTtcbiAgbGV0IHZhbHVlID0gdm0uY29uc3RhbnRzLmdldFN0cmluZyhfdmFsdWUpO1xuICBsZXQgbmFtZXNwYWNlID0gX25hbWVzcGFjZSA/IHZtLmNvbnN0YW50cy5nZXRTdHJpbmcoX25hbWVzcGFjZSkgOiBudWxsO1xuXG4gIHZtLmVsZW1lbnRzKCkuc2V0U3RhdGljQXR0cmlidXRlKG5hbWUsIHZhbHVlLCBuYW1lc3BhY2UpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5EeW5hbWljQXR0ciwgKHZtLCB7IG9wMTogX25hbWUsIG9wMjogdHJ1c3RpbmcsIG9wMzogX25hbWVzcGFjZSB9KSA9PiB7XG4gIGxldCBuYW1lID0gdm0uY29uc3RhbnRzLmdldFN0cmluZyhfbmFtZSk7XG4gIGxldCByZWZlcmVuY2UgPSBjaGVjayh2bS5zdGFjay5wb3AoKSwgQ2hlY2tSZWZlcmVuY2UpO1xuICBsZXQgdmFsdWUgPSByZWZlcmVuY2UudmFsdWUoKTtcbiAgbGV0IG5hbWVzcGFjZSA9IF9uYW1lc3BhY2UgPyB2bS5jb25zdGFudHMuZ2V0U3RyaW5nKF9uYW1lc3BhY2UpIDogbnVsbDtcblxuICBsZXQgYXR0cmlidXRlID0gdm0uZWxlbWVudHMoKS5zZXREeW5hbWljQXR0cmlidXRlKG5hbWUsIHZhbHVlLCAhIXRydXN0aW5nLCBuYW1lc3BhY2UpO1xuXG4gIGlmICghaXNDb25zdChyZWZlcmVuY2UpKSB7XG4gICAgdm0udXBkYXRlV2l0aChuZXcgVXBkYXRlRHluYW1pY0F0dHJpYnV0ZU9wY29kZShyZWZlcmVuY2UsIGF0dHJpYnV0ZSkpO1xuICB9XG59KTtcblxuZXhwb3J0IGNsYXNzIFVwZGF0ZUR5bmFtaWNBdHRyaWJ1dGVPcGNvZGUgZXh0ZW5kcyBVcGRhdGluZ09wY29kZSB7XG4gIHB1YmxpYyB0eXBlID0gJ3BhdGNoLWVsZW1lbnQnO1xuXG4gIHB1YmxpYyB0YWc6IFRhZztcbiAgcHVibGljIGxhc3RSZXZpc2lvbjogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVmZXJlbmNlOiBWZXJzaW9uZWRSZWZlcmVuY2U8T3BhcXVlPiwgcHJpdmF0ZSBhdHRyaWJ1dGU6IER5bmFtaWNBdHRyaWJ1dGUpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMudGFnID0gcmVmZXJlbmNlLnRhZztcbiAgICB0aGlzLmxhc3RSZXZpc2lvbiA9IHRoaXMudGFnLnZhbHVlKCk7XG4gIH1cblxuICBldmFsdWF0ZSh2bTogVXBkYXRpbmdWTSkge1xuICAgIGxldCB7IGF0dHJpYnV0ZSwgcmVmZXJlbmNlLCB0YWcgfSA9IHRoaXM7XG4gICAgaWYgKCF0YWcudmFsaWRhdGUodGhpcy5sYXN0UmV2aXNpb24pKSB7XG4gICAgICB0aGlzLmxhc3RSZXZpc2lvbiA9IHRhZy52YWx1ZSgpO1xuICAgICAgYXR0cmlidXRlLnVwZGF0ZShyZWZlcmVuY2UudmFsdWUoKSwgdm0uZW52KTtcbiAgICB9XG4gIH1cbn1cbiJdfQ==","import { assert } from '@glimmer/util';\nexport function resolveComponent(resolver, name, meta) {\n    let definition = resolver.lookupComponent(name, meta);\n    (false && assert(definition, `Could not find a component named \"${name}\"`));\n\n    return definition;\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVzb2x2ZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3J1bnRpbWUvbGliL2NvbXBvbmVudC9yZXNvbHZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLEFBQU8sU0FBVSxBQUFNLEFBQUUsY0FBTSxBQUFlLEFBQUM7QUFJL0MsQUFBTSxpQ0FBc0MsQUFBb0MsVUFBRSxBQUFZLE1BQUUsQUFBZTtBQUM3RyxRQUFJLEFBQVUsYUFBRyxBQUFRLFNBQUMsQUFBZSxnQkFBQyxBQUFJLE1BQUUsQUFBSSxBQUFDLEFBQUM7Y0FDdEQsQUFBTSxPQUFDLEFBQVUsQUFBRSxpREFBcUMsQUFBSSxJQUFHLEFBQUMsQUFBQzs7QUFDakUsQUFBTSxXQUFDLEFBQWlDLEFBQUMsQUFDM0M7QUFBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFJ1bnRpbWVSZXNvbHZlciB9IGZyb20gJ0BnbGltbWVyL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgT3B0aW9uLCBhc3NlcnQgfSBmcm9tICdAZ2xpbW1lci91dGlsJztcblxuaW1wb3J0IHsgQ29tcG9uZW50RGVmaW5pdGlvbiB9IGZyb20gJy4vaW50ZXJmYWNlcyc7XG5cbmV4cG9ydCBmdW5jdGlvbiByZXNvbHZlQ29tcG9uZW50PFNwZWNpZmllcj4ocmVzb2x2ZXI6IFJ1bnRpbWVSZXNvbHZlcjxTcGVjaWZpZXI+LCBuYW1lOiBzdHJpbmcsIG1ldGE6IFNwZWNpZmllcik6IE9wdGlvbjxDb21wb25lbnREZWZpbml0aW9uPiB7XG4gIGxldCBkZWZpbml0aW9uID0gcmVzb2x2ZXIubG9va3VwQ29tcG9uZW50KG5hbWUsIG1ldGEpO1xuICBhc3NlcnQoZGVmaW5pdGlvbiwgYENvdWxkIG5vdCBmaW5kIGEgY29tcG9uZW50IG5hbWVkIFwiJHtuYW1lfVwiYCk7XG4gIHJldHVybiBkZWZpbml0aW9uIGFzIENvbXBvbmVudERlZmluaXRpb247XG59Il19","/** @internal */\nexport function hasStaticLayout(state, manager) {\n    return manager.getCapabilities(state).dynamicLayout === false;\n}\n/** @internal */\nexport function hasDynamicLayout(state, manager) {\n    return manager.getCapabilities(state).dynamicLayout === true;\n}\nexport const DEFAULT_CAPABILITIES = {\n    dynamicLayout: true,\n    dynamicTag: true,\n    prepareArgs: true,\n    createArgs: true,\n    attributeHook: false,\n    elementHook: false\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW50ZXJmYWNlcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3J1bnRpbWUvbGliL2NvbXBvbmVudC9pbnRlcmZhY2VzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQTZHQSxBQUFnQjtBQUNoQixBQUFNLGdDQUFnRyxBQUFRLE9BQUUsQUFBK0I7QUFDN0ksQUFBTSxXQUFDLEFBQU8sUUFBQyxBQUFlLGdCQUFDLEFBQUssQUFBQyxPQUFDLEFBQWEsa0JBQUssQUFBSyxBQUFDLEFBQ2hFO0FBQUM7QUFVRCxBQUFnQjtBQUNoQixBQUFNLGlDQUFpRyxBQUFRLE9BQUUsQUFBK0I7QUFDOUksQUFBTSxXQUFDLEFBQU8sUUFBQyxBQUFlLGdCQUFDLEFBQUssQUFBQyxPQUFDLEFBQWEsa0JBQUssQUFBSSxBQUFDLEFBQy9EO0FBQUM7QUFFRCxBQUFNLGFBQU8sQUFBb0I7QUFDL0IsQUFBYSxtQkFBRSxBQUFJO0FBQ25CLEFBQVUsZ0JBQUUsQUFBSTtBQUNoQixBQUFXLGlCQUFFLEFBQUk7QUFDakIsQUFBVSxnQkFBRSxBQUFJO0FBQ2hCLEFBQWEsbUJBQUUsQUFBSztBQUNwQixBQUFXLGlCQUFFLEFBQUssQUFDbkIsQUFBQztBQVB5RCxDQUFwRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFNpbXBsZSwgRGljdCwgT3BhcXVlLCBPcHRpb24sIFJ1bnRpbWVSZXNvbHZlciwgVW5pcXVlLCBQcm9ncmFtU3ltYm9sVGFibGUsIFZNSGFuZGxlLCBDb21wb25lbnRDYXBhYmlsaXRpZXMgfSBmcm9tICdAZ2xpbW1lci9pbnRlcmZhY2VzJztcbmltcG9ydCB7IFRhZywgVmVyc2lvbmVkUGF0aFJlZmVyZW5jZSB9IGZyb20gJ0BnbGltbWVyL3JlZmVyZW5jZSc7XG5pbXBvcnQgeyBEZXN0cm95YWJsZSB9IGZyb20gJ0BnbGltbWVyL3V0aWwnO1xuaW1wb3J0IEJvdW5kcyBmcm9tICcuLi9ib3VuZHMnO1xuaW1wb3J0IHsgRWxlbWVudE9wZXJhdGlvbnMgfSBmcm9tICcuLi92bS9lbGVtZW50LWJ1aWxkZXInO1xuaW1wb3J0IEVudmlyb25tZW50LCB7IER5bmFtaWNTY29wZSB9IGZyb20gJy4uL2Vudmlyb25tZW50JztcbmltcG9ydCB7IElBcmd1bWVudHMgfSBmcm9tICcuLi92bS9hcmd1bWVudHMnO1xuaW1wb3J0IHsgQ3VycmllZENvbXBvbmVudERlZmluaXRpb24gfSBmcm9tICcuL2N1cnJpZWQtY29tcG9uZW50JztcblxuZXhwb3J0IGludGVyZmFjZSBQcmVwYXJlZEFyZ3VtZW50cyB7XG4gIHBvc2l0aW9uYWw6IEFycmF5PFZlcnNpb25lZFBhdGhSZWZlcmVuY2U8T3BhcXVlPj47XG4gIG5hbWVkOiBEaWN0PFZlcnNpb25lZFBhdGhSZWZlcmVuY2U8T3BhcXVlPj47XG59XG5cbmV4cG9ydCB0eXBlIENvbXBvbmVudERlZmluaXRpb25TdGF0ZSA9IFVuaXF1ZTwnQ29tcG9uZW50RGVmaW5pdGlvblN0YXRlJz47XG5leHBvcnQgdHlwZSBDb21wb25lbnRJbnN0YW5jZVN0YXRlID0gVW5pcXVlPCdDb21wb25lbnRJbnN0YW5jZVN0YXRlJz47XG5cbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCBpbnRlcmZhY2UgQ29tcG9uZW50RGVmaW5pdGlvbiB7XG4gIHN0YXRlOiBDb21wb25lbnREZWZpbml0aW9uU3RhdGU7XG4gIG1hbmFnZXI6IEludGVybmFsQ29tcG9uZW50TWFuYWdlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQdWJsaWNDb21wb25lbnREZWZpbml0aW9uPENvbXBvbmVudERlZmluaXRpb25TdGF0ZSA9IE9wYXF1ZSwgTWFuYWdlciA9IENvbXBvbmVudE1hbmFnZXI8T3BhcXVlLCBDb21wb25lbnREZWZpbml0aW9uU3RhdGU+PiB7XG4gIHN0YXRlOiBDb21wb25lbnREZWZpbml0aW9uU3RhdGU7XG4gIG1hbmFnZXI6IE1hbmFnZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29tcG9uZW50TWFuYWdlcjxDb21wb25lbnRJbnN0YW5jZVN0YXRlLCBDb21wb25lbnREZWZpbml0aW9uU3RhdGU+IHtcbiAgZ2V0Q2FwYWJpbGl0aWVzKHN0YXRlOiBDb21wb25lbnREZWZpbml0aW9uU3RhdGUpOiBDb21wb25lbnRDYXBhYmlsaXRpZXM7XG5cbiAgLy8gRmlyc3QsIHRoZSBjb21wb25lbnQgbWFuYWdlciBpcyBhc2tlZCB0byBwcmVwYXJlIHRoZSBhcmd1bWVudHMgbmVlZGVkXG4gIC8vIGZvciBgY3JlYXRlYC4gVGhpcyBhbGxvd3MgZm9yIHRoaW5ncyBsaWtlIGNsb3N1cmUgY29tcG9uZW50cyB3aGVyZSB0aGVcbiAgLy8gYXJncyBuZWVkIHRvIGJlIGN1cnJpZWQgYmVmb3JlIGNvbnN0cnVjdGluZyB0aGUgaW5zdGFuY2Ugb2YgdGhlIHN0YXRlXG4gIC8vIGJ1Y2tldC5cbiAgcHJlcGFyZUFyZ3Moc3RhdGU6IENvbXBvbmVudERlZmluaXRpb25TdGF0ZSwgYXJnczogSUFyZ3VtZW50cyk6IE9wdGlvbjxQcmVwYXJlZEFyZ3VtZW50cz47XG5cbiAgLy8gVGhlbiwgdGhlIGNvbXBvbmVudCBtYW5hZ2VyIGlzIGFza2VkIHRvIGNyZWF0ZSBhIGJ1Y2tldCBvZiBzdGF0ZSBmb3JcbiAgLy8gdGhlIHN1cHBsaWVkIGFyZ3VtZW50cy4gRnJvbSB0aGUgcGVyc3BlY3RpdmUgb2YgR2xpbW1lciwgdGhpcyBpc1xuICAvLyBhbiBvcGFxdWUgdG9rZW4sIGJ1dCBpbiBwcmFjdGljZSBpdCBpcyBwcm9iYWJseSBhIGNvbXBvbmVudCBvYmplY3QuXG4gIGNyZWF0ZShlbnY6IEVudmlyb25tZW50LCBzdGF0ZTogQ29tcG9uZW50RGVmaW5pdGlvblN0YXRlLCBhcmdzOiBPcHRpb248SUFyZ3VtZW50cz4sIGR5bmFtaWNTY29wZTogRHluYW1pY1Njb3BlLCBjYWxsZXI6IFZlcnNpb25lZFBhdGhSZWZlcmVuY2U8T3BhcXVlPiwgaGFzRGVmYXVsdEJsb2NrOiBib29sZWFuKTogQ29tcG9uZW50SW5zdGFuY2VTdGF0ZTtcblxuICAvLyBOZXh0LCBHbGltbWVyIGFza3MgdGhlIG1hbmFnZXIgdG8gY3JlYXRlIGEgcmVmZXJlbmNlIGZvciB0aGUgYHNlbGZgXG4gIC8vIGl0IHNob3VsZCB1c2UgaW4gdGhlIGxheW91dC5cbiAgZ2V0U2VsZihzdGF0ZTogQ29tcG9uZW50SW5zdGFuY2VTdGF0ZSk6IFZlcnNpb25lZFBhdGhSZWZlcmVuY2U8T3BhcXVlPjtcblxuICAvLyBDb252ZXJ0IHRoZSBvcGFxdWUgY29tcG9uZW50IGludG8gYSBgUmV2aXNpb25UYWdgIHRoYXQgZGV0ZXJtaW5zIHdoZW5cbiAgLy8gdGhlIGNvbXBvbmVudCdzIHVwZGF0ZSBob29rcyBuZWVkIHRvIGJlIGNhbGxlZCAoaWYgYXQgYWxsKS5cbiAgZ2V0VGFnKHN0YXRlOiBDb21wb25lbnRJbnN0YW5jZVN0YXRlKTogVGFnO1xuXG4gIC8vIFRoaXMgaG9vayBpcyBydW4gYWZ0ZXIgdGhlIGVudGlyZSBsYXlvdXQgaGFzIGJlZW4gcmVuZGVyZWQuXG4gIC8vXG4gIC8vIEhvc3RzIHNob3VsZCB1c2UgYGRpZENyZWF0ZWAsIHdoaWNoIHJ1bnMgYXN5bmNocm9ub3VzbHkgYWZ0ZXIgdGhlIHJlbmRlcmluZ1xuICAvLyBwcm9jZXNzLCB0byBwcm92aWRlIGhvb2tzIGZvciB1c2VyIGNvZGUuXG4gIGRpZFJlbmRlckxheW91dChzdGF0ZTogQ29tcG9uZW50SW5zdGFuY2VTdGF0ZSwgYm91bmRzOiBCb3VuZHMpOiB2b2lkO1xuXG4gIC8vIE9uY2UgdGhlIHdob2xlIHRvcC1kb3duIHJlbmRlcmluZyBwcm9jZXNzIGlzIGNvbXBsZXRlLCBHbGltbWVyIGludm9rZXNcbiAgLy8gdGhlIGBkaWRDcmVhdGVgIGNhbGxiYWNrcy5cbiAgZGlkQ3JlYXRlKHN0YXRlOiBDb21wb25lbnRJbnN0YW5jZVN0YXRlKTogdm9pZDtcblxuICAvLyBXaGVuIHRoZSBjb21wb25lbnQncyB0YWcgaGFzIGludmFsaWRhdGVkLCB0aGUgbWFuYWdlcidzIGB1cGRhdGVgIGhvb2sgaXNcbiAgLy8gY2FsbGVkLlxuICB1cGRhdGUoc3RhdGU6IENvbXBvbmVudEluc3RhbmNlU3RhdGUsIGR5bmFtaWNTY29wZTogRHluYW1pY1Njb3BlKTogdm9pZDtcblxuICAvLyBUaGlzIGhvb2sgaXMgcnVuIGFmdGVyIHRoZSBlbnRpcmUgbGF5b3V0IGhhcyBiZWVuIHVwZGF0ZWQuXG4gIC8vXG4gIC8vIEhvc3RzIHNob3VsZCB1c2UgYGRpZFVwZGF0ZWAsIHdoaWNoIHJ1bnMgYXN5bmNocm9ub3VzbHkgYWZ0ZXIgdGhlIHJlbmRlcmluZ1xuICAvLyBwcm9jZXNzLCB0byBwcm92aWRlIGhvb2tzIGZvciB1c2VyIGNvZGUuXG4gIGRpZFVwZGF0ZUxheW91dChzdGF0ZTogQ29tcG9uZW50SW5zdGFuY2VTdGF0ZSwgYm91bmRzOiBCb3VuZHMpOiB2b2lkO1xuXG4gIC8vIEZpbmFsbHksIG9uY2UgdG9wLWRvd24gcmV2YWxpZGF0aW9uIGhhcyBjb21wbGV0ZWQsIEdsaW1tZXIgaW52b2tlc1xuICAvLyB0aGUgYGRpZFVwZGF0ZWAgY2FsbGJhY2tzIG9uIGNvbXBvbmVudHMgdGhhdCBjaGFuZ2VkLlxuICBkaWRVcGRhdGUoc3RhdGU6IENvbXBvbmVudEluc3RhbmNlU3RhdGUpOiB2b2lkO1xuXG4gIC8vIENvbnZlcnQgdGhlIG9wYXF1ZSBjb21wb25lbnQgaW50byBhbiBvYmplY3QgdGhhdCBpbXBsZW1lbnRzIERlc3Ryb3lhYmxlLlxuICAvLyBJZiBpdCByZXR1cm5zIG51bGwsIHRoZSBjb21wb25lbnQgd2lsbCBub3QgYmUgZGVzdHJveWVkLlxuICBnZXREZXN0cnVjdG9yKHN0YXRlOiBDb21wb25lbnRJbnN0YW5jZVN0YXRlKTogT3B0aW9uPERlc3Ryb3lhYmxlPjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJbnZvY2F0aW9uIHtcbiAgaGFuZGxlOiBWTUhhbmRsZTtcbiAgc3ltYm9sVGFibGU6IFByb2dyYW1TeW1ib2xUYWJsZTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBXaXRoRHluYW1pY1RhZ05hbWU8Q29tcG9uZW50PiBleHRlbmRzIENvbXBvbmVudE1hbmFnZXI8Q29tcG9uZW50LCBPcGFxdWU+IHtcbiAgLy8gSWYgdGhlIGNvbXBvbmVudCBhc2tzIGZvciB0aGUgZHluYW1pYyB0YWcgbmFtZSBjYXBhYmlsaXR5LCBhc2sgZm9yXG4gIC8vIHRoZSB0YWcgbmFtZSB0byB1c2UuIChPbmx5IHVzZWQgaW4gdGhlIFwiV3JhcHBlZEJ1aWxkZXJcIi4pXG4gIGdldFRhZ05hbWUoY29tcG9uZW50OiBDb21wb25lbnQpOiBPcHRpb248c3RyaW5nPjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBXaXRoU3RhdGljTGF5b3V0PENvbXBvbmVudEluc3RhbmNlU3RhdGUsIENvbXBvbmVudERlZmluaXRpb25TdGF0ZSwgU3BlY2lmaWVyLCBSIGV4dGVuZHMgUnVudGltZVJlc29sdmVyPFNwZWNpZmllcj4+IGV4dGVuZHMgQ29tcG9uZW50TWFuYWdlcjxDb21wb25lbnRJbnN0YW5jZVN0YXRlLCBDb21wb25lbnREZWZpbml0aW9uU3RhdGU+IHtcbiAgZ2V0TGF5b3V0KHN0YXRlOiBDb21wb25lbnREZWZpbml0aW9uU3RhdGUsIHJlc29sdmVyOiBSKTogSW52b2NhdGlvbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBXaXRoQXR0cmlidXRlSG9vazxDb21wb25lbnQsIERlZmluaXRpb24+IGV4dGVuZHMgQ29tcG9uZW50TWFuYWdlcjxDb21wb25lbnQsIERlZmluaXRpb24+IHtcbiAgZGlkU3BsYXRBdHRyaWJ1dGVzKGNvbXBvbmVudDogQ29tcG9uZW50LCBlbGVtZW50OiBDb21wb25lbnQsIG9wZXJhdGlvbnM6IEVsZW1lbnRPcGVyYXRpb25zKTogdm9pZDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBXaXRoRWxlbWVudEhvb2s8Q29tcG9uZW50PiBleHRlbmRzIENvbXBvbmVudE1hbmFnZXI8Q29tcG9uZW50LCBDb21wb25lbnREZWZpbml0aW9uU3RhdGU+IHtcbiAgLy8gVGhlIGBkaWRDcmVhdGVFbGVtZW50YCBob29rIGlzIHJ1biBmb3Igbm9uLXRhZ2xlc3MgY29tcG9uZW50cyBhZnRlciB0aGVcbiAgLy8gZWxlbWVudCBhcyBiZWVuIGNyZWF0ZWQsIGJ1dCBiZWZvcmUgaXQgaGFzIGJlZW4gYXBwZW5kZWQgKFwiZmx1c2hlZFwiKSB0b1xuICAvLyB0aGUgRE9NLiBUaGlzIGhvb2sgYWxsb3dzIHRoZSBtYW5hZ2VyIHRvIHNhdmUgb2ZmIHRoZSBlbGVtZW50LCBhcyB3ZWxsIGFzXG4gIC8vIGluc3RhbGwgb3RoZXIgZHluYW1pYyBhdHRyaWJ1dGVzIHZpYSB0aGUgRWxlbWVudE9wZXJhdGlvbnMgb2JqZWN0LlxuICAvL1xuICAvLyBIb3N0cyBzaG91bGQgdXNlIGBkaWRDcmVhdGVgLCB3aGljaCBydW5zIGFzeW5jaHJvbm91c2x5IGFmdGVyIHRoZSByZW5kZXJpbmdcbiAgLy8gcHJvY2VzcywgdG8gcHJvdmlkZSBob29rcyBmb3IgdXNlciBjb2RlLlxuICBkaWRDcmVhdGVFbGVtZW50KGNvbXBvbmVudDogQ29tcG9uZW50LCBlbGVtZW50OiBTaW1wbGUuRWxlbWVudCwgb3BlcmF0aW9uczogRWxlbWVudE9wZXJhdGlvbnMpOiB2b2lkO1xufVxuXG4vKiogQGludGVybmFsICovXG5leHBvcnQgZnVuY3Rpb24gaGFzU3RhdGljTGF5b3V0PEQgZXh0ZW5kcyBDb21wb25lbnREZWZpbml0aW9uU3RhdGUsIEkgZXh0ZW5kcyBDb21wb25lbnRJbnN0YW5jZVN0YXRlPihzdGF0ZTogRCwgbWFuYWdlcjogQ29tcG9uZW50TWFuYWdlcjxJLCBEPik6IG1hbmFnZXIgaXMgV2l0aFN0YXRpY0xheW91dDxJLCBELCBPcGFxdWUsIFJ1bnRpbWVSZXNvbHZlcjxPcGFxdWU+PiB7XG4gIHJldHVybiBtYW5hZ2VyLmdldENhcGFiaWxpdGllcyhzdGF0ZSkuZHluYW1pY0xheW91dCA9PT0gZmFsc2U7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgV2l0aER5bmFtaWNMYXlvdXQ8Q29tcG9uZW50LCBTcGVjaWZpZXIsIFIgZXh0ZW5kcyBSdW50aW1lUmVzb2x2ZXI8U3BlY2lmaWVyPj4gZXh0ZW5kcyBDb21wb25lbnRNYW5hZ2VyPENvbXBvbmVudCwgT3BhcXVlPiB7XG4gIC8vIFJldHVybiB0aGUgY29tcGlsZWQgbGF5b3V0IHRvIHVzZSBmb3IgdGhpcyBjb21wb25lbnQuIFRoaXMgaXMgY2FsbGVkXG4gIC8vICphZnRlciogdGhlIGNvbXBvbmVudCBpbnN0YW5jZSBoYXMgYmVlbiBjcmVhdGVkLCBiZWNhdXNlIHlvdSBtaWdodFxuICAvLyB3YW50IHRvIHJldHVybiBhIGRpZmZlcmVudCBsYXlvdXQgcGVyLWluc3RhbmNlIGZvciBvcHRpbWl6YXRpb24gcmVhc29uc1xuICAvLyBvciB0byBpbXBsZW1lbnQgZmVhdHVyZXMgbGlrZSBFbWJlcidzIFwibGF0ZS1ib3VuZFwiIGxheW91dHMuXG4gIGdldER5bmFtaWNMYXlvdXQoY29tcG9uZW50OiBDb21wb25lbnQsIHJlc29sdmVyOiBSKTogSW52b2NhdGlvbjtcbn1cblxuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IGZ1bmN0aW9uIGhhc0R5bmFtaWNMYXlvdXQ8RCBleHRlbmRzIENvbXBvbmVudERlZmluaXRpb25TdGF0ZSwgSSBleHRlbmRzIENvbXBvbmVudEluc3RhbmNlU3RhdGU+KHN0YXRlOiBELCBtYW5hZ2VyOiBDb21wb25lbnRNYW5hZ2VyPEksIEQ+KTogbWFuYWdlciBpcyBXaXRoRHluYW1pY0xheW91dDxJLCBPcGFxdWUsIFJ1bnRpbWVSZXNvbHZlcjxPcGFxdWU+PiB7XG4gIHJldHVybiBtYW5hZ2VyLmdldENhcGFiaWxpdGllcyhzdGF0ZSkuZHluYW1pY0xheW91dCA9PT0gdHJ1ZTtcbn1cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfQ0FQQUJJTElUSUVTOiBDb21wb25lbnRDYXBhYmlsaXRpZXMgPSB7XG4gIGR5bmFtaWNMYXlvdXQ6IHRydWUsXG4gIGR5bmFtaWNUYWc6IHRydWUsXG4gIHByZXBhcmVBcmdzOiB0cnVlLFxuICBjcmVhdGVBcmdzOiB0cnVlLFxuICBhdHRyaWJ1dGVIb29rOiBmYWxzZSxcbiAgZWxlbWVudEhvb2s6IGZhbHNlXG59O1xuXG5leHBvcnQgdHlwZSBCcmFuZGVkQ29tcG9uZW50RGVmaW5pdGlvbiA9IEN1cnJpZWRDb21wb25lbnREZWZpbml0aW9uO1xuZXhwb3J0IHR5cGUgSW50ZXJuYWxDb21wb25lbnQgPSBDb21wb25lbnRJbnN0YW5jZVN0YXRlO1xuZXhwb3J0IHR5cGUgSW50ZXJuYWxDb21wb25lbnRNYW5hZ2VyID0gQ29tcG9uZW50TWFuYWdlcjxDb21wb25lbnRJbnN0YW5jZVN0YXRlLCBDb21wb25lbnREZWZpbml0aW9uU3RhdGU+O1xuIl19","import { CurriedComponentDefinition, isCurriedComponentDefinition } from '../component/curried-component';\nimport { resolveComponent } from '../component/resolve';\nimport { UNDEFINED_REFERENCE } from '../references';\nexport default class CurryComponentReference {\n    constructor(inner, resolver, meta, args) {\n        this.inner = inner;\n        this.resolver = resolver;\n        this.meta = meta;\n        this.args = args;\n        this.tag = inner.tag;\n        this.lastValue = null;\n        this.lastDefinition = null;\n    }\n    value() {\n        let { inner, lastValue } = this;\n        let value = inner.value();\n        if (value === lastValue) {\n            return this.lastDefinition;\n        }\n        let definition = null;\n        if (isCurriedComponentDefinition(value)) {\n            definition = value;\n        } else if (typeof value === 'string' && value) {\n            let { resolver, meta } = this;\n            definition = resolveComponent(resolver, value, meta);\n        }\n        definition = this.curry(definition);\n        this.lastValue = value;\n        this.lastDefinition = definition;\n        return definition;\n    }\n    get() {\n        return UNDEFINED_REFERENCE;\n    }\n    curry(definition) {\n        let { args } = this;\n        if (!args && isCurriedComponentDefinition(definition)) {\n            return definition;\n        } else if (!definition) {\n            return null;\n        } else {\n            return new CurriedComponentDefinition(definition, args);\n        }\n    }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3VycnktY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcGFja2FnZXMvQGdsaW1tZXIvcnVudGltZS9saWIvcmVmZXJlbmNlcy9jdXJyeS1jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBT0EsQUFBTyxTQUFFLEFBQTBCLDRCQUFFLEFBQTRCLEFBQUUsb0NBQU0sQUFBZ0MsQUFBQztBQUMxRyxBQUFPLFNBQUUsQUFBZ0IsQUFBRSx3QkFBTSxBQUFzQixBQUFDO0FBQ3hELEFBQU8sU0FBRSxBQUFtQixBQUFFLDJCQUFNLEFBQWUsQUFBQztBQUVwRCxBQUFNLEFBQUMsQUFBTztBQUtaLGdCQUNVLEFBQXdCLE9BQ3hCLEFBQW9DLFVBQ3BDLEFBQWUsTUFDZixBQUFnQztBQUhoQyxhQUFLLFFBQUwsQUFBSyxBQUFtQjtBQUN4QixhQUFRLFdBQVIsQUFBUSxBQUE0QjtBQUNwQyxhQUFJLE9BQUosQUFBSSxBQUFXO0FBQ2YsYUFBSSxPQUFKLEFBQUksQUFBNEI7QUFFeEMsQUFBSSxhQUFDLEFBQUcsTUFBRyxBQUFLLE1BQUMsQUFBRyxBQUFDO0FBQ3JCLEFBQUksYUFBQyxBQUFTLFlBQUcsQUFBSSxBQUFDO0FBQ3RCLEFBQUksYUFBQyxBQUFjLGlCQUFHLEFBQUksQUFBQyxBQUM3QjtBQUFDO0FBRUQsQUFBSztBQUNILFlBQUksRUFBRSxBQUFLLE9BQUUsQUFBUyxBQUFFLGNBQUcsQUFBSSxBQUFDO0FBRWhDLFlBQUksQUFBSyxRQUFHLEFBQUssTUFBQyxBQUFLLEFBQUUsQUFBQztBQUUxQixBQUFFLEFBQUMsWUFBQyxBQUFLLFVBQUssQUFBUyxBQUFDLFdBQUMsQUFBQztBQUN4QixBQUFNLG1CQUFDLEFBQUksS0FBQyxBQUFjLEFBQUMsQUFDN0I7QUFBQztBQUVELFlBQUksQUFBVSxhQUE2RCxBQUFJLEFBQUM7QUFFaEYsQUFBRSxBQUFDLFlBQUMsQUFBNEIsNkJBQUMsQUFBSyxBQUFDLEFBQUMsUUFBQyxBQUFDO0FBQ3hDLEFBQVUseUJBQUcsQUFBSyxBQUFDLEFBQ3JCO0FBQUMsQUFBQyxBQUFJLGVBQUMsQUFBRSxBQUFDLElBQUMsT0FBTyxBQUFLLFVBQUssQUFBUSxZQUFJLEFBQUssQUFBQyxPQUFDLEFBQUM7QUFDOUMsZ0JBQUksRUFBRSxBQUFRLFVBQUUsQUFBSSxBQUFFLFNBQUcsQUFBSSxBQUFDO0FBQzlCLEFBQVUseUJBQUcsQUFBZ0IsaUJBQUMsQUFBUSxVQUFFLEFBQUssT0FBRSxBQUFJLEFBQUMsQUFBQyxBQUN2RDtBQUFDO0FBRUQsQUFBVSxxQkFBRyxBQUFJLEtBQUMsQUFBSyxNQUFDLEFBQVUsQUFBQyxBQUFDO0FBRXBDLEFBQUksYUFBQyxBQUFTLFlBQUcsQUFBSyxBQUFDO0FBQ3ZCLEFBQUksYUFBQyxBQUFjLGlCQUFHLEFBQVUsQUFBQztBQUVqQyxBQUFNLGVBQUMsQUFBVSxBQUFDLEFBQ3BCO0FBQUM7QUFFRCxBQUFHO0FBQ0QsQUFBTSxlQUFDLEFBQW1CLEFBQUMsQUFDN0I7QUFBQztBQUVPLEFBQUssVUFBQyxBQUFvRTtBQUNoRixZQUFJLEVBQUUsQUFBSSxBQUFFLFNBQUcsQUFBSSxBQUFDO0FBRXBCLEFBQUUsQUFBQyxZQUFDLENBQUMsQUFBSSxRQUFJLEFBQTRCLDZCQUFDLEFBQVUsQUFBQyxBQUFDLGFBQUMsQUFBQztBQUN0RCxBQUFNLG1CQUFDLEFBQVUsQUFBQyxBQUNwQjtBQUFDLEFBQUMsQUFBSSxtQkFBSyxDQUFDLEFBQVUsQUFBQyxZQUFDLEFBQUM7QUFDdkIsQUFBTSxtQkFBQyxBQUFJLEFBQUMsQUFDZDtBQUFDLEFBQUMsQUFBSSxTQUZDLEFBQUUsQUFBQyxNQUVILEFBQUM7QUFDTixBQUFNLG1CQUFDLElBQUksQUFBMEIsMkJBQUMsQUFBVSxZQUFFLEFBQUksQUFBQyxBQUFDLEFBQzFEO0FBQUMsQUFDSDtBQUFDLEFBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJcbmltcG9ydCB7IFJlZmVyZW5jZSwgUGF0aFJlZmVyZW5jZSwgVGFnIH0gZnJvbSAnQGdsaW1tZXIvcmVmZXJlbmNlJztcbmltcG9ydCB7IE9wdGlvbiwgT3BhcXVlIH0gZnJvbSAnQGdsaW1tZXIvdXRpbCc7XG5pbXBvcnQgeyBSdW50aW1lUmVzb2x2ZXIgfSBmcm9tICdAZ2xpbW1lci9pbnRlcmZhY2VzJztcblxuaW1wb3J0IHsgSUNhcHR1cmVkQXJndW1lbnRzIH0gZnJvbSAnLi4vdm0vYXJndW1lbnRzJztcbmltcG9ydCB7IENvbXBvbmVudERlZmluaXRpb24gfSBmcm9tICcuLi9jb21wb25lbnQvaW50ZXJmYWNlcyc7XG5pbXBvcnQgeyBDdXJyaWVkQ29tcG9uZW50RGVmaW5pdGlvbiwgaXNDdXJyaWVkQ29tcG9uZW50RGVmaW5pdGlvbiB9IGZyb20gJy4uL2NvbXBvbmVudC9jdXJyaWVkLWNvbXBvbmVudCc7XG5pbXBvcnQgeyByZXNvbHZlQ29tcG9uZW50IH0gZnJvbSAnLi4vY29tcG9uZW50L3Jlc29sdmUnO1xuaW1wb3J0IHsgVU5ERUZJTkVEX1JFRkVSRU5DRSB9IGZyb20gJy4uL3JlZmVyZW5jZXMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDdXJyeUNvbXBvbmVudFJlZmVyZW5jZTxTcGVjaWZpZXI+IGltcGxlbWVudHMgUGF0aFJlZmVyZW5jZTxPcHRpb248Q3VycmllZENvbXBvbmVudERlZmluaXRpb24+PiB7XG4gIHB1YmxpYyB0YWc6IFRhZztcbiAgcHJpdmF0ZSBsYXN0VmFsdWU6IE9wYXF1ZTtcbiAgcHJpdmF0ZSBsYXN0RGVmaW5pdGlvbjogT3B0aW9uPEN1cnJpZWRDb21wb25lbnREZWZpbml0aW9uPjtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIGlubmVyOiBSZWZlcmVuY2U8T3BhcXVlPixcbiAgICBwcml2YXRlIHJlc29sdmVyOiBSdW50aW1lUmVzb2x2ZXI8U3BlY2lmaWVyPixcbiAgICBwcml2YXRlIG1ldGE6IFNwZWNpZmllcixcbiAgICBwcml2YXRlIGFyZ3M6IE9wdGlvbjxJQ2FwdHVyZWRBcmd1bWVudHM+XG4gICkge1xuICAgIHRoaXMudGFnID0gaW5uZXIudGFnO1xuICAgIHRoaXMubGFzdFZhbHVlID0gbnVsbDtcbiAgICB0aGlzLmxhc3REZWZpbml0aW9uID0gbnVsbDtcbiAgfVxuXG4gIHZhbHVlKCk6IE9wdGlvbjxDdXJyaWVkQ29tcG9uZW50RGVmaW5pdGlvbj4ge1xuICAgIGxldCB7IGlubmVyLCBsYXN0VmFsdWUgfSA9IHRoaXM7XG5cbiAgICBsZXQgdmFsdWUgPSBpbm5lci52YWx1ZSgpO1xuXG4gICAgaWYgKHZhbHVlID09PSBsYXN0VmFsdWUpIHtcbiAgICAgIHJldHVybiB0aGlzLmxhc3REZWZpbml0aW9uO1xuICAgIH1cblxuICAgIGxldCBkZWZpbml0aW9uOiBPcHRpb248Q3VycmllZENvbXBvbmVudERlZmluaXRpb24gfCBDb21wb25lbnREZWZpbml0aW9uPiA9IG51bGw7XG5cbiAgICBpZiAoaXNDdXJyaWVkQ29tcG9uZW50RGVmaW5pdGlvbih2YWx1ZSkpIHtcbiAgICAgIGRlZmluaXRpb24gPSB2YWx1ZTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYgdmFsdWUpIHtcbiAgICAgIGxldCB7IHJlc29sdmVyLCBtZXRhIH0gPSB0aGlzO1xuICAgICAgZGVmaW5pdGlvbiA9IHJlc29sdmVDb21wb25lbnQocmVzb2x2ZXIsIHZhbHVlLCBtZXRhKTtcbiAgICB9XG5cbiAgICBkZWZpbml0aW9uID0gdGhpcy5jdXJyeShkZWZpbml0aW9uKTtcblxuICAgIHRoaXMubGFzdFZhbHVlID0gdmFsdWU7XG4gICAgdGhpcy5sYXN0RGVmaW5pdGlvbiA9IGRlZmluaXRpb247XG5cbiAgICByZXR1cm4gZGVmaW5pdGlvbjtcbiAgfVxuXG4gIGdldCgpOiBQYXRoUmVmZXJlbmNlPE9wYXF1ZT4ge1xuICAgIHJldHVybiBVTkRFRklORURfUkVGRVJFTkNFO1xuICB9XG5cbiAgcHJpdmF0ZSBjdXJyeShkZWZpbml0aW9uOiBPcHRpb248Q3VycmllZENvbXBvbmVudERlZmluaXRpb24gfCBDb21wb25lbnREZWZpbml0aW9uPik6IE9wdGlvbjxDdXJyaWVkQ29tcG9uZW50RGVmaW5pdGlvbj4ge1xuICAgIGxldCB7IGFyZ3MgfSA9IHRoaXM7XG5cbiAgICBpZiAoIWFyZ3MgJiYgaXNDdXJyaWVkQ29tcG9uZW50RGVmaW5pdGlvbihkZWZpbml0aW9uKSkge1xuICAgICAgcmV0dXJuIGRlZmluaXRpb247XG4gICAgfSBlbHNlIGlmICghZGVmaW5pdGlvbikge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBuZXcgQ3VycmllZENvbXBvbmVudERlZmluaXRpb24oZGVmaW5pdGlvbiwgYXJncyk7XG4gICAgfVxuICB9XG59Il19","export function normalizeStringValue(value) {\n    if (isEmpty(value)) {\n        return '';\n    }\n    return String(value);\n}\nexport function normalizeTrustedValue(value) {\n    if (isEmpty(value)) {\n        return '';\n    }\n    if (isString(value)) {\n        return value;\n    }\n    if (isSafeString(value)) {\n        return value.toHTML();\n    }\n    if (isNode(value)) {\n        return value;\n    }\n    return String(value);\n}\nexport function isEmpty(value) {\n    return value === null || value === undefined || typeof value.toString !== 'function';\n}\nexport function isSafeString(value) {\n    return typeof value === 'object' && value !== null && typeof value.toHTML === 'function';\n}\nexport function isNode(value) {\n    return typeof value === 'object' && value !== null && typeof value.nodeType === 'number';\n}\nexport function isFragment(value) {\n    return isNode(value) && value.nodeType === 11;\n}\nexport function isString(value) {\n    return typeof value === 'string';\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm9ybWFsaXplLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcGFja2FnZXMvQGdsaW1tZXIvcnVudGltZS9saWIvZG9tL25vcm1hbGl6ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFVQSxBQUFNLHFDQUErQixBQUFhO0FBQ2hELEFBQUUsQUFBQyxRQUFDLEFBQU8sUUFBQyxBQUFLLEFBQUMsQUFBQyxRQUFDLEFBQUM7QUFDbkIsQUFBTSxlQUFDLEFBQUUsQUFBQyxBQUNaO0FBQUM7QUFDRCxBQUFNLFdBQUMsQUFBTSxPQUFDLEFBQUssQUFBQyxBQUFDLEFBQ3ZCO0FBQUM7QUFFRCxBQUFNLHNDQUFnQyxBQUFhO0FBQ2pELEFBQUUsQUFBQyxRQUFDLEFBQU8sUUFBQyxBQUFLLEFBQUMsQUFBQyxRQUFDLEFBQUM7QUFDbkIsQUFBTSxlQUFDLEFBQUUsQUFBQyxBQUNaO0FBQUM7QUFDRCxBQUFFLEFBQUMsUUFBQyxBQUFRLFNBQUMsQUFBSyxBQUFDLEFBQUMsUUFBQyxBQUFDO0FBQ3BCLEFBQU0sZUFBQyxBQUFLLEFBQUMsQUFDZjtBQUFDO0FBQ0QsQUFBRSxBQUFDLFFBQUMsQUFBWSxhQUFDLEFBQUssQUFBQyxBQUFDLFFBQUMsQUFBQztBQUN4QixBQUFNLGVBQUMsQUFBSyxNQUFDLEFBQU0sQUFBRSxBQUFDLEFBQ3hCO0FBQUM7QUFDRCxBQUFFLEFBQUMsUUFBQyxBQUFNLE9BQUMsQUFBSyxBQUFDLEFBQUMsUUFBQyxBQUFDO0FBQ2xCLEFBQU0sZUFBQyxBQUFLLEFBQUMsQUFDZjtBQUFDO0FBQ0QsQUFBTSxXQUFDLEFBQU0sT0FBQyxBQUFLLEFBQUMsQUFBQyxBQUN2QjtBQUFDO0FBRUQsQUFBTSx3QkFBa0IsQUFBYTtBQUNuQyxBQUFNLFdBQUMsQUFBSyxVQUFLLEFBQUksUUFBSSxBQUFLLFVBQUssQUFBUyxhQUFJLE9BQU8sQUFBSyxNQUFDLEFBQVEsYUFBSyxBQUFVLEFBQUMsQUFDdkY7QUFBQztBQUVELEFBQU0sNkJBQXVCLEFBQWE7QUFDeEMsQUFBTSxXQUFDLE9BQU8sQUFBSyxVQUFLLEFBQVEsWUFBSSxBQUFLLFVBQUssQUFBSSxRQUFJLE9BQVEsQUFBYSxNQUFDLEFBQU0sV0FBSyxBQUFVLEFBQUMsQUFDcEc7QUFBQztBQUVELEFBQU0sdUJBQWlCLEFBQWE7QUFDbEMsQUFBTSxXQUFDLE9BQU8sQUFBSyxVQUFLLEFBQVEsWUFBSSxBQUFLLFVBQUssQUFBSSxRQUFJLE9BQVEsQUFBYSxNQUFDLEFBQVEsYUFBSyxBQUFRLEFBQUMsQUFDcEc7QUFBQztBQUVELEFBQU0sMkJBQXFCLEFBQWE7QUFDdEMsQUFBTSxXQUFDLEFBQU0sT0FBQyxBQUFLLEFBQUMsVUFBSSxBQUFLLE1BQUMsQUFBUSxhQUFLLEFBQUUsQUFBQyxBQUNoRDtBQUFDO0FBRUQsQUFBTSx5QkFBbUIsQUFBYTtBQUNwQyxBQUFNLFdBQUMsT0FBTyxBQUFLLFVBQUssQUFBUSxBQUFDLEFBQ25DO0FBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBPcGFxdWUsIFNpbXBsZSB9IGZyb20gXCJAZ2xpbW1lci9pbnRlcmZhY2VzXCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2FmZVN0cmluZyB7XG4gIHRvSFRNTCgpOiBzdHJpbmc7XG59XG5cbmV4cG9ydCB0eXBlIEluc2VydGlvbiA9IENhdXRpb3VzSW5zZXJ0aW9uIHwgVHJ1c3RpbmdJbnNlcnRpb247XG5leHBvcnQgdHlwZSBDYXV0aW91c0luc2VydGlvbiA9IHN0cmluZyB8IFNhZmVTdHJpbmcgfCBTaW1wbGUuTm9kZTtcbmV4cG9ydCB0eXBlIFRydXN0aW5nSW5zZXJ0aW9uID0gc3RyaW5nIHwgU2ltcGxlLk5vZGU7XG5cbmV4cG9ydCBmdW5jdGlvbiBub3JtYWxpemVTdHJpbmdWYWx1ZSh2YWx1ZTogT3BhcXVlKTogc3RyaW5nIHtcbiAgaWYgKGlzRW1wdHkodmFsdWUpKSB7XG4gICAgcmV0dXJuICcnO1xuICB9XG4gIHJldHVybiBTdHJpbmcodmFsdWUpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbm9ybWFsaXplVHJ1c3RlZFZhbHVlKHZhbHVlOiBPcGFxdWUpOiBUcnVzdGluZ0luc2VydGlvbiB7XG4gIGlmIChpc0VtcHR5KHZhbHVlKSkge1xuICAgIHJldHVybiAnJztcbiAgfVxuICBpZiAoaXNTdHJpbmcodmFsdWUpKSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG4gIGlmIChpc1NhZmVTdHJpbmcodmFsdWUpKSB7XG4gICAgcmV0dXJuIHZhbHVlLnRvSFRNTCgpO1xuICB9XG4gIGlmIChpc05vZGUodmFsdWUpKSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG4gIHJldHVybiBTdHJpbmcodmFsdWUpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNFbXB0eSh2YWx1ZTogT3BhcXVlKTogYm9vbGVhbiB7XG4gIHJldHVybiB2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHR5cGVvZiB2YWx1ZS50b1N0cmluZyAhPT0gJ2Z1bmN0aW9uJztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzU2FmZVN0cmluZyh2YWx1ZTogT3BhcXVlKTogdmFsdWUgaXMgU2FmZVN0cmluZyB7XG4gIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICE9PSBudWxsICYmIHR5cGVvZiAodmFsdWUgYXMgYW55KS50b0hUTUwgPT09ICdmdW5jdGlvbic7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc05vZGUodmFsdWU6IE9wYXF1ZSk6IHZhbHVlIGlzIFNpbXBsZS5Ob2RlIHtcbiAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgIT09IG51bGwgJiYgdHlwZW9mICh2YWx1ZSBhcyBhbnkpLm5vZGVUeXBlID09PSAnbnVtYmVyJztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzRnJhZ21lbnQodmFsdWU6IE9wYXF1ZSk6IHZhbHVlIGlzIFNpbXBsZS5Eb2N1bWVudEZyYWdtZW50IHtcbiAgcmV0dXJuIGlzTm9kZSh2YWx1ZSkgJiYgdmFsdWUubm9kZVR5cGUgPT09IDExO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNTdHJpbmcodmFsdWU6IE9wYXF1ZSk6IHZhbHVlIGlzIHN0cmluZyB7XG4gIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnO1xufVxuIl19","import { combineTagged } from '@glimmer/reference';\nimport { normalizeStringValue } from '../dom/normalize';\nexport default class ClassListReference {\n    constructor(list) {\n        this.list = list;\n        this.tag = combineTagged(list);\n        this.list = list;\n    }\n    value() {\n        let ret = [];\n        let { list } = this;\n        for (let i = 0; i < list.length; i++) {\n            let value = normalizeStringValue(list[i].value());\n            if (value) ret.push(value);\n        }\n        return ret.length === 0 ? null : ret.join(' ');\n    }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2xhc3MtbGlzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3J1bnRpbWUvbGliL3JlZmVyZW5jZXMvY2xhc3MtbGlzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxBQUFPLFNBQWtCLEFBQWEsQUFBRSxxQkFBTSxBQUFvQixBQUFDO0FBR25FLEFBQU8sU0FBRSxBQUFvQixBQUFFLDRCQUFNLEFBQWtCLEFBQUM7QUFFeEQsQUFBTSxBQUFDLEFBQU87QUFHWixnQkFBb0IsQUFBeUI7QUFBekIsYUFBSSxPQUFKLEFBQUksQUFBcUI7QUFDM0MsQUFBSSxhQUFDLEFBQUcsTUFBRyxBQUFhLGNBQUMsQUFBSSxBQUFDLEFBQUM7QUFDL0IsQUFBSSxhQUFDLEFBQUksT0FBRyxBQUFJLEFBQUMsQUFDbkI7QUFBQztBQUVELEFBQUs7QUFDSCxZQUFJLEFBQUcsTUFBYSxBQUFFLEFBQUM7QUFDdkIsWUFBSSxFQUFFLEFBQUksQUFBRSxTQUFHLEFBQUksQUFBQztBQUVwQixBQUFHLEFBQUMsYUFBQyxJQUFJLEFBQUMsSUFBQyxBQUFDLEdBQUUsQUFBQyxJQUFDLEFBQUksS0FBQyxBQUFNLFFBQUUsQUFBQyxBQUFFLEtBQUUsQUFBQztBQUNqQyxnQkFBSSxBQUFLLFFBQUcsQUFBb0IscUJBQUMsQUFBSSxLQUFDLEFBQUMsQUFBQyxHQUFDLEFBQUssQUFBRSxBQUFDLEFBQUM7QUFDbEQsQUFBRSxBQUFDLGdCQUFDLEFBQUssQUFBQyxPQUFDLEFBQUcsSUFBQyxBQUFJLEtBQUMsQUFBSyxBQUFDLEFBQUMsQUFDN0I7QUFBQztBQUVELEFBQU0sZUFBQyxBQUFHLElBQUMsQUFBTSxXQUFLLEFBQUMsSUFBRyxBQUFJLE9BQUcsQUFBRyxJQUFDLEFBQUksS0FBQyxBQUFHLEFBQUMsQUFBQyxBQUNqRDtBQUFDLEFBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJcbmltcG9ydCB7IFJlZmVyZW5jZSwgVGFnLCBjb21iaW5lVGFnZ2VkIH0gZnJvbSAnQGdsaW1tZXIvcmVmZXJlbmNlJztcbmltcG9ydCB7IE9wdGlvbiwgT3BhcXVlIH0gZnJvbSAnQGdsaW1tZXIvdXRpbCc7XG5cbmltcG9ydCB7IG5vcm1hbGl6ZVN0cmluZ1ZhbHVlIH0gZnJvbSAnLi4vZG9tL25vcm1hbGl6ZSc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENsYXNzTGlzdFJlZmVyZW5jZSBpbXBsZW1lbnRzIFJlZmVyZW5jZTxPcHRpb248c3RyaW5nPj4ge1xuICBwdWJsaWMgdGFnOiBUYWc7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBsaXN0OiBSZWZlcmVuY2U8T3BhcXVlPltdKSB7XG4gICAgdGhpcy50YWcgPSBjb21iaW5lVGFnZ2VkKGxpc3QpO1xuICAgIHRoaXMubGlzdCA9IGxpc3Q7XG4gIH1cblxuICB2YWx1ZSgpOiBPcHRpb248c3RyaW5nPiB7XG4gICAgbGV0IHJldDogc3RyaW5nW10gPSBbXTtcbiAgICBsZXQgeyBsaXN0IH0gPSB0aGlzO1xuXG4gICAgZm9yIChsZXQgaT0wOyBpPGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgIGxldCB2YWx1ZSA9IG5vcm1hbGl6ZVN0cmluZ1ZhbHVlKGxpc3RbaV0udmFsdWUoKSk7XG4gICAgICBpZiAodmFsdWUpIHJldC5wdXNoKHZhbHVlKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmV0Lmxlbmd0aCA9PT0gMCA/IG51bGwgOiByZXQuam9pbignICcpO1xuICB9XG59Il19","import { Register } from '@glimmer/vm';\nimport { ATTRS_BLOCK } from '@glimmer/opcode-compiler';\nimport { dict, assert, unreachable } from '@glimmer/util';\nimport { CONSTANT_TAG, isConst, isConstTag } from '@glimmer/reference';\n\nimport { APPEND_OPCODES, UpdatingOpcode } from '../../opcodes';\nimport { Arguments } from '../../vm/arguments';\nimport { IsCurriedComponentDefinitionReference } from './content';\nimport { UpdateDynamicAttributeOpcode } from './dom';\nimport { resolveComponent } from \"../../component/resolve\";\nimport { hasDynamicLayout, hasStaticLayout } from '../../component/interfaces';\nimport { isCurriedComponentDefinition } from '../../component/curried-component';\nimport CurryComponentReference from '../../references/curry-component';\nimport ClassListReference from '../../references/class-list';\n\nconst ARGS = new Arguments();\nAPPEND_OPCODES.add(57 /* IsComponent */, vm => {\n    let stack = vm.stack;\n    let ref = stack.pop();\n    stack.push(IsCurriedComponentDefinitionReference.create(ref));\n});\nAPPEND_OPCODES.add(58 /* CurryComponent */, (vm, { op1: _meta }) => {\n    let stack = vm.stack;\n    let definition = stack.pop();\n    let args = stack.pop();\n    let captured = null;\n    if (args.length) {\n        captured = args.capture();\n    }\n    let meta = vm.constants.getSerializable(_meta);\n    let resolver = vm.constants.resolver;\n    vm.loadValue(Register.v0, new CurryComponentReference(definition, resolver, meta, captured));\n    // expectStackChange(vm.stack, -args.length - 1, 'CurryComponent');\n});\nAPPEND_OPCODES.add(59 /* PushComponentDefinition */, (vm, { op1: handle }) => {\n    let definition = vm.constants.resolveHandle(handle);\n    (false && assert(!!definition, `Missing component for ${handle} (TODO: env.specifierForHandle)`));\n\n    let { manager } = definition;\n    vm.stack.push({ definition, manager, state: null });\n});\nAPPEND_OPCODES.add(60 /* PushDynamicComponentManager */, (vm, { op1: _meta }) => {\n    let stack = vm.stack;\n    let component = stack.pop().value();\n    let definition;\n    if (typeof component === 'string') {\n        let { constants, constants: { resolver } } = vm;\n        let meta = constants.getSerializable(_meta);\n        let resolvedDefinition = resolveComponent(resolver, component, meta);\n        definition = resolvedDefinition;\n    } else if (isCurriedComponentDefinition(component)) {\n        definition = component;\n    } else {\n        throw unreachable();\n    }\n    stack.push({ definition, manager: null, state: null });\n});\nAPPEND_OPCODES.add(61 /* PushArgs */, (vm, { op1: _names, op2: flags }) => {\n    let stack = vm.stack;\n    let names = vm.constants.getStringArray(_names);\n    let positionalCount = flags >> 4;\n    let synthetic = flags & 0b1000;\n    let blockNames = [];\n    if (flags & 0b0100) blockNames.push('main');\n    if (flags & 0b0010) blockNames.push('else');\n    if (flags & 0b0001) blockNames.push('attrs');\n    ARGS.setup(stack, names, blockNames, positionalCount, !!synthetic);\n    stack.push(ARGS);\n});\nAPPEND_OPCODES.add(63 /* PrepareArgs */, (vm, { op1: _state }) => {\n    let stack = vm.stack;\n    let instance = vm.fetchValue(_state);\n    let { definition } = instance;\n    let args;\n    if (isCurriedComponentDefinition(definition)) {\n        (false && assert(!definition.manager, \"If the component definition was curried, we don't yet have a manager\"));\n\n        args = stack.pop();\n        definition = instance.definition = definition.unwrap(args);\n    } else {\n        args = stack.pop();\n    }\n    let { manager, state } = definition;\n    instance.manager = definition.manager;\n    if (manager.getCapabilities(state).prepareArgs !== true) {\n        stack.push(args);\n        return;\n    }\n    let blocks = args.blocks.values;\n    let blockNames = args.blocks.names;\n    let preparedArgs = manager.prepareArgs(state, args);\n    if (preparedArgs) {\n        args.clear();\n        for (let i = 0; i < blocks.length; i++) {\n            stack.push(blocks[i]);\n        }\n        let { positional, named } = preparedArgs;\n        let positionalCount = positional.length;\n        for (let i = 0; i < positionalCount; i++) {\n            stack.push(positional[i]);\n        }\n        let names = Object.keys(named);\n        for (let i = 0; i < names.length; i++) {\n            stack.push(named[names[i]]);\n        }\n        args.setup(stack, names, blockNames, positionalCount, true);\n    }\n    stack.push(args);\n});\nAPPEND_OPCODES.add(64 /* CreateComponent */, (vm, { op1: flags, op2: _state }) => {\n    let dynamicScope = vm.dynamicScope();\n    let instance = vm.fetchValue(_state);\n    let { definition, manager } = instance;\n    let hasDefaultBlock = flags & 1;\n    let args = null;\n    if (manager.getCapabilities(definition.state).createArgs) {\n        args = vm.stack.peek();\n    }\n    let state = manager.create(vm.env, definition.state, args, dynamicScope, vm.getSelf(), !!hasDefaultBlock);\n    // We want to reuse the `state` POJO here, because we know that the opcodes\n    // only transition at exactly one place.\n    instance.state = state;\n    let tag = manager.getTag(state);\n    if (!isConstTag(tag)) {\n        vm.updateWith(new UpdateComponentOpcode(tag, state, manager, dynamicScope));\n    }\n});\nAPPEND_OPCODES.add(65 /* RegisterComponentDestructor */, (vm, { op1: _state }) => {\n    let { manager, state } = vm.fetchValue(_state);\n    let destructor = manager.getDestructor(state);\n    if (destructor) vm.newDestroyable(destructor);\n});\nAPPEND_OPCODES.add(71 /* BeginComponentTransaction */, vm => {\n    vm.beginCacheGroup();\n    vm.elements().pushSimpleBlock();\n});\nAPPEND_OPCODES.add(66 /* PutComponentOperations */, vm => {\n    vm.loadValue(Register.t0, new ComponentElementOperations());\n});\nAPPEND_OPCODES.add(30 /* ComponentAttr */, (vm, { op1: _name, op2: trusting, op3: _namespace }) => {\n    let name = vm.constants.getString(_name);\n    let reference = vm.stack.pop();\n    let namespace = _namespace ? vm.constants.getString(_namespace) : null;\n    vm.fetchValue(Register.t0).setAttribute(name, reference, !!trusting, namespace);\n});\nexport class ComponentElementOperations {\n    constructor() {\n        this.attributes = dict();\n        this.classes = [];\n    }\n    setAttribute(name, value, trusting, namespace) {\n        let deferred = { value, namespace, trusting };\n        if (name === 'class') {\n            this.classes.push(value);\n        }\n        this.attributes[name] = deferred;\n    }\n    flush(vm) {\n        for (let name in this.attributes) {\n            let attr = this.attributes[name];\n            let { value: reference, namespace, trusting } = attr;\n            if (name === 'class') {\n                reference = new ClassListReference(this.classes);\n            }\n            let attribute = vm.elements().setDynamicAttribute(name, reference.value(), trusting, namespace);\n            if (!isConst(reference)) {\n                vm.updateWith(new UpdateDynamicAttributeOpcode(reference, attribute));\n            }\n        }\n    }\n}\nAPPEND_OPCODES.add(73 /* DidCreateElement */, (vm, { op1: _state }) => {\n    let { definition, state } = vm.fetchValue(_state);\n    let { manager } = definition;\n    let operations = vm.fetchValue(Register.t0);\n    let action = 'DidCreateElementOpcode#evaluate';\n    manager.didCreateElement(state, vm.elements().expectConstructing(action), operations);\n});\nAPPEND_OPCODES.add(67 /* GetComponentSelf */, (vm, { op1: _state }) => {\n    let { definition, state } = vm.fetchValue(_state);\n    let { manager } = definition;\n    vm.stack.push(manager.getSelf(state));\n});\nAPPEND_OPCODES.add(68 /* GetComponentTagName */, (vm, { op1: _state }) => {\n    let { definition, state } = vm.fetchValue(_state);\n    let { manager } = definition;\n    vm.stack.push(manager.getTagName(state));\n});\n// Dynamic Invocation Only\nAPPEND_OPCODES.add(69 /* GetComponentLayout */, (vm, { op1: _state }) => {\n    let instance = vm.fetchValue(_state);\n    let { manager, definition } = instance;\n    let { constants: { resolver }, stack } = vm;\n    let { state: instanceState } = instance;\n    let { state: definitionState } = definition;\n    let invoke;\n    if (hasStaticLayout(definitionState, manager)) {\n        invoke = manager.getLayout(definitionState, resolver);\n    } else if (hasDynamicLayout(definitionState, manager)) {\n        invoke = manager.getDynamicLayout(instanceState, resolver);\n    } else {\n        throw unreachable();\n    }\n    stack.push(invoke.symbolTable);\n    stack.push(invoke.handle);\n});\n// Dynamic Invocation Only\nAPPEND_OPCODES.add(70 /* InvokeComponentLayout */, vm => {\n    let { stack } = vm;\n    let handle = stack.pop();\n    let { symbols, hasEval } = stack.pop();\n    {\n        let scope = vm.pushRootScope(symbols.length + 1, true);\n        scope.bindSelf(stack.pop());\n        let args = vm.stack.pop();\n        let lookup = null;\n        let $eval = -1;\n        if (hasEval) {\n            $eval = symbols.indexOf('$eval') + 1;\n            lookup = dict();\n        }\n        let callerNames = args.named.atNames;\n        for (let i = callerNames.length - 1; i >= 0; i--) {\n            let atName = callerNames[i];\n            let symbol = symbols.indexOf(callerNames[i]);\n            let value = args.named.get(atName, false);\n            if (symbol !== -1) scope.bindSymbol(symbol + 1, value);\n            if (hasEval) lookup[atName] = value;\n        }\n        let bindBlock = (symbolName, blockName) => {\n            let symbol = symbols.indexOf(symbolName);\n            let block = blocks.get(blockName);\n            if (symbol !== -1) {\n                scope.bindBlock(symbol + 1, block);\n            }\n            if (lookup) lookup[symbolName] = block;\n        };\n        let blocks = args.blocks;\n        bindBlock(ATTRS_BLOCK, 'attrs');\n        bindBlock('&inverse', 'else');\n        bindBlock('&default', 'main');\n        if (lookup) scope.bindEvalScope(lookup);\n        vm.call(handle);\n    }\n});\nAPPEND_OPCODES.add(74 /* DidRenderLayout */, (vm, { op1: _state }) => {\n    let { manager, state } = vm.fetchValue(_state);\n    let bounds = vm.elements().popBlock();\n    let mgr = manager;\n    mgr.didRenderLayout(state, bounds);\n    vm.env.didCreate(state, manager);\n    vm.updateWith(new DidUpdateLayoutOpcode(manager, state, bounds));\n});\nAPPEND_OPCODES.add(72 /* CommitComponentTransaction */, vm => {\n    vm.commitCacheGroup();\n});\nexport class UpdateComponentOpcode extends UpdatingOpcode {\n    constructor(tag, component, manager, dynamicScope) {\n        super();\n        this.tag = tag;\n        this.component = component;\n        this.manager = manager;\n        this.dynamicScope = dynamicScope;\n        this.type = 'update-component';\n    }\n    evaluate(_vm) {\n        let { component, manager, dynamicScope } = this;\n        manager.update(component, dynamicScope);\n    }\n}\nexport class DidUpdateLayoutOpcode extends UpdatingOpcode {\n    constructor(manager, component, bounds) {\n        super();\n        this.manager = manager;\n        this.component = component;\n        this.bounds = bounds;\n        this.type = 'did-update-layout';\n        this.tag = CONSTANT_TAG;\n    }\n    evaluate(vm) {\n        let { manager, component, bounds } = this;\n        manager.didUpdateLayout(component, bounds);\n        vm.env.didUpdate(component, manager);\n    }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vcGFja2FnZXMvQGdsaW1tZXIvcnVudGltZS9saWIvY29tcGlsZWQvb3Bjb2Rlcy9jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsQUFBTyxTQUFNLEFBQVEsQUFBRSxnQkFBTSxBQUFhLEFBQUM7QUFFM0MsQUFBTyxTQUFFLEFBQVcsQUFBRSxtQkFBTSxBQUEwQixBQUFDO0FBQ3ZELEFBQU8sU0FBd0IsQUFBSSxNQUFFLEFBQU0sUUFBRSxBQUFXLEFBQUUsQUFBTSxBQUFFLG1CQUFNLEFBQWUsQUFBQztBQVF4RixBQUFPLFNBQ0wsQUFBWSxjQUdaLEFBQU8sU0FDUCxBQUFVLEFBQ1gsa0JBQU0sQUFBb0IsQUFBQyxBQUM1QixBQUFPLEFBQ0wsQUFBSyxBQUNMLEFBQWlCLEFBQ2pCLEFBQWUsQUFDZixBQUFhLEFBQ2IsQUFBYyxBQUNkLEFBQXVCLEFBQ3ZCLEFBQVcsQUFDWixBQUFNLEFBQWdCLEFBQUM7O0FBSXhCLEFBQU8sU0FBRSxBQUFjLGdCQUFFLEFBQWMsQUFBRSxzQkFBTSxBQUFlLEFBQUM7QUFFL0QsQUFBTyxTQUFFLEFBQVMsQUFBa0MsaUJBQU0sQUFBb0IsQUFBQztBQUMvRSxBQUFPLFNBQUUsQUFBcUMsQUFBRSw2Q0FBTSxBQUFXLEFBQUM7QUFDbEUsQUFBTyxTQUFFLEFBQTRCLEFBQUUsb0NBQU0sQUFBTyxBQUFDO0FBRXJELEFBQU8sU0FBRSxBQUFnQixBQUFFLHdCQUFNLEFBQXlCLEFBQUM7QUFDM0QsQUFBTyxTQUNMLEFBQWdCLGtCQUNoQixBQUFlLEFBS2hCLHVCQUFNLEFBQTRCLEFBQUM7QUFDcEMsQUFBTyxTQUVMLEFBQTRCLEFBQzdCLG9DQUFNLEFBQW1DLEFBQUM7QUFDM0MsT0FBTyxBQUF1Qiw2QkFBTSxBQUFrQyxBQUFDO0FBQ3ZFLE9BQU8sQUFBa0Isd0JBQU0sQUFBNkIsQUFBQyxBQUM3RCxBQUFP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QUNGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgT3AsIFJlZ2lzdGVyIH0gZnJvbSAnQGdsaW1tZXIvdm0nO1xuaW1wb3J0IHsgVGVtcGxhdGVNZXRhIH0gZnJvbSAnQGdsaW1tZXIvd2lyZS1mb3JtYXQnO1xuaW1wb3J0IHsgQVRUUlNfQkxPQ0sgfSBmcm9tICdAZ2xpbW1lci9vcGNvZGUtY29tcGlsZXInO1xuaW1wb3J0IHsgT3BhcXVlLCBPcHRpb24sIERpY3QsIGRpY3QsIGFzc2VydCwgdW5yZWFjaGFibGUsIGV4cGVjdCB9IGZyb20gJ0BnbGltbWVyL3V0aWwnO1xuaW1wb3J0IHtcbiAgVk1IYW5kbGUsXG4gIFByb2dyYW1TeW1ib2xUYWJsZSxcbiAgQ29tcG9uZW50SW5zdGFuY2VTdGF0ZSxcbiAgQ29tcG9uZW50RGVmaW5pdGlvblN0YXRlLFxuICBSZWNhc3Rcbn0gZnJvbSAnQGdsaW1tZXIvaW50ZXJmYWNlcyc7XG5pbXBvcnQge1xuICBDT05TVEFOVF9UQUcsXG4gIFRhZyxcbiAgVmVyc2lvbmVkUmVmZXJlbmNlLFxuICBpc0NvbnN0LFxuICBpc0NvbnN0VGFnXG59IGZyb20gJ0BnbGltbWVyL3JlZmVyZW5jZSc7XG5pbXBvcnQge1xuICBjaGVjayxcbiAgZXhwZWN0U3RhY2tDaGFuZ2UsXG4gIENoZWNrSW5zdGFuY2VvZixcbiAgQ2hlY2tGdW5jdGlvbixcbiAgQ2hlY2tJbnRlcmZhY2UsXG4gIENoZWNrUHJvZ3JhbVN5bWJvbFRhYmxlLFxuICBDaGVja0hhbmRsZVxufSBmcm9tICdAZ2xpbW1lci9kZWJ1Zyc7XG5cbmltcG9ydCBCb3VuZHMgZnJvbSAnLi4vLi4vYm91bmRzJztcbmltcG9ydCB7IER5bmFtaWNTY29wZSwgU2NvcGVTbG90IH0gZnJvbSAnLi4vLi4vZW52aXJvbm1lbnQnO1xuaW1wb3J0IHsgQVBQRU5EX09QQ09ERVMsIFVwZGF0aW5nT3Bjb2RlIH0gZnJvbSAnLi4vLi4vb3Bjb2Rlcyc7XG5pbXBvcnQgeyBVcGRhdGluZ1ZNLCBWTSB9IGZyb20gJy4uLy4uL3ZtJztcbmltcG9ydCB7IEFyZ3VtZW50cywgSUFyZ3VtZW50cywgSUNhcHR1cmVkQXJndW1lbnRzIH0gZnJvbSAnLi4vLi4vdm0vYXJndW1lbnRzJztcbmltcG9ydCB7IElzQ3VycmllZENvbXBvbmVudERlZmluaXRpb25SZWZlcmVuY2UgfSBmcm9tICcuL2NvbnRlbnQnO1xuaW1wb3J0IHsgVXBkYXRlRHluYW1pY0F0dHJpYnV0ZU9wY29kZSB9IGZyb20gJy4vZG9tJztcbmltcG9ydCB7IENvbXBvbmVudE1hbmFnZXIsIENvbXBvbmVudCB9IGZyb20gJy4uLy4uL2ludGVybmFsLWludGVyZmFjZXMnO1xuaW1wb3J0IHsgcmVzb2x2ZUNvbXBvbmVudCB9IGZyb20gXCIuLi8uLi9jb21wb25lbnQvcmVzb2x2ZVwiO1xuaW1wb3J0IHtcbiAgaGFzRHluYW1pY0xheW91dCxcbiAgaGFzU3RhdGljTGF5b3V0LFxuICBXaXRoRHluYW1pY1RhZ05hbWUsXG4gIFdpdGhFbGVtZW50SG9vayxcbiAgQ29tcG9uZW50RGVmaW5pdGlvbixcbiAgSW50ZXJuYWxDb21wb25lbnRNYW5hZ2VyXG59IGZyb20gJy4uLy4uL2NvbXBvbmVudC9pbnRlcmZhY2VzJztcbmltcG9ydCB7XG4gIEN1cnJpZWRDb21wb25lbnREZWZpbml0aW9uLFxuICBpc0N1cnJpZWRDb21wb25lbnREZWZpbml0aW9uXG59IGZyb20gJy4uLy4uL2NvbXBvbmVudC9jdXJyaWVkLWNvbXBvbmVudCc7XG5pbXBvcnQgQ3VycnlDb21wb25lbnRSZWZlcmVuY2UgZnJvbSAnLi4vLi4vcmVmZXJlbmNlcy9jdXJyeS1jb21wb25lbnQnO1xuaW1wb3J0IENsYXNzTGlzdFJlZmVyZW5jZSBmcm9tICcuLi8uLi9yZWZlcmVuY2VzL2NsYXNzLWxpc3QnO1xuaW1wb3J0IHtcbiAgQ2hlY2tSZWZlcmVuY2UsXG4gIENoZWNrQXJndW1lbnRzLFxuICBDaGVja1BhdGhSZWZlcmVuY2UsXG4gIENoZWNrQ29tcG9uZW50SW5zdGFuY2Vcbn0gZnJvbSAnLi8tZGVidWctc3RyaXAnO1xuXG5jb25zdCBBUkdTID0gbmV3IEFyZ3VtZW50cygpO1xuXG4vKipcbiAqIFRoZSBWTSBjcmVhdGVzIGEgbmV3IENvbXBvbmVudEluc3RhbmNlIGRhdGEgc3RydWN0dXJlIGZvciBldmVyeSBjb21wb25lbnRcbiAqIGludm9jYXRpb24gaXQgZW5jb3VudGVycy5cbiAqXG4gKiBTaW1pbGFyIHRvIGhvdyBhIENvbXBvbmVudERlZmluaXRpb24gY29udGFpbnMgc3RhdGUgYWJvdXQgYWxsIGNvbXBvbmVudHMgb2YgYVxuICogcGFydGljdWxhciB0eXBlLCBhIENvbXBvbmVudEluc3RhbmNlIGNvbnRhaW5zIHN0YXRlIHNwZWNpZmljIHRvIGEgcGFydGljdWxhclxuICogaW5zdGFuY2Ugb2YgYSBjb21wb25lbnQgdHlwZS4gSXQgYWxzbyBjb250YWlucyBhIHBvaW50ZXIgYmFjayB0byBpdHNcbiAqIGNvbXBvbmVudCB0eXBlJ3MgQ29tcG9uZW50RGVmaW5pdGlvbi5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBDb21wb25lbnRJbnN0YW5jZSB7XG4gIGRlZmluaXRpb246IENvbXBvbmVudERlZmluaXRpb247XG4gIG1hbmFnZXI6IEludGVybmFsQ29tcG9uZW50TWFuYWdlcjtcbiAgc3RhdGU6IENvbXBvbmVudEluc3RhbmNlU3RhdGU7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSW5pdGlhbENvbXBvbmVudEluc3RhbmNlIHtcbiAgZGVmaW5pdGlvbjogUGFydGlhbENvbXBvbmVudERlZmluaXRpb247XG4gIG1hbmFnZXI6IE9wdGlvbjxJbnRlcm5hbENvbXBvbmVudE1hbmFnZXI+O1xuICBzdGF0ZTogbnVsbDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQb3B1bGF0ZWRDb21wb25lbnRJbnN0YW5jZSB7XG4gIGRlZmluaXRpb246IENvbXBvbmVudERlZmluaXRpb247XG4gIG1hbmFnZXI6IEludGVybmFsQ29tcG9uZW50TWFuYWdlcjtcbiAgc3RhdGU6IG51bGw7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGFydGlhbENvbXBvbmVudERlZmluaXRpb24ge1xuICBzdGF0ZTogT3B0aW9uPENvbXBvbmVudERlZmluaXRpb25TdGF0ZT47XG4gIG1hbmFnZXI6IEludGVybmFsQ29tcG9uZW50TWFuYWdlcjtcbn1cblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLklzQ29tcG9uZW50LCB2bSA9PiB7XG4gIGxldCBzdGFjayA9IHZtLnN0YWNrO1xuICBsZXQgcmVmID0gY2hlY2soc3RhY2sucG9wKCksIENoZWNrUmVmZXJlbmNlKTtcblxuICBzdGFjay5wdXNoKElzQ3VycmllZENvbXBvbmVudERlZmluaXRpb25SZWZlcmVuY2UuY3JlYXRlKHJlZikpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5DdXJyeUNvbXBvbmVudCwgKHZtLCB7IG9wMTogX21ldGEgfSkgPT4ge1xuICBsZXQgc3RhY2sgPSB2bS5zdGFjaztcblxuICBsZXQgZGVmaW5pdGlvbiA9IGNoZWNrKHN0YWNrLnBvcCgpLCBDaGVja1JlZmVyZW5jZSk7XG4gIGxldCBhcmdzID0gY2hlY2soc3RhY2sucG9wKCksIENoZWNrQXJndW1lbnRzKTtcbiAgbGV0IGNhcHR1cmVkOiBPcHRpb248SUNhcHR1cmVkQXJndW1lbnRzPiA9IG51bGw7XG5cbiAgaWYgKGFyZ3MubGVuZ3RoKSB7XG4gICAgY2FwdHVyZWQgPSBhcmdzLmNhcHR1cmUoKTtcbiAgfVxuXG4gIGxldCBtZXRhID0gdm0uY29uc3RhbnRzLmdldFNlcmlhbGl6YWJsZTxUZW1wbGF0ZU1ldGE+KF9tZXRhKTtcbiAgbGV0IHJlc29sdmVyID0gdm0uY29uc3RhbnRzLnJlc29sdmVyO1xuXG4gIHZtLmxvYWRWYWx1ZShSZWdpc3Rlci52MCwgbmV3IEN1cnJ5Q29tcG9uZW50UmVmZXJlbmNlKGRlZmluaXRpb24sIHJlc29sdmVyLCBtZXRhLCBjYXB0dXJlZCkpO1xuXG4gIC8vIGV4cGVjdFN0YWNrQ2hhbmdlKHZtLnN0YWNrLCAtYXJncy5sZW5ndGggLSAxLCAnQ3VycnlDb21wb25lbnQnKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUHVzaENvbXBvbmVudERlZmluaXRpb24sICh2bSwgeyBvcDE6IGhhbmRsZSB9KSA9PiB7XG4gIGxldCBkZWZpbml0aW9uID0gdm0uY29uc3RhbnRzLnJlc29sdmVIYW5kbGU8Q29tcG9uZW50RGVmaW5pdGlvbj4oaGFuZGxlKTtcbiAgYXNzZXJ0KCEhZGVmaW5pdGlvbiwgYE1pc3NpbmcgY29tcG9uZW50IGZvciAke2hhbmRsZX0gKFRPRE86IGVudi5zcGVjaWZpZXJGb3JIYW5kbGUpYCk7XG5cbiAgbGV0IHsgbWFuYWdlciB9ID0gZGVmaW5pdGlvbjtcbiAgdm0uc3RhY2sucHVzaCh7IGRlZmluaXRpb24sIG1hbmFnZXIsIHN0YXRlOiBudWxsIH0pO1xuXG4gIGV4cGVjdFN0YWNrQ2hhbmdlKHZtLnN0YWNrLCAxLCAnUHVzaENvbXBvbmVudERlZmluaXRpb24nKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUHVzaER5bmFtaWNDb21wb25lbnRNYW5hZ2VyLCAodm0sIHsgb3AxOiBfbWV0YSB9KSA9PiB7XG4gIGxldCBzdGFjayA9IHZtLnN0YWNrO1xuXG4gIGxldCBjb21wb25lbnQgPSBjaGVjayhzdGFjay5wb3AoKSwgQ2hlY2tQYXRoUmVmZXJlbmNlKS52YWx1ZSgpO1xuICBsZXQgZGVmaW5pdGlvbjogQ29tcG9uZW50RGVmaW5pdGlvbiB8IEN1cnJpZWRDb21wb25lbnREZWZpbml0aW9uO1xuXG4gIGlmICh0eXBlb2YgY29tcG9uZW50ID09PSAnc3RyaW5nJykge1xuICAgIGxldCB7IGNvbnN0YW50cywgY29uc3RhbnRzOiB7IHJlc29sdmVyIH0gfSA9IHZtO1xuICAgIGxldCBtZXRhID0gY29uc3RhbnRzLmdldFNlcmlhbGl6YWJsZTxUZW1wbGF0ZU1ldGE+KF9tZXRhKTtcbiAgICBsZXQgcmVzb2x2ZWREZWZpbml0aW9uID0gcmVzb2x2ZUNvbXBvbmVudChyZXNvbHZlciwgY29tcG9uZW50LCBtZXRhKTtcblxuICAgIGRlZmluaXRpb24gPSBleHBlY3QocmVzb2x2ZWREZWZpbml0aW9uLCBgQ291bGQgbm90IGZpbmQgYSBjb21wb25lbnQgbmFtZWQgXCIke2NvbXBvbmVudH1cImApO1xuICB9IGVsc2UgaWYgKGlzQ3VycmllZENvbXBvbmVudERlZmluaXRpb24oY29tcG9uZW50KSkge1xuICAgIGRlZmluaXRpb24gPSBjb21wb25lbnQ7XG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgdW5yZWFjaGFibGUoKTtcbiAgfVxuXG4gIHN0YWNrLnB1c2goeyBkZWZpbml0aW9uLCBtYW5hZ2VyOiBudWxsLCBzdGF0ZTogbnVsbCB9KTtcblxuICBleHBlY3RTdGFja0NoYW5nZSh2bS5zdGFjaywgMCwgJ1B1c2hEeW5hbWljQ29tcG9uZW50TWFuYWdlcicpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5QdXNoQXJncywgKHZtLCB7IG9wMTogX25hbWVzLCBvcDI6IGZsYWdzIH0pID0+IHtcbiAgbGV0IHN0YWNrID0gdm0uc3RhY2s7XG4gIGxldCBuYW1lcyA9IHZtLmNvbnN0YW50cy5nZXRTdHJpbmdBcnJheShfbmFtZXMpO1xuXG4gIGxldCBwb3NpdGlvbmFsQ291bnQgPSBmbGFncyA+PiA0O1xuICBsZXQgc3ludGhldGljID0gZmxhZ3MgJiAwYjEwMDA7XG4gIGxldCBibG9ja05hbWVzID0gW107XG5cbiAgaWYgKGZsYWdzICYgMGIwMTAwKSBibG9ja05hbWVzLnB1c2goJ21haW4nKTtcbiAgaWYgKGZsYWdzICYgMGIwMDEwKSBibG9ja05hbWVzLnB1c2goJ2Vsc2UnKTtcbiAgaWYgKGZsYWdzICYgMGIwMDAxKSBibG9ja05hbWVzLnB1c2goJ2F0dHJzJyk7XG5cbiAgQVJHUy5zZXR1cChzdGFjaywgbmFtZXMsIGJsb2NrTmFtZXMsIHBvc2l0aW9uYWxDb3VudCwgISFzeW50aGV0aWMpO1xuICBzdGFjay5wdXNoKEFSR1MpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5QcmVwYXJlQXJncywgKHZtLCB7IG9wMTogX3N0YXRlIH0pID0+IHtcbiAgbGV0IHN0YWNrID0gdm0uc3RhY2s7XG4gIGxldCBpbnN0YW5jZSA9IHZtLmZldGNoVmFsdWU8SW5pdGlhbENvbXBvbmVudEluc3RhbmNlPihfc3RhdGUpO1xuXG4gIGxldCB7IGRlZmluaXRpb24gfSA9IGluc3RhbmNlO1xuXG4gIGxldCBhcmdzOiBBcmd1bWVudHM7XG5cbiAgaWYgKGlzQ3VycmllZENvbXBvbmVudERlZmluaXRpb24oZGVmaW5pdGlvbikpIHtcbiAgICBhc3NlcnQoIWRlZmluaXRpb24ubWFuYWdlciwgXCJJZiB0aGUgY29tcG9uZW50IGRlZmluaXRpb24gd2FzIGN1cnJpZWQsIHdlIGRvbid0IHlldCBoYXZlIGEgbWFuYWdlclwiKTtcblxuICAgIGFyZ3MgPSBjaGVjayhzdGFjay5wb3AoKSwgQ2hlY2tJbnN0YW5jZW9mKEFyZ3VtZW50cykpO1xuICAgIGRlZmluaXRpb24gPSBpbnN0YW5jZS5kZWZpbml0aW9uID0gZGVmaW5pdGlvbi51bndyYXAoYXJncyk7XG4gIH0gZWxzZSB7XG4gICAgYXJncyA9IGNoZWNrKHN0YWNrLnBvcCgpLCBDaGVja0luc3RhbmNlb2YoQXJndW1lbnRzKSk7XG4gIH1cblxuICBsZXQgeyBtYW5hZ2VyLCBzdGF0ZSB9ID0gZGVmaW5pdGlvbiBhcyBDb21wb25lbnREZWZpbml0aW9uO1xuICBpbnN0YW5jZS5tYW5hZ2VyID0gZGVmaW5pdGlvbi5tYW5hZ2VyO1xuXG4gIGlmIChtYW5hZ2VyLmdldENhcGFiaWxpdGllcyhzdGF0ZSkucHJlcGFyZUFyZ3MgIT09IHRydWUpIHtcbiAgICBzdGFjay5wdXNoKGFyZ3MpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGxldCBibG9ja3MgPSBhcmdzLmJsb2Nrcy52YWx1ZXM7XG4gIGxldCBibG9ja05hbWVzID0gYXJncy5ibG9ja3MubmFtZXM7XG4gIGxldCBwcmVwYXJlZEFyZ3MgPSBtYW5hZ2VyLnByZXBhcmVBcmdzKHN0YXRlLCBhcmdzKTtcblxuICBpZiAocHJlcGFyZWRBcmdzKSB7XG4gICAgYXJncy5jbGVhcigpO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBibG9ja3MubGVuZ3RoOyBpKyspIHtcbiAgICAgIHN0YWNrLnB1c2goYmxvY2tzW2ldKTtcbiAgICB9XG5cbiAgICBsZXQgeyBwb3NpdGlvbmFsLCBuYW1lZCB9ID0gcHJlcGFyZWRBcmdzO1xuXG4gICAgbGV0IHBvc2l0aW9uYWxDb3VudCA9IHBvc2l0aW9uYWwubGVuZ3RoO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb3NpdGlvbmFsQ291bnQ7IGkrKykge1xuICAgICAgc3RhY2sucHVzaChwb3NpdGlvbmFsW2ldKTtcbiAgICB9XG5cbiAgICBsZXQgbmFtZXMgPSBPYmplY3Qua2V5cyhuYW1lZCk7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5hbWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBzdGFjay5wdXNoKG5hbWVkW25hbWVzW2ldXSk7XG4gICAgfVxuXG4gICAgYXJncy5zZXR1cChzdGFjaywgbmFtZXMsIGJsb2NrTmFtZXMsIHBvc2l0aW9uYWxDb3VudCwgdHJ1ZSk7XG4gIH1cblxuICBzdGFjay5wdXNoKGFyZ3MpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5DcmVhdGVDb21wb25lbnQsICh2bSwgeyBvcDE6IGZsYWdzLCBvcDI6IF9zdGF0ZSB9KSA9PiB7XG4gIGxldCBkeW5hbWljU2NvcGUgPSB2bS5keW5hbWljU2NvcGUoKTtcblxuICBsZXQgaW5zdGFuY2UgPSB2bS5mZXRjaFZhbHVlPFBvcHVsYXRlZENvbXBvbmVudEluc3RhbmNlPihfc3RhdGUpO1xuICBsZXQgeyBkZWZpbml0aW9uLCBtYW5hZ2VyIH0gPSBpbnN0YW5jZTtcblxuICBsZXQgaGFzRGVmYXVsdEJsb2NrID0gZmxhZ3MgJiAxO1xuICBsZXQgYXJnczogT3B0aW9uPElBcmd1bWVudHM+ID0gbnVsbDtcblxuICBpZiAobWFuYWdlci5nZXRDYXBhYmlsaXRpZXMoZGVmaW5pdGlvbi5zdGF0ZSkuY3JlYXRlQXJncykge1xuICAgIGFyZ3MgPSBjaGVjayh2bS5zdGFjay5wZWVrKCksIENoZWNrQXJndW1lbnRzKTtcbiAgfVxuXG4gIGxldCBzdGF0ZSA9IG1hbmFnZXIuY3JlYXRlKHZtLmVudiwgZGVmaW5pdGlvbi5zdGF0ZSwgYXJncywgZHluYW1pY1Njb3BlLCB2bS5nZXRTZWxmKCksICEhaGFzRGVmYXVsdEJsb2NrKTtcblxuICAvLyBXZSB3YW50IHRvIHJldXNlIHRoZSBgc3RhdGVgIFBPSk8gaGVyZSwgYmVjYXVzZSB3ZSBrbm93IHRoYXQgdGhlIG9wY29kZXNcbiAgLy8gb25seSB0cmFuc2l0aW9uIGF0IGV4YWN0bHkgb25lIHBsYWNlLlxuICAoaW5zdGFuY2UgYXMgUmVjYXN0PEluaXRpYWxDb21wb25lbnRJbnN0YW5jZSwgQ29tcG9uZW50SW5zdGFuY2U+KS5zdGF0ZSA9IHN0YXRlO1xuXG4gIGxldCB0YWcgPSBtYW5hZ2VyLmdldFRhZyhzdGF0ZSk7XG5cbiAgaWYgKCFpc0NvbnN0VGFnKHRhZykpIHtcbiAgICB2bS51cGRhdGVXaXRoKG5ldyBVcGRhdGVDb21wb25lbnRPcGNvZGUodGFnLCBzdGF0ZSwgbWFuYWdlciwgZHluYW1pY1Njb3BlKSk7XG4gIH1cbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUmVnaXN0ZXJDb21wb25lbnREZXN0cnVjdG9yLCAodm0sIHsgb3AxOiBfc3RhdGUgfSkgPT4ge1xuICBsZXQgeyBtYW5hZ2VyLCBzdGF0ZSB9ID0gY2hlY2sodm0uZmV0Y2hWYWx1ZShfc3RhdGUpLCBDaGVja0NvbXBvbmVudEluc3RhbmNlKTtcblxuICBsZXQgZGVzdHJ1Y3RvciA9IG1hbmFnZXIuZ2V0RGVzdHJ1Y3RvcihzdGF0ZSk7XG4gIGlmIChkZXN0cnVjdG9yKSB2bS5uZXdEZXN0cm95YWJsZShkZXN0cnVjdG9yKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuQmVnaW5Db21wb25lbnRUcmFuc2FjdGlvbiwgdm0gPT4ge1xuICB2bS5iZWdpbkNhY2hlR3JvdXAoKTtcbiAgdm0uZWxlbWVudHMoKS5wdXNoU2ltcGxlQmxvY2soKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUHV0Q29tcG9uZW50T3BlcmF0aW9ucywgdm0gPT4ge1xuICB2bS5sb2FkVmFsdWUoUmVnaXN0ZXIudDAsIG5ldyBDb21wb25lbnRFbGVtZW50T3BlcmF0aW9ucygpKTtcblxuICBleHBlY3RTdGFja0NoYW5nZSh2bS5zdGFjaywgMCwgJ1B1dENvbXBvbmVudE9wZXJhdGlvbnMnKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuQ29tcG9uZW50QXR0ciwgKHZtLCB7IG9wMTogX25hbWUsIG9wMjogdHJ1c3RpbmcsIG9wMzogX25hbWVzcGFjZSB9KSA9PiB7XG4gIGxldCBuYW1lID0gdm0uY29uc3RhbnRzLmdldFN0cmluZyhfbmFtZSk7XG4gIGxldCByZWZlcmVuY2UgPSBjaGVjayh2bS5zdGFjay5wb3AoKSwgQ2hlY2tSZWZlcmVuY2UpO1xuICBsZXQgbmFtZXNwYWNlID0gX25hbWVzcGFjZSA/IHZtLmNvbnN0YW50cy5nZXRTdHJpbmcoX25hbWVzcGFjZSkgOiBudWxsO1xuXG4gIGNoZWNrKHZtLmZldGNoVmFsdWUoUmVnaXN0ZXIudDApLCBDaGVja0luc3RhbmNlb2YoQ29tcG9uZW50RWxlbWVudE9wZXJhdGlvbnMpKS5zZXRBdHRyaWJ1dGUobmFtZSwgcmVmZXJlbmNlLCAhIXRydXN0aW5nLCBuYW1lc3BhY2UpO1xufSk7XG5cbmludGVyZmFjZSBEZWZlcnJlZEF0dHJpYnV0ZSB7XG4gIHZhbHVlOiBWZXJzaW9uZWRSZWZlcmVuY2U8T3BhcXVlPjtcbiAgbmFtZXNwYWNlOiBPcHRpb248c3RyaW5nPjtcbiAgdHJ1c3Rpbmc6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjbGFzcyBDb21wb25lbnRFbGVtZW50T3BlcmF0aW9ucyB7XG4gIHByaXZhdGUgYXR0cmlidXRlcyA9IGRpY3Q8RGVmZXJyZWRBdHRyaWJ1dGU+KCk7XG4gIHByaXZhdGUgY2xhc3NlczogVmVyc2lvbmVkUmVmZXJlbmNlPE9wYXF1ZT5bXSA9IFtdO1xuXG4gIHNldEF0dHJpYnV0ZShuYW1lOiBzdHJpbmcsIHZhbHVlOiBWZXJzaW9uZWRSZWZlcmVuY2U8T3BhcXVlPiwgdHJ1c3Rpbmc6IGJvb2xlYW4sIG5hbWVzcGFjZTogT3B0aW9uPHN0cmluZz4pIHtcbiAgICBsZXQgZGVmZXJyZWQgPSB7IHZhbHVlLCBuYW1lc3BhY2UsIHRydXN0aW5nIH07XG5cbiAgICBpZiAobmFtZSA9PT0gJ2NsYXNzJykge1xuICAgICAgdGhpcy5jbGFzc2VzLnB1c2godmFsdWUpO1xuICAgIH1cblxuICAgIHRoaXMuYXR0cmlidXRlc1tuYW1lXSA9IGRlZmVycmVkO1xuICB9XG5cbiAgZmx1c2godm06IFZNPE9wYXF1ZT4pIHtcbiAgICBmb3IgKGxldCBuYW1lIGluIHRoaXMuYXR0cmlidXRlcykge1xuICAgICAgbGV0IGF0dHIgPSB0aGlzLmF0dHJpYnV0ZXNbbmFtZV07XG4gICAgICBsZXQgeyB2YWx1ZTogcmVmZXJlbmNlLCBuYW1lc3BhY2UsIHRydXN0aW5nIH0gPSBhdHRyO1xuXG4gICAgICBpZiAobmFtZSA9PT0gJ2NsYXNzJykge1xuICAgICAgICByZWZlcmVuY2UgPSBuZXcgQ2xhc3NMaXN0UmVmZXJlbmNlKHRoaXMuY2xhc3Nlcyk7XG4gICAgICB9XG5cbiAgICAgIGxldCBhdHRyaWJ1dGUgPSB2bS5lbGVtZW50cygpLnNldER5bmFtaWNBdHRyaWJ1dGUobmFtZSwgcmVmZXJlbmNlLnZhbHVlKCksIHRydXN0aW5nLCBuYW1lc3BhY2UpO1xuXG4gICAgICBpZiAoIWlzQ29uc3QocmVmZXJlbmNlKSkge1xuICAgICAgICB2bS51cGRhdGVXaXRoKG5ldyBVcGRhdGVEeW5hbWljQXR0cmlidXRlT3Bjb2RlKHJlZmVyZW5jZSwgYXR0cmlidXRlKSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5EaWRDcmVhdGVFbGVtZW50LCAodm0sIHsgb3AxOiBfc3RhdGUgfSkgPT4ge1xuICBsZXQgeyBkZWZpbml0aW9uLCBzdGF0ZSB9ID0gY2hlY2sodm0uZmV0Y2hWYWx1ZShfc3RhdGUpLCBDaGVja0NvbXBvbmVudEluc3RhbmNlKTtcbiAgbGV0IHsgbWFuYWdlciB9ID0gZGVmaW5pdGlvbjtcblxuICBsZXQgb3BlcmF0aW9ucyA9IGNoZWNrKHZtLmZldGNoVmFsdWUoUmVnaXN0ZXIudDApLCBDaGVja0luc3RhbmNlb2YoQ29tcG9uZW50RWxlbWVudE9wZXJhdGlvbnMpKTtcblxuICBsZXQgYWN0aW9uID0gJ0RpZENyZWF0ZUVsZW1lbnRPcGNvZGUjZXZhbHVhdGUnO1xuICAobWFuYWdlciBhcyBXaXRoRWxlbWVudEhvb2s8Q29tcG9uZW50PikuZGlkQ3JlYXRlRWxlbWVudChzdGF0ZSwgdm0uZWxlbWVudHMoKS5leHBlY3RDb25zdHJ1Y3RpbmcoYWN0aW9uKSwgb3BlcmF0aW9ucyk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkdldENvbXBvbmVudFNlbGYsICh2bSwgeyBvcDE6IF9zdGF0ZSB9KSA9PiB7XG4gIGxldCB7IGRlZmluaXRpb24sIHN0YXRlIH0gPSBjaGVjayh2bS5mZXRjaFZhbHVlKF9zdGF0ZSksIENoZWNrQ29tcG9uZW50SW5zdGFuY2UpO1xuICBsZXQgeyBtYW5hZ2VyIH0gPSBkZWZpbml0aW9uO1xuXG4gIHZtLnN0YWNrLnB1c2gobWFuYWdlci5nZXRTZWxmKHN0YXRlKSk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkdldENvbXBvbmVudFRhZ05hbWUsICh2bSwgeyBvcDE6IF9zdGF0ZSB9KSA9PiB7XG4gIGxldCB7IGRlZmluaXRpb24sIHN0YXRlIH0gPSBjaGVjayh2bS5mZXRjaFZhbHVlKF9zdGF0ZSksIENoZWNrQ29tcG9uZW50SW5zdGFuY2UpO1xuICBsZXQgeyBtYW5hZ2VyIH0gPSBkZWZpbml0aW9uO1xuXG4gIHZtLnN0YWNrLnB1c2goKG1hbmFnZXIgYXMgUmVjYXN0PENvbXBvbmVudE1hbmFnZXIsIFdpdGhEeW5hbWljVGFnTmFtZTxDb21wb25lbnQ+PikuZ2V0VGFnTmFtZShzdGF0ZSkpO1xufSk7XG5cbi8vIER5bmFtaWMgSW52b2NhdGlvbiBPbmx5XG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuR2V0Q29tcG9uZW50TGF5b3V0LCAodm0sIHsgb3AxOiBfc3RhdGUgfSkgPT4ge1xuICBsZXQgaW5zdGFuY2UgPSBjaGVjayh2bS5mZXRjaFZhbHVlKF9zdGF0ZSksIENoZWNrQ29tcG9uZW50SW5zdGFuY2UpO1xuICBsZXQgeyBtYW5hZ2VyLCBkZWZpbml0aW9uIH0gPSBpbnN0YW5jZTtcbiAgbGV0IHsgY29uc3RhbnRzOiB7IHJlc29sdmVyIH0sIHN0YWNrIH0gPSB2bTtcblxuICBsZXQgeyBzdGF0ZTogaW5zdGFuY2VTdGF0ZSB9ID0gaW5zdGFuY2U7XG4gIGxldCB7IHN0YXRlOiBkZWZpbml0aW9uU3RhdGUgfSA9IGRlZmluaXRpb247XG5cbiAgbGV0IGludm9rZTogeyBoYW5kbGU6IFZNSGFuZGxlLCBzeW1ib2xUYWJsZTogUHJvZ3JhbVN5bWJvbFRhYmxlIH07XG5cbiAgaWYgKGhhc1N0YXRpY0xheW91dChkZWZpbml0aW9uU3RhdGUsIG1hbmFnZXIpKSB7XG4gICAgaW52b2tlID0gbWFuYWdlci5nZXRMYXlvdXQoZGVmaW5pdGlvblN0YXRlLCByZXNvbHZlcik7XG4gIH0gZWxzZSBpZiAoaGFzRHluYW1pY0xheW91dChkZWZpbml0aW9uU3RhdGUsIG1hbmFnZXIpKSB7XG4gICAgaW52b2tlID0gbWFuYWdlci5nZXREeW5hbWljTGF5b3V0KGluc3RhbmNlU3RhdGUsIHJlc29sdmVyKTtcbiAgfSBlbHNlIHtcbiAgICB0aHJvdyB1bnJlYWNoYWJsZSgpO1xuICB9XG5cbiAgc3RhY2sucHVzaChpbnZva2Uuc3ltYm9sVGFibGUpO1xuICBzdGFjay5wdXNoKGludm9rZS5oYW5kbGUpO1xufSk7XG5cbi8vIER5bmFtaWMgSW52b2NhdGlvbiBPbmx5XG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuSW52b2tlQ29tcG9uZW50TGF5b3V0LCB2bSA9PiB7XG4gIGxldCB7IHN0YWNrIH0gPSB2bTtcblxuICBsZXQgaGFuZGxlID0gY2hlY2soc3RhY2sucG9wKCksIENoZWNrSGFuZGxlKTtcbiAgbGV0IHsgc3ltYm9scywgaGFzRXZhbCB9ID0gY2hlY2soc3RhY2sucG9wKCksIENoZWNrUHJvZ3JhbVN5bWJvbFRhYmxlKTtcblxuICB7XG4gICAgbGV0IHNjb3BlID0gdm0ucHVzaFJvb3RTY29wZShzeW1ib2xzLmxlbmd0aCArIDEsIHRydWUpO1xuICAgIHNjb3BlLmJpbmRTZWxmKGNoZWNrKHN0YWNrLnBvcCgpLCBDaGVja1BhdGhSZWZlcmVuY2UpKTtcblxuICAgIGxldCBhcmdzID0gY2hlY2sodm0uc3RhY2sucG9wKCksIENoZWNrQXJndW1lbnRzKTtcblxuICAgIGxldCBsb29rdXA6IE9wdGlvbjxEaWN0PFNjb3BlU2xvdD4+ID0gbnVsbDtcbiAgICBsZXQgJGV2YWw6IE9wdGlvbjxudW1iZXI+ID0gLTE7XG5cbiAgICBpZiAoaGFzRXZhbCkge1xuICAgICAgJGV2YWwgPSBzeW1ib2xzLmluZGV4T2YoJyRldmFsJykgKyAxO1xuICAgICAgbG9va3VwID0gZGljdDxTY29wZVNsb3Q+KCk7XG4gICAgfVxuXG4gICAgbGV0IGNhbGxlck5hbWVzID0gYXJncy5uYW1lZC5hdE5hbWVzO1xuXG4gICAgZm9yIChsZXQgaT1jYWxsZXJOYW1lcy5sZW5ndGggLSAxOyBpPj0wOyBpLS0pIHtcbiAgICAgIGxldCBhdE5hbWUgPSBjYWxsZXJOYW1lc1tpXTtcbiAgICAgIGxldCBzeW1ib2wgPSBzeW1ib2xzLmluZGV4T2YoY2FsbGVyTmFtZXNbaV0pO1xuICAgICAgbGV0IHZhbHVlID0gYXJncy5uYW1lZC5nZXQoYXROYW1lLCBmYWxzZSk7XG5cbiAgICAgIGlmIChzeW1ib2wgIT09IC0xKSBzY29wZS5iaW5kU3ltYm9sKHN5bWJvbCArIDEsIHZhbHVlKTtcbiAgICAgIGlmIChoYXNFdmFsKSBsb29rdXAhW2F0TmFtZV0gPSB2YWx1ZTtcbiAgICB9XG5cbiAgICBsZXQgYmluZEJsb2NrID0gKHN5bWJvbE5hbWU6IHN0cmluZywgYmxvY2tOYW1lOiBzdHJpbmcpID0+IHtcbiAgICAgIGxldCBzeW1ib2wgPSBzeW1ib2xzLmluZGV4T2Yoc3ltYm9sTmFtZSk7XG5cbiAgICAgIGxldCBibG9jayA9IGJsb2Nrcy5nZXQoYmxvY2tOYW1lKTtcblxuICAgICAgaWYgKHN5bWJvbCAhPT0gLTEpIHtcbiAgICAgICAgc2NvcGUuYmluZEJsb2NrKHN5bWJvbCArIDEsIGJsb2NrKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGxvb2t1cCkgbG9va3VwW3N5bWJvbE5hbWVdID0gYmxvY2s7XG4gICAgfTtcblxuICAgIGxldCBibG9ja3MgPSBhcmdzLmJsb2NrcztcbiAgICBiaW5kQmxvY2soQVRUUlNfQkxPQ0ssICdhdHRycycpO1xuICAgIGJpbmRCbG9jaygnJmludmVyc2UnLCAnZWxzZScpO1xuICAgIGJpbmRCbG9jaygnJmRlZmF1bHQnLCAnbWFpbicpO1xuXG4gICAgaWYgKGxvb2t1cCkgc2NvcGUuYmluZEV2YWxTY29wZShsb29rdXApO1xuXG4gICAgdm0uY2FsbChoYW5kbGUhKTtcbiAgfVxufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5EaWRSZW5kZXJMYXlvdXQsICh2bSwgeyBvcDE6IF9zdGF0ZSB9KSA9PiB7XG4gIGxldCB7IG1hbmFnZXIsIHN0YXRlIH0gPSBjaGVjayh2bS5mZXRjaFZhbHVlKF9zdGF0ZSksIENoZWNrQ29tcG9uZW50SW5zdGFuY2UpO1xuICBsZXQgYm91bmRzID0gdm0uZWxlbWVudHMoKS5wb3BCbG9jaygpO1xuXG4gIGxldCBtZ3IgPSBjaGVjayhtYW5hZ2VyLCBDaGVja0ludGVyZmFjZSh7IGRpZFJlbmRlckxheW91dDogQ2hlY2tGdW5jdGlvbiB9KSk7XG5cbiAgbWdyLmRpZFJlbmRlckxheW91dChzdGF0ZSwgYm91bmRzKTtcblxuICB2bS5lbnYuZGlkQ3JlYXRlKHN0YXRlLCBtYW5hZ2VyKTtcblxuICB2bS51cGRhdGVXaXRoKG5ldyBEaWRVcGRhdGVMYXlvdXRPcGNvZGUobWFuYWdlciwgc3RhdGUsIGJvdW5kcykpO1xuXG4gIGV4cGVjdFN0YWNrQ2hhbmdlKHZtLnN0YWNrLCAwLCAnRGlkUmVuZGVyTGF5b3V0Jyk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkNvbW1pdENvbXBvbmVudFRyYW5zYWN0aW9uLCB2bSA9PiB7XG4gIHZtLmNvbW1pdENhY2hlR3JvdXAoKTtcblxuICBleHBlY3RTdGFja0NoYW5nZSh2bS5zdGFjaywgMCwgJ0NvbW1pdENvbXBvbmVudFRyYW5zYWN0aW9uJyk7XG59KTtcblxuZXhwb3J0IGNsYXNzIFVwZGF0ZUNvbXBvbmVudE9wY29kZSBleHRlbmRzIFVwZGF0aW5nT3Bjb2RlIHtcbiAgcHVibGljIHR5cGUgPSAndXBkYXRlLWNvbXBvbmVudCc7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHVibGljIHRhZzogVGFnLFxuICAgIHByaXZhdGUgY29tcG9uZW50OiBDb21wb25lbnQsXG4gICAgcHJpdmF0ZSBtYW5hZ2VyOiBDb21wb25lbnRNYW5hZ2VyLFxuICAgIHByaXZhdGUgZHluYW1pY1Njb3BlOiBEeW5hbWljU2NvcGUsXG4gICkge1xuICAgIHN1cGVyKCk7XG4gIH1cblxuICBldmFsdWF0ZShfdm06IFVwZGF0aW5nVk08T3BhcXVlPikge1xuICAgIGxldCB7IGNvbXBvbmVudCwgbWFuYWdlciwgZHluYW1pY1Njb3BlIH0gPSB0aGlzO1xuXG4gICAgbWFuYWdlci51cGRhdGUoY29tcG9uZW50LCBkeW5hbWljU2NvcGUpO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBEaWRVcGRhdGVMYXlvdXRPcGNvZGUgZXh0ZW5kcyBVcGRhdGluZ09wY29kZSB7XG4gIHB1YmxpYyB0eXBlID0gJ2RpZC11cGRhdGUtbGF5b3V0JztcbiAgcHVibGljIHRhZzogVGFnID0gQ09OU1RBTlRfVEFHO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgbWFuYWdlcjogQ29tcG9uZW50TWFuYWdlcixcbiAgICBwcml2YXRlIGNvbXBvbmVudDogQ29tcG9uZW50LFxuICAgIHByaXZhdGUgYm91bmRzOiBCb3VuZHMsXG4gICkge1xuICAgIHN1cGVyKCk7XG4gIH1cblxuICBldmFsdWF0ZSh2bTogVXBkYXRpbmdWTTxPcGFxdWU+KSB7XG4gICAgbGV0IHsgbWFuYWdlciwgY29tcG9uZW50LCBib3VuZHMgfSA9IHRoaXM7XG5cbiAgICBtYW5hZ2VyLmRpZFVwZGF0ZUxheW91dChjb21wb25lbnQsIGJvdW5kcyk7XG5cbiAgICB2bS5lbnYuZGlkVXBkYXRlKGNvbXBvbmVudCwgbWFuYWdlcik7XG4gIH1cbn1cbiJdfQ==","import { dict } from '@glimmer/util';\nimport { APPEND_OPCODES } from '../../opcodes';\n/* tslint:disable */\nfunction debugCallback(context, get) {\n    console.info('Use `context`, and `get(<path>)` to debug this template.');\n    // for example...\n    context === get('this');\n    debugger;\n}\n/* tslint:enable */\nlet callback = debugCallback;\n// For testing purposes\nexport function setDebuggerCallback(cb) {\n    callback = cb;\n}\nexport function resetDebuggerCallback() {\n    callback = debugCallback;\n}\nclass ScopeInspector {\n    constructor(scope, symbols, evalInfo) {\n        this.scope = scope;\n        this.locals = dict();\n        for (let i = 0; i < evalInfo.length; i++) {\n            let slot = evalInfo[i];\n            let name = symbols[slot - 1];\n            let ref = scope.getSymbol(slot);\n            this.locals[name] = ref;\n        }\n    }\n    get(path) {\n        let { scope, locals } = this;\n        let parts = path.split('.');\n        let [head, ...tail] = path.split('.');\n        let evalScope = scope.getEvalScope();\n        let ref;\n        if (head === 'this') {\n            ref = scope.getSelf();\n        } else if (locals[head]) {\n            ref = locals[head];\n        } else if (head.indexOf('@') === 0 && evalScope[head]) {\n            ref = evalScope[head];\n        } else {\n            ref = this.scope.getSelf();\n            tail = parts;\n        }\n        return tail.reduce((r, part) => r.get(part), ref);\n    }\n}\nAPPEND_OPCODES.add(77 /* Debugger */, (vm, { op1: _symbols, op2: _evalInfo }) => {\n    let symbols = vm.constants.getStringArray(_symbols);\n    let evalInfo = vm.constants.getArray(_evalInfo);\n    let inspector = new ScopeInspector(vm.scope(), symbols, evalInfo);\n    callback(vm.getSelf().value(), path => inspector.get(path).value());\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVidWdnZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci9ydW50aW1lL2xpYi9jb21waWxlZC9vcGNvZGVzL2RlYnVnZ2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLEFBQU8sU0FBRSxBQUFJLEFBQUUsWUFBTSxBQUFlLEFBQUM7QUFFckMsQUFBTyxTQUFFLEFBQWMsQUFBRSxzQkFBTSxBQUFlLEFBQUM7QUFPL0MsQUFBb0I7QUFDcEIsdUJBQXVCLEFBQWUsU0FBRSxBQUFhO0FBQ25ELEFBQU8sWUFBQyxBQUFJLEtBQUMsQUFBMEQsQUFBQyxBQUFDO0FBRXpFLEFBQWlCO0FBQ2pCLEFBQU8sZ0JBQUssQUFBRyxJQUFDLEFBQU0sQUFBQyxBQUFDO0FBRXhCLEFBQVEsQUFBQyxBQUNYO0FBQUM7QUFDRCxBQUFtQjtBQUVuQixJQUFJLEFBQVEsV0FBRyxBQUFhLEFBQUM7QUFFN0IsQUFBdUI7QUFDdkIsQUFBTSxvQ0FBOEIsQUFBaUI7QUFDbkQsQUFBUSxlQUFHLEFBQUUsQUFBQyxBQUNoQjtBQUFDO0FBRUQsQUFBTTtBQUNKLEFBQVEsZUFBRyxBQUFhLEFBQUMsQUFDM0I7QUFBQztBQUVEO0FBR0UsZ0JBQW9CLEFBQVksT0FBRSxBQUFpQixTQUFFLEFBQWtCO0FBQW5ELGFBQUssUUFBTCxBQUFLLEFBQU87QUFGeEIsYUFBTSxTQUFHLEFBQUksQUFBa0MsQUFBQztBQUd0RCxBQUFHLEFBQUMsYUFBQyxJQUFJLEFBQUMsSUFBRyxBQUFDLEdBQUUsQUFBQyxJQUFHLEFBQVEsU0FBQyxBQUFNLFFBQUUsQUFBQyxBQUFFLEtBQUUsQUFBQztBQUN6QyxnQkFBSSxBQUFJLE9BQUcsQUFBUSxTQUFDLEFBQUMsQUFBQyxBQUFDO0FBQ3ZCLGdCQUFJLEFBQUksT0FBRyxBQUFPLFFBQUMsQUFBSSxPQUFHLEFBQUMsQUFBQyxBQUFDO0FBQzdCLGdCQUFJLEFBQUcsTUFBSSxBQUFLLE1BQUMsQUFBUyxVQUFDLEFBQUksQUFBQyxBQUFDO0FBQ2pDLEFBQUksaUJBQUMsQUFBTSxPQUFDLEFBQUksQUFBQyxRQUFHLEFBQUcsQUFBQyxBQUMxQjtBQUFDLEFBQ0g7QUFBQztBQUVELEFBQUcsUUFBQyxBQUFZO0FBQ2QsWUFBSSxFQUFFLEFBQUssT0FBRSxBQUFNLEFBQUUsV0FBRyxBQUFJLEFBQUM7QUFDN0IsWUFBSSxBQUFLLFFBQUcsQUFBSSxLQUFDLEFBQUssTUFBQyxBQUFHLEFBQUMsQUFBQztBQUM1QixZQUFJLENBQUMsQUFBSSxNQUFFLEdBQUcsQUFBSSxBQUFDLFFBQUcsQUFBSSxLQUFDLEFBQUssTUFBQyxBQUFHLEFBQUMsQUFBQztBQUV0QyxZQUFJLEFBQVMsWUFBRyxBQUFLLE1BQUMsQUFBWSxBQUFHLEFBQUM7QUFDdEMsWUFBSSxBQUFtQyxBQUFDO0FBRXhDLEFBQUUsQUFBQyxZQUFDLEFBQUksU0FBSyxBQUFNLEFBQUMsUUFBQyxBQUFDO0FBQ3BCLEFBQUcsa0JBQUcsQUFBSyxNQUFDLEFBQU8sQUFBRSxBQUFDLEFBQ3hCO0FBQUMsQUFBQyxBQUFJLG1CQUFLLEFBQU0sT0FBQyxBQUFJLEFBQUMsQUFBQyxPQUFDLEFBQUM7QUFDeEIsQUFBRyxrQkFBRyxBQUFNLE9BQUMsQUFBSSxBQUFDLEFBQUMsQUFDckI7QUFBQyxBQUFDLEFBQUksU0FGQyxBQUFFLEFBQUMsVUFFQyxBQUFJLEtBQUMsQUFBTyxRQUFDLEFBQUcsQUFBQyxTQUFLLEFBQUMsS0FBSSxBQUFTLFVBQUMsQUFBSSxBQUFDLEFBQUMsT0FBQyxBQUFDO0FBQ3RELEFBQUcsa0JBQUcsQUFBUyxVQUFDLEFBQUksQUFBbUMsQUFBQyxBQUMxRDtBQUFDLEFBQUMsQUFBSSxTQUZDLEFBQUUsQUFBQyxNQUVILEFBQUM7QUFDTixBQUFHLGtCQUFHLEFBQUksS0FBQyxBQUFLLE1BQUMsQUFBTyxBQUFFLEFBQUM7QUFDM0IsQUFBSSxtQkFBRyxBQUFLLEFBQUMsQUFDZjtBQUFDO0FBRUQsQUFBTSxlQUFDLEFBQUksS0FBQyxBQUFNLE9BQUMsQ0FBQyxBQUFDLEdBQUUsQUFBSSxTQUFLLEFBQUMsRUFBQyxBQUFHLElBQUMsQUFBSSxBQUFDLE9BQUUsQUFBRyxBQUFDLEFBQUMsQUFDcEQ7QUFBQyxBQUNGOztBQUVELEFBQWMsZUFBQyxBQUFHLHVCQUFjLENBQUMsQUFBRSxJQUFFLEVBQUUsQUFBRyxLQUFFLEFBQVEsVUFBRSxBQUFHLEtBQUUsQUFBUyxBQUFFO0FBQ3BFLFFBQUksQUFBTyxVQUFHLEFBQUUsR0FBQyxBQUFTLFVBQUMsQUFBYyxlQUFDLEFBQVEsQUFBQyxBQUFDO0FBQ3BELFFBQUksQUFBUSxXQUFHLEFBQUUsR0FBQyxBQUFTLFVBQUMsQUFBUSxTQUFDLEFBQVMsQUFBQyxBQUFDO0FBQ2hELFFBQUksQUFBUyxZQUFHLElBQUksQUFBYyxlQUFDLEFBQUUsR0FBQyxBQUFLLEFBQUUsU0FBRSxBQUFPLFNBQUUsQUFBUSxBQUFDLEFBQUM7QUFDbEUsQUFBUSxhQUFDLEFBQUUsR0FBQyxBQUFPLEFBQUUsVUFBQyxBQUFLLEFBQUUsU0FBRSxBQUFJLFFBQUksQUFBUyxVQUFDLEFBQUcsSUFBQyxBQUFJLEFBQUMsTUFBQyxBQUFLLEFBQUUsQUFBQyxBQUFDLEFBQ3RFO0FBQUMsQUFBQyxBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgT3BhcXVlIH0gZnJvbSAnQGdsaW1tZXIvaW50ZXJmYWNlcyc7XG5pbXBvcnQgeyBWZXJzaW9uZWRQYXRoUmVmZXJlbmNlIH0gZnJvbSAnQGdsaW1tZXIvcmVmZXJlbmNlJztcbmltcG9ydCB7IGRpY3QgfSBmcm9tICdAZ2xpbW1lci91dGlsJztcbmltcG9ydCB7IFNjb3BlIH0gZnJvbSAnLi4vLi4vZW52aXJvbm1lbnQnO1xuaW1wb3J0IHsgQVBQRU5EX09QQ09ERVMgfSBmcm9tICcuLi8uLi9vcGNvZGVzJztcbmltcG9ydCB7IE9wIH0gZnJvbSAnQGdsaW1tZXIvdm0nO1xuXG5leHBvcnQgdHlwZSBEZWJ1Z0dldCA9ICgocGF0aDogc3RyaW5nKSA9PiBPcGFxdWUpO1xuXG5leHBvcnQgdHlwZSBEZWJ1Z0NhbGxiYWNrID0gKChjb250ZXh0OiBPcGFxdWUsIGdldDogRGVidWdHZXQpID0+IHZvaWQpO1xuXG4vKiB0c2xpbnQ6ZGlzYWJsZSAqL1xuZnVuY3Rpb24gZGVidWdDYWxsYmFjayhjb250ZXh0OiBPcGFxdWUsIGdldDogRGVidWdHZXQpOiB2b2lkIHtcbiAgY29uc29sZS5pbmZvKCdVc2UgYGNvbnRleHRgLCBhbmQgYGdldCg8cGF0aD4pYCB0byBkZWJ1ZyB0aGlzIHRlbXBsYXRlLicpO1xuXG4gIC8vIGZvciBleGFtcGxlLi4uXG4gIGNvbnRleHQgPT09IGdldCgndGhpcycpO1xuXG4gIGRlYnVnZ2VyO1xufVxuLyogdHNsaW50OmVuYWJsZSAqL1xuXG5sZXQgY2FsbGJhY2sgPSBkZWJ1Z0NhbGxiYWNrO1xuXG4vLyBGb3IgdGVzdGluZyBwdXJwb3Nlc1xuZXhwb3J0IGZ1bmN0aW9uIHNldERlYnVnZ2VyQ2FsbGJhY2soY2I6IERlYnVnQ2FsbGJhY2spIHtcbiAgY2FsbGJhY2sgPSBjYjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0RGVidWdnZXJDYWxsYmFjaygpIHtcbiAgY2FsbGJhY2sgPSBkZWJ1Z0NhbGxiYWNrO1xufVxuXG5jbGFzcyBTY29wZUluc3BlY3RvciB7XG4gIHByaXZhdGUgbG9jYWxzID0gZGljdDxWZXJzaW9uZWRQYXRoUmVmZXJlbmNlPE9wYXF1ZT4+KCk7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBzY29wZTogU2NvcGUsIHN5bWJvbHM6IHN0cmluZ1tdLCBldmFsSW5mbzogbnVtYmVyW10pIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGV2YWxJbmZvLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgc2xvdCA9IGV2YWxJbmZvW2ldO1xuICAgICAgbGV0IG5hbWUgPSBzeW1ib2xzW3Nsb3QgLSAxXTtcbiAgICAgIGxldCByZWYgID0gc2NvcGUuZ2V0U3ltYm9sKHNsb3QpO1xuICAgICAgdGhpcy5sb2NhbHNbbmFtZV0gPSByZWY7XG4gICAgfVxuICB9XG5cbiAgZ2V0KHBhdGg6IHN0cmluZyk6IFZlcnNpb25lZFBhdGhSZWZlcmVuY2U8T3BhcXVlPiB7XG4gICAgbGV0IHsgc2NvcGUsIGxvY2FscyB9ID0gdGhpcztcbiAgICBsZXQgcGFydHMgPSBwYXRoLnNwbGl0KCcuJyk7XG4gICAgbGV0IFtoZWFkLCAuLi50YWlsXSA9IHBhdGguc3BsaXQoJy4nKTtcblxuICAgIGxldCBldmFsU2NvcGUgPSBzY29wZS5nZXRFdmFsU2NvcGUoKSE7XG4gICAgbGV0IHJlZjogVmVyc2lvbmVkUGF0aFJlZmVyZW5jZTxPcGFxdWU+O1xuXG4gICAgaWYgKGhlYWQgPT09ICd0aGlzJykge1xuICAgICAgcmVmID0gc2NvcGUuZ2V0U2VsZigpO1xuICAgIH0gZWxzZSBpZiAobG9jYWxzW2hlYWRdKSB7XG4gICAgICByZWYgPSBsb2NhbHNbaGVhZF07XG4gICAgfSBlbHNlIGlmIChoZWFkLmluZGV4T2YoJ0AnKSA9PT0gMCAmJiBldmFsU2NvcGVbaGVhZF0pIHtcbiAgICAgIHJlZiA9IGV2YWxTY29wZVtoZWFkXSBhcyBWZXJzaW9uZWRQYXRoUmVmZXJlbmNlPE9wYXF1ZT47XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlZiA9IHRoaXMuc2NvcGUuZ2V0U2VsZigpO1xuICAgICAgdGFpbCA9IHBhcnRzO1xuICAgIH1cblxuICAgIHJldHVybiB0YWlsLnJlZHVjZSgociwgcGFydCkgPT4gci5nZXQocGFydCksIHJlZik7XG4gIH1cbn1cblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkRlYnVnZ2VyLCAodm0sIHsgb3AxOiBfc3ltYm9scywgb3AyOiBfZXZhbEluZm8gfSkgPT4ge1xuICBsZXQgc3ltYm9scyA9IHZtLmNvbnN0YW50cy5nZXRTdHJpbmdBcnJheShfc3ltYm9scyk7XG4gIGxldCBldmFsSW5mbyA9IHZtLmNvbnN0YW50cy5nZXRBcnJheShfZXZhbEluZm8pO1xuICBsZXQgaW5zcGVjdG9yID0gbmV3IFNjb3BlSW5zcGVjdG9yKHZtLnNjb3BlKCksIHN5bWJvbHMsIGV2YWxJbmZvKTtcbiAgY2FsbGJhY2sodm0uZ2V0U2VsZigpLnZhbHVlKCksIHBhdGggPT4gaW5zcGVjdG9yLmdldChwYXRoKS52YWx1ZSgpKTtcbn0pO1xuIl19","import { APPEND_OPCODES } from '../../opcodes';\nimport { assert, dict } from \"@glimmer/util\";\n\nAPPEND_OPCODES.add(75 /* InvokePartial */, (vm, { op1: _meta, op2: _symbols, op3: _evalInfo }) => {\n    let { constants, constants: { resolver }, stack } = vm;\n    let name = stack.pop().value();\n    (false && assert(typeof name === 'string', `Could not find a partial named \"${String(name)}\"`));\n\n    let meta = constants.getSerializable(_meta);\n    let outerSymbols = constants.getStringArray(_symbols);\n    let evalInfo = constants.getArray(_evalInfo);\n    let specifier = resolver.lookupPartial(name, meta);\n    (false && assert(specifier, `Could not find a partial named \"${name}\"`));\n\n    let definition = resolver.resolve(specifier);\n    let { symbolTable, handle } = definition.getPartial();\n    {\n        let partialSymbols = symbolTable.symbols;\n        let outerScope = vm.scope();\n        let partialScope = vm.pushRootScope(partialSymbols.length, false);\n        partialScope.bindCallerScope(outerScope.getCallerScope());\n        partialScope.bindEvalScope(outerScope.getEvalScope());\n        partialScope.bindSelf(outerScope.getSelf());\n        let locals = dict();\n        for (let i = 0; i < evalInfo.length; i++) {\n            let slot = evalInfo[i];\n            let name = outerSymbols[slot - 1];\n            let ref = outerScope.getSymbol(slot);\n            locals[name] = ref;\n        }\n        let evalScope = outerScope.getEvalScope();\n        for (let i = 0; i < partialSymbols.length; i++) {\n            let name = partialSymbols[i];\n            let symbol = i + 1;\n            let value = evalScope[name];\n            if (value !== undefined) partialScope.bind(symbol, value);\n        }\n        partialScope.bindPartialMap(locals);\n        vm.pushFrame(); // sp += 2\n        vm.call(handle);\n    }\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFydGlhbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3J1bnRpbWUvbGliL2NvbXBpbGVkL29wY29kZXMvcGFydGlhbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFHQSxBQUFPLFNBQUUsQUFBYyxBQUFFLHNCQUFNLEFBQWUsQUFBQztBQUUvQyxBQUFPLFNBQUUsQUFBTSxRQUFFLEFBQUksQUFBRSxZQUFNLEFBQWUsQUFBQyxBQUM3QyxBQUFPLEFBQUUsQUFBSyxBQUFFLEFBQWlCLEFBQUUsQUFBTSxBQUFnQixBQUFDLEFBRTFELEFBQU8sQUFBRSxBQUFjLEFBQUUsQUFBTSxBQUFnQixBQUFDOztBQUVoRCxBQUFjLGVBQUMsQUFBRyw0QkFBbUIsQ0FBQyxBQUFFLElBQUUsRUFBRSxBQUFHLEtBQUUsQUFBSyxPQUFFLEFBQUcsS0FBRSxBQUFRLFVBQUUsQUFBRyxLQUFFLEFBQVMsQUFBRTtBQUNyRixRQUFJLEVBQUUsQUFBUyxXQUFFLEFBQVMsV0FBRSxFQUFFLEFBQVEsQUFBRSxZQUFFLEFBQUssQUFBRSxVQUFHLEFBQUUsQUFBQztBQUV2RCxRQUFJLEFBQUksT0FBUyxBQUFLLE1BQUMsQUFBRyxBQUFFLEFBQUUsQUFBYyxBQUFDLEtBQWxDLEFBQUssQ0FBOEIsQUFBSyxBQUFFLEFBQUM7Y0FDdEQsQUFBTSxPQUFDLE9BQU8sQUFBSSxTQUFLLEFBQVEsQUFBRSw2Q0FBbUMsQUFBTSxPQUFDLEFBQUksQUFBQyxLQUFHLEFBQUMsQUFBQzs7QUFFckYsUUFBSSxBQUFJLE9BQUcsQUFBUyxVQUFDLEFBQWUsZ0JBQWUsQUFBSyxBQUFDLEFBQUM7QUFDMUQsUUFBSSxBQUFZLGVBQUcsQUFBUyxVQUFDLEFBQWMsZUFBQyxBQUFRLEFBQUMsQUFBQztBQUN0RCxRQUFJLEFBQVEsV0FBRyxBQUFTLFVBQUMsQUFBUSxTQUFDLEFBQVMsQUFBQyxBQUFDO0FBRTdDLFFBQUksQUFBUyxZQUFHLEFBQVEsU0FBQyxBQUFhLGNBQUMsQUFBYyxNQUFFLEFBQUksQUFBQyxBQUFDO2NBRTdELEFBQU0sT0FBQyxBQUFTLEFBQUUsOENBQW1DLEFBQUksSUFBRyxBQUFDLEFBQUM7O0FBRTlELFFBQUksQUFBVSxhQUFHLEFBQVEsU0FBQyxBQUFPLFFBQW9CLEFBQVUsQUFBQyxBQUFDO0FBRWpFLFFBQUksRUFBRSxBQUFXLGFBQUUsQUFBTSxBQUFFLFdBQUcsQUFBVSxXQUFDLEFBQVUsQUFBRSxBQUFDO0FBRXRELEFBQUM7QUFDQyxZQUFJLEFBQWMsaUJBQUcsQUFBVyxZQUFDLEFBQU8sQUFBQztBQUN6QyxZQUFJLEFBQVUsYUFBRyxBQUFFLEdBQUMsQUFBSyxBQUFFLEFBQUM7QUFDNUIsWUFBSSxBQUFZLGVBQUcsQUFBRSxHQUFDLEFBQWEsY0FBQyxBQUFjLGVBQUMsQUFBTSxRQUFFLEFBQUssQUFBQyxBQUFDO0FBQ2xFLEFBQVkscUJBQUMsQUFBZSxnQkFBQyxBQUFVLFdBQUMsQUFBYyxBQUFFLEFBQUMsQUFBQztBQUMxRCxBQUFZLHFCQUFDLEFBQWEsY0FBQyxBQUFVLFdBQUMsQUFBWSxBQUFFLEFBQUMsQUFBQztBQUN0RCxBQUFZLHFCQUFDLEFBQVEsU0FBQyxBQUFVLFdBQUMsQUFBTyxBQUFFLEFBQUMsQUFBQztBQUU1QyxZQUFJLEFBQU0sU0FBRyxBQUFJLEFBQWtDLEFBQUM7QUFFcEQsQUFBRyxBQUFDLGFBQUMsSUFBSSxBQUFDLElBQUcsQUFBQyxHQUFFLEFBQUMsSUFBRyxBQUFRLFNBQUMsQUFBTSxRQUFFLEFBQUMsQUFBRSxLQUFFLEFBQUM7QUFDekMsZ0JBQUksQUFBSSxPQUFHLEFBQVEsU0FBQyxBQUFDLEFBQUMsQUFBQztBQUN2QixnQkFBSSxBQUFJLE9BQUcsQUFBWSxhQUFDLEFBQUksT0FBRyxBQUFDLEFBQUMsQUFBQztBQUNsQyxnQkFBSSxBQUFHLE1BQUksQUFBVSxXQUFDLEFBQVMsVUFBQyxBQUFJLEFBQUMsQUFBQztBQUN0QyxBQUFNLG1CQUFDLEFBQUksQUFBQyxRQUFHLEFBQUcsQUFBQyxBQUNyQjtBQUFDO0FBRUQsWUFBSSxBQUFTLFlBQUcsQUFBVSxXQUFDLEFBQVksQUFBRyxBQUFDO0FBRTNDLEFBQUcsQUFBQyxhQUFDLElBQUksQUFBQyxJQUFHLEFBQUMsR0FBRSxBQUFDLElBQUcsQUFBYyxlQUFDLEFBQU0sUUFBRSxBQUFDLEFBQUUsS0FBRSxBQUFDO0FBQy9DLGdCQUFJLEFBQUksT0FBRyxBQUFjLGVBQUMsQUFBQyxBQUFDLEFBQUM7QUFDN0IsZ0JBQUksQUFBTSxTQUFHLEFBQUMsSUFBRyxBQUFDLEFBQUM7QUFDbkIsZ0JBQUksQUFBSyxRQUFHLEFBQVMsVUFBQyxBQUFJLEFBQUMsQUFBQztBQUU1QixBQUFFLEFBQUMsZ0JBQUMsQUFBSyxVQUFLLEFBQVMsQUFBQyxXQUFDLEFBQVksYUFBQyxBQUFJLEtBQUMsQUFBTSxRQUFFLEFBQUssQUFBQyxBQUFDLEFBQzVEO0FBQUM7QUFFRCxBQUFZLHFCQUFDLEFBQWMsZUFBQyxBQUFNLEFBQUMsQUFBQztBQUVwQyxBQUFFLFdBQUMsQUFBUyxBQUFFLEFBQUMsYUFBQyxBQUFVO0FBQzFCLEFBQUUsV0FBQyxBQUFJLEtBQUMsQUFBTyxBQUFDLEFBQUMsQUFDbkI7QUFBQyxBQUVELEFBQWlCLEFBQUMsQUFBRSxBQUFDLEFBQUssQUFBRSxBQUFDLEFBQUUsQUFBZSxBQUFDLEFBQUMsQUFDbEQ7QUFBQyxBQUFDLEFBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBWZXJzaW9uZWRQYXRoUmVmZXJlbmNlIH0gZnJvbSAnQGdsaW1tZXIvcmVmZXJlbmNlJztcbmltcG9ydCB7IFRlbXBsYXRlTWV0YSB9IGZyb20gJ0BnbGltbWVyL3dpcmUtZm9ybWF0JztcbmltcG9ydCB7IE9wIH0gZnJvbSAnQGdsaW1tZXIvdm0nO1xuaW1wb3J0IHsgQVBQRU5EX09QQ09ERVMgfSBmcm9tICcuLi8uLi9vcGNvZGVzJztcbmltcG9ydCB7IFBhcnRpYWxEZWZpbml0aW9uIH0gZnJvbSAnLi4vLi4vcGFydGlhbCc7XG5pbXBvcnQgeyBhc3NlcnQsIGRpY3QgfSBmcm9tIFwiQGdsaW1tZXIvdXRpbFwiO1xuaW1wb3J0IHsgY2hlY2ssIGV4cGVjdFN0YWNrQ2hhbmdlIH0gZnJvbSAnQGdsaW1tZXIvZGVidWcnO1xuaW1wb3J0IHsgT3BhcXVlIH0gZnJvbSBcIkBnbGltbWVyL2ludGVyZmFjZXNcIjtcbmltcG9ydCB7IENoZWNrUmVmZXJlbmNlIH0gZnJvbSAnLi8tZGVidWctc3RyaXAnO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuSW52b2tlUGFydGlhbCwgKHZtLCB7IG9wMTogX21ldGEsIG9wMjogX3N5bWJvbHMsIG9wMzogX2V2YWxJbmZvIH0pID0+IHtcbiAgbGV0IHsgY29uc3RhbnRzLCBjb25zdGFudHM6IHsgcmVzb2x2ZXIgfSwgc3RhY2sgfSA9IHZtO1xuXG4gIGxldCBuYW1lID0gY2hlY2soc3RhY2sucG9wKCksIENoZWNrUmVmZXJlbmNlKS52YWx1ZSgpO1xuICBhc3NlcnQodHlwZW9mIG5hbWUgPT09ICdzdHJpbmcnLCBgQ291bGQgbm90IGZpbmQgYSBwYXJ0aWFsIG5hbWVkIFwiJHtTdHJpbmcobmFtZSl9XCJgKTtcblxuICBsZXQgbWV0YSA9IGNvbnN0YW50cy5nZXRTZXJpYWxpemFibGU8VGVtcGxhdGVNZXRhPihfbWV0YSk7XG4gIGxldCBvdXRlclN5bWJvbHMgPSBjb25zdGFudHMuZ2V0U3RyaW5nQXJyYXkoX3N5bWJvbHMpO1xuICBsZXQgZXZhbEluZm8gPSBjb25zdGFudHMuZ2V0QXJyYXkoX2V2YWxJbmZvKTtcblxuICBsZXQgc3BlY2lmaWVyID0gcmVzb2x2ZXIubG9va3VwUGFydGlhbChuYW1lIGFzIHN0cmluZywgbWV0YSk7XG5cbiAgYXNzZXJ0KHNwZWNpZmllciwgYENvdWxkIG5vdCBmaW5kIGEgcGFydGlhbCBuYW1lZCBcIiR7bmFtZX1cImApO1xuXG4gIGxldCBkZWZpbml0aW9uID0gcmVzb2x2ZXIucmVzb2x2ZTxQYXJ0aWFsRGVmaW5pdGlvbj4oc3BlY2lmaWVyISk7XG5cbiAgbGV0IHsgc3ltYm9sVGFibGUsIGhhbmRsZSB9ID0gZGVmaW5pdGlvbi5nZXRQYXJ0aWFsKCk7XG5cbiAge1xuICAgIGxldCBwYXJ0aWFsU3ltYm9scyA9IHN5bWJvbFRhYmxlLnN5bWJvbHM7XG4gICAgbGV0IG91dGVyU2NvcGUgPSB2bS5zY29wZSgpO1xuICAgIGxldCBwYXJ0aWFsU2NvcGUgPSB2bS5wdXNoUm9vdFNjb3BlKHBhcnRpYWxTeW1ib2xzLmxlbmd0aCwgZmFsc2UpO1xuICAgIHBhcnRpYWxTY29wZS5iaW5kQ2FsbGVyU2NvcGUob3V0ZXJTY29wZS5nZXRDYWxsZXJTY29wZSgpKTtcbiAgICBwYXJ0aWFsU2NvcGUuYmluZEV2YWxTY29wZShvdXRlclNjb3BlLmdldEV2YWxTY29wZSgpKTtcbiAgICBwYXJ0aWFsU2NvcGUuYmluZFNlbGYob3V0ZXJTY29wZS5nZXRTZWxmKCkpO1xuXG4gICAgbGV0IGxvY2FscyA9IGRpY3Q8VmVyc2lvbmVkUGF0aFJlZmVyZW5jZTxPcGFxdWU+PigpO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBldmFsSW5mby5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IHNsb3QgPSBldmFsSW5mb1tpXTtcbiAgICAgIGxldCBuYW1lID0gb3V0ZXJTeW1ib2xzW3Nsb3QgLSAxXTtcbiAgICAgIGxldCByZWYgID0gb3V0ZXJTY29wZS5nZXRTeW1ib2woc2xvdCk7XG4gICAgICBsb2NhbHNbbmFtZV0gPSByZWY7XG4gICAgfVxuXG4gICAgbGV0IGV2YWxTY29wZSA9IG91dGVyU2NvcGUuZ2V0RXZhbFNjb3BlKCkhO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXJ0aWFsU3ltYm9scy5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IG5hbWUgPSBwYXJ0aWFsU3ltYm9sc1tpXTtcbiAgICAgIGxldCBzeW1ib2wgPSBpICsgMTtcbiAgICAgIGxldCB2YWx1ZSA9IGV2YWxTY29wZVtuYW1lXTtcblxuICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHBhcnRpYWxTY29wZS5iaW5kKHN5bWJvbCwgdmFsdWUpO1xuICAgIH1cblxuICAgIHBhcnRpYWxTY29wZS5iaW5kUGFydGlhbE1hcChsb2NhbHMpO1xuXG4gICAgdm0ucHVzaEZyYW1lKCk7IC8vIHNwICs9IDJcbiAgICB2bS5jYWxsKGhhbmRsZSEpO1xuICB9XG5cbiAgZXhwZWN0U3RhY2tDaGFuZ2Uodm0uc3RhY2ssIDEsICdJbnZva2VQYXJ0aWFsJyk7XG59KTtcbiJdfQ==","import { ReferenceIterator } from '@glimmer/reference';\nimport { APPEND_OPCODES } from '../../opcodes';\n\nclass IterablePresenceReference {\n    constructor(artifacts) {\n        this.tag = artifacts.tag;\n        this.artifacts = artifacts;\n    }\n    value() {\n        return !this.artifacts.isEmpty();\n    }\n}\nAPPEND_OPCODES.add(55 /* PutIterator */, vm => {\n    let stack = vm.stack;\n    let listRef = stack.pop();\n    let key = stack.pop();\n    let iterable = vm.env.iterableFor(listRef, key.value());\n    let iterator = new ReferenceIterator(iterable);\n    stack.push(iterator);\n    stack.push(new IterablePresenceReference(iterator.artifacts));\n});\nAPPEND_OPCODES.add(53 /* EnterList */, (vm, { op1: relativeStart }) => {\n    vm.enterList(relativeStart);\n});\nAPPEND_OPCODES.add(54 /* ExitList */, vm => {\n    vm.exitList();\n});\nAPPEND_OPCODES.add(56 /* Iterate */, (vm, { op1: breaks }) => {\n    let stack = vm.stack;\n    let item = stack.peek().next();\n    if (item) {\n        let tryOpcode = vm.iterate(item.memo, item.value);\n        vm.enterItem(item.key, tryOpcode);\n    } else {\n        vm.goto(breaks);\n    }\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGlzdHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci9ydW50aW1lL2xpYi9jb21waWxlZC9vcGNvZGVzL2xpc3RzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLEFBQU8sU0FHTCxBQUFpQixBQUVsQix5QkFBTSxBQUFvQixBQUFDO0FBQzVCLEFBQU8sU0FBRSxBQUFjLEFBQUUsc0JBQU0sQUFBZSxBQUFDLEFBQy9DLEFBQU8sQUFBRSxBQUFrQixBQUFFLEFBQU0sQUFBZ0IsQUFBQyxBQUNwRCxBQUFPLEFBQUUsQUFBSyxBQUFFLEFBQVcsQUFBRSxBQUFpQixBQUFFLEFBQWUsQUFBRSxBQUFNLEFBQWdCLEFBQUM7O0FBRXhGO0FBSUUsZ0JBQVksQUFBNkI7QUFDdkMsQUFBSSxhQUFDLEFBQUcsTUFBRyxBQUFTLFVBQUMsQUFBRyxBQUFDO0FBQ3pCLEFBQUksYUFBQyxBQUFTLFlBQUcsQUFBUyxBQUFDLEFBQzdCO0FBQUM7QUFFRCxBQUFLO0FBQ0gsQUFBTSxlQUFDLENBQUMsQUFBSSxLQUFDLEFBQVMsVUFBQyxBQUFPLEFBQUUsQUFBQyxBQUNuQztBQUFDLEFBQ0Y7O0FBRUQsQUFBYyxlQUFDLEFBQUcsMEJBQWlCLEFBQUU7QUFDbkMsUUFBSSxBQUFLLFFBQUcsQUFBRSxHQUFDLEFBQUssQUFBQztBQUNyQixRQUFJLEFBQU8sQUFBRyxBQUFLLFVBQUMsQUFBSyxNQUFDLEFBQUcsQUFBRSxBQUFFLEFBQWtCLEFBQUMsQUFBQztBQUNyRCxRQUFJLEFBQUcsQUFBRyxBQUFLLE1BQUMsQUFBSyxNQUFDLEFBQUcsQUFBRSxBQUFFLEFBQWtCLEFBQUMsQUFBQztBQUNqRCxRQUFJLEFBQVEsV0FBRyxBQUFFLEdBQUMsQUFBRyxJQUFDLEFBQVcsWUFBQyxBQUFPLEFBQUUsQUFBSyxTQUFDLEFBQUcsSUFBQyxBQUFLLEFBQUUsQUFBRSxBQUFXLEFBQUMsQUFBQyxBQUFDO0FBQzVFLFFBQUksQUFBUSxXQUFHLElBQUksQUFBaUIsa0JBQUMsQUFBUSxBQUFDLEFBQUM7QUFFL0MsQUFBSyxVQUFDLEFBQUksS0FBQyxBQUFRLEFBQUMsQUFBQztBQUNyQixBQUFLLFVBQUMsQUFBSSxLQUFDLElBQUksQUFBeUIsMEJBQUMsQUFBUSxTQUFDLEFBQVMsQUFBQyxBQUFDLEFBQUMsQUFDaEU7QUFBQyxBQUFDLEFBQUM7QUFFSCxBQUFjLGVBQUMsQUFBRyx3QkFBZSxDQUFDLEFBQUUsSUFBRSxFQUFFLEFBQUcsS0FBRSxBQUFhLEFBQUU7QUFDMUQsQUFBRSxPQUFDLEFBQVMsVUFBQyxBQUFhLEFBQUMsQUFBQyxBQUM5QjtBQUFDLEFBQUMsQUFBQztBQUVILEFBQWMsZUFBQyxBQUFHLHVCQUFjLEFBQUU7QUFDaEMsQUFBRSxPQUFDLEFBQVEsQUFBRSxBQUFDLEFBQ2hCO0FBQUMsQUFBQyxBQUFDO0FBRUgsQUFBYyxlQUFDLEFBQUcsc0JBQWEsQ0FBQyxBQUFFLElBQUUsRUFBRSxBQUFHLEtBQUUsQUFBTSxBQUFFO0FBQ2pELFFBQUksQUFBSyxRQUFHLEFBQUUsR0FBQyxBQUFLLEFBQUM7QUFDckIsUUFBSSxBQUFJLE9BQVMsQUFBSyxNQUFDLEFBQUksQUFBRSxBQUFFLEFBQWUsQUFBQyxBQUFpQixBQUFDLEFBQUMsTUFBdkQsQUFBSyxDQUFtRCxBQUFJLEFBQUUsQUFBQztBQUUxRSxBQUFFLEFBQUMsUUFBQyxBQUFJLEFBQUMsTUFBQyxBQUFDO0FBQ1QsWUFBSSxBQUFTLFlBQUcsQUFBRSxHQUFDLEFBQU8sUUFBQyxBQUFJLEtBQUMsQUFBSSxNQUFFLEFBQUksS0FBQyxBQUFLLEFBQUMsQUFBQztBQUNsRCxBQUFFLFdBQUMsQUFBUyxVQUFDLEFBQUksS0FBQyxBQUFHLEtBQUUsQUFBUyxBQUFDLEFBQUMsQUFDcEM7QUFBQyxBQUFDLEFBQUksV0FBQyxBQUFDO0FBQ04sQUFBRSxXQUFDLEFBQUksS0FBQyxBQUFNLEFBQUMsQUFBQyxBQUNsQjtBQUFDLEFBRUQsQUFBaUIsQUFBQyxBQUFFLEFBQUMsQUFBSyxBQUFFLEFBQUksQUFBRyxBQUFDLEFBQUcsQUFBQyxBQUFFLEFBQVMsQUFBQyxBQUFDLEFBQ3ZEO0FBQUMsQUFBQyxBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgT3AgfSBmcm9tICdAZ2xpbW1lci92bSc7XG5pbXBvcnQge1xuICBJdGVyYXRpb25BcnRpZmFjdHMsXG4gIFJlZmVyZW5jZSxcbiAgUmVmZXJlbmNlSXRlcmF0b3IsXG4gIFRhZ1xufSBmcm9tICdAZ2xpbW1lci9yZWZlcmVuY2UnO1xuaW1wb3J0IHsgQVBQRU5EX09QQ09ERVMgfSBmcm9tICcuLi8uLi9vcGNvZGVzJztcbmltcG9ydCB7IENoZWNrUGF0aFJlZmVyZW5jZSB9IGZyb20gJy4vLWRlYnVnLXN0cmlwJztcbmltcG9ydCB7IGNoZWNrLCBDaGVja1N0cmluZywgZXhwZWN0U3RhY2tDaGFuZ2UsIENoZWNrSW5zdGFuY2VvZiB9IGZyb20gXCJAZ2xpbW1lci9kZWJ1Z1wiO1xuXG5jbGFzcyBJdGVyYWJsZVByZXNlbmNlUmVmZXJlbmNlIGltcGxlbWVudHMgUmVmZXJlbmNlPGJvb2xlYW4+IHtcbiAgcHVibGljIHRhZzogVGFnO1xuICBwcml2YXRlIGFydGlmYWN0czogSXRlcmF0aW9uQXJ0aWZhY3RzO1xuXG4gIGNvbnN0cnVjdG9yKGFydGlmYWN0czogSXRlcmF0aW9uQXJ0aWZhY3RzKSB7XG4gICAgdGhpcy50YWcgPSBhcnRpZmFjdHMudGFnO1xuICAgIHRoaXMuYXJ0aWZhY3RzID0gYXJ0aWZhY3RzO1xuICB9XG5cbiAgdmFsdWUoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICF0aGlzLmFydGlmYWN0cy5pc0VtcHR5KCk7XG4gIH1cbn1cblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLlB1dEl0ZXJhdG9yLCB2bSA9PiB7XG4gIGxldCBzdGFjayA9IHZtLnN0YWNrO1xuICBsZXQgbGlzdFJlZiA9IGNoZWNrKHN0YWNrLnBvcCgpLCBDaGVja1BhdGhSZWZlcmVuY2UpO1xuICBsZXQga2V5ID0gY2hlY2soc3RhY2sucG9wKCksIENoZWNrUGF0aFJlZmVyZW5jZSk7XG4gIGxldCBpdGVyYWJsZSA9IHZtLmVudi5pdGVyYWJsZUZvcihsaXN0UmVmLCBjaGVjayhrZXkudmFsdWUoKSwgQ2hlY2tTdHJpbmcpKTtcbiAgbGV0IGl0ZXJhdG9yID0gbmV3IFJlZmVyZW5jZUl0ZXJhdG9yKGl0ZXJhYmxlKTtcblxuICBzdGFjay5wdXNoKGl0ZXJhdG9yKTtcbiAgc3RhY2sucHVzaChuZXcgSXRlcmFibGVQcmVzZW5jZVJlZmVyZW5jZShpdGVyYXRvci5hcnRpZmFjdHMpKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuRW50ZXJMaXN0LCAodm0sIHsgb3AxOiByZWxhdGl2ZVN0YXJ0IH0pID0+IHtcbiAgdm0uZW50ZXJMaXN0KHJlbGF0aXZlU3RhcnQpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5FeGl0TGlzdCwgdm0gPT4ge1xuICB2bS5leGl0TGlzdCgpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5JdGVyYXRlLCAodm0sIHsgb3AxOiBicmVha3MgfSkgPT4ge1xuICBsZXQgc3RhY2sgPSB2bS5zdGFjaztcbiAgbGV0IGl0ZW0gPSBjaGVjayhzdGFjay5wZWVrKCksIENoZWNrSW5zdGFuY2VvZihSZWZlcmVuY2VJdGVyYXRvcikpLm5leHQoKTtcblxuICBpZiAoaXRlbSkge1xuICAgIGxldCB0cnlPcGNvZGUgPSB2bS5pdGVyYXRlKGl0ZW0ubWVtbywgaXRlbS52YWx1ZSk7XG4gICAgdm0uZW50ZXJJdGVtKGl0ZW0ua2V5LCB0cnlPcGNvZGUpO1xuICB9IGVsc2Uge1xuICAgIHZtLmdvdG8oYnJlYWtzKTtcbiAgfVxuXG4gIGV4cGVjdFN0YWNrQ2hhbmdlKHZtLnN0YWNrLCBpdGVtID8gMiA6IDAsICdJdGVyYXRlJyk7XG59KTtcbiJdfQ==","export class Cursor {\n    constructor(element, nextSibling) {\n        this.element = element;\n        this.nextSibling = nextSibling;\n    }\n}\nexport class ConcreteBounds {\n    constructor(parentNode, first, last) {\n        this.parentNode = parentNode;\n        this.first = first;\n        this.last = last;\n    }\n    parentElement() {\n        return this.parentNode;\n    }\n    firstNode() {\n        return this.first;\n    }\n    lastNode() {\n        return this.last;\n    }\n}\nexport class SingleNodeBounds {\n    constructor(parentNode, node) {\n        this.parentNode = parentNode;\n        this.node = node;\n    }\n    parentElement() {\n        return this.parentNode;\n    }\n    firstNode() {\n        return this.node;\n    }\n    lastNode() {\n        return this.node;\n    }\n}\nexport function bounds(parent, first, last) {\n    return new ConcreteBounds(parent, first, last);\n}\nexport function single(parent, node) {\n    return new SingleNodeBounds(parent, node);\n}\nexport function move(bounds, reference) {\n    let parent = bounds.parentElement();\n    let first = bounds.firstNode();\n    let last = bounds.lastNode();\n    let node = first;\n    while (node) {\n        let next = node.nextSibling;\n        parent.insertBefore(node, reference);\n        if (node === last) return next;\n        node = next;\n    }\n    return null;\n}\nexport function clear(bounds) {\n    let parent = bounds.parentElement();\n    let first = bounds.firstNode();\n    let last = bounds.lastNode();\n    let node = first;\n    while (node) {\n        let next = node.nextSibling;\n        parent.removeChild(node);\n        if (node === last) return next;\n        node = next;\n    }\n    return null;\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYm91bmRzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcGFja2FnZXMvQGdsaW1tZXIvcnVudGltZS9saWIvYm91bmRzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQVVBLEFBQU07QUFDSixnQkFBbUIsQUFBdUIsU0FBUyxBQUFnQztBQUFoRSxhQUFPLFVBQVAsQUFBTyxBQUFnQjtBQUFTLGFBQVcsY0FBWCxBQUFXLEFBQXFCLEFBQUc7QUFBQyxBQUN4Rjs7QUFNRCxBQUFNO0FBQ0osZ0JBQW1CLEFBQTBCLFlBQVUsQUFBMEIsT0FBVSxBQUF5QjtBQUFqRyxhQUFVLGFBQVYsQUFBVSxBQUFnQjtBQUFVLGFBQUssUUFBTCxBQUFLLEFBQXFCO0FBQVUsYUFBSSxPQUFKLEFBQUksQUFBcUIsQUFBRztBQUFDO0FBRXhILEFBQWE7QUFBSyxBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQVUsQUFBQyxBQUFDO0FBQUM7QUFDM0MsQUFBUztBQUFLLEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBSyxBQUFDLEFBQUM7QUFBQztBQUNsQyxBQUFRO0FBQUssQUFBTSxlQUFDLEFBQUksS0FBQyxBQUFJLEFBQUMsQUFBQztBQUFDLEFBQ2pDOztBQUVELEFBQU07QUFJSixnQkFBWSxBQUEwQixZQUFFLEFBQWlCO0FBQ3ZELEFBQUksYUFBQyxBQUFVLGFBQUcsQUFBcUIsQUFBQztBQUN4QyxBQUFJLGFBQUMsQUFBSSxPQUFHLEFBQVksQUFBQyxBQUMzQjtBQUFDO0FBRUQsQUFBYTtBQUFLLEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBVSxBQUFDLEFBQUM7QUFBQztBQUMzQyxBQUFTO0FBQUssQUFBTSxlQUFDLEFBQUksS0FBQyxBQUFJLEFBQUMsQUFBQztBQUFDO0FBQ2pDLEFBQVE7QUFBSyxBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQUksQUFBQyxBQUFDO0FBQUMsQUFDakM7O0FBRUQsQUFBTSx1QkFBaUIsQUFBc0IsUUFBRSxBQUFrQixPQUFFLEFBQWlCO0FBQ2xGLEFBQU0sV0FBQyxJQUFJLEFBQWMsZUFBQyxBQUFNLFFBQUUsQUFBSyxPQUFFLEFBQUksQUFBQyxBQUFDLEFBQ2pEO0FBQUM7QUFFRCxBQUFNLHVCQUFpQixBQUFzQixRQUFFLEFBQWlCO0FBQzlELEFBQU0sV0FBQyxJQUFJLEFBQWdCLGlCQUFDLEFBQU0sUUFBRSxBQUFJLEFBQUMsQUFBQyxBQUM1QztBQUFDO0FBRUQsQUFBTSxxQkFBZSxBQUFjLFFBQUUsQUFBOEI7QUFDakUsUUFBSSxBQUFNLFNBQUcsQUFBTSxPQUFDLEFBQWEsQUFBRSxBQUFDO0FBQ3BDLFFBQUksQUFBSyxRQUFHLEFBQU0sT0FBQyxBQUFTLEFBQUUsQUFBQztBQUMvQixRQUFJLEFBQUksT0FBRyxBQUFNLE9BQUMsQUFBUSxBQUFFLEFBQUM7QUFFN0IsUUFBSSxBQUFJLE9BQXdCLEFBQUssQUFBQztBQUV0QyxXQUFPLEFBQUksTUFBRSxBQUFDO0FBQ1osWUFBSSxBQUFJLE9BQUcsQUFBSSxLQUFDLEFBQVcsQUFBQztBQUM1QixBQUFNLGVBQUMsQUFBWSxhQUFDLEFBQUksTUFBRSxBQUFTLEFBQUMsQUFBQztBQUNyQyxBQUFFLEFBQUMsWUFBQyxBQUFJLFNBQUssQUFBSSxBQUFDLE1BQUMsQUFBTSxPQUFDLEFBQUksQUFBQztBQUMvQixBQUFJLGVBQUcsQUFBSSxBQUFDLEFBQ2Q7QUFBQztBQUVELEFBQU0sV0FBQyxBQUFJLEFBQUMsQUFDZDtBQUFDO0FBRUQsQUFBTSxzQkFBZ0IsQUFBYztBQUNsQyxRQUFJLEFBQU0sU0FBRyxBQUFNLE9BQUMsQUFBYSxBQUFFLEFBQUM7QUFDcEMsUUFBSSxBQUFLLFFBQUcsQUFBTSxPQUFDLEFBQVMsQUFBRSxBQUFDO0FBQy9CLFFBQUksQUFBSSxPQUFHLEFBQU0sT0FBQyxBQUFRLEFBQUUsQUFBQztBQUU3QixRQUFJLEFBQUksT0FBd0IsQUFBSyxBQUFDO0FBRXRDLFdBQU8sQUFBSSxNQUFFLEFBQUM7QUFDWixZQUFJLEFBQUksT0FBRyxBQUFJLEtBQUMsQUFBVyxBQUFDO0FBQzVCLEFBQU0sZUFBQyxBQUFXLFlBQUMsQUFBSSxBQUFDLEFBQUM7QUFDekIsQUFBRSxBQUFDLFlBQUMsQUFBSSxTQUFLLEFBQUksQUFBQyxNQUFDLEFBQU0sT0FBQyxBQUFJLEFBQUM7QUFDL0IsQUFBSSxlQUFHLEFBQUksQUFBQyxBQUNkO0FBQUM7QUFFRCxBQUFNLFdBQUMsQUFBSSxBQUFDLEFBQ2Q7QUFBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFNpbXBsZSB9IGZyb20gJ0BnbGltbWVyL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgT3B0aW9uLCBEZXN0cm95YWJsZSB9IGZyb20gJ0BnbGltbWVyL3V0aWwnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEJvdW5kcyB7XG4gIC8vIGEgbWV0aG9kIHRvIGZ1dHVyZS1wcm9vZiBmb3Igd29ybWhvbGluZzsgbWF5IG5vdCBiZSBuZWVkZWQgdWx0aW1hdGVseVxuICBwYXJlbnRFbGVtZW50KCk6IFNpbXBsZS5FbGVtZW50O1xuICBmaXJzdE5vZGUoKTogT3B0aW9uPFNpbXBsZS5Ob2RlPjtcbiAgbGFzdE5vZGUoKTogT3B0aW9uPFNpbXBsZS5Ob2RlPjtcbn1cblxuZXhwb3J0IGNsYXNzIEN1cnNvciB7XG4gIGNvbnN0cnVjdG9yKHB1YmxpYyBlbGVtZW50OiBTaW1wbGUuRWxlbWVudCwgcHVibGljIG5leHRTaWJsaW5nOiBPcHRpb248U2ltcGxlLk5vZGU+KSB7fVxufVxuXG5leHBvcnQgZGVmYXVsdCBCb3VuZHM7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRGVzdHJveWFibGVCb3VuZHMgZXh0ZW5kcyBCb3VuZHMsIERlc3Ryb3lhYmxlIHt9XG5cbmV4cG9ydCBjbGFzcyBDb25jcmV0ZUJvdW5kcyBpbXBsZW1lbnRzIEJvdW5kcyB7XG4gIGNvbnN0cnVjdG9yKHB1YmxpYyBwYXJlbnROb2RlOiBTaW1wbGUuRWxlbWVudCwgcHJpdmF0ZSBmaXJzdDogT3B0aW9uPFNpbXBsZS5Ob2RlPiwgcHJpdmF0ZSBsYXN0OiBPcHRpb248U2ltcGxlLk5vZGU+KSB7fVxuXG4gIHBhcmVudEVsZW1lbnQoKSB7IHJldHVybiB0aGlzLnBhcmVudE5vZGU7IH1cbiAgZmlyc3ROb2RlKCkgeyByZXR1cm4gdGhpcy5maXJzdDsgfVxuICBsYXN0Tm9kZSgpIHsgcmV0dXJuIHRoaXMubGFzdDsgfVxufVxuXG5leHBvcnQgY2xhc3MgU2luZ2xlTm9kZUJvdW5kcyBpbXBsZW1lbnRzIEJvdW5kcyB7XG4gIHByaXZhdGUgcGFyZW50Tm9kZTogRWxlbWVudDtcbiAgcHJpdmF0ZSBub2RlOiBOb2RlO1xuXG4gIGNvbnN0cnVjdG9yKHBhcmVudE5vZGU6IFNpbXBsZS5FbGVtZW50LCBub2RlOiBTaW1wbGUuTm9kZSkge1xuICAgIHRoaXMucGFyZW50Tm9kZSA9IHBhcmVudE5vZGUgYXMgRWxlbWVudDtcbiAgICB0aGlzLm5vZGUgPSBub2RlIGFzIE5vZGU7XG4gIH1cblxuICBwYXJlbnRFbGVtZW50KCkgeyByZXR1cm4gdGhpcy5wYXJlbnROb2RlOyB9XG4gIGZpcnN0Tm9kZSgpIHsgcmV0dXJuIHRoaXMubm9kZTsgfVxuICBsYXN0Tm9kZSgpIHsgcmV0dXJuIHRoaXMubm9kZTsgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gYm91bmRzKHBhcmVudDogU2ltcGxlLkVsZW1lbnQsIGZpcnN0OiBTaW1wbGUuTm9kZSwgbGFzdDogU2ltcGxlLk5vZGUpOiBDb25jcmV0ZUJvdW5kcyB7XG4gIHJldHVybiBuZXcgQ29uY3JldGVCb3VuZHMocGFyZW50LCBmaXJzdCwgbGFzdCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzaW5nbGUocGFyZW50OiBTaW1wbGUuRWxlbWVudCwgbm9kZTogU2ltcGxlLk5vZGUpOiBTaW5nbGVOb2RlQm91bmRzIHtcbiAgcmV0dXJuIG5ldyBTaW5nbGVOb2RlQm91bmRzKHBhcmVudCwgbm9kZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtb3ZlKGJvdW5kczogQm91bmRzLCByZWZlcmVuY2U6IE9wdGlvbjxTaW1wbGUuTm9kZT4pIHtcbiAgbGV0IHBhcmVudCA9IGJvdW5kcy5wYXJlbnRFbGVtZW50KCk7XG4gIGxldCBmaXJzdCA9IGJvdW5kcy5maXJzdE5vZGUoKTtcbiAgbGV0IGxhc3QgPSBib3VuZHMubGFzdE5vZGUoKTtcblxuICBsZXQgbm9kZTogT3B0aW9uPFNpbXBsZS5Ob2RlPiA9IGZpcnN0O1xuXG4gIHdoaWxlIChub2RlKSB7XG4gICAgbGV0IG5leHQgPSBub2RlLm5leHRTaWJsaW5nO1xuICAgIHBhcmVudC5pbnNlcnRCZWZvcmUobm9kZSwgcmVmZXJlbmNlKTtcbiAgICBpZiAobm9kZSA9PT0gbGFzdCkgcmV0dXJuIG5leHQ7XG4gICAgbm9kZSA9IG5leHQ7XG4gIH1cblxuICByZXR1cm4gbnVsbDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyKGJvdW5kczogQm91bmRzKTogT3B0aW9uPFNpbXBsZS5Ob2RlPiB7XG4gIGxldCBwYXJlbnQgPSBib3VuZHMucGFyZW50RWxlbWVudCgpO1xuICBsZXQgZmlyc3QgPSBib3VuZHMuZmlyc3ROb2RlKCk7XG4gIGxldCBsYXN0ID0gYm91bmRzLmxhc3ROb2RlKCk7XG5cbiAgbGV0IG5vZGU6IE9wdGlvbjxTaW1wbGUuTm9kZT4gPSBmaXJzdDtcblxuICB3aGlsZSAobm9kZSkge1xuICAgIGxldCBuZXh0ID0gbm9kZS5uZXh0U2libGluZztcbiAgICBwYXJlbnQucmVtb3ZlQ2hpbGQobm9kZSk7XG4gICAgaWYgKG5vZGUgPT09IGxhc3QpIHJldHVybiBuZXh0O1xuICAgIG5vZGUgPSBuZXh0O1xuICB9XG5cbiAgcmV0dXJuIG51bGw7XG59XG4iXX0=","import { ConcreteBounds } from '../bounds';\nimport { moveNodesBefore } from '../dom/helper';\n\nexport const SVG_NAMESPACE = 'http://www.w3.org/2000/svg';\n// Patch:    insertAdjacentHTML on SVG Fix\n// Browsers: Safari, IE, Edge, Firefox ~33-34\n// Reason:   insertAdjacentHTML does not exist on SVG elements in Safari. It is\n//           present but throws an exception on IE and Edge. Old versions of\n//           Firefox create nodes in the incorrect namespace.\n// Fix:      Since IE and Edge silently fail to create SVG nodes using\n//           innerHTML, and because Firefox may create nodes in the incorrect\n//           namespace using innerHTML on SVG elements, an HTML-string wrapping\n//           approach is used. A pre/post SVG tag is added to the string, then\n//           that whole string is added to a div. The created nodes are plucked\n//           out and applied to the target location on DOM.\nexport function applySVGInnerHTMLFix(document, DOMClass, svgNamespace) {\n    if (!document) return DOMClass;\n    if (!shouldApplyFix(document, svgNamespace)) {\n        return DOMClass;\n    }\n    let div = document.createElement('div');\n    return class DOMChangesWithSVGInnerHTMLFix extends DOMClass {\n        insertHTMLBefore(parent, nextSibling, html) {\n            if (html === null || html === '') {\n                return super.insertHTMLBefore(parent, nextSibling, html);\n            }\n            if (parent.namespaceURI !== svgNamespace) {\n                return super.insertHTMLBefore(parent, nextSibling, html);\n            }\n            return fixSVG(parent, div, html, nextSibling);\n        }\n    };\n}\nfunction fixSVG(parent, div, html, reference) {\n    // IE, Edge: also do not correctly support using `innerHTML` on SVG\n    // namespaced elements. So here a wrapper is used.\n    let wrappedHtml = '<svg>' + html + '</svg>';\n    div.innerHTML = wrappedHtml;\n    let [first, last] = moveNodesBefore(div.firstChild, parent, reference);\n    return new ConcreteBounds(parent, first, last);\n}\nfunction shouldApplyFix(document, svgNamespace) {\n    let svg = document.createElementNS(svgNamespace, 'svg');\n    try {\n        svg['insertAdjacentHTML']('beforeend', '<circle></circle>');\n    } catch (e) {\n        // IE, Edge: Will throw, insertAdjacentHTML is unsupported on SVG\n        // Safari: Will throw, insertAdjacentHTML is not present on SVG\n    } finally {\n        // FF: Old versions will create a node in the wrong namespace\n        if (svg.childNodes.length === 1 && svg.firstChild.namespaceURI === SVG_NAMESPACE) {\n            // The test worked as expected, no fix required\n            return false;\n        }\n        return true;\n    }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3ZnLWlubmVyLWh0bWwtZml4LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcGFja2FnZXMvQGdsaW1tZXIvcnVudGltZS9saWIvY29tcGF0L3N2Zy1pbm5lci1odG1sLWZpeC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxBQUFPLFNBQVUsQUFBYyxBQUFFLHNCQUFNLEFBQVcsQUFBQztBQUNuRCxBQUFPLFNBQUUsQUFBZSxBQUFpQix1QkFBTSxBQUFlLEFBQUMsQUFDL0QsQUFBTyxBQUFVLEFBQU0sQUFBRSxBQUFNLEFBQWUsQUFBQzs7QUFFL0MsQUFBTSxPQUFDLE1BQU0sQUFBYSxnQkFBRyxBQUE0QixBQUFDO0FBRzFELEFBQTBDO0FBQzFDLEFBQTZDO0FBQzdDLEFBQStFO0FBQy9FLEFBQTRFO0FBQzVFLEFBQTZEO0FBQzdELEFBQXNFO0FBQ3RFLEFBQTZFO0FBQzdFLEFBQStFO0FBQy9FLEFBQThFO0FBQzlFLEFBQStFO0FBQy9FLEFBQTJEO0FBQzNELEFBQU0scUNBQStCLEFBQTBCLFVBQUUsQUFBOEIsVUFBRSxBQUEyQjtBQUMxSCxBQUFFLEFBQUMsUUFBQyxDQUFDLEFBQVEsQUFBQyxVQUFDLEFBQU0sT0FBQyxBQUFRLEFBQUM7QUFFL0IsQUFBRSxBQUFDLFFBQUMsQ0FBQyxBQUFjLGVBQUMsQUFBUSxVQUFFLEFBQVksQUFBQyxBQUFDLGVBQUMsQUFBQztBQUM1QyxBQUFNLGVBQUMsQUFBUSxBQUFDLEFBQ2xCO0FBQUM7QUFFRCxRQUFJLEFBQUcsTUFBRyxBQUFRLFNBQUMsQUFBYSxjQUFDLEFBQUssQUFBQyxBQUFDO0FBRXhDLEFBQU0sV0FBQyxNQUFvQyxzQ0FBUSxBQUFRO0FBQ3pELEFBQWdCLHlCQUFDLEFBQW1CLFFBQUUsQUFBaUIsYUFBRSxBQUFZO0FBQ25FLEFBQUUsQUFBQyxnQkFBQyxBQUFJLFNBQUssQUFBSSxRQUFJLEFBQUksU0FBSyxBQUFFLEFBQUMsSUFBQyxBQUFDO0FBQ2pDLEFBQU0sdUJBQUMsQUFBSyxNQUFDLEFBQWdCLGlCQUFDLEFBQU0sUUFBRSxBQUFXLGFBQUUsQUFBSSxBQUFDLEFBQUMsQUFDM0Q7QUFBQztBQUVELEFBQUUsQUFBQyxnQkFBQyxBQUFNLE9BQUMsQUFBWSxpQkFBSyxBQUFZLEFBQUMsY0FBQyxBQUFDO0FBQ3pDLEFBQU0sdUJBQUMsQUFBSyxNQUFDLEFBQWdCLGlCQUFDLEFBQU0sUUFBRSxBQUFXLGFBQUUsQUFBSSxBQUFDLEFBQUMsQUFDM0Q7QUFBQztBQUVELEFBQU0sbUJBQUMsQUFBTSxPQUFDLEFBQU0sUUFBRSxBQUFHLEtBQUUsQUFBSSxNQUFFLEFBQVcsQUFBQyxBQUFDLEFBQ2hEO0FBQUMsQUFDRixBQUFDLEFBQ0o7O0FBQUM7QUFFRCxnQkFBZ0IsQUFBZSxRQUFFLEFBQWdCLEtBQUUsQUFBWSxNQUFFLEFBQWU7QUFDOUUsQUFBbUU7QUFDbkUsQUFBa0Q7QUFDbEQsUUFBSSxBQUFXLGNBQUcsQUFBTyxVQUFHLEFBQUksT0FBRyxBQUFRLEFBQUM7QUFFNUMsQUFBRyxRQUFDLEFBQVMsWUFBRyxBQUFXLEFBQUM7QUFFNUIsUUFBSSxDQUFDLEFBQUssT0FBRSxBQUFJLEFBQUMsUUFBRyxBQUFlLGdCQUFDLEFBQUcsSUFBQyxBQUFrQixZQUFFLEFBQU0sUUFBRSxBQUFTLEFBQUMsQUFBQztBQUMvRSxBQUFNLFdBQUMsSUFBSSxBQUFjLGVBQUMsQUFBTSxRQUFFLEFBQUssT0FBRSxBQUFJLEFBQUMsQUFBQyxBQUNqRDtBQUFDO0FBRUQsd0JBQXdCLEFBQWtCLFVBQUUsQUFBMkI7QUFDckUsUUFBSSxBQUFHLE1BQUcsQUFBUSxTQUFDLEFBQWUsZ0JBQUMsQUFBWSxjQUFFLEFBQUssQUFBQyxBQUFDO0FBRXhELFFBQUksQUFBQztBQUNILEFBQUcsWUFBQyxBQUFvQixBQUFDLHNCQUFDLEFBQVcsYUFBRSxBQUFtQixBQUFDLEFBQUMsQUFDOUQ7QUFBQyxNQUFDLEFBQUssQUFBQyxPQUFDLEFBQUMsQUFBQyxHQUFDLEFBQUM7QUFDWCxBQUFpRTtBQUNqRSxBQUErRCxBQUNqRTtBQUFDLGNBQVMsQUFBQztBQUNULEFBQTZEO0FBQzdELEFBQUUsQUFBQyxZQUFDLEFBQUcsSUFBQyxBQUFVLFdBQUMsQUFBTSxXQUFLLEFBQUMsS0FBVyxBQUFHLElBQUMsQUFBVSxBQUFDLFVBQXRCLEFBQU0sQ0FBaUIsQUFBWSxpQkFBSyxBQUFhLEFBQUMsZUFBQyxBQUFDO0FBQ3pGLEFBQStDO0FBQy9DLEFBQU0sbUJBQUMsQUFBSyxBQUFDLEFBQ2Y7QUFBQztBQUVELEFBQU0sZUFBQyxBQUFJLEFBQUMsQUFDZDtBQUFDLEFBQ0g7QUFBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJvdW5kcywgQ29uY3JldGVCb3VuZHMgfSBmcm9tICcuLi9ib3VuZHMnO1xuaW1wb3J0IHsgbW92ZU5vZGVzQmVmb3JlLCBET01PcGVyYXRpb25zIH0gZnJvbSAnLi4vZG9tL2hlbHBlcic7XG5pbXBvcnQgeyBPcHRpb24sIHVud3JhcCB9IGZyb20gJ0BnbGltbWVyL3V0aWwnO1xuXG5leHBvcnQgY29uc3QgU1ZHX05BTUVTUEFDRSA9ICdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zyc7XG5leHBvcnQgdHlwZSBTVkdfTkFNRVNQQUNFID0gdHlwZW9mIFNWR19OQU1FU1BBQ0U7XG5cbi8vIFBhdGNoOiAgICBpbnNlcnRBZGphY2VudEhUTUwgb24gU1ZHIEZpeFxuLy8gQnJvd3NlcnM6IFNhZmFyaSwgSUUsIEVkZ2UsIEZpcmVmb3ggfjMzLTM0XG4vLyBSZWFzb246ICAgaW5zZXJ0QWRqYWNlbnRIVE1MIGRvZXMgbm90IGV4aXN0IG9uIFNWRyBlbGVtZW50cyBpbiBTYWZhcmkuIEl0IGlzXG4vLyAgICAgICAgICAgcHJlc2VudCBidXQgdGhyb3dzIGFuIGV4Y2VwdGlvbiBvbiBJRSBhbmQgRWRnZS4gT2xkIHZlcnNpb25zIG9mXG4vLyAgICAgICAgICAgRmlyZWZveCBjcmVhdGUgbm9kZXMgaW4gdGhlIGluY29ycmVjdCBuYW1lc3BhY2UuXG4vLyBGaXg6ICAgICAgU2luY2UgSUUgYW5kIEVkZ2Ugc2lsZW50bHkgZmFpbCB0byBjcmVhdGUgU1ZHIG5vZGVzIHVzaW5nXG4vLyAgICAgICAgICAgaW5uZXJIVE1MLCBhbmQgYmVjYXVzZSBGaXJlZm94IG1heSBjcmVhdGUgbm9kZXMgaW4gdGhlIGluY29ycmVjdFxuLy8gICAgICAgICAgIG5hbWVzcGFjZSB1c2luZyBpbm5lckhUTUwgb24gU1ZHIGVsZW1lbnRzLCBhbiBIVE1MLXN0cmluZyB3cmFwcGluZ1xuLy8gICAgICAgICAgIGFwcHJvYWNoIGlzIHVzZWQuIEEgcHJlL3Bvc3QgU1ZHIHRhZyBpcyBhZGRlZCB0byB0aGUgc3RyaW5nLCB0aGVuXG4vLyAgICAgICAgICAgdGhhdCB3aG9sZSBzdHJpbmcgaXMgYWRkZWQgdG8gYSBkaXYuIFRoZSBjcmVhdGVkIG5vZGVzIGFyZSBwbHVja2VkXG4vLyAgICAgICAgICAgb3V0IGFuZCBhcHBsaWVkIHRvIHRoZSB0YXJnZXQgbG9jYXRpb24gb24gRE9NLlxuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5U1ZHSW5uZXJIVE1MRml4KGRvY3VtZW50OiBPcHRpb248RG9jdW1lbnQ+LCBET01DbGFzczogdHlwZW9mIERPTU9wZXJhdGlvbnMsIHN2Z05hbWVzcGFjZTogU1ZHX05BTUVTUEFDRSk6IHR5cGVvZiBET01PcGVyYXRpb25zIHtcbiAgaWYgKCFkb2N1bWVudCkgcmV0dXJuIERPTUNsYXNzO1xuXG4gIGlmICghc2hvdWxkQXBwbHlGaXgoZG9jdW1lbnQsIHN2Z05hbWVzcGFjZSkpIHtcbiAgICByZXR1cm4gRE9NQ2xhc3M7XG4gIH1cblxuICBsZXQgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cbiAgcmV0dXJuIGNsYXNzIERPTUNoYW5nZXNXaXRoU1ZHSW5uZXJIVE1MRml4IGV4dGVuZHMgRE9NQ2xhc3Mge1xuICAgIGluc2VydEhUTUxCZWZvcmUocGFyZW50OiBIVE1MRWxlbWVudCwgbmV4dFNpYmxpbmc6IE5vZGUsIGh0bWw6IHN0cmluZyk6IEJvdW5kcyB7XG4gICAgICBpZiAoaHRtbCA9PT0gbnVsbCB8fCBodG1sID09PSAnJykge1xuICAgICAgICByZXR1cm4gc3VwZXIuaW5zZXJ0SFRNTEJlZm9yZShwYXJlbnQsIG5leHRTaWJsaW5nLCBodG1sKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHBhcmVudC5uYW1lc3BhY2VVUkkgIT09IHN2Z05hbWVzcGFjZSkge1xuICAgICAgICByZXR1cm4gc3VwZXIuaW5zZXJ0SFRNTEJlZm9yZShwYXJlbnQsIG5leHRTaWJsaW5nLCBodG1sKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZpeFNWRyhwYXJlbnQsIGRpdiwgaHRtbCwgbmV4dFNpYmxpbmcpO1xuICAgIH1cbiAgfTtcbn1cblxuZnVuY3Rpb24gZml4U1ZHKHBhcmVudDogRWxlbWVudCwgZGl2OiBIVE1MRWxlbWVudCwgaHRtbDogc3RyaW5nLCByZWZlcmVuY2U6IE5vZGUpOiBCb3VuZHMge1xuICAvLyBJRSwgRWRnZTogYWxzbyBkbyBub3QgY29ycmVjdGx5IHN1cHBvcnQgdXNpbmcgYGlubmVySFRNTGAgb24gU1ZHXG4gIC8vIG5hbWVzcGFjZWQgZWxlbWVudHMuIFNvIGhlcmUgYSB3cmFwcGVyIGlzIHVzZWQuXG4gIGxldCB3cmFwcGVkSHRtbCA9ICc8c3ZnPicgKyBodG1sICsgJzwvc3ZnPic7XG5cbiAgZGl2LmlubmVySFRNTCA9IHdyYXBwZWRIdG1sO1xuXG4gIGxldCBbZmlyc3QsIGxhc3RdID0gbW92ZU5vZGVzQmVmb3JlKGRpdi5maXJzdENoaWxkIGFzIE5vZGUsIHBhcmVudCwgcmVmZXJlbmNlKTtcbiAgcmV0dXJuIG5ldyBDb25jcmV0ZUJvdW5kcyhwYXJlbnQsIGZpcnN0LCBsYXN0KTtcbn1cblxuZnVuY3Rpb24gc2hvdWxkQXBwbHlGaXgoZG9jdW1lbnQ6IERvY3VtZW50LCBzdmdOYW1lc3BhY2U6IFNWR19OQU1FU1BBQ0UpIHtcbiAgbGV0IHN2ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhzdmdOYW1lc3BhY2UsICdzdmcnKTtcblxuICB0cnkge1xuICAgIHN2Z1snaW5zZXJ0QWRqYWNlbnRIVE1MJ10oJ2JlZm9yZWVuZCcsICc8Y2lyY2xlPjwvY2lyY2xlPicpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgLy8gSUUsIEVkZ2U6IFdpbGwgdGhyb3csIGluc2VydEFkamFjZW50SFRNTCBpcyB1bnN1cHBvcnRlZCBvbiBTVkdcbiAgICAvLyBTYWZhcmk6IFdpbGwgdGhyb3csIGluc2VydEFkamFjZW50SFRNTCBpcyBub3QgcHJlc2VudCBvbiBTVkdcbiAgfSBmaW5hbGx5IHtcbiAgICAvLyBGRjogT2xkIHZlcnNpb25zIHdpbGwgY3JlYXRlIGEgbm9kZSBpbiB0aGUgd3JvbmcgbmFtZXNwYWNlXG4gICAgaWYgKHN2Zy5jaGlsZE5vZGVzLmxlbmd0aCA9PT0gMSAmJiB1bndyYXAoc3ZnLmZpcnN0Q2hpbGQpLm5hbWVzcGFjZVVSSSA9PT0gU1ZHX05BTUVTUEFDRSkge1xuICAgICAgLy8gVGhlIHRlc3Qgd29ya2VkIGFzIGV4cGVjdGVkLCBubyBmaXggcmVxdWlyZWRcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxufVxuIl19","// Patch:    Adjacent text node merging fix\n// Browsers: IE, Edge, Firefox w/o inspector open\n// Reason:   These browsers will merge adjacent text nodes. For exmaple given\n//           <div>Hello</div> with div.insertAdjacentHTML(' world') browsers\n//           with proper behavior will populate div.childNodes with two items.\n//           These browsers will populate it with one merged node instead.\n// Fix:      Add these nodes to a wrapper element, then iterate the childNodes\n//           of that wrapper and move the nodes to their target location. Note\n//           that potential SVG bugs will have been handled before this fix.\n//           Note that this fix must only apply to the previous text node, as\n//           the base implementation of `insertHTMLBefore` already handles\n//           following text nodes correctly.\nexport function applyTextNodeMergingFix(document, DOMClass) {\n    if (!document) return DOMClass;\n    if (!shouldApplyFix(document)) {\n        return DOMClass;\n    }\n    return class DOMChangesWithTextNodeMergingFix extends DOMClass {\n        constructor(document) {\n            super(document);\n            this.uselessComment = document.createComment('');\n        }\n        insertHTMLBefore(parent, nextSibling, html) {\n            if (html === null) {\n                return super.insertHTMLBefore(parent, nextSibling, html);\n            }\n            let didSetUselessComment = false;\n            let nextPrevious = nextSibling ? nextSibling.previousSibling : parent.lastChild;\n            if (nextPrevious && nextPrevious instanceof Text) {\n                didSetUselessComment = true;\n                parent.insertBefore(this.uselessComment, nextSibling);\n            }\n            let bounds = super.insertHTMLBefore(parent, nextSibling, html);\n            if (didSetUselessComment) {\n                parent.removeChild(this.uselessComment);\n            }\n            return bounds;\n        }\n    };\n}\nfunction shouldApplyFix(document) {\n    let mergingTextDiv = document.createElement('div');\n    mergingTextDiv.innerHTML = 'first';\n    mergingTextDiv.insertAdjacentHTML('beforeend', 'second');\n    if (mergingTextDiv.childNodes.length === 2) {\n        // It worked as expected, no fix required\n        return false;\n    }\n    return true;\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGV4dC1ub2RlLW1lcmdpbmctZml4LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcGFja2FnZXMvQGdsaW1tZXIvcnVudGltZS9saWIvY29tcGF0L3RleHQtbm9kZS1tZXJnaW5nLWZpeC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFJQSxBQUEyQztBQUMzQyxBQUFpRDtBQUNqRCxBQUE2RTtBQUM3RSxBQUE0RTtBQUM1RSxBQUE4RTtBQUM5RSxBQUEwRTtBQUMxRSxBQUE4RTtBQUM5RSxBQUE4RTtBQUM5RSxBQUE0RTtBQUM1RSxBQUE2RTtBQUM3RSxBQUEwRTtBQUMxRSxBQUE0QztBQUM1QyxBQUFNLHdDQUFrQyxBQUEwQixVQUFFLEFBQThCO0FBQ2hHLEFBQUUsQUFBQyxRQUFDLENBQUMsQUFBUSxBQUFDLFVBQUMsQUFBTSxPQUFDLEFBQVEsQUFBQztBQUUvQixBQUFFLEFBQUMsUUFBQyxDQUFDLEFBQWMsZUFBQyxBQUFRLEFBQUMsQUFBQyxXQUFDLEFBQUM7QUFDOUIsQUFBTSxlQUFDLEFBQVEsQUFBQyxBQUNsQjtBQUFDO0FBRUQsQUFBTSxXQUFDLE1BQXVDLHlDQUFRLEFBQVE7QUFHNUQsb0JBQVksQUFBa0I7QUFDNUIsQUFBSyxrQkFBQyxBQUFRLEFBQUMsQUFBQztBQUNoQixBQUFJLGlCQUFDLEFBQWMsaUJBQUcsQUFBUSxTQUFDLEFBQWEsY0FBQyxBQUFFLEFBQUMsQUFBQyxBQUNuRDtBQUFDO0FBRUQsQUFBZ0IseUJBQUMsQUFBbUIsUUFBRSxBQUFpQixhQUFFLEFBQVk7QUFDbkUsQUFBRSxBQUFDLGdCQUFDLEFBQUksU0FBSyxBQUFJLEFBQUMsTUFBQyxBQUFDO0FBQ2xCLEFBQU0sdUJBQUMsQUFBSyxNQUFDLEFBQWdCLGlCQUFDLEFBQU0sUUFBRSxBQUFXLGFBQUUsQUFBSSxBQUFDLEFBQUMsQUFDM0Q7QUFBQztBQUVELGdCQUFJLEFBQW9CLHVCQUFHLEFBQUssQUFBQztBQUVqQyxnQkFBSSxBQUFZLGVBQUcsQUFBVyxjQUFHLEFBQVcsWUFBQyxBQUFlLGtCQUFHLEFBQU0sT0FBQyxBQUFTLEFBQUM7QUFDaEYsQUFBRSxBQUFDLGdCQUFDLEFBQVksZ0JBQUksQUFBWSx3QkFBWSxBQUFJLEFBQUMsTUFBQyxBQUFDO0FBQ2pELEFBQW9CLHVDQUFHLEFBQUksQUFBQztBQUM1QixBQUFNLHVCQUFDLEFBQVksYUFBQyxBQUFJLEtBQUMsQUFBYyxnQkFBRSxBQUFXLEFBQUMsQUFBQyxBQUN4RDtBQUFDO0FBRUQsZ0JBQUksQUFBTSxTQUFHLEFBQUssTUFBQyxBQUFnQixpQkFBQyxBQUFNLFFBQUUsQUFBVyxhQUFFLEFBQUksQUFBQyxBQUFDO0FBRS9ELEFBQUUsQUFBQyxnQkFBQyxBQUFvQixBQUFDLHNCQUFDLEFBQUM7QUFDekIsQUFBTSx1QkFBQyxBQUFXLFlBQUMsQUFBSSxLQUFDLEFBQWMsQUFBQyxBQUFDLEFBQzFDO0FBQUM7QUFFRCxBQUFNLG1CQUFDLEFBQU0sQUFBQyxBQUNoQjtBQUFDLEFBQ0YsQUFBQyxBQUNKOztBQUFDO0FBRUQsd0JBQXdCLEFBQWtCO0FBQ3hDLFFBQUksQUFBYyxpQkFBbUIsQUFBUSxTQUFDLEFBQWEsY0FBQyxBQUFLLEFBQUMsQUFBQztBQUVuRSxBQUFjLG1CQUFDLEFBQVMsWUFBRyxBQUFPLEFBQUM7QUFDbkMsQUFBYyxtQkFBQyxBQUFrQixtQkFBQyxBQUFXLGFBQUUsQUFBUSxBQUFDLEFBQUM7QUFFekQsQUFBRSxBQUFDLFFBQUMsQUFBYyxlQUFDLEFBQVUsV0FBQyxBQUFNLFdBQUssQUFBQyxBQUFDLEdBQUMsQUFBQztBQUMzQyxBQUF5QztBQUN6QyxBQUFNLGVBQUMsQUFBSyxBQUFDLEFBQ2Y7QUFBQztBQUVELEFBQU0sV0FBQyxBQUFJLEFBQUMsQUFDZDtBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQm91bmRzIH0gZnJvbSAnLi4vYm91bmRzJztcbmltcG9ydCB7IERPTU9wZXJhdGlvbnMgfSBmcm9tICcuLi9kb20vaGVscGVyJztcbmltcG9ydCB7IE9wdGlvbiB9IGZyb20gJ0BnbGltbWVyL3V0aWwnO1xuXG4vLyBQYXRjaDogICAgQWRqYWNlbnQgdGV4dCBub2RlIG1lcmdpbmcgZml4XG4vLyBCcm93c2VyczogSUUsIEVkZ2UsIEZpcmVmb3ggdy9vIGluc3BlY3RvciBvcGVuXG4vLyBSZWFzb246ICAgVGhlc2UgYnJvd3NlcnMgd2lsbCBtZXJnZSBhZGphY2VudCB0ZXh0IG5vZGVzLiBGb3IgZXhtYXBsZSBnaXZlblxuLy8gICAgICAgICAgIDxkaXY+SGVsbG88L2Rpdj4gd2l0aCBkaXYuaW5zZXJ0QWRqYWNlbnRIVE1MKCcgd29ybGQnKSBicm93c2Vyc1xuLy8gICAgICAgICAgIHdpdGggcHJvcGVyIGJlaGF2aW9yIHdpbGwgcG9wdWxhdGUgZGl2LmNoaWxkTm9kZXMgd2l0aCB0d28gaXRlbXMuXG4vLyAgICAgICAgICAgVGhlc2UgYnJvd3NlcnMgd2lsbCBwb3B1bGF0ZSBpdCB3aXRoIG9uZSBtZXJnZWQgbm9kZSBpbnN0ZWFkLlxuLy8gRml4OiAgICAgIEFkZCB0aGVzZSBub2RlcyB0byBhIHdyYXBwZXIgZWxlbWVudCwgdGhlbiBpdGVyYXRlIHRoZSBjaGlsZE5vZGVzXG4vLyAgICAgICAgICAgb2YgdGhhdCB3cmFwcGVyIGFuZCBtb3ZlIHRoZSBub2RlcyB0byB0aGVpciB0YXJnZXQgbG9jYXRpb24uIE5vdGVcbi8vICAgICAgICAgICB0aGF0IHBvdGVudGlhbCBTVkcgYnVncyB3aWxsIGhhdmUgYmVlbiBoYW5kbGVkIGJlZm9yZSB0aGlzIGZpeC5cbi8vICAgICAgICAgICBOb3RlIHRoYXQgdGhpcyBmaXggbXVzdCBvbmx5IGFwcGx5IHRvIHRoZSBwcmV2aW91cyB0ZXh0IG5vZGUsIGFzXG4vLyAgICAgICAgICAgdGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYGluc2VydEhUTUxCZWZvcmVgIGFscmVhZHkgaGFuZGxlc1xuLy8gICAgICAgICAgIGZvbGxvd2luZyB0ZXh0IG5vZGVzIGNvcnJlY3RseS5cbmV4cG9ydCBmdW5jdGlvbiBhcHBseVRleHROb2RlTWVyZ2luZ0ZpeChkb2N1bWVudDogT3B0aW9uPERvY3VtZW50PiwgRE9NQ2xhc3M6IHR5cGVvZiBET01PcGVyYXRpb25zKTogdHlwZW9mIERPTU9wZXJhdGlvbnMge1xuICBpZiAoIWRvY3VtZW50KSByZXR1cm4gRE9NQ2xhc3M7XG5cbiAgaWYgKCFzaG91bGRBcHBseUZpeChkb2N1bWVudCkpIHtcbiAgICByZXR1cm4gRE9NQ2xhc3M7XG4gIH1cblxuICByZXR1cm4gY2xhc3MgRE9NQ2hhbmdlc1dpdGhUZXh0Tm9kZU1lcmdpbmdGaXggZXh0ZW5kcyBET01DbGFzcyB7XG4gICAgcHJpdmF0ZSB1c2VsZXNzQ29tbWVudDogQ29tbWVudDtcblxuICAgIGNvbnN0cnVjdG9yKGRvY3VtZW50OiBEb2N1bWVudCkge1xuICAgICAgc3VwZXIoZG9jdW1lbnQpO1xuICAgICAgdGhpcy51c2VsZXNzQ29tbWVudCA9IGRvY3VtZW50LmNyZWF0ZUNvbW1lbnQoJycpO1xuICAgIH1cblxuICAgIGluc2VydEhUTUxCZWZvcmUocGFyZW50OiBIVE1MRWxlbWVudCwgbmV4dFNpYmxpbmc6IE5vZGUsIGh0bWw6IHN0cmluZyk6IEJvdW5kcyB7XG4gICAgICBpZiAoaHRtbCA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gc3VwZXIuaW5zZXJ0SFRNTEJlZm9yZShwYXJlbnQsIG5leHRTaWJsaW5nLCBodG1sKTtcbiAgICAgIH1cblxuICAgICAgbGV0IGRpZFNldFVzZWxlc3NDb21tZW50ID0gZmFsc2U7XG5cbiAgICAgIGxldCBuZXh0UHJldmlvdXMgPSBuZXh0U2libGluZyA/IG5leHRTaWJsaW5nLnByZXZpb3VzU2libGluZyA6IHBhcmVudC5sYXN0Q2hpbGQ7XG4gICAgICBpZiAobmV4dFByZXZpb3VzICYmIG5leHRQcmV2aW91cyBpbnN0YW5jZW9mIFRleHQpIHtcbiAgICAgICAgZGlkU2V0VXNlbGVzc0NvbW1lbnQgPSB0cnVlO1xuICAgICAgICBwYXJlbnQuaW5zZXJ0QmVmb3JlKHRoaXMudXNlbGVzc0NvbW1lbnQsIG5leHRTaWJsaW5nKTtcbiAgICAgIH1cblxuICAgICAgbGV0IGJvdW5kcyA9IHN1cGVyLmluc2VydEhUTUxCZWZvcmUocGFyZW50LCBuZXh0U2libGluZywgaHRtbCk7XG5cbiAgICAgIGlmIChkaWRTZXRVc2VsZXNzQ29tbWVudCkge1xuICAgICAgICBwYXJlbnQucmVtb3ZlQ2hpbGQodGhpcy51c2VsZXNzQ29tbWVudCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBib3VuZHM7XG4gICAgfVxuICB9O1xufVxuXG5mdW5jdGlvbiBzaG91bGRBcHBseUZpeChkb2N1bWVudDogRG9jdW1lbnQpIHtcbiAgbGV0IG1lcmdpbmdUZXh0RGl2OiBIVE1MRGl2RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXG4gIG1lcmdpbmdUZXh0RGl2LmlubmVySFRNTCA9ICdmaXJzdCc7XG4gIG1lcmdpbmdUZXh0RGl2Lmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlZW5kJywgJ3NlY29uZCcpO1xuXG4gIGlmIChtZXJnaW5nVGV4dERpdi5jaGlsZE5vZGVzLmxlbmd0aCA9PT0gMikge1xuICAgIC8vIEl0IHdvcmtlZCBhcyBleHBlY3RlZCwgbm8gZml4IHJlcXVpcmVkXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgcmV0dXJuIHRydWU7XG59XG4iXX0=","import { ConcreteBounds } from '../bounds';\nimport { applySVGInnerHTMLFix } from '../compat/svg-inner-html-fix';\nimport { applyTextNodeMergingFix } from '../compat/text-node-merging-fix';\nexport const SVG_NAMESPACE = 'http://www.w3.org/2000/svg';\n// http://www.w3.org/TR/html/syntax.html#html-integration-point\nconst SVG_INTEGRATION_POINTS = { foreignObject: 1, desc: 1, title: 1 };\n// http://www.w3.org/TR/html/syntax.html#adjust-svg-attributes\n// TODO: Adjust SVG attributes\n// http://www.w3.org/TR/html/syntax.html#parsing-main-inforeign\n// TODO: Adjust SVG elements\n// http://www.w3.org/TR/html/syntax.html#parsing-main-inforeign\nexport const BLACKLIST_TABLE = Object.create(null);\n[\"b\", \"big\", \"blockquote\", \"body\", \"br\", \"center\", \"code\", \"dd\", \"div\", \"dl\", \"dt\", \"em\", \"embed\", \"h1\", \"h2\", \"h3\", \"h4\", \"h5\", \"h6\", \"head\", \"hr\", \"i\", \"img\", \"li\", \"listing\", \"main\", \"meta\", \"nobr\", \"ol\", \"p\", \"pre\", \"ruby\", \"s\", \"small\", \"span\", \"strong\", \"strike\", \"sub\", \"sup\", \"table\", \"tt\", \"u\", \"ul\", \"var\"].forEach(tag => BLACKLIST_TABLE[tag] = 1);\nconst WHITESPACE = /[\\t-\\r \\xA0\\u1680\\u180E\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF]/;\nlet doc = typeof document === 'undefined' ? null : document;\nexport function isWhitespace(string) {\n    return WHITESPACE.test(string);\n}\nexport function moveNodesBefore(source, target, nextSibling) {\n    let first = source.firstChild;\n    let last = null;\n    let current = first;\n    while (current) {\n        last = current;\n        current = current.nextSibling;\n        target.insertBefore(last, nextSibling);\n    }\n    return [first, last];\n}\nexport class DOMOperations {\n    constructor(document) {\n        this.document = document;\n        this.setupUselessElement();\n    }\n    // split into seperate method so that NodeDOMTreeConstruction\n    // can override it.\n    setupUselessElement() {\n        this.uselessElement = this.document.createElement('div');\n    }\n    createElement(tag, context) {\n        let isElementInSVGNamespace, isHTMLIntegrationPoint;\n        if (context) {\n            isElementInSVGNamespace = context.namespaceURI === SVG_NAMESPACE || tag === 'svg';\n            isHTMLIntegrationPoint = SVG_INTEGRATION_POINTS[context.tagName];\n        } else {\n            isElementInSVGNamespace = tag === 'svg';\n            isHTMLIntegrationPoint = false;\n        }\n        if (isElementInSVGNamespace && !isHTMLIntegrationPoint) {\n            // FIXME: This does not properly handle <font> with color, face, or\n            // size attributes, which is also disallowed by the spec. We should fix\n            // this.\n            if (BLACKLIST_TABLE[tag]) {\n                throw new Error(`Cannot create a ${tag} inside an SVG context`);\n            }\n            return this.document.createElementNS(SVG_NAMESPACE, tag);\n        } else {\n            return this.document.createElement(tag);\n        }\n    }\n    insertBefore(parent, node, reference) {\n        parent.insertBefore(node, reference);\n    }\n    insertHTMLBefore(_parent, nextSibling, html) {\n        return insertHTMLBefore(this.uselessElement, _parent, nextSibling, html);\n    }\n    createTextNode(text) {\n        return this.document.createTextNode(text);\n    }\n    createComment(data) {\n        return this.document.createComment(data);\n    }\n}\nexport var DOM;\n(function (DOM) {\n    class TreeConstruction extends DOMOperations {\n        createElementNS(namespace, tag) {\n            return this.document.createElementNS(namespace, tag);\n        }\n        setAttribute(element, name, value, namespace = null) {\n            if (namespace) {\n                element.setAttributeNS(namespace, name, value);\n            } else {\n                element.setAttribute(name, value);\n            }\n        }\n    }\n    DOM.TreeConstruction = TreeConstruction;\n    let appliedTreeContruction = TreeConstruction;\n    appliedTreeContruction = applyTextNodeMergingFix(doc, appliedTreeContruction);\n    appliedTreeContruction = applySVGInnerHTMLFix(doc, appliedTreeContruction, SVG_NAMESPACE);\n    DOM.DOMTreeConstruction = appliedTreeContruction;\n})(DOM || (DOM = {}));\nexport class DOMChanges extends DOMOperations {\n    constructor(document) {\n        super(document);\n        this.document = document;\n        this.namespace = null;\n    }\n    setAttribute(element, name, value) {\n        element.setAttribute(name, value);\n    }\n    removeAttribute(element, name) {\n        element.removeAttribute(name);\n    }\n    insertAfter(element, node, reference) {\n        this.insertBefore(element, node, reference.nextSibling);\n    }\n}\nexport function insertHTMLBefore(_useless, _parent, _nextSibling, html) {\n    // TypeScript vendored an old version of the DOM spec where `insertAdjacentHTML`\n    // only exists on `HTMLElement` but not on `Element`. We actually work with the\n    // newer version of the DOM API here (and monkey-patch this method in `./compat`\n    // when we detect older browsers). This is a hack to work around this limitation.\n    let parent = _parent;\n    let useless = _useless;\n    let nextSibling = _nextSibling;\n    let prev = nextSibling ? nextSibling.previousSibling : parent.lastChild;\n    let last;\n    if (html === null || html === '') {\n        return new ConcreteBounds(parent, null, null);\n    }\n    if (nextSibling === null) {\n        parent.insertAdjacentHTML('beforeend', html);\n        last = parent.lastChild;\n    } else if (nextSibling instanceof HTMLElement) {\n        nextSibling.insertAdjacentHTML('beforebegin', html);\n        last = nextSibling.previousSibling;\n    } else {\n        // Non-element nodes do not support insertAdjacentHTML, so add an\n        // element and call it on that element. Then remove the element.\n        //\n        // This also protects Edge, IE and Firefox w/o the inspector open\n        // from merging adjacent text nodes. See ./compat/text-node-merging-fix.ts\n        parent.insertBefore(useless, nextSibling);\n        useless.insertAdjacentHTML('beforebegin', html);\n        last = useless.previousSibling;\n        parent.removeChild(useless);\n    }\n    let first = prev ? prev.nextSibling : parent.firstChild;\n    return new ConcreteBounds(parent, first, last);\n}\nlet helper = DOMChanges;\nhelper = applyTextNodeMergingFix(doc, helper);\nhelper = applySVGInnerHTMLFix(doc, helper, SVG_NAMESPACE);\nexport default helper;\nexport const DOMTreeConstruction = DOM.DOMTreeConstruction;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGVscGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcGFja2FnZXMvQGdsaW1tZXIvcnVudGltZS9saWIvZG9tL2hlbHBlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxBQUFPLFNBQVUsQUFBYyxBQUFFLHNCQUFNLEFBQVcsQUFBQztBQUNuRCxBQUFPLFNBQ0wsQUFBb0IsQUFDckIsNEJBQU0sQUFBOEIsQUFBQztBQUN0QyxBQUFPLFNBQ0wsQUFBdUIsQUFDeEIsK0JBQU0sQUFBaUMsQUFBQztBQUt6QyxBQUFNLE9BQUMsTUFBTSxBQUFhLGdCQUFHLEFBQTRCLEFBQUM7QUFFMUQsQUFBK0Q7QUFDL0QsTUFBTSxBQUFzQix5QkFBRyxFQUFFLEFBQWEsZUFBRSxBQUFDLEdBQUUsQUFBSSxNQUFFLEFBQUMsR0FBRSxBQUFLLE9BQUUsQUFBQyxBQUFFLEFBQUM7QUFFdkUsQUFBOEQ7QUFDOUQsQUFBOEI7QUFFOUIsQUFBK0Q7QUFDL0QsQUFBNEI7QUFFNUIsQUFBK0Q7QUFDL0QsQUFBTSxPQUFDLE1BQU0sQUFBZSxrQkFBRyxBQUFNLE9BQUMsQUFBTSxPQUFDLEFBQUksQUFBQyxBQUFDO0FBRWxELENBQ0MsQUFBRyxLQUFFLEFBQUssT0FBRSxBQUFZLGNBQUUsQUFBTSxRQUFFLEFBQUksTUFBRSxBQUFRLFVBQUUsQUFBTSxRQUFFLEFBQUksTUFBRSxBQUFLLE9BQUUsQUFBSSxNQUFFLEFBQUksTUFBRSxBQUFJLE1BQUUsQUFBTyxTQUNoRyxBQUFJLE1BQUUsQUFBSSxNQUFFLEFBQUksTUFBRSxBQUFJLE1BQUUsQUFBSSxNQUFFLEFBQUksTUFBRSxBQUFNLFFBQUUsQUFBSSxNQUFFLEFBQUcsS0FBRSxBQUFLLE9BQUUsQUFBSSxNQUFFLEFBQVMsV0FBRSxBQUFNLFFBQUUsQUFBTSxRQUFFLEFBQU0sUUFDckcsQUFBSSxNQUFFLEFBQUcsS0FBRSxBQUFLLE9BQUUsQUFBTSxRQUFFLEFBQUcsS0FBRSxBQUFPLFNB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QUFBdUIsd0JBQUMsQUFBRyxLQUFFLEFBQU0sQUFBc0IsQUFBQztBQUNuRSxBQUFNLFNBQUcsQUFBb0IscUJBQUMsQUFBRyxLQUFFLEFBQU0sUUFBRSxBQUFhLEFBQXNCLEFBQUM7QUFFL0UsZUFBZSxBQUFNLEFBQUM7QUFDdEIsQUFBTSxPQUFDLE1BQU0sQUFBbUIsc0JBQUcsQUFBRyxJQUFDLEFBQW1CLEFBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCb3VuZHMsIENvbmNyZXRlQm91bmRzIH0gZnJvbSAnLi4vYm91bmRzJztcbmltcG9ydCB7XG4gIGFwcGx5U1ZHSW5uZXJIVE1MRml4XG59IGZyb20gJy4uL2NvbXBhdC9zdmctaW5uZXItaHRtbC1maXgnO1xuaW1wb3J0IHtcbiAgYXBwbHlUZXh0Tm9kZU1lcmdpbmdGaXhcbn0gZnJvbSAnLi4vY29tcGF0L3RleHQtbm9kZS1tZXJnaW5nLWZpeCc7XG5pbXBvcnQgeyBTaW1wbGUgfSBmcm9tICdAZ2xpbW1lci9pbnRlcmZhY2VzJztcblxuaW1wb3J0IHsgT3B0aW9uIH0gZnJvbSAnQGdsaW1tZXIvdXRpbCc7XG5cbmV4cG9ydCBjb25zdCBTVkdfTkFNRVNQQUNFID0gJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJztcblxuLy8gaHR0cDovL3d3dy53My5vcmcvVFIvaHRtbC9zeW50YXguaHRtbCNodG1sLWludGVncmF0aW9uLXBvaW50XG5jb25zdCBTVkdfSU5URUdSQVRJT05fUE9JTlRTID0geyBmb3JlaWduT2JqZWN0OiAxLCBkZXNjOiAxLCB0aXRsZTogMSB9O1xuXG4vLyBodHRwOi8vd3d3LnczLm9yZy9UUi9odG1sL3N5bnRheC5odG1sI2FkanVzdC1zdmctYXR0cmlidXRlc1xuLy8gVE9ETzogQWRqdXN0IFNWRyBhdHRyaWJ1dGVzXG5cbi8vIGh0dHA6Ly93d3cudzMub3JnL1RSL2h0bWwvc3ludGF4Lmh0bWwjcGFyc2luZy1tYWluLWluZm9yZWlnblxuLy8gVE9ETzogQWRqdXN0IFNWRyBlbGVtZW50c1xuXG4vLyBodHRwOi8vd3d3LnczLm9yZy9UUi9odG1sL3N5bnRheC5odG1sI3BhcnNpbmctbWFpbi1pbmZvcmVpZ25cbmV4cG9ydCBjb25zdCBCTEFDS0xJU1RfVEFCTEUgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuXG4oW1xuICBcImJcIiwgXCJiaWdcIiwgXCJibG9ja3F1b3RlXCIsIFwiYm9keVwiLCBcImJyXCIsIFwiY2VudGVyXCIsIFwiY29kZVwiLCBcImRkXCIsIFwiZGl2XCIsIFwiZGxcIiwgXCJkdFwiLCBcImVtXCIsIFwiZW1iZWRcIixcbiAgXCJoMVwiLCBcImgyXCIsIFwiaDNcIiwgXCJoNFwiLCBcImg1XCIsIFwiaDZcIiwgXCJoZWFkXCIsIFwiaHJcIiwgXCJpXCIsIFwiaW1nXCIsIFwibGlcIiwgXCJsaXN0aW5nXCIsIFwibWFpblwiLCBcIm1ldGFcIiwgXCJub2JyXCIsXG4gIFwib2xcIiwgXCJwXCIsIFwicHJlXCIsIFwicnVieVwiLCBcInNcIiwgXCJzbWFsbFwiLCBcInNwYW5cIiwgXCJzdHJvbmdcIiwgXCJzdHJpa2VcIiwgXCJzdWJcIiwgXCJzdXBcIiwgXCJ0YWJsZVwiLCBcInR0XCIsIFwidVwiLFxuICBcInVsXCIsIFwidmFyXCJcbl0pLmZvckVhY2godGFnID0+IEJMQUNLTElTVF9UQUJMRVt0YWddID0gMSk7XG5cbmNvbnN0IFdISVRFU1BBQ0UgPSAvW1xcdC1cXHIgXFx4QTBcXHUxNjgwXFx1MTgwRVxcdTIwMDAtXFx1MjAwQVxcdTIwMjhcXHUyMDI5XFx1MjAyRlxcdTIwNUZcXHUzMDAwXFx1RkVGRl0vO1xuXG5sZXQgZG9jOiBPcHRpb248RG9jdW1lbnQ+ID0gdHlwZW9mIGRvY3VtZW50ID09PSAndW5kZWZpbmVkJyA/IG51bGwgOiBkb2N1bWVudDtcblxuZXhwb3J0IGZ1bmN0aW9uIGlzV2hpdGVzcGFjZShzdHJpbmc6IHN0cmluZykge1xuICByZXR1cm4gV0hJVEVTUEFDRS50ZXN0KHN0cmluZyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtb3ZlTm9kZXNCZWZvcmUoc291cmNlOiBTaW1wbGUuTm9kZSwgdGFyZ2V0OiBTaW1wbGUuRWxlbWVudCwgbmV4dFNpYmxpbmc6IFNpbXBsZS5Ob2RlKSB7XG4gIGxldCBmaXJzdCA9IHNvdXJjZS5maXJzdENoaWxkO1xuICBsZXQgbGFzdDogU2ltcGxlLk5vZGUgfCBudWxsID0gbnVsbDtcbiAgbGV0IGN1cnJlbnQgPSBmaXJzdDtcbiAgd2hpbGUgKGN1cnJlbnQpIHtcbiAgICBsYXN0ID0gY3VycmVudDtcbiAgICBjdXJyZW50ID0gY3VycmVudC5uZXh0U2libGluZztcbiAgICB0YXJnZXQuaW5zZXJ0QmVmb3JlKGxhc3QsIG5leHRTaWJsaW5nKTtcbiAgfVxuICByZXR1cm4gW2ZpcnN0LCBsYXN0XTtcbn1cblxuZXhwb3J0IGNsYXNzIERPTU9wZXJhdGlvbnMge1xuICBwcm90ZWN0ZWQgdXNlbGVzc0VsZW1lbnQ6IEhUTUxFbGVtZW50O1xuXG4gIGNvbnN0cnVjdG9yKHByb3RlY3RlZCBkb2N1bWVudDogU2ltcGxlLkRvY3VtZW50KSB7XG4gICAgdGhpcy5zZXR1cFVzZWxlc3NFbGVtZW50KCk7XG4gIH1cblxuICAvLyBzcGxpdCBpbnRvIHNlcGVyYXRlIG1ldGhvZCBzbyB0aGF0IE5vZGVET01UcmVlQ29uc3RydWN0aW9uXG4gIC8vIGNhbiBvdmVycmlkZSBpdC5cbiAgcHJvdGVjdGVkIHNldHVwVXNlbGVzc0VsZW1lbnQoKSB7XG4gICAgdGhpcy51c2VsZXNzRWxlbWVudCA9IHRoaXMuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JykgYXMgSFRNTEVsZW1lbnQ7XG4gIH1cblxuICBjcmVhdGVFbGVtZW50KHRhZzogc3RyaW5nLCBjb250ZXh0PzogU2ltcGxlLkVsZW1lbnQpOiBTaW1wbGUuRWxlbWVudCB7XG4gICAgbGV0IGlzRWxlbWVudEluU1ZHTmFtZXNwYWNlOiBib29sZWFuLCBpc0hUTUxJbnRlZ3JhdGlvblBvaW50OiBib29sZWFuO1xuXG4gICAgaWYgKGNvbnRleHQpIHtcbiAgICAgIGlzRWxlbWVudEluU1ZHTmFtZXNwYWNlID0gY29udGV4dC5uYW1lc3BhY2VVUkkgPT09IFNWR19OQU1FU1BBQ0UgfHwgdGFnID09PSAnc3ZnJztcbiAgICAgIGlzSFRNTEludGVncmF0aW9uUG9pbnQgPSBTVkdfSU5URUdSQVRJT05fUE9JTlRTW2NvbnRleHQudGFnTmFtZV07XG4gICAgfSBlbHNlIHtcbiAgICAgIGlzRWxlbWVudEluU1ZHTmFtZXNwYWNlID0gdGFnID09PSAnc3ZnJztcbiAgICAgIGlzSFRNTEludGVncmF0aW9uUG9pbnQgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAoaXNFbGVtZW50SW5TVkdOYW1lc3BhY2UgJiYgIWlzSFRNTEludGVncmF0aW9uUG9pbnQpIHtcbiAgICAgIC8vIEZJWE1FOiBUaGlzIGRvZXMgbm90IHByb3Blcmx5IGhhbmRsZSA8Zm9udD4gd2l0aCBjb2xvciwgZmFjZSwgb3JcbiAgICAgIC8vIHNpemUgYXR0cmlidXRlcywgd2hpY2ggaXMgYWxzbyBkaXNhbGxvd2VkIGJ5IHRoZSBzcGVjLiBXZSBzaG91bGQgZml4XG4gICAgICAvLyB0aGlzLlxuICAgICAgaWYgKEJMQUNLTElTVF9UQUJMRVt0YWddKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgQ2Fubm90IGNyZWF0ZSBhICR7dGFnfSBpbnNpZGUgYW4gU1ZHIGNvbnRleHRgKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMuZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKFNWR19OQU1FU1BBQ0UsIHRhZyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGFnKTtcbiAgICB9XG4gIH1cblxuICBpbnNlcnRCZWZvcmUocGFyZW50OiBTaW1wbGUuRWxlbWVudCwgbm9kZTogU2ltcGxlLk5vZGUsIHJlZmVyZW5jZTogT3B0aW9uPFNpbXBsZS5Ob2RlPikge1xuICAgIHBhcmVudC5pbnNlcnRCZWZvcmUobm9kZSwgcmVmZXJlbmNlKTtcbiAgfVxuXG4gIGluc2VydEhUTUxCZWZvcmUoX3BhcmVudDogU2ltcGxlLkVsZW1lbnQsIG5leHRTaWJsaW5nOiBPcHRpb248U2ltcGxlLk5vZGU+LCBodG1sOiBzdHJpbmcpOiBCb3VuZHMge1xuICAgIHJldHVybiBpbnNlcnRIVE1MQmVmb3JlKHRoaXMudXNlbGVzc0VsZW1lbnQsIF9wYXJlbnQsIG5leHRTaWJsaW5nLCBodG1sKTtcbiAgfVxuXG4gIGNyZWF0ZVRleHROb2RlKHRleHQ6IHN0cmluZyk6IFNpbXBsZS5UZXh0IHtcbiAgICByZXR1cm4gdGhpcy5kb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0ZXh0KTtcbiAgfVxuXG4gIGNyZWF0ZUNvbW1lbnQoZGF0YTogc3RyaW5nKTogU2ltcGxlLkNvbW1lbnQge1xuICAgIHJldHVybiB0aGlzLmRvY3VtZW50LmNyZWF0ZUNvbW1lbnQoZGF0YSk7XG4gIH1cbn1cblxuZXhwb3J0IG5hbWVzcGFjZSBET00ge1xuICBleHBvcnQgdHlwZSBOb2RlID0gU2ltcGxlLk5vZGU7XG4gIGV4cG9ydCB0eXBlIEVsZW1lbnQgPSBTaW1wbGUuRWxlbWVudDtcbiAgZXhwb3J0IHR5cGUgRG9jdW1lbnQgPSBTaW1wbGUuRG9jdW1lbnQ7XG4gIGV4cG9ydCB0eXBlIENvbW1lbnQgPSBTaW1wbGUuQ29tbWVudDtcbiAgZXhwb3J0IHR5cGUgVGV4dCA9IFNpbXBsZS5UZXh0O1xuICBleHBvcnQgdHlwZSBOYW1lc3BhY2UgPSBTaW1wbGUuTmFtZXNwYWNlO1xuICBleHBvcnQgdHlwZSBIVE1MRWxlbWVudCA9IFNpbXBsZS5IVE1MRWxlbWVudDtcblxuICBleHBvcnQgY2xhc3MgVHJlZUNvbnN0cnVjdGlvbiBleHRlbmRzIERPTU9wZXJhdGlvbnMge1xuICAgIGNyZWF0ZUVsZW1lbnROUyhuYW1lc3BhY2U6IE5hbWVzcGFjZSwgdGFnOiBzdHJpbmcpOiBFbGVtZW50IHtcbiAgICAgIHJldHVybiB0aGlzLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhuYW1lc3BhY2UsIHRhZyk7XG4gICAgfVxuXG4gICAgc2V0QXR0cmlidXRlKGVsZW1lbnQ6IEVsZW1lbnQsIG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgbmFtZXNwYWNlOiBPcHRpb248c3RyaW5nPiA9IG51bGwpIHtcbiAgICAgIGlmIChuYW1lc3BhY2UpIHtcbiAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGVOUyhuYW1lc3BhY2UsIG5hbWUsIHZhbHVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKG5hbWUsIHZhbHVlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBsZXQgYXBwbGllZFRyZWVDb250cnVjdGlvbiA9IFRyZWVDb25zdHJ1Y3Rpb247XG4gIGFwcGxpZWRUcmVlQ29udHJ1Y3Rpb24gPSBhcHBseVRleHROb2RlTWVyZ2luZ0ZpeChkb2MsIGFwcGxpZWRUcmVlQ29udHJ1Y3Rpb24pIGFzIHR5cGVvZiBUcmVlQ29uc3RydWN0aW9uO1xuICBhcHBsaWVkVHJlZUNvbnRydWN0aW9uID0gYXBwbHlTVkdJbm5lckhUTUxGaXgoZG9jLCBhcHBsaWVkVHJlZUNvbnRydWN0aW9uLCBTVkdfTkFNRVNQQUNFKSBhcyB0eXBlb2YgVHJlZUNvbnN0cnVjdGlvbjtcblxuICBleHBvcnQgY29uc3QgRE9NVHJlZUNvbnN0cnVjdGlvbiA9IGFwcGxpZWRUcmVlQ29udHJ1Y3Rpb247XG4gIGV4cG9ydCB0eXBlIERPTVRyZWVDb25zdHJ1Y3Rpb24gPSBUcmVlQ29uc3RydWN0aW9uO1xufVxuXG5leHBvcnQgY2xhc3MgRE9NQ2hhbmdlcyBleHRlbmRzIERPTU9wZXJhdGlvbnMge1xuICBwcm90ZWN0ZWQgbmFtZXNwYWNlOiBPcHRpb248c3RyaW5nPjtcblxuICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgZG9jdW1lbnQ6IEhUTUxEb2N1bWVudCkge1xuICAgIHN1cGVyKGRvY3VtZW50KTtcbiAgICB0aGlzLm5hbWVzcGFjZSA9IG51bGw7XG4gIH1cblxuICBzZXRBdHRyaWJ1dGUoZWxlbWVudDogU2ltcGxlLkVsZW1lbnQsIG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZykge1xuICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKG5hbWUsIHZhbHVlKTtcbiAgfVxuXG4gIHJlbW92ZUF0dHJpYnV0ZShlbGVtZW50OiBTaW1wbGUuRWxlbWVudCwgbmFtZTogc3RyaW5nKSB7XG4gICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUobmFtZSk7XG4gIH1cblxuICBpbnNlcnRBZnRlcihlbGVtZW50OiBTaW1wbGUuRWxlbWVudCwgbm9kZTogU2ltcGxlLk5vZGUsIHJlZmVyZW5jZTogU2ltcGxlLk5vZGUpIHtcbiAgICB0aGlzLmluc2VydEJlZm9yZShlbGVtZW50LCBub2RlLCByZWZlcmVuY2UubmV4dFNpYmxpbmcpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpbnNlcnRIVE1MQmVmb3JlKHRoaXM6IHZvaWQsIF91c2VsZXNzOiBTaW1wbGUuRWxlbWVudCwgX3BhcmVudDogU2ltcGxlLkVsZW1lbnQsIF9uZXh0U2libGluZzogT3B0aW9uPFNpbXBsZS5Ob2RlPiwgaHRtbDogc3RyaW5nKTogQm91bmRzIHsgLy8gdHNsaW50OmRpc2FibGUtbGluZVxuICAvLyBUeXBlU2NyaXB0IHZlbmRvcmVkIGFuIG9sZCB2ZXJzaW9uIG9mIHRoZSBET00gc3BlYyB3aGVyZSBgaW5zZXJ0QWRqYWNlbnRIVE1MYFxuICAvLyBvbmx5IGV4aXN0cyBvbiBgSFRNTEVsZW1lbnRgIGJ1dCBub3Qgb24gYEVsZW1lbnRgLiBXZSBhY3R1YWxseSB3b3JrIHdpdGggdGhlXG4gIC8vIG5ld2VyIHZlcnNpb24gb2YgdGhlIERPTSBBUEkgaGVyZSAoYW5kIG1vbmtleS1wYXRjaCB0aGlzIG1ldGhvZCBpbiBgLi9jb21wYXRgXG4gIC8vIHdoZW4gd2UgZGV0ZWN0IG9sZGVyIGJyb3dzZXJzKS4gVGhpcyBpcyBhIGhhY2sgdG8gd29yayBhcm91bmQgdGhpcyBsaW1pdGF0aW9uLlxuICBsZXQgcGFyZW50ID0gX3BhcmVudCBhcyBIVE1MRWxlbWVudDtcbiAgbGV0IHVzZWxlc3MgPSBfdXNlbGVzcyBhcyBIVE1MRWxlbWVudDtcbiAgbGV0IG5leHRTaWJsaW5nID0gX25leHRTaWJsaW5nIGFzIE5vZGU7XG5cbiAgbGV0IHByZXYgPSBuZXh0U2libGluZyA/IG5leHRTaWJsaW5nLnByZXZpb3VzU2libGluZyA6IHBhcmVudC5sYXN0Q2hpbGQ7XG4gIGxldCBsYXN0OiBTaW1wbGUuTm9kZSB8IG51bGw7XG5cbiAgaWYgKGh0bWwgPT09IG51bGwgfHwgaHRtbCA9PT0gJycpIHtcbiAgICByZXR1cm4gbmV3IENvbmNyZXRlQm91bmRzKHBhcmVudCwgbnVsbCwgbnVsbCk7XG4gIH1cblxuICBpZiAobmV4dFNpYmxpbmcgPT09IG51bGwpIHtcbiAgICBwYXJlbnQuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVlbmQnLCBodG1sKTtcbiAgICBsYXN0ID0gcGFyZW50Lmxhc3RDaGlsZDtcbiAgfSBlbHNlIGlmIChuZXh0U2libGluZyBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XG4gICAgbmV4dFNpYmxpbmcuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmViZWdpbicsIGh0bWwpO1xuICAgIGxhc3QgPSBuZXh0U2libGluZy5wcmV2aW91c1NpYmxpbmc7XG4gIH0gZWxzZSB7XG4gICAgLy8gTm9uLWVsZW1lbnQgbm9kZXMgZG8gbm90IHN1cHBvcnQgaW5zZXJ0QWRqYWNlbnRIVE1MLCBzbyBhZGQgYW5cbiAgICAvLyBlbGVtZW50IGFuZCBjYWxsIGl0IG9uIHRoYXQgZWxlbWVudC4gVGhlbiByZW1vdmUgdGhlIGVsZW1lbnQuXG4gICAgLy9cbiAgICAvLyBUaGlzIGFsc28gcHJvdGVjdHMgRWRnZSwgSUUgYW5kIEZpcmVmb3ggdy9vIHRoZSBpbnNwZWN0b3Igb3BlblxuICAgIC8vIGZyb20gbWVyZ2luZyBhZGphY2VudCB0ZXh0IG5vZGVzLiBTZWUgLi9jb21wYXQvdGV4dC1ub2RlLW1lcmdpbmctZml4LnRzXG4gICAgcGFyZW50Lmluc2VydEJlZm9yZSh1c2VsZXNzLCBuZXh0U2libGluZyk7XG4gICAgdXNlbGVzcy5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZWJlZ2luJywgaHRtbCk7XG4gICAgbGFzdCA9IHVzZWxlc3MucHJldmlvdXNTaWJsaW5nO1xuICAgIHBhcmVudC5yZW1vdmVDaGlsZCh1c2VsZXNzKTtcbiAgfVxuXG4gIGxldCBmaXJzdCA9IHByZXYgPyBwcmV2Lm5leHRTaWJsaW5nIDogcGFyZW50LmZpcnN0Q2hpbGQ7XG4gIHJldHVybiBuZXcgQ29uY3JldGVCb3VuZHMocGFyZW50LCBmaXJzdCwgbGFzdCk7XG59XG5cbmxldCBoZWxwZXIgPSBET01DaGFuZ2VzO1xuXG5oZWxwZXIgPSBhcHBseVRleHROb2RlTWVyZ2luZ0ZpeChkb2MsIGhlbHBlcikgYXMgdHlwZW9mIERPTUNoYW5nZXM7XG5oZWxwZXIgPSBhcHBseVNWR0lubmVySFRNTEZpeChkb2MsIGhlbHBlciwgU1ZHX05BTUVTUEFDRSkgYXMgdHlwZW9mIERPTUNoYW5nZXM7XG5cbmV4cG9ydCBkZWZhdWx0IGhlbHBlcjtcbmV4cG9ydCBjb25zdCBET01UcmVlQ29uc3RydWN0aW9uID0gRE9NLkRPTVRyZWVDb25zdHJ1Y3Rpb247XG5leHBvcnQgdHlwZSBET01UcmVlQ29uc3RydWN0aW9uID0gRE9NLkRPTVRyZWVDb25zdHJ1Y3Rpb247XG5leHBvcnQgdHlwZSBET01OYW1lc3BhY2UgPSBTaW1wbGUuTmFtZXNwYWNlO1xuIl19","import { normalizeStringValue, isSafeString } from '../dom/normalize';\nconst badProtocols = ['javascript:', 'vbscript:'];\nconst badTags = ['A', 'BODY', 'LINK', 'IMG', 'IFRAME', 'BASE', 'FORM'];\nconst badTagsForDataURI = ['EMBED'];\nconst badAttributes = ['href', 'src', 'background', 'action'];\nconst badAttributesForDataURI = ['src'];\nfunction has(array, item) {\n    return array.indexOf(item) !== -1;\n}\nfunction checkURI(tagName, attribute) {\n    return (tagName === null || has(badTags, tagName)) && has(badAttributes, attribute);\n}\nfunction checkDataURI(tagName, attribute) {\n    if (tagName === null) return false;\n    return has(badTagsForDataURI, tagName) && has(badAttributesForDataURI, attribute);\n}\nexport function requiresSanitization(tagName, attribute) {\n    return checkURI(tagName, attribute) || checkDataURI(tagName, attribute);\n}\nexport function sanitizeAttributeValue(env, element, attribute, value) {\n    let tagName = null;\n    if (value === null || value === undefined) {\n        return value;\n    }\n    if (isSafeString(value)) {\n        return value.toHTML();\n    }\n    if (!element) {\n        tagName = null;\n    } else {\n        tagName = element.tagName.toUpperCase();\n    }\n    let str = normalizeStringValue(value);\n    if (checkURI(tagName, attribute)) {\n        let protocol = env.protocolForURL(str);\n        if (has(badProtocols, protocol)) {\n            return `unsafe:${str}`;\n        }\n    }\n    if (checkDataURI(tagName, attribute)) {\n        return `unsafe:${str}`;\n    }\n    return str;\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2FuaXRpemVkLXZhbHVlcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3J1bnRpbWUvbGliL2RvbS9zYW5pdGl6ZWQtdmFsdWVzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLEFBQU8sU0FBRSxBQUFvQixzQkFBRSxBQUFZLEFBQUUsb0JBQU0sQUFBa0IsQUFBQztBQUl0RSxNQUFNLEFBQVksZUFBRyxDQUNuQixBQUFhLGVBQ2IsQUFBVyxBQUNaLEFBQUM7QUFFRixNQUFNLEFBQU8sVUFBRyxDQUNkLEFBQUcsS0FDSCxBQUFNLFFBQ04sQUFBTSxRQUNOLEFBQUssT0FDTCxBQUFRLFVBQ1IsQUFBTSxRQUNOLEFBQU0sQUFDUCxBQUFDO0FBRUYsTUFBTSxBQUFpQixvQkFBRyxDQUN4QixBQUFPLEFBQ1IsQUFBQztBQUVGLE1BQU0sQUFBYSxnQkFBRyxDQUNwQixBQUFNLFFBQ04sQUFBSyxPQUNMLEFBQVksY0FDWixBQUFRLEFBQ1QsQUFBQztBQUVGLE1BQU0sQUFBdUIsMEJBQUcsQ0FDOUIsQUFBSyxBQUNOLEFBQUM7QUFFRixhQUFhLEFBQW9CLE9BQUUsQUFBWTtBQUM3QyxBQUFNLFdBQUMsQUFBSyxNQUFDLEFBQU8sUUFBQyxBQUFJLEFBQUMsVUFBSyxDQUFDLEFBQUMsQUFBQyxBQUNwQztBQUFDO0FBRUQsa0JBQWtCLEFBQXVCLFNBQUUsQUFBaUI7QUFDMUQsQUFBTSxXQUFDLENBQUMsQUFBTyxZQUFLLEFBQUksUUFBSSxBQUFHLElBQUMsQUFBTyxTQUFFLEFBQU8sQUFBQyxBQUFDLGFBQUksQUFBRyxJQUFDLEFBQWEsZUFBRSxBQUFTLEFBQUMsQUFBQyxBQUN0RjtBQUFDO0FBRUQsc0JBQXNCLEFBQXVCLFNBQUUsQUFBaUI7QUFDOUQsQUFBRSxBQUFDLFFBQUMsQUFBTyxZQUFLLEFBQUksQUFBQyxNQUFDLEFBQU0sT0FBQyxBQUFLLEFBQUM7QUFDbkMsQUFBTSxXQUFDLEFBQUcsSUFBQyxBQUFpQixtQkFBRSxBQUFPLEFBQUMsWUFBSSxBQUFHLElBQUMsQUFBdUIseUJBQUUsQUFBUyxBQUFDLEFBQUMsQUFDcEY7QUFBQztBQUVELEFBQU0scUNBQStCLEFBQWUsU0FBRSxBQUFpQjtBQUNyRSxBQUFNLFdBQUMsQUFBUSxTQUFDLEFBQU8sU0FBRSxBQUFTLEFBQUMsY0FBSSxBQUFZLGFBQUMsQUFBTyxTQUFFLEFBQVMsQUFBQyxBQUFDLEFBQzFFO0FBQUM7QUFFRCxBQUFNLHVDQUFpQyxBQUFnQixLQUFFLEFBQXVCLFNBQUUsQUFBaUIsV0FBRSxBQUFhO0FBQ2hILFFBQUksQUFBTyxVQUFtQixBQUFJLEFBQUM7QUFFbkMsQUFBRSxBQUFDLFFBQUMsQUFBSyxVQUFLLEFBQUksUUFBSSxBQUFLLFVBQUssQUFBUyxBQUFDLFdBQUMsQUFBQztBQUMxQyxBQUFNLGVBQUMsQUFBSyxBQUFDLEFBQ2Y7QUFBQztBQUVELEFBQUUsQUFBQyxRQUFDLEFBQVksYUFBQyxBQUFLLEFBQUMsQUFBQyxRQUFDLEFBQUM7QUFDeEIsQUFBTSxlQUFDLEFBQUssTUFBQyxBQUFNLEFBQUUsQUFBQyxBQUN4QjtBQUFDO0FBRUQsQUFBRSxBQUFDLFFBQUMsQ0FBQyxBQUFPLEFBQUMsU0FBQyxBQUFDO0FBQ2IsQUFBTyxrQkFBRyxBQUFJLEFBQUMsQUFDakI7QUFBQyxBQUFDLEFBQUksV0FBQyxBQUFDO0FBQ04sQUFBTyxrQkFBRyxBQUFPLFFBQUMsQUFBTyxRQUFDLEFBQVcsQUFBRSxBQUFDLEFBQzFDO0FBQUM7QUFFRCxRQUFJLEFBQUcsTUFBRyxBQUFvQixxQkFBQyxBQUFLLEFBQUMsQUFBQztBQUV0QyxBQUFFLEFBQUMsUUFBQyxBQUFRLFNBQUMsQUFBTyxTQUFFLEFBQVMsQUFBQyxBQUFDLFlBQUMsQUFBQztBQUNqQyxZQUFJLEFBQVEsV0FBRyxBQUFHLElBQUMsQUFBYyxlQUFDLEFBQUcsQUFBQyxBQUFDO0FBQ3ZDLEFBQUUsQUFBQyxZQUFDLEFBQUcsSUFBQyxBQUFZLGNBQUUsQUFBUSxBQUFDLEFBQUMsV0FBQyxBQUFDO0FBQ2hDLEFBQU0sQUFBQyw2QkFBVSxBQUFHLEdBQUUsQUFBQyxBQUN6QjtBQUFDLEFBQ0g7QUFBQztBQUVELEFBQUUsQUFBQyxRQUFDLEFBQVksYUFBQyxBQUFPLFNBQUUsQUFBUyxBQUFDLEFBQUMsWUFBQyxBQUFDO0FBQ3JDLEFBQU0sQUFBQyx5QkFBVSxBQUFHLEdBQUUsQUFBQyxBQUN6QjtBQUFDO0FBRUQsQUFBTSxXQUFDLEFBQUcsQUFBQyxBQUNiO0FBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBPcGFxdWUsIE9wdGlvbiB9IGZyb20gJ0BnbGltbWVyL3V0aWwnO1xuaW1wb3J0IHsgbm9ybWFsaXplU3RyaW5nVmFsdWUsIGlzU2FmZVN0cmluZyB9IGZyb20gJy4uL2RvbS9ub3JtYWxpemUnO1xuaW1wb3J0IHsgRW52aXJvbm1lbnQgfSBmcm9tICcuLi9lbnZpcm9ubWVudCc7XG5pbXBvcnQgeyBTaW1wbGUgfSBmcm9tICdAZ2xpbW1lci9pbnRlcmZhY2VzJztcblxuY29uc3QgYmFkUHJvdG9jb2xzID0gW1xuICAnamF2YXNjcmlwdDonLFxuICAndmJzY3JpcHQ6J1xuXTtcblxuY29uc3QgYmFkVGFncyA9IFtcbiAgJ0EnLFxuICAnQk9EWScsXG4gICdMSU5LJyxcbiAgJ0lNRycsXG4gICdJRlJBTUUnLFxuICAnQkFTRScsXG4gICdGT1JNJ1xuXTtcblxuY29uc3QgYmFkVGFnc0ZvckRhdGFVUkkgPSBbXG4gICdFTUJFRCdcbl07XG5cbmNvbnN0IGJhZEF0dHJpYnV0ZXMgPSBbXG4gICdocmVmJyxcbiAgJ3NyYycsXG4gICdiYWNrZ3JvdW5kJyxcbiAgJ2FjdGlvbidcbl07XG5cbmNvbnN0IGJhZEF0dHJpYnV0ZXNGb3JEYXRhVVJJID0gW1xuICAnc3JjJ1xuXTtcblxuZnVuY3Rpb24gaGFzKGFycmF5OiBBcnJheTxzdHJpbmc+LCBpdGVtOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgcmV0dXJuIGFycmF5LmluZGV4T2YoaXRlbSkgIT09IC0xO1xufVxuXG5mdW5jdGlvbiBjaGVja1VSSSh0YWdOYW1lOiBPcHRpb248c3RyaW5nPiwgYXR0cmlidXRlOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgcmV0dXJuICh0YWdOYW1lID09PSBudWxsIHx8IGhhcyhiYWRUYWdzLCB0YWdOYW1lKSkgJiYgaGFzKGJhZEF0dHJpYnV0ZXMsIGF0dHJpYnV0ZSk7XG59XG5cbmZ1bmN0aW9uIGNoZWNrRGF0YVVSSSh0YWdOYW1lOiBPcHRpb248c3RyaW5nPiwgYXR0cmlidXRlOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgaWYgKHRhZ05hbWUgPT09IG51bGwpIHJldHVybiBmYWxzZTtcbiAgcmV0dXJuIGhhcyhiYWRUYWdzRm9yRGF0YVVSSSwgdGFnTmFtZSkgJiYgaGFzKGJhZEF0dHJpYnV0ZXNGb3JEYXRhVVJJLCBhdHRyaWJ1dGUpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVxdWlyZXNTYW5pdGl6YXRpb24odGFnTmFtZTogc3RyaW5nLCBhdHRyaWJ1dGU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICByZXR1cm4gY2hlY2tVUkkodGFnTmFtZSwgYXR0cmlidXRlKSB8fCBjaGVja0RhdGFVUkkodGFnTmFtZSwgYXR0cmlidXRlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNhbml0aXplQXR0cmlidXRlVmFsdWUoZW52OiBFbnZpcm9ubWVudCwgZWxlbWVudDogU2ltcGxlLkVsZW1lbnQsIGF0dHJpYnV0ZTogc3RyaW5nLCB2YWx1ZTogT3BhcXVlKTogT3BhcXVlIHtcbiAgbGV0IHRhZ05hbWU6IE9wdGlvbjxzdHJpbmc+ID0gbnVsbDtcblxuICBpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuXG4gIGlmIChpc1NhZmVTdHJpbmcodmFsdWUpKSB7XG4gICAgcmV0dXJuIHZhbHVlLnRvSFRNTCgpO1xuICB9XG5cbiAgaWYgKCFlbGVtZW50KSB7XG4gICAgdGFnTmFtZSA9IG51bGw7XG4gIH0gZWxzZSB7XG4gICAgdGFnTmFtZSA9IGVsZW1lbnQudGFnTmFtZS50b1VwcGVyQ2FzZSgpO1xuICB9XG5cbiAgbGV0IHN0ciA9IG5vcm1hbGl6ZVN0cmluZ1ZhbHVlKHZhbHVlKTtcblxuICBpZiAoY2hlY2tVUkkodGFnTmFtZSwgYXR0cmlidXRlKSkge1xuICAgIGxldCBwcm90b2NvbCA9IGVudi5wcm90b2NvbEZvclVSTChzdHIpO1xuICAgIGlmIChoYXMoYmFkUHJvdG9jb2xzLCBwcm90b2NvbCkpIHtcbiAgICAgIHJldHVybiBgdW5zYWZlOiR7c3RyfWA7XG4gICAgfVxuICB9XG5cbiAgaWYgKGNoZWNrRGF0YVVSSSh0YWdOYW1lLCBhdHRyaWJ1dGUpKSB7XG4gICAgcmV0dXJuIGB1bnNhZmU6JHtzdHJ9YDtcbiAgfVxuXG4gIHJldHVybiBzdHI7XG59XG4iXX0=","/*\n * @method normalizeProperty\n * @param element {HTMLElement}\n * @param slotName {String}\n * @returns {Object} { name, type }\n */\nexport function normalizeProperty(element, slotName) {\n    let type, normalized;\n    if (slotName in element) {\n        normalized = slotName;\n        type = 'prop';\n    } else {\n        let lower = slotName.toLowerCase();\n        if (lower in element) {\n            type = 'prop';\n            normalized = lower;\n        } else {\n            type = 'attr';\n            normalized = slotName;\n        }\n    }\n    if (type === 'prop' && (normalized.toLowerCase() === 'style' || preferAttr(element.tagName, normalized))) {\n        type = 'attr';\n    }\n    return { normalized, type };\n}\nexport function normalizePropertyValue(value) {\n    if (value === '') {\n        return true;\n    }\n    return value;\n}\n// properties that MUST be set as attributes, due to:\n// * browser bug\n// * strange spec outlier\nconst ATTR_OVERRIDES = {\n    INPUT: {\n        form: true,\n        // Chrome 46.0.2464.0: 'autocorrect' in document.createElement('input') === false\n        // Safari 8.0.7: 'autocorrect' in document.createElement('input') === false\n        // Mobile Safari (iOS 8.4 simulator): 'autocorrect' in document.createElement('input') === true\n        autocorrect: true,\n        // Chrome 54.0.2840.98: 'list' in document.createElement('input') === true\n        // Safari 9.1.3: 'list' in document.createElement('input') === false\n        list: true\n    },\n    // element.form is actually a legitimate readOnly property, that is to be\n    // mutated, but must be mutated by setAttribute...\n    SELECT: { form: true },\n    OPTION: { form: true },\n    TEXTAREA: { form: true },\n    LABEL: { form: true },\n    FIELDSET: { form: true },\n    LEGEND: { form: true },\n    OBJECT: { form: true }\n};\nfunction preferAttr(tagName, propName) {\n    let tag = ATTR_OVERRIDES[tagName.toUpperCase()];\n    return tag && tag[propName.toLowerCase()] || false;\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvcHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci9ydW50aW1lL2xpYi9kb20vcHJvcHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBR0EsQUFLRzs7Ozs7O0FBQ0gsQUFBTSxrQ0FBNEIsQUFBdUIsU0FBRSxBQUFnQjtBQUN6RSxRQUFJLEFBQUksTUFBRSxBQUFVLEFBQUM7QUFFckIsQUFBRSxBQUFDLFFBQUMsQUFBUSxZQUFJLEFBQU8sQUFBQyxTQUFDLEFBQUM7QUFDeEIsQUFBVSxxQkFBRyxBQUFRLEFBQUM7QUFDdEIsQUFBSSxlQUFHLEFBQU0sQUFBQyxBQUNoQjtBQUFDLEFBQUMsQUFBSSxXQUFDLEFBQUM7QUFDTixZQUFJLEFBQUssUUFBRyxBQUFRLFNBQUMsQUFBVyxBQUFFLEFBQUM7QUFDbkMsQUFBRSxBQUFDLFlBQUMsQUFBSyxTQUFJLEFBQU8sQUFBQyxTQUFDLEFBQUM7QUFDckIsQUFBSSxtQkFBRyxBQUFNLEFBQUM7QUFDZCxBQUFVLHlCQUFHLEFBQUssQUFBQyxBQUNyQjtBQUFDLEFBQUMsQUFBSSxlQUFDLEFBQUM7QUFDTixBQUFJLG1CQUFHLEFBQU0sQUFBQztBQUNkLEFBQVUseUJBQUcsQUFBUSxBQUFDLEFBQ3hCO0FBQUMsQUFDSDtBQUFDO0FBRUQsQUFBRSxBQUFDLFFBQUMsQUFBSSxTQUFLLEFBQU0sQUFDZixXQUFDLEFBQVUsV0FBQyxBQUFXLEFBQUUsa0JBQUssQUFBTyxXQUNwQyxBQUFVLFdBQUMsQUFBTyxRQUFDLEFBQU8sU0FBRSxBQUFVLEFBQUMsQUFBQyxBQUFDLGNBQUMsQUFBQztBQUM5QyxBQUFJLGVBQUcsQUFBTSxBQUFDLEFBQ2hCO0FBQUM7QUFFRCxBQUFNLFdBQUMsRUFBRSxBQUFVLFlBQUUsQUFBSSxBQUFFLEFBQUMsQUFDOUI7QUFBQztBQUVELEFBQU0sdUNBQWlDLEFBQWE7QUFDbEQsQUFBRSxBQUFDLFFBQUMsQUFBSyxVQUFLLEFBQUUsQUFBQyxJQUFDLEFBQUM7QUFDakIsQUFBTSxlQUFDLEFBQUksQUFBQyxBQUNkO0FBQUM7QUFFRCxBQUFNLFdBQUMsQUFBSyxBQUFDLEFBQ2Y7QUFBQztBQUVELEFBQXFEO0FBQ3JELEFBQWdCO0FBQ2hCLEFBQXlCO0FBQ3pCLE1BQU0sQUFBYztBQUVsQixBQUFLO0FBQ0gsQUFBSSxjQUFFLEFBQUk7QUFDVixBQUFpRjtBQUNqRixBQUEyRTtBQUMzRSxBQUErRjtBQUMvRixBQUFXLHFCQUFFLEFBQUk7QUFDakIsQUFBMEU7QUFDMUUsQUFBb0U7QUFDcEUsQUFBSSxjQUFFLEFBQUksQUFDWDtBQVRNO0FBV1AsQUFBeUU7QUFDekUsQUFBa0Q7QUFDbEQsQUFBTSxZQUFJLEVBQUUsQUFBSSxNQUFFLEFBQUksQUFBRTtBQUN4QixBQUFNLFlBQUksRUFBRSxBQUFJLE1BQUUsQUFBSSxBQUFFO0FBQ3hCLEFBQVEsY0FBRSxFQUFFLEFBQUksTUFBRSxBQUFJLEFBQUU7QUFDeEIsQUFBSyxXQUFLLEVBQUUsQUFBSSxNQUFFLEFBQUksQUFBRTtBQUN4QixBQUFRLGNBQUUsRUFBRSxBQUFJLE1BQUUsQUFBSSxBQUFFO0FBQ3hCLEFBQU0sWUFBSSxFQUFFLEFBQUksTUFBRSxBQUFJLEFBQUU7QUFDeEIsQUFBTSxZQUFJLEVBQUUsQUFBSSxNQUFFLEFBQUksQUFBRSxBQUN6QixBQUFDO0FBdEJxQjtBQXdCdkIsb0JBQW9CLEFBQWUsU0FBRSxBQUFnQjtBQUNuRCxRQUFJLEFBQUcsTUFBRyxBQUFjLGVBQUMsQUFBTyxRQUFDLEFBQVcsQUFBRSxBQUFDLEFBQUM7QUFDaEQsQUFBTSxXQUFDLEFBQUcsT0FBSSxBQUFHLElBQUMsQUFBUSxTQUFDLEFBQVcsQUFBRSxBQUFDLGtCQUFJLEFBQUssQUFBQyxBQUNyRDtBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgT3BhcXVlIH0gZnJvbSAnQGdsaW1tZXIvdXRpbCc7XG5pbXBvcnQgeyBTaW1wbGUgfSBmcm9tICdAZ2xpbW1lci9pbnRlcmZhY2VzJztcblxuLypcbiAqIEBtZXRob2Qgbm9ybWFsaXplUHJvcGVydHlcbiAqIEBwYXJhbSBlbGVtZW50IHtIVE1MRWxlbWVudH1cbiAqIEBwYXJhbSBzbG90TmFtZSB7U3RyaW5nfVxuICogQHJldHVybnMge09iamVjdH0geyBuYW1lLCB0eXBlIH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG5vcm1hbGl6ZVByb3BlcnR5KGVsZW1lbnQ6IFNpbXBsZS5FbGVtZW50LCBzbG90TmFtZTogc3RyaW5nKSB7XG4gIGxldCB0eXBlLCBub3JtYWxpemVkO1xuXG4gIGlmIChzbG90TmFtZSBpbiBlbGVtZW50KSB7XG4gICAgbm9ybWFsaXplZCA9IHNsb3ROYW1lO1xuICAgIHR5cGUgPSAncHJvcCc7XG4gIH0gZWxzZSB7XG4gICAgbGV0IGxvd2VyID0gc2xvdE5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICBpZiAobG93ZXIgaW4gZWxlbWVudCkge1xuICAgICAgdHlwZSA9ICdwcm9wJztcbiAgICAgIG5vcm1hbGl6ZWQgPSBsb3dlcjtcbiAgICB9IGVsc2Uge1xuICAgICAgdHlwZSA9ICdhdHRyJztcbiAgICAgIG5vcm1hbGl6ZWQgPSBzbG90TmFtZTtcbiAgICB9XG4gIH1cblxuICBpZiAodHlwZSA9PT0gJ3Byb3AnICYmXG4gICAgICAobm9ybWFsaXplZC50b0xvd2VyQ2FzZSgpID09PSAnc3R5bGUnIHx8XG4gICAgICAgcHJlZmVyQXR0cihlbGVtZW50LnRhZ05hbWUsIG5vcm1hbGl6ZWQpKSkge1xuICAgIHR5cGUgPSAnYXR0cic7XG4gIH1cblxuICByZXR1cm4geyBub3JtYWxpemVkLCB0eXBlIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBub3JtYWxpemVQcm9wZXJ0eVZhbHVlKHZhbHVlOiBPcGFxdWUpOiBPcGFxdWUge1xuICBpZiAodmFsdWUgPT09ICcnKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICByZXR1cm4gdmFsdWU7XG59XG5cbi8vIHByb3BlcnRpZXMgdGhhdCBNVVNUIGJlIHNldCBhcyBhdHRyaWJ1dGVzLCBkdWUgdG86XG4vLyAqIGJyb3dzZXIgYnVnXG4vLyAqIHN0cmFuZ2Ugc3BlYyBvdXRsaWVyXG5jb25zdCBBVFRSX09WRVJSSURFUyA9IHtcblxuICBJTlBVVDoge1xuICAgIGZvcm06IHRydWUsXG4gICAgLy8gQ2hyb21lIDQ2LjAuMjQ2NC4wOiAnYXV0b2NvcnJlY3QnIGluIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0JykgPT09IGZhbHNlXG4gICAgLy8gU2FmYXJpIDguMC43OiAnYXV0b2NvcnJlY3QnIGluIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0JykgPT09IGZhbHNlXG4gICAgLy8gTW9iaWxlIFNhZmFyaSAoaU9TIDguNCBzaW11bGF0b3IpOiAnYXV0b2NvcnJlY3QnIGluIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0JykgPT09IHRydWVcbiAgICBhdXRvY29ycmVjdDogdHJ1ZSxcbiAgICAvLyBDaHJvbWUgNTQuMC4yODQwLjk4OiAnbGlzdCcgaW4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKSA9PT0gdHJ1ZVxuICAgIC8vIFNhZmFyaSA5LjEuMzogJ2xpc3QnIGluIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0JykgPT09IGZhbHNlXG4gICAgbGlzdDogdHJ1ZVxuICB9LFxuXG4gIC8vIGVsZW1lbnQuZm9ybSBpcyBhY3R1YWxseSBhIGxlZ2l0aW1hdGUgcmVhZE9ubHkgcHJvcGVydHksIHRoYXQgaXMgdG8gYmVcbiAgLy8gbXV0YXRlZCwgYnV0IG11c3QgYmUgbXV0YXRlZCBieSBzZXRBdHRyaWJ1dGUuLi5cbiAgU0VMRUNUOiAgIHsgZm9ybTogdHJ1ZSB9LFxuICBPUFRJT046ICAgeyBmb3JtOiB0cnVlIH0sXG4gIFRFWFRBUkVBOiB7IGZvcm06IHRydWUgfSxcbiAgTEFCRUw6ICAgIHsgZm9ybTogdHJ1ZSB9LFxuICBGSUVMRFNFVDogeyBmb3JtOiB0cnVlIH0sXG4gIExFR0VORDogICB7IGZvcm06IHRydWUgfSxcbiAgT0JKRUNUOiAgIHsgZm9ybTogdHJ1ZSB9XG59O1xuXG5mdW5jdGlvbiBwcmVmZXJBdHRyKHRhZ05hbWU6IHN0cmluZywgcHJvcE5hbWU6IHN0cmluZykge1xuICBsZXQgdGFnID0gQVRUUl9PVkVSUklERVNbdGFnTmFtZS50b1VwcGVyQ2FzZSgpXTtcbiAgcmV0dXJuIHRhZyAmJiB0YWdbcHJvcE5hbWUudG9Mb3dlckNhc2UoKV0gfHwgZmFsc2U7XG59XG4iXX0=","import { sanitizeAttributeValue, requiresSanitization } from '../../dom/sanitized-values';\nimport { normalizeProperty } from '../../dom/props';\nimport { SVG_NAMESPACE } from '../../dom/helper';\nimport { normalizeStringValue } from '../../dom/normalize';\nexport function defaultDynamicAttributes(element, attr) {\n    let { tagName, namespaceURI } = element;\n    if (namespaceURI === SVG_NAMESPACE) {\n        return defaultDynamicAttribute(tagName, attr);\n    }\n    let { type, normalized } = normalizeProperty(element, attr);\n    if (type === 'attr') {\n        return defaultDynamicAttribute(tagName, normalized);\n    } else {\n        return defaultDynamicProperty(tagName, normalized);\n    }\n}\nexport function defaultDynamicAttribute(tagName, name) {\n    if (requiresSanitization(tagName, name)) {\n        return SafeDynamicAttribute;\n    } else {\n        return SimpleDynamicAttribute;\n    }\n}\nexport function defaultDynamicProperty(tagName, name) {\n    if (requiresSanitization(tagName, name)) {\n        return SafeDynamicProperty;\n    }\n    if (isUserInputValue(tagName, name)) {\n        return InputValueDynamicAttribute;\n    }\n    if (isOptionSelected(tagName, name)) {\n        return OptionSelectedDynamicAttribute;\n    }\n    return DefaultDynamicProperty;\n}\nexport class DynamicAttribute {\n    constructor(attribute) {\n        this.attribute = attribute;\n    }\n}\nexport class SimpleDynamicAttribute extends DynamicAttribute {\n    set(dom, value, _env) {\n        let normalizedValue = normalizeValue(value);\n        if (normalizedValue !== null) {\n            let { name, namespace } = this.attribute;\n            dom.__setAttribute(name, normalizedValue, namespace);\n        }\n    }\n    update(value, _env) {\n        let normalizedValue = normalizeValue(value);\n        let { element, name } = this.attribute;\n        if (normalizedValue === null) {\n            element.removeAttribute(name);\n        } else {\n            element.setAttribute(name, normalizedValue);\n        }\n    }\n}\nexport class DefaultDynamicProperty extends DynamicAttribute {\n    set(dom, value, _env) {\n        if (value !== null && value !== undefined) {\n            let { name } = this.attribute;\n            this.value = value;\n            dom.__setProperty(name, value);\n        }\n    }\n    update(value, _env) {\n        let { element, name } = this.attribute;\n        if (this.value !== value) {\n            element[name] = this.value = value;\n            if (value === null || value === undefined) {\n                this.removeAttribute();\n            }\n        }\n    }\n    removeAttribute() {\n        // TODO this sucks but to preserve properties first and to meet current\n        // semantics we must do this.\n        let { element, name, namespace } = this.attribute;\n        if (namespace) {\n            element.removeAttributeNS(namespace, name);\n        } else {\n            element.removeAttribute(name);\n        }\n    }\n}\nexport class SafeDynamicProperty extends DefaultDynamicProperty {\n    set(dom, value, env) {\n        let { element, name } = this.attribute;\n        let sanitized = sanitizeAttributeValue(env, element, name, value);\n        super.set(dom, sanitized, env);\n    }\n    update(value, env) {\n        let { element, name } = this.attribute;\n        let sanitized = sanitizeAttributeValue(env, element, name, value);\n        super.update(sanitized, env);\n    }\n}\nexport class SafeDynamicAttribute extends SimpleDynamicAttribute {\n    set(dom, value, env) {\n        let { element, name } = this.attribute;\n        let sanitized = sanitizeAttributeValue(env, element, name, value);\n        super.set(dom, sanitized, env);\n    }\n    update(value, env) {\n        let { element, name } = this.attribute;\n        let sanitized = sanitizeAttributeValue(env, element, name, value);\n        super.update(sanitized, env);\n    }\n}\nexport class InputValueDynamicAttribute extends DefaultDynamicProperty {\n    set(dom, value) {\n        dom.__setProperty('value', normalizeStringValue(value));\n    }\n    update(value) {\n        let input = this.attribute.element;\n        let currentValue = input.value;\n        let normalizedValue = normalizeStringValue(value);\n        if (currentValue !== normalizedValue) {\n            input.value = normalizedValue;\n        }\n    }\n}\nexport class OptionSelectedDynamicAttribute extends DefaultDynamicProperty {\n    set(dom, value) {\n        if (value !== null && value !== undefined && value !== false) {\n            dom.__setProperty('selected', true);\n        }\n    }\n    update(value) {\n        let option = this.attribute.element;\n        if (value) {\n            option.selected = true;\n        } else {\n            option.selected = false;\n        }\n    }\n}\nfunction isOptionSelected(tagName, attribute) {\n    return tagName === 'OPTION' && attribute === 'selected';\n}\nfunction isUserInputValue(tagName, attribute) {\n    return (tagName === 'INPUT' || tagName === 'TEXTAREA') && attribute === 'value';\n}\nfunction normalizeValue(value) {\n    if (value === false || value === undefined || value === null || typeof value.toString === 'undefined') {\n        return null;\n    }\n    if (value === true) {\n        return '';\n    }\n    // onclick function etc in SSR\n    if (typeof value === 'function') {\n        return null;\n    }\n    return String(value);\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZHluYW1pYy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3J1bnRpbWUvbGliL3ZtL2F0dHJpYnV0ZXMvZHluYW1pYy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFHQSxBQUFPLFNBQUUsQUFBc0Isd0JBQUUsQUFBb0IsQUFBRSw0QkFBTSxBQUE0QixBQUFDO0FBQzFGLEFBQU8sU0FBRSxBQUFpQixBQUFFLHlCQUFNLEFBQWlCLEFBQUM7QUFDcEQsQUFBTyxTQUFFLEFBQWEsQUFBRSxxQkFBTSxBQUFrQixBQUFDO0FBRWpELEFBQU8sU0FBRSxBQUFvQixBQUFFLDRCQUFNLEFBQXFCLEFBQUM7QUFNM0QsQUFBTSx5Q0FBbUMsQUFBdUIsU0FBRSxBQUFZO0FBQzVFLFFBQUksRUFBRSxBQUFPLFNBQUUsQUFBWSxBQUFFLGlCQUFHLEFBQU8sQUFBQztBQUV4QyxBQUFFLEFBQUMsUUFBQyxBQUFZLGlCQUFLLEFBQWEsQUFBQyxlQUFDLEFBQUM7QUFDbkMsQUFBTSxlQUFDLEFBQXVCLHdCQUFDLEFBQU8sU0FBRSxBQUFJLEFBQUMsQUFBQyxBQUNoRDtBQUFDO0FBRUQsUUFBSSxFQUFFLEFBQUksTUFBRSxBQUFVLEFBQUUsZUFBRyxBQUFpQixrQkFBQyxBQUFPLFNBQUUsQUFBSSxBQUFDLEFBQUM7QUFFNUQsQUFBRSxBQUFDLFFBQUMsQUFBSSxTQUFLLEFBQU0sQUFBQyxRQUFDLEFBQUM7QUFDcEIsQUFBTSxlQUFDLEFBQXVCLHdCQUFDLEFBQU8sU0FBRSxBQUFVLEFBQUMsQUFBQyxBQUN0RDtBQUFDLEFBQUMsQUFBSSxXQUFDLEFBQUM7QUFDTixBQUFNLGVBQUMsQUFBc0IsdUJBQUMsQUFBTyxTQUFFLEFBQVUsQUFBQyxBQUFDLEFBQ3JEO0FBQUMsQUFDSDtBQUFDO0FBRUQsQUFBTSx3Q0FBa0MsQUFBZSxTQUFFLEFBQVk7QUFDbkUsQUFBRSxBQUFDLFFBQUMsQUFBb0IscUJBQUMsQUFB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QUFBTSxlQUFDLEFBQUksQUFBQyxBQUNkO0FBQUM7QUFDRCxBQUFFLEFBQUMsUUFBQyxBQUFLLFVBQUssQUFBSSxBQUFDLE1BQUMsQUFBQztBQUNuQixBQUFNLGVBQUMsQUFBRSxBQUFDLEFBQ1o7QUFBQztBQUNELEFBQThCO0FBQzlCLEFBQUUsQUFBQyxRQUFDLE9BQU8sQUFBSyxVQUFLLEFBQVUsQUFBQyxZQUFDLEFBQUM7QUFDaEMsQUFBTSxlQUFDLEFBQUksQUFBQyxBQUNkO0FBQUM7QUFFRCxBQUFNLFdBQUMsQUFBTSxPQUFDLEFBQUssQUFBQyxBQUFDLEFBQ3ZCO0FBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTaW1wbGUsIE9wdGlvbiwgT3BhcXVlIH0gZnJvbSBcIkBnbGltbWVyL2ludGVyZmFjZXNcIjtcbmltcG9ydCBFbnZpcm9ubWVudCBmcm9tICcuLi8uLi9lbnZpcm9ubWVudCc7XG5pbXBvcnQgeyBFbGVtZW50QnVpbGRlciB9IGZyb20gJy4uL2VsZW1lbnQtYnVpbGRlcic7XG5pbXBvcnQgeyBzYW5pdGl6ZUF0dHJpYnV0ZVZhbHVlLCByZXF1aXJlc1Nhbml0aXphdGlvbiB9IGZyb20gJy4uLy4uL2RvbS9zYW5pdGl6ZWQtdmFsdWVzJztcbmltcG9ydCB7IG5vcm1hbGl6ZVByb3BlcnR5IH0gZnJvbSAnLi4vLi4vZG9tL3Byb3BzJztcbmltcG9ydCB7IFNWR19OQU1FU1BBQ0UgfSBmcm9tICcuLi8uLi9kb20vaGVscGVyJztcbmltcG9ydCB7IEF0dHJpYnV0ZSwgQXR0cmlidXRlT3BlcmF0aW9uIH0gZnJvbSAnLi9pbmRleCc7XG5pbXBvcnQgeyBub3JtYWxpemVTdHJpbmdWYWx1ZSB9IGZyb20gJy4uLy4uL2RvbS9ub3JtYWxpemUnO1xuXG5leHBvcnQgaW50ZXJmYWNlIER5bmFtaWNBdHRyaWJ1dGVGYWN0b3J5IHtcbiAgbmV3KGF0dHJpYnV0ZTogQXR0cmlidXRlKTogRHluYW1pY0F0dHJpYnV0ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlZmF1bHREeW5hbWljQXR0cmlidXRlcyhlbGVtZW50OiBTaW1wbGUuRWxlbWVudCwgYXR0cjogc3RyaW5nKTogRHluYW1pY0F0dHJpYnV0ZUZhY3Rvcnkge1xuICBsZXQgeyB0YWdOYW1lLCBuYW1lc3BhY2VVUkkgfSA9IGVsZW1lbnQ7XG5cbiAgaWYgKG5hbWVzcGFjZVVSSSA9PT0gU1ZHX05BTUVTUEFDRSkge1xuICAgIHJldHVybiBkZWZhdWx0RHluYW1pY0F0dHJpYnV0ZSh0YWdOYW1lLCBhdHRyKTtcbiAgfVxuXG4gIGxldCB7IHR5cGUsIG5vcm1hbGl6ZWQgfSA9IG5vcm1hbGl6ZVByb3BlcnR5KGVsZW1lbnQsIGF0dHIpO1xuXG4gIGlmICh0eXBlID09PSAnYXR0cicpIHtcbiAgICByZXR1cm4gZGVmYXVsdER5bmFtaWNBdHRyaWJ1dGUodGFnTmFtZSwgbm9ybWFsaXplZCk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGRlZmF1bHREeW5hbWljUHJvcGVydHkodGFnTmFtZSwgbm9ybWFsaXplZCk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlZmF1bHREeW5hbWljQXR0cmlidXRlKHRhZ05hbWU6IHN0cmluZywgbmFtZTogc3RyaW5nKTogRHluYW1pY0F0dHJpYnV0ZUZhY3Rvcnkge1xuICBpZiAocmVxdWlyZXNTYW5pdGl6YXRpb24odGFnTmFtZSwgbmFtZSkpIHtcbiAgICByZXR1cm4gU2FmZUR5bmFtaWNBdHRyaWJ1dGU7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIFNpbXBsZUR5bmFtaWNBdHRyaWJ1dGU7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlZmF1bHREeW5hbWljUHJvcGVydHkodGFnTmFtZTogc3RyaW5nLCBuYW1lOiBzdHJpbmcpOiBEeW5hbWljQXR0cmlidXRlRmFjdG9yeSB7XG4gIGlmIChyZXF1aXJlc1Nhbml0aXphdGlvbih0YWdOYW1lLCBuYW1lKSkge1xuICAgIHJldHVybiBTYWZlRHluYW1pY1Byb3BlcnR5O1xuICB9XG5cbiAgaWYgKGlzVXNlcklucHV0VmFsdWUodGFnTmFtZSwgbmFtZSkpIHtcbiAgICByZXR1cm4gSW5wdXRWYWx1ZUR5bmFtaWNBdHRyaWJ1dGU7XG4gIH1cblxuICBpZiAoaXNPcHRpb25TZWxlY3RlZCh0YWdOYW1lLCBuYW1lKSkge1xuICAgIHJldHVybiBPcHRpb25TZWxlY3RlZER5bmFtaWNBdHRyaWJ1dGU7XG4gIH1cblxuICByZXR1cm4gRGVmYXVsdER5bmFtaWNQcm9wZXJ0eTtcbn1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIER5bmFtaWNBdHRyaWJ1dGUgaW1wbGVtZW50cyBBdHRyaWJ1dGVPcGVyYXRpb24ge1xuICBjb25zdHJ1Y3RvcihwdWJsaWMgYXR0cmlidXRlOiBBdHRyaWJ1dGUpIHt9XG5cbiAgYWJzdHJhY3Qgc2V0KGRvbTogRWxlbWVudEJ1aWxkZXIsIHZhbHVlOiBPcGFxdWUsIGVudjogRW52aXJvbm1lbnQpOiB2b2lkO1xuICBhYnN0cmFjdCB1cGRhdGUodmFsdWU6IE9wYXF1ZSwgZW52OiBFbnZpcm9ubWVudCk6IHZvaWQ7XG59XG5cbmV4cG9ydCBjbGFzcyBTaW1wbGVEeW5hbWljQXR0cmlidXRlIGV4dGVuZHMgRHluYW1pY0F0dHJpYnV0ZSB7XG4gIHNldChkb206IEVsZW1lbnRCdWlsZGVyLCB2YWx1ZTogT3BhcXVlLCBfZW52OiBFbnZpcm9ubWVudCk6IHZvaWQge1xuICAgIGxldCBub3JtYWxpemVkVmFsdWUgPSBub3JtYWxpemVWYWx1ZSh2YWx1ZSk7XG5cbiAgICBpZiAobm9ybWFsaXplZFZhbHVlICE9PSBudWxsKSB7XG4gICAgICBsZXQgeyBuYW1lLCBuYW1lc3BhY2UgfSA9IHRoaXMuYXR0cmlidXRlO1xuICAgICAgZG9tLl9fc2V0QXR0cmlidXRlKG5hbWUsIG5vcm1hbGl6ZWRWYWx1ZSwgbmFtZXNwYWNlKTtcbiAgICB9XG4gIH1cblxuICB1cGRhdGUodmFsdWU6IE9wYXF1ZSwgX2VudjogRW52aXJvbm1lbnQpOiB2b2lkIHtcbiAgICBsZXQgbm9ybWFsaXplZFZhbHVlID0gbm9ybWFsaXplVmFsdWUodmFsdWUpO1xuICAgIGxldCB7IGVsZW1lbnQsIG5hbWUgfSA9IHRoaXMuYXR0cmlidXRlO1xuXG4gICAgaWYgKG5vcm1hbGl6ZWRWYWx1ZSA9PT0gbnVsbCkge1xuICAgICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUobmFtZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKG5hbWUsIG5vcm1hbGl6ZWRWYWx1ZSk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBEZWZhdWx0RHluYW1pY1Byb3BlcnR5IGV4dGVuZHMgRHluYW1pY0F0dHJpYnV0ZSB7XG4gIHZhbHVlOiBPcGFxdWU7XG4gIHNldChkb206IEVsZW1lbnRCdWlsZGVyLCB2YWx1ZTogT3BhcXVlLCBfZW52OiBFbnZpcm9ubWVudCk6IHZvaWQge1xuICAgIGlmICh2YWx1ZSAhPT0gbnVsbCAmJiB2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBsZXQgeyBuYW1lIH0gPSB0aGlzLmF0dHJpYnV0ZTtcbiAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgIGRvbS5fX3NldFByb3BlcnR5KG5hbWUsIHZhbHVlKTtcbiAgICB9XG4gIH1cblxuICB1cGRhdGUodmFsdWU6IE9wYXF1ZSwgX2VudjogRW52aXJvbm1lbnQpOiB2b2lkIHtcbiAgICBsZXQgeyBlbGVtZW50LCBuYW1lIH0gPSB0aGlzLmF0dHJpYnV0ZTtcblxuICAgIGlmICh0aGlzLnZhbHVlICE9PSB2YWx1ZSkge1xuICAgICAgZWxlbWVudFtuYW1lXSA9IHRoaXMudmFsdWUgPSB2YWx1ZTtcblxuICAgICAgaWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhpcy5yZW1vdmVBdHRyaWJ1dGUoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgfVxuXG4gIHByb3RlY3RlZCByZW1vdmVBdHRyaWJ1dGUoKSB7XG4gICAgLy8gVE9ETyB0aGlzIHN1Y2tzIGJ1dCB0byBwcmVzZXJ2ZSBwcm9wZXJ0aWVzIGZpcnN0IGFuZCB0byBtZWV0IGN1cnJlbnRcbiAgICAvLyBzZW1hbnRpY3Mgd2UgbXVzdCBkbyB0aGlzLlxuICAgIGxldCB7IGVsZW1lbnQsIG5hbWUsIG5hbWVzcGFjZSB9ID0gdGhpcy5hdHRyaWJ1dGU7XG5cbiAgICBpZiAobmFtZXNwYWNlKSB7XG4gICAgICBlbGVtZW50LnJlbW92ZUF0dHJpYnV0ZU5TKG5hbWVzcGFjZSwgbmFtZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKG5hbWUpO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgU2FmZUR5bmFtaWNQcm9wZXJ0eSBleHRlbmRzIERlZmF1bHREeW5hbWljUHJvcGVydHkge1xuICBzZXQoZG9tOiBFbGVtZW50QnVpbGRlciwgdmFsdWU6IE9wYXF1ZSwgZW52OiBFbnZpcm9ubWVudCk6IHZvaWQge1xuICAgIGxldCB7IGVsZW1lbnQsIG5hbWUgfSA9IHRoaXMuYXR0cmlidXRlO1xuICAgIGxldCBzYW5pdGl6ZWQgPSBzYW5pdGl6ZUF0dHJpYnV0ZVZhbHVlKGVudiwgZWxlbWVudCwgbmFtZSwgdmFsdWUpO1xuICAgIHN1cGVyLnNldChkb20sIHNhbml0aXplZCwgZW52KTtcbiAgfVxuXG4gIHVwZGF0ZSh2YWx1ZTogT3BhcXVlLCBlbnY6IEVudmlyb25tZW50KTogdm9pZCB7XG4gICAgbGV0IHsgZWxlbWVudCwgbmFtZSB9ID0gdGhpcy5hdHRyaWJ1dGU7XG4gICAgbGV0IHNhbml0aXplZCA9IHNhbml0aXplQXR0cmlidXRlVmFsdWUoZW52LCBlbGVtZW50LCBuYW1lLCB2YWx1ZSk7XG4gICAgc3VwZXIudXBkYXRlKHNhbml0aXplZCwgZW52KTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgU2FmZUR5bmFtaWNBdHRyaWJ1dGUgZXh0ZW5kcyBTaW1wbGVEeW5hbWljQXR0cmlidXRlIHtcbiAgc2V0KGRvbTogRWxlbWVudEJ1aWxkZXIsIHZhbHVlOiBPcGFxdWUsIGVudjogRW52aXJvbm1lbnQpOiB2b2lkIHtcbiAgICBsZXQgeyBlbGVtZW50LCBuYW1lIH0gPSB0aGlzLmF0dHJpYnV0ZTtcbiAgICBsZXQgc2FuaXRpemVkID0gc2FuaXRpemVBdHRyaWJ1dGVWYWx1ZShlbnYsIGVsZW1lbnQsIG5hbWUsIHZhbHVlKTtcbiAgICBzdXBlci5zZXQoZG9tLCBzYW5pdGl6ZWQsIGVudik7XG4gIH1cblxuICB1cGRhdGUodmFsdWU6IE9wYXF1ZSwgZW52OiBFbnZpcm9ubWVudCk6IHZvaWQge1xuICAgIGxldCB7IGVsZW1lbnQsIG5hbWUgfSA9IHRoaXMuYXR0cmlidXRlO1xuICAgIGxldCBzYW5pdGl6ZWQgPSBzYW5pdGl6ZUF0dHJpYnV0ZVZhbHVlKGVudiwgZWxlbWVudCwgbmFtZSwgdmFsdWUpO1xuICAgIHN1cGVyLnVwZGF0ZShzYW5pdGl6ZWQsIGVudik7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIElucHV0VmFsdWVEeW5hbWljQXR0cmlidXRlIGV4dGVuZHMgRGVmYXVsdER5bmFtaWNQcm9wZXJ0eSB7XG4gIHNldChkb206IEVsZW1lbnRCdWlsZGVyLCB2YWx1ZTogT3BhcXVlKSB7XG4gICAgZG9tLl9fc2V0UHJvcGVydHkoJ3ZhbHVlJywgbm9ybWFsaXplU3RyaW5nVmFsdWUodmFsdWUpKTtcbiAgfVxuXG4gIHVwZGF0ZSh2YWx1ZTogT3BhcXVlKSB7XG4gICAgbGV0IGlucHV0ID0gdGhpcy5hdHRyaWJ1dGUuZWxlbWVudCBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgIGxldCBjdXJyZW50VmFsdWUgPSBpbnB1dC52YWx1ZTtcbiAgICBsZXQgbm9ybWFsaXplZFZhbHVlID0gbm9ybWFsaXplU3RyaW5nVmFsdWUodmFsdWUpO1xuICAgIGlmIChjdXJyZW50VmFsdWUgIT09IG5vcm1hbGl6ZWRWYWx1ZSkge1xuICAgICAgaW5wdXQudmFsdWUgPSBub3JtYWxpemVkVmFsdWUhO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgT3B0aW9uU2VsZWN0ZWREeW5hbWljQXR0cmlidXRlIGV4dGVuZHMgRGVmYXVsdER5bmFtaWNQcm9wZXJ0eSB7XG4gIHNldChkb206IEVsZW1lbnRCdWlsZGVyLCB2YWx1ZTogT3BhcXVlKTogdm9pZCB7XG4gICAgaWYgKHZhbHVlICE9PSBudWxsICYmIHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgIT09IGZhbHNlKSB7XG4gICAgICBkb20uX19zZXRQcm9wZXJ0eSgnc2VsZWN0ZWQnLCB0cnVlKTtcbiAgICB9XG4gIH1cblxuICB1cGRhdGUodmFsdWU6IE9wYXF1ZSk6IHZvaWQge1xuICAgIGxldCBvcHRpb24gPSB0aGlzLmF0dHJpYnV0ZS5lbGVtZW50IGFzIEhUTUxPcHRpb25FbGVtZW50O1xuXG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICBvcHRpb24uc2VsZWN0ZWQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBvcHRpb24uc2VsZWN0ZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gaXNPcHRpb25TZWxlY3RlZCh0YWdOYW1lOiBzdHJpbmcsIGF0dHJpYnV0ZTogc3RyaW5nKSB7XG4gIHJldHVybiB0YWdOYW1lID09PSAnT1BUSU9OJyAmJiBhdHRyaWJ1dGUgPT09ICdzZWxlY3RlZCc7XG59XG5cbmZ1bmN0aW9uIGlzVXNlcklucHV0VmFsdWUodGFnTmFtZTogc3RyaW5nLCBhdHRyaWJ1dGU6IHN0cmluZykge1xuICByZXR1cm4gKHRhZ05hbWUgPT09ICdJTlBVVCcgfHwgdGFnTmFtZSA9PT0gJ1RFWFRBUkVBJykgJiYgYXR0cmlidXRlID09PSAndmFsdWUnO1xufVxuXG5mdW5jdGlvbiBub3JtYWxpemVWYWx1ZSh2YWx1ZTogT3BhcXVlKTogT3B0aW9uPHN0cmluZz4ge1xuICBpZiAodmFsdWUgPT09IGZhbHNlIHx8IHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09IG51bGwgfHwgdHlwZW9mIHZhbHVlLnRvU3RyaW5nID09PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGlmICh2YWx1ZSA9PT0gdHJ1ZSkge1xuICAgIHJldHVybiAnJztcbiAgfVxuICAvLyBvbmNsaWNrIGZ1bmN0aW9uIGV0YyBpbiBTU1JcbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcmV0dXJuIFN0cmluZyh2YWx1ZSk7XG59XG4iXX0=","import { assert, ensureGuid } from '@glimmer/util';\nimport { DOMChanges, DOMTreeConstruction } from './dom/helper';\nimport { UNDEFINED_REFERENCE, ConditionalReference } from './references';\nimport { defaultDynamicAttributes } from './vm/attributes/dynamic';\nexport class Scope {\n    constructor(\n    // the 0th slot is `self`\n    slots, callerScope,\n    // named arguments and blocks passed to a layout that uses eval\n    evalScope,\n    // locals in scope when the partial was invoked\n    partialMap) {\n        this.slots = slots;\n        this.callerScope = callerScope;\n        this.evalScope = evalScope;\n        this.partialMap = partialMap;\n    }\n    static root(self, size = 0) {\n        let refs = new Array(size + 1);\n        for (let i = 0; i <= size; i++) {\n            refs[i] = UNDEFINED_REFERENCE;\n        }\n        return new Scope(refs, null, null, null).init({ self });\n    }\n    static sized(size = 0) {\n        let refs = new Array(size + 1);\n        for (let i = 0; i <= size; i++) {\n            refs[i] = UNDEFINED_REFERENCE;\n        }\n        return new Scope(refs, null, null, null);\n    }\n    init({ self }) {\n        this.slots[0] = self;\n        return this;\n    }\n    getSelf() {\n        return this.get(0);\n    }\n    getSymbol(symbol) {\n        return this.get(symbol);\n    }\n    getBlock(symbol) {\n        return this.get(symbol);\n    }\n    getEvalScope() {\n        return this.evalScope;\n    }\n    getPartialMap() {\n        return this.partialMap;\n    }\n    bind(symbol, value) {\n        this.set(symbol, value);\n    }\n    bindSelf(self) {\n        this.set(0, self);\n    }\n    bindSymbol(symbol, value) {\n        this.set(symbol, value);\n    }\n    bindBlock(symbol, value) {\n        this.set(symbol, value);\n    }\n    bindEvalScope(map) {\n        this.evalScope = map;\n    }\n    bindPartialMap(map) {\n        this.partialMap = map;\n    }\n    bindCallerScope(scope) {\n        this.callerScope = scope;\n    }\n    getCallerScope() {\n        return this.callerScope;\n    }\n    child() {\n        return new Scope(this.slots.slice(), this.callerScope, this.evalScope, this.partialMap);\n    }\n    get(index) {\n        if (index >= this.slots.length) {\n            throw new RangeError(`BUG: cannot get $${index} from scope; length=${this.slots.length}`);\n        }\n        return this.slots[index];\n    }\n    set(index, value) {\n        if (index >= this.slots.length) {\n            throw new RangeError(`BUG: cannot get $${index} from scope; length=${this.slots.length}`);\n        }\n        this.slots[index] = value;\n    }\n}\nclass Transaction {\n    constructor() {\n        this.scheduledInstallManagers = [];\n        this.scheduledInstallModifiers = [];\n        this.scheduledUpdateModifierManagers = [];\n        this.scheduledUpdateModifiers = [];\n        this.createdComponents = [];\n        this.createdManagers = [];\n        this.updatedComponents = [];\n        this.updatedManagers = [];\n        this.destructors = [];\n    }\n    didCreate(component, manager) {\n        this.createdComponents.push(component);\n        this.createdManagers.push(manager);\n    }\n    didUpdate(component, manager) {\n        this.updatedComponents.push(component);\n        this.updatedManagers.push(manager);\n    }\n    scheduleInstallModifier(modifier, manager) {\n        this.scheduledInstallManagers.push(manager);\n        this.scheduledInstallModifiers.push(modifier);\n    }\n    scheduleUpdateModifier(modifier, manager) {\n        this.scheduledUpdateModifierManagers.push(manager);\n        this.scheduledUpdateModifiers.push(modifier);\n    }\n    didDestroy(d) {\n        this.destructors.push(d);\n    }\n    commit() {\n        let { createdComponents, createdManagers } = this;\n        for (let i = 0; i < createdComponents.length; i++) {\n            let component = createdComponents[i];\n            let manager = createdManagers[i];\n            manager.didCreate(component);\n        }\n        let { updatedComponents, updatedManagers } = this;\n        for (let i = 0; i < updatedComponents.length; i++) {\n            let component = updatedComponents[i];\n            let manager = updatedManagers[i];\n            manager.didUpdate(component);\n        }\n        let { destructors } = this;\n        for (let i = 0; i < destructors.length; i++) {\n            destructors[i].destroy();\n        }\n        let { scheduledInstallManagers, scheduledInstallModifiers } = this;\n        for (let i = 0; i < scheduledInstallManagers.length; i++) {\n            let manager = scheduledInstallManagers[i];\n            let modifier = scheduledInstallModifiers[i];\n            manager.install(modifier);\n        }\n        let { scheduledUpdateModifierManagers, scheduledUpdateModifiers } = this;\n        for (let i = 0; i < scheduledUpdateModifierManagers.length; i++) {\n            let manager = scheduledUpdateModifierManagers[i];\n            let modifier = scheduledUpdateModifiers[i];\n            manager.update(modifier);\n        }\n    }\n}\nexport class Environment {\n    constructor({ appendOperations, updateOperations }) {\n        this._transaction = null;\n        this.appendOperations = appendOperations;\n        this.updateOperations = updateOperations;\n    }\n    toConditionalReference(reference) {\n        return new ConditionalReference(reference);\n    }\n    getAppendOperations() {\n        return this.appendOperations;\n    }\n    getDOM() {\n        return this.updateOperations;\n    }\n    getIdentity(object) {\n        return ensureGuid(object) + '';\n    }\n    begin() {\n        (false && assert(!this._transaction, 'a glimmer transaction was begun, but one already exists. You may have a nested transaction'));\n\n        this._transaction = new Transaction();\n    }\n    get transaction() {\n        return this._transaction;\n    }\n    didCreate(component, manager) {\n        this.transaction.didCreate(component, manager);\n    }\n    didUpdate(component, manager) {\n        this.transaction.didUpdate(component, manager);\n    }\n    scheduleInstallModifier(modifier, manager) {\n        this.transaction.scheduleInstallModifier(modifier, manager);\n    }\n    scheduleUpdateModifier(modifier, manager) {\n        this.transaction.scheduleUpdateModifier(modifier, manager);\n    }\n    didDestroy(d) {\n        this.transaction.didDestroy(d);\n    }\n    commit() {\n        let transaction = this.transaction;\n        this._transaction = null;\n        transaction.commit();\n    }\n    attributeFor(element, attr, _isTrusting, _namespace = null) {\n        return defaultDynamicAttributes(element, attr);\n    }\n}\nexport class DefaultEnvironment extends Environment {\n    constructor(options) {\n        if (!options) {\n            let document = window.document;\n            let appendOperations = new DOMTreeConstruction(document);\n            let updateOperations = new DOMChanges(document);\n            options = { appendOperations, updateOperations };\n        }\n        super(options);\n    }\n}\nexport default Environment;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW52aXJvbm1lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci9ydW50aW1lL2xpYi9lbnZpcm9ubWVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFJQSxBQUFPLFNBTUwsQUFBTSxRQUNOLEFBQVUsQUFDVixBQUFNLEFBQ1Asa0JBQU0sQUFBZSxBQUFDO0FBRXZCLEFBQU8sU0FBRSxBQUFVLFlBQUUsQUFBbUIsQUFBRSwyQkFBTSxBQUFjLEFBQUM7QUFHL0QsQUFBTyxTQUFFLEFBQW1CLHFCQUFFLEFBQW9CLEFBQUUsNEJBQU0sQUFBYyxBQUFDO0FBQ3pFLEFBQU8sU0FBMkIsQUFBd0IsQUFBRSxnQ0FBTSxBQUF5QixBQUFDO0FBZ0I1RixBQUFNO0FBcUJKO0FBQ0UsQUFBeUI7QUFDakIsQUFBa0IsV0FDbEIsQUFBMEI7QUFDbEMsQUFBK0Q7QUFDdkQsQUFBa0M7QUFDMUMsQUFBK0M7QUFDdkMsQUFBK0M7QUFML0MsYUFBSyxRQUFMLEFBQUssQUFBYTtBQUNsQixhQUFXLGNBQVgsQUFBVyxBQUFlO0FBRTFCLGFBQVMsWUFBVCxBQUFTLEFBQXlCO0FBRWxDLGFBQVUsYUFBVixBQUFVLEFBQXFDLEFBQ3pEO0FBQUM7QUE1QkQsQUFBTSxXQUFDLEFBQUksS0FBQyxBQUEyQixNQUFFLEFBQUksT0FBRyxBQUFDO0FBQy9DLFlBQUksQUFBSSxPQUE0QixJQUFJLEFBQUssTUFBQyxBQUFJLE9BQUcsQUFBQyxBQUFDLEFBQUM7QUFFeEQsQUFBRyxBQUFDLGFBQUMsSUFBSSxBQUFDLElBQUcsQUFBQyxHQUFFLEFBQUMsS0FBSSxBQUFJLE1BQUUsQUFBQyxBQUFFLEtBQUUsQUFBQztBQUMvQixBQUFJLGlCQUFDLEFBQUMsQUFBQyxLQUFHLEFBQW1CLEFBQUMsQUFDaEM7QUFBQztBQUVELEFBQU0sZUFBQyxJQUFJLEFBQUssTUFBQyxBQUFJLE1BQUUsQUFBSSxNQUFFLEFBQUksTUFBRSxBQUFJLEFB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QUNGOztBQUVELGVBQWUsQUFBVyxBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUmVmZXJlbmNlLCBQYXRoUmVmZXJlbmNlLCBPcGFxdWVJdGVyYWJsZSB9IGZyb20gJ0BnbGltbWVyL3JlZmVyZW5jZSc7XG5pbXBvcnQgeyBNYWNyb3MsIE9wY29kZUJ1aWxkZXJDb25zdHJ1Y3RvciwgSUNvbXBpbGFibGVUZW1wbGF0ZSB9IGZyb20gJ0BnbGltbWVyL29wY29kZS1jb21waWxlcic7XG5pbXBvcnQgeyBTaW1wbGUsIFJ1bnRpbWVSZXNvbHZlciwgQmxvY2tTeW1ib2xUYWJsZSwgVk1IYW5kbGUgfSBmcm9tICdAZ2xpbW1lci9pbnRlcmZhY2VzJztcbmltcG9ydCB7IFByb2dyYW0gfSBmcm9tIFwiQGdsaW1tZXIvcHJvZ3JhbVwiO1xuaW1wb3J0IHtcbiAgRGljdCxcbiAgT3B0aW9uLFxuICBEZXN0cm95YWJsZSxcbiAgT3BhcXVlLFxuICBIYXNHdWlkLFxuICBhc3NlcnQsXG4gIGVuc3VyZUd1aWQsXG4gIGV4cGVjdFxufSBmcm9tICdAZ2xpbW1lci91dGlsJztcblxuaW1wb3J0IHsgRE9NQ2hhbmdlcywgRE9NVHJlZUNvbnN0cnVjdGlvbiB9IGZyb20gJy4vZG9tL2hlbHBlcic7XG5pbXBvcnQgeyBQdWJsaWNWTSB9IGZyb20gJy4vdm0vYXBwZW5kJztcbmltcG9ydCB7IElBcmd1bWVudHMgfSBmcm9tICcuL3ZtL2FyZ3VtZW50cyc7XG5pbXBvcnQgeyBVTkRFRklORURfUkVGRVJFTkNFLCBDb25kaXRpb25hbFJlZmVyZW5jZSB9IGZyb20gJy4vcmVmZXJlbmNlcyc7XG5pbXBvcnQgeyBEeW5hbWljQXR0cmlidXRlRmFjdG9yeSwgZGVmYXVsdER5bmFtaWNBdHRyaWJ1dGVzIH0gZnJvbSAnLi92bS9hdHRyaWJ1dGVzL2R5bmFtaWMnO1xuaW1wb3J0IHtcbiAgTW9kaWZpZXJNYW5hZ2VyLCBNb2RpZmllclxufSBmcm9tICcuL21vZGlmaWVyL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgQ29tcG9uZW50LCBDb21wb25lbnRNYW5hZ2VyIH0gZnJvbSBcIi4vaW50ZXJuYWwtaW50ZXJmYWNlc1wiO1xuXG5leHBvcnQgdHlwZSBTY29wZUJsb2NrID0gW1ZNSGFuZGxlIHwgSUNvbXBpbGFibGVUZW1wbGF0ZTxCbG9ja1N5bWJvbFRhYmxlPiwgU2NvcGUsIEJsb2NrU3ltYm9sVGFibGVdO1xuZXhwb3J0IHR5cGUgQmxvY2tWYWx1ZSA9IFNjb3BlQmxvY2tbMCB8IDEgfCAyXTtcbmV4cG9ydCB0eXBlIFNjb3BlU2xvdCA9IE9wdGlvbjxQYXRoUmVmZXJlbmNlPE9wYXF1ZT4+IHwgT3B0aW9uPFNjb3BlQmxvY2s+O1xuXG5leHBvcnQgaW50ZXJmYWNlIER5bmFtaWNTY29wZSB7XG4gIGdldChrZXk6IHN0cmluZyk6IFBhdGhSZWZlcmVuY2U8T3BhcXVlPjtcbiAgc2V0KGtleTogc3RyaW5nLCByZWZlcmVuY2U6IFBhdGhSZWZlcmVuY2U8T3BhcXVlPik6IFBhdGhSZWZlcmVuY2U8T3BhcXVlPjtcbiAgY2hpbGQoKTogRHluYW1pY1Njb3BlO1xufVxuXG5leHBvcnQgY2xhc3MgU2NvcGUge1xuICBzdGF0aWMgcm9vdChzZWxmOiBQYXRoUmVmZXJlbmNlPE9wYXF1ZT4sIHNpemUgPSAwKSB7XG4gICAgbGV0IHJlZnM6IFBhdGhSZWZlcmVuY2U8T3BhcXVlPltdID0gbmV3IEFycmF5KHNpemUgKyAxKTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IHNpemU7IGkrKykge1xuICAgICAgcmVmc1tpXSA9IFVOREVGSU5FRF9SRUZFUkVOQ0U7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBTY29wZShyZWZzLCBudWxsLCBudWxsLCBudWxsKS5pbml0KHsgc2VsZiB9KTtcbiAgfVxuXG4gIHN0YXRpYyBzaXplZChzaXplID0gMCkge1xuICAgIGxldCByZWZzOiBQYXRoUmVmZXJlbmNlPE9wYXF1ZT5bXSA9IG5ldyBBcnJheShzaXplICsgMSk7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8PSBzaXplOyBpKyspIHtcbiAgICAgIHJlZnNbaV0gPSBVTkRFRklORURfUkVGRVJFTkNFO1xuICAgIH1cblxuICAgIHJldHVybiBuZXcgU2NvcGUocmVmcywgbnVsbCwgbnVsbCwgbnVsbCk7XG4gIH1cblxuICBjb25zdHJ1Y3RvcihcbiAgICAvLyB0aGUgMHRoIHNsb3QgaXMgYHNlbGZgXG4gICAgcHJpdmF0ZSBzbG90czogU2NvcGVTbG90W10sXG4gICAgcHJpdmF0ZSBjYWxsZXJTY29wZTogT3B0aW9uPFNjb3BlPixcbiAgICAvLyBuYW1lZCBhcmd1bWVudHMgYW5kIGJsb2NrcyBwYXNzZWQgdG8gYSBsYXlvdXQgdGhhdCB1c2VzIGV2YWxcbiAgICBwcml2YXRlIGV2YWxTY29wZTogT3B0aW9uPERpY3Q8U2NvcGVTbG90Pj4sXG4gICAgLy8gbG9jYWxzIGluIHNjb3BlIHdoZW4gdGhlIHBhcnRpYWwgd2FzIGludm9rZWRcbiAgICBwcml2YXRlIHBhcnRpYWxNYXA6IE9wdGlvbjxEaWN0PFBhdGhSZWZlcmVuY2U8T3BhcXVlPj4+KSB7XG4gIH1cblxuICBpbml0KHsgc2VsZiB9OiB7IHNlbGY6IFBhdGhSZWZlcmVuY2U8T3BhcXVlPiB9KTogdGhpcyB7XG4gICAgdGhpcy5zbG90c1swXSA9IHNlbGY7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBnZXRTZWxmKCk6IFBhdGhSZWZlcmVuY2U8T3BhcXVlPiB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0PFBhdGhSZWZlcmVuY2U8T3BhcXVlPj4oMCk7XG4gIH1cblxuICBnZXRTeW1ib2woc3ltYm9sOiBudW1iZXIpOiBQYXRoUmVmZXJlbmNlPE9wYXF1ZT4ge1xuICAgIHJldHVybiB0aGlzLmdldDxQYXRoUmVmZXJlbmNlPE9wYXF1ZT4+KHN5bWJvbCk7XG4gIH1cblxuICBnZXRCbG9jayhzeW1ib2w6IG51bWJlcik6IFNjb3BlQmxvY2sge1xuICAgIHJldHVybiB0aGlzLmdldDxTY29wZUJsb2NrPihzeW1ib2wpO1xuICB9XG5cbiAgZ2V0RXZhbFNjb3BlKCk6IE9wdGlvbjxEaWN0PFNjb3BlU2xvdD4+IHtcbiAgICByZXR1cm4gdGhpcy5ldmFsU2NvcGU7XG4gIH1cblxuICBnZXRQYXJ0aWFsTWFwKCk6IE9wdGlvbjxEaWN0PFBhdGhSZWZlcmVuY2U8T3BhcXVlPj4+IHtcbiAgICByZXR1cm4gdGhpcy5wYXJ0aWFsTWFwO1xuICB9XG5cbiAgYmluZChzeW1ib2w6IG51bWJlciwgdmFsdWU6IFNjb3BlU2xvdCkge1xuICAgIHRoaXMuc2V0KHN5bWJvbCwgdmFsdWUpO1xuICB9XG5cbiAgYmluZFNlbGYoc2VsZjogUGF0aFJlZmVyZW5jZTxPcGFxdWU+KSB7XG4gICAgdGhpcy5zZXQ8UGF0aFJlZmVyZW5jZTxPcGFxdWU+PigwLCBzZWxmKTtcbiAgfVxuXG4gIGJpbmRTeW1ib2woc3ltYm9sOiBudW1iZXIsIHZhbHVlOiBQYXRoUmVmZXJlbmNlPE9wYXF1ZT4pIHtcbiAgICB0aGlzLnNldChzeW1ib2wsIHZhbHVlKTtcbiAgfVxuXG4gIGJpbmRCbG9jayhzeW1ib2w6IG51bWJlciwgdmFsdWU6IE9wdGlvbjxTY29wZUJsb2NrPikge1xuICAgIHRoaXMuc2V0PE9wdGlvbjxTY29wZUJsb2NrPj4oc3ltYm9sLCB2YWx1ZSk7XG4gIH1cblxuICBiaW5kRXZhbFNjb3BlKG1hcDogT3B0aW9uPERpY3Q8U2NvcGVTbG90Pj4pIHtcbiAgICB0aGlzLmV2YWxTY29wZSA9IG1hcDtcbiAgfVxuXG4gIGJpbmRQYXJ0aWFsTWFwKG1hcDogRGljdDxQYXRoUmVmZXJlbmNlPE9wYXF1ZT4+KSB7XG4gICAgdGhpcy5wYXJ0aWFsTWFwID0gbWFwO1xuICB9XG5cbiAgYmluZENhbGxlclNjb3BlKHNjb3BlOiBPcHRpb248U2NvcGU+KSB7XG4gICAgdGhpcy5jYWxsZXJTY29wZSA9IHNjb3BlO1xuICB9XG5cbiAgZ2V0Q2FsbGVyU2NvcGUoKTogT3B0aW9uPFNjb3BlPiB7XG4gICAgcmV0dXJuIHRoaXMuY2FsbGVyU2NvcGU7XG4gIH1cblxuICBjaGlsZCgpOiBTY29wZSB7XG4gICAgcmV0dXJuIG5ldyBTY29wZSh0aGlzLnNsb3RzLnNsaWNlKCksIHRoaXMuY2FsbGVyU2NvcGUsIHRoaXMuZXZhbFNjb3BlLCB0aGlzLnBhcnRpYWxNYXApO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXQ8VCBleHRlbmRzIFNjb3BlU2xvdD4oaW5kZXg6IG51bWJlcik6IFQge1xuICAgIGlmIChpbmRleCA+PSB0aGlzLnNsb3RzLmxlbmd0aCkge1xuICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoYEJVRzogY2Fubm90IGdldCAkJHtpbmRleH0gZnJvbSBzY29wZTsgbGVuZ3RoPSR7dGhpcy5zbG90cy5sZW5ndGh9YCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuc2xvdHNbaW5kZXhdIGFzIFQ7XG4gIH1cblxuICBwcml2YXRlIHNldDxUIGV4dGVuZHMgU2NvcGVTbG90PihpbmRleDogbnVtYmVyLCB2YWx1ZTogVCk6IHZvaWQge1xuICAgIGlmIChpbmRleCA+PSB0aGlzLnNsb3RzLmxlbmd0aCkge1xuICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoYEJVRzogY2Fubm90IGdldCAkJHtpbmRleH0gZnJvbSBzY29wZTsgbGVuZ3RoPSR7dGhpcy5zbG90cy5sZW5ndGh9YCk7XG4gICAgfVxuXG4gICAgdGhpcy5zbG90c1tpbmRleF0gPSB2YWx1ZTtcbiAgfVxufVxuXG5jbGFzcyBUcmFuc2FjdGlvbiB7XG4gIHB1YmxpYyBzY2hlZHVsZWRJbnN0YWxsTWFuYWdlcnM6IE1vZGlmaWVyTWFuYWdlcltdID0gW107XG4gIHB1YmxpYyBzY2hlZHVsZWRJbnN0YWxsTW9kaWZpZXJzOiBNb2RpZmllcltdID0gW107XG4gIHB1YmxpYyBzY2hlZHVsZWRVcGRhdGVNb2RpZmllck1hbmFnZXJzOiBNb2RpZmllck1hbmFnZXJbXSA9IFtdO1xuICBwdWJsaWMgc2NoZWR1bGVkVXBkYXRlTW9kaWZpZXJzOiBNb2RpZmllcltdID0gW107XG4gIHB1YmxpYyBjcmVhdGVkQ29tcG9uZW50czogQ29tcG9uZW50W10gPSBbXTtcbiAgcHVibGljIGNyZWF0ZWRNYW5hZ2VyczogQ29tcG9uZW50TWFuYWdlcltdID0gW107XG4gIHB1YmxpYyB1cGRhdGVkQ29tcG9uZW50czogQ29tcG9uZW50W10gPSBbXTtcbiAgcHVibGljIHVwZGF0ZWRNYW5hZ2VyczogQ29tcG9uZW50TWFuYWdlcltdID0gW107XG4gIHB1YmxpYyBkZXN0cnVjdG9yczogRGVzdHJveWFibGVbXSA9IFtdO1xuXG4gIGRpZENyZWF0ZShjb21wb25lbnQ6IENvbXBvbmVudCwgbWFuYWdlcjogQ29tcG9uZW50TWFuYWdlcikge1xuICAgIHRoaXMuY3JlYXRlZENvbXBvbmVudHMucHVzaChjb21wb25lbnQpO1xuICAgIHRoaXMuY3JlYXRlZE1hbmFnZXJzLnB1c2gobWFuYWdlcik7XG4gIH1cblxuICBkaWRVcGRhdGUoY29tcG9uZW50OiBDb21wb25lbnQsIG1hbmFnZXI6IENvbXBvbmVudE1hbmFnZXIpIHtcbiAgICB0aGlzLnVwZGF0ZWRDb21wb25lbnRzLnB1c2goY29tcG9uZW50KTtcbiAgICB0aGlzLnVwZGF0ZWRNYW5hZ2Vycy5wdXNoKG1hbmFnZXIpO1xuICB9XG5cbiAgc2NoZWR1bGVJbnN0YWxsTW9kaWZpZXIobW9kaWZpZXI6IE1vZGlmaWVyLCBtYW5hZ2VyOiBNb2RpZmllck1hbmFnZXIpIHtcbiAgICB0aGlzLnNjaGVkdWxlZEluc3RhbGxNYW5hZ2Vycy5wdXNoKG1hbmFnZXIpO1xuICAgIHRoaXMuc2NoZWR1bGVkSW5zdGFsbE1vZGlmaWVycy5wdXNoKG1vZGlmaWVyKTtcbiAgfVxuXG4gIHNjaGVkdWxlVXBkYXRlTW9kaWZpZXIobW9kaWZpZXI6IE1vZGlmaWVyLCBtYW5hZ2VyOiBNb2RpZmllck1hbmFnZXIpIHtcbiAgICB0aGlzLnNjaGVkdWxlZFVwZGF0ZU1vZGlmaWVyTWFuYWdlcnMucHVzaChtYW5hZ2VyKTtcbiAgICB0aGlzLnNjaGVkdWxlZFVwZGF0ZU1vZGlmaWVycy5wdXNoKG1vZGlmaWVyKTtcbiAgfVxuXG4gIGRpZERlc3Ryb3koZDogRGVzdHJveWFibGUpIHtcbiAgICB0aGlzLmRlc3RydWN0b3JzLnB1c2goZCk7XG4gIH1cblxuICBjb21taXQoKSB7XG4gICAgbGV0IHsgY3JlYXRlZENvbXBvbmVudHMsIGNyZWF0ZWRNYW5hZ2VycyB9ID0gdGhpcztcblxuICAgIGZvciAobGV0IGk9MDsgaTxjcmVhdGVkQ29tcG9uZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IGNvbXBvbmVudCA9IGNyZWF0ZWRDb21wb25lbnRzW2ldO1xuICAgICAgbGV0IG1hbmFnZXIgPSBjcmVhdGVkTWFuYWdlcnNbaV07XG4gICAgICBtYW5hZ2VyLmRpZENyZWF0ZShjb21wb25lbnQpO1xuICAgIH1cblxuICAgIGxldCB7IHVwZGF0ZWRDb21wb25lbnRzLCB1cGRhdGVkTWFuYWdlcnMgfSA9IHRoaXM7XG5cbiAgICBmb3IgKGxldCBpPTA7IGk8dXBkYXRlZENvbXBvbmVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGxldCBjb21wb25lbnQgPSB1cGRhdGVkQ29tcG9uZW50c1tpXTtcbiAgICAgIGxldCBtYW5hZ2VyID0gdXBkYXRlZE1hbmFnZXJzW2ldO1xuICAgICAgbWFuYWdlci5kaWRVcGRhdGUoY29tcG9uZW50KTtcbiAgICB9XG5cbiAgICBsZXQgeyBkZXN0cnVjdG9ycyB9ID0gdGhpcztcblxuICAgIGZvciAobGV0IGk9MDsgaTxkZXN0cnVjdG9ycy5sZW5ndGg7IGkrKykge1xuICAgICAgZGVzdHJ1Y3RvcnNbaV0uZGVzdHJveSgpO1xuICAgIH1cblxuICAgIGxldCB7IHNjaGVkdWxlZEluc3RhbGxNYW5hZ2Vycywgc2NoZWR1bGVkSW5zdGFsbE1vZGlmaWVycyB9ID0gdGhpcztcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2NoZWR1bGVkSW5zdGFsbE1hbmFnZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgbWFuYWdlciA9IHNjaGVkdWxlZEluc3RhbGxNYW5hZ2Vyc1tpXTtcbiAgICAgIGxldCBtb2RpZmllciA9IHNjaGVkdWxlZEluc3RhbGxNb2RpZmllcnNbaV07XG4gICAgICBtYW5hZ2VyLmluc3RhbGwobW9kaWZpZXIpO1xuICAgIH1cblxuICAgIGxldCB7IHNjaGVkdWxlZFVwZGF0ZU1vZGlmaWVyTWFuYWdlcnMsIHNjaGVkdWxlZFVwZGF0ZU1vZGlmaWVycyB9ID0gdGhpcztcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2NoZWR1bGVkVXBkYXRlTW9kaWZpZXJNYW5hZ2Vycy5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IG1hbmFnZXIgPSBzY2hlZHVsZWRVcGRhdGVNb2RpZmllck1hbmFnZXJzW2ldO1xuICAgICAgbGV0IG1vZGlmaWVyID0gc2NoZWR1bGVkVXBkYXRlTW9kaWZpZXJzW2ldO1xuICAgICAgbWFuYWdlci51cGRhdGUobW9kaWZpZXIpO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIENvbXBpbGF0aW9uT3B0aW9uczxTcGVjaWZpZXIsIFIgZXh0ZW5kcyBSdW50aW1lUmVzb2x2ZXI8U3BlY2lmaWVyPj4ge1xuICByZXNvbHZlcjogUjtcbiAgcHJvZ3JhbTogUHJvZ3JhbTxTcGVjaWZpZXI+O1xuICBtYWNyb3M6IE1hY3JvcztcbiAgQnVpbGRlcjogT3Bjb2RlQnVpbGRlckNvbnN0cnVjdG9yO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEVudmlyb25tZW50T3B0aW9ucyB7XG4gIGFwcGVuZE9wZXJhdGlvbnM6IERPTVRyZWVDb25zdHJ1Y3Rpb247XG4gIHVwZGF0ZU9wZXJhdGlvbnM6IERPTUNoYW5nZXM7XG59XG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBFbnZpcm9ubWVudCB7XG4gIHByb3RlY3RlZCB1cGRhdGVPcGVyYXRpb25zOiBET01DaGFuZ2VzO1xuICBwcm90ZWN0ZWQgYXBwZW5kT3BlcmF0aW9uczogRE9NVHJlZUNvbnN0cnVjdGlvbjtcbiAgcHJpdmF0ZSBfdHJhbnNhY3Rpb246IE9wdGlvbjxUcmFuc2FjdGlvbj4gPSBudWxsO1xuXG4gIGNvbnN0cnVjdG9yKHsgYXBwZW5kT3BlcmF0aW9ucywgdXBkYXRlT3BlcmF0aW9ucyB9OiBFbnZpcm9ubWVudE9wdGlvbnMpIHtcbiAgICB0aGlzLmFwcGVuZE9wZXJhdGlvbnMgPSBhcHBlbmRPcGVyYXRpb25zO1xuICAgIHRoaXMudXBkYXRlT3BlcmF0aW9ucyA9IHVwZGF0ZU9wZXJhdGlvbnM7XG4gIH1cblxuICB0b0NvbmRpdGlvbmFsUmVmZXJlbmNlKHJlZmVyZW5jZTogUmVmZXJlbmNlKTogUmVmZXJlbmNlPGJvb2xlYW4+IHtcbiAgICByZXR1cm4gbmV3IENvbmRpdGlvbmFsUmVmZXJlbmNlKHJlZmVyZW5jZSk7XG4gIH1cblxuICBhYnN0cmFjdCBpdGVyYWJsZUZvcihyZWZlcmVuY2U6IFJlZmVyZW5jZSwga2V5OiBzdHJpbmcpOiBPcGFxdWVJdGVyYWJsZTtcbiAgYWJzdHJhY3QgcHJvdG9jb2xGb3JVUkwoczogc3RyaW5nKTogc3RyaW5nO1xuXG4gIGdldEFwcGVuZE9wZXJhdGlvbnMoKTogRE9NVHJlZUNvbnN0cnVjdGlvbiB7IHJldHVybiB0aGlzLmFwcGVuZE9wZXJhdGlvbnM7IH1cbiAgZ2V0RE9NKCk6IERPTUNoYW5nZXMgeyByZXR1cm4gdGhpcy51cGRhdGVPcGVyYXRpb25zOyB9XG5cbiAgZ2V0SWRlbnRpdHkob2JqZWN0OiBIYXNHdWlkKTogc3RyaW5nIHtcbiAgICByZXR1cm4gZW5zdXJlR3VpZChvYmplY3QpICsgJyc7XG4gIH1cblxuICBiZWdpbigpIHtcbiAgICBhc3NlcnQoIXRoaXMuX3RyYW5zYWN0aW9uLCAnYSBnbGltbWVyIHRyYW5zYWN0aW9uIHdhcyBiZWd1biwgYnV0IG9uZSBhbHJlYWR5IGV4aXN0cy4gWW91IG1heSBoYXZlIGEgbmVzdGVkIHRyYW5zYWN0aW9uJyk7XG4gICAgdGhpcy5fdHJhbnNhY3Rpb24gPSBuZXcgVHJhbnNhY3Rpb24oKTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0IHRyYW5zYWN0aW9uKCk6IFRyYW5zYWN0aW9uIHtcbiAgICByZXR1cm4gZXhwZWN0KHRoaXMuX3RyYW5zYWN0aW9uISwgJ211c3QgYmUgaW4gYSB0cmFuc2FjdGlvbicpO1xuICB9XG5cbiAgZGlkQ3JlYXRlKGNvbXBvbmVudDogQ29tcG9uZW50LCBtYW5hZ2VyOiBDb21wb25lbnRNYW5hZ2VyKSB7XG4gICAgdGhpcy50cmFuc2FjdGlvbi5kaWRDcmVhdGUoY29tcG9uZW50LCBtYW5hZ2VyKTtcbiAgfVxuXG4gIGRpZFVwZGF0ZShjb21wb25lbnQ6IENvbXBvbmVudCwgbWFuYWdlcjogQ29tcG9uZW50TWFuYWdlcikge1xuICAgIHRoaXMudHJhbnNhY3Rpb24uZGlkVXBkYXRlKGNvbXBvbmVudCwgbWFuYWdlcik7XG4gIH1cblxuICBzY2hlZHVsZUluc3RhbGxNb2RpZmllcihtb2RpZmllcjogTW9kaWZpZXIsIG1hbmFnZXI6IE1vZGlmaWVyTWFuYWdlcikge1xuICAgIHRoaXMudHJhbnNhY3Rpb24uc2NoZWR1bGVJbnN0YWxsTW9kaWZpZXIobW9kaWZpZXIsIG1hbmFnZXIpO1xuICB9XG5cbiAgc2NoZWR1bGVVcGRhdGVNb2RpZmllcihtb2RpZmllcjogTW9kaWZpZXIsIG1hbmFnZXI6IE1vZGlmaWVyTWFuYWdlcikge1xuICAgIHRoaXMudHJhbnNhY3Rpb24uc2NoZWR1bGVVcGRhdGVNb2RpZmllcihtb2RpZmllciwgbWFuYWdlcik7XG4gIH1cblxuICBkaWREZXN0cm95KGQ6IERlc3Ryb3lhYmxlKSB7XG4gICAgdGhpcy50cmFuc2FjdGlvbi5kaWREZXN0cm95KGQpO1xuICB9XG5cbiAgY29tbWl0KCkge1xuICAgIGxldCB0cmFuc2FjdGlvbiA9IHRoaXMudHJhbnNhY3Rpb247XG4gICAgdGhpcy5fdHJhbnNhY3Rpb24gPSBudWxsO1xuICAgIHRyYW5zYWN0aW9uLmNvbW1pdCgpO1xuICB9XG5cbiAgYXR0cmlidXRlRm9yKGVsZW1lbnQ6IFNpbXBsZS5FbGVtZW50LCBhdHRyOiBzdHJpbmcsIF9pc1RydXN0aW5nOiBib29sZWFuLCBfbmFtZXNwYWNlOiBPcHRpb248c3RyaW5nPiA9IG51bGwpOiBEeW5hbWljQXR0cmlidXRlRmFjdG9yeSB7XG4gICAgcmV0dXJuIGRlZmF1bHREeW5hbWljQXR0cmlidXRlcyhlbGVtZW50LCBhdHRyKTtcbiAgfVxufVxuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgRGVmYXVsdEVudmlyb25tZW50IGV4dGVuZHMgRW52aXJvbm1lbnQge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zPzogRW52aXJvbm1lbnRPcHRpb25zKSB7XG4gICAgaWYgKCFvcHRpb25zKSB7XG4gICAgICBsZXQgZG9jdW1lbnQgPSB3aW5kb3cuZG9jdW1lbnQ7XG4gICAgICBsZXQgYXBwZW5kT3BlcmF0aW9ucyA9IG5ldyBET01UcmVlQ29uc3RydWN0aW9uKGRvY3VtZW50KTtcbiAgICAgIGxldCB1cGRhdGVPcGVyYXRpb25zID0gbmV3IERPTUNoYW5nZXMoZG9jdW1lbnQgYXMgSFRNTERvY3VtZW50KTtcbiAgICAgIG9wdGlvbnMgPSB7IGFwcGVuZE9wZXJhdGlvbnMsIHVwZGF0ZU9wZXJhdGlvbnMgfTtcbiAgICB9XG5cbiAgICBzdXBlcihvcHRpb25zKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBFbnZpcm9ubWVudDtcblxuZXhwb3J0IGludGVyZmFjZSBIZWxwZXIge1xuICAodm06IFB1YmxpY1ZNLCBhcmdzOiBJQXJndW1lbnRzKTogUGF0aFJlZmVyZW5jZTxPcGFxdWU+O1xufVxuIl19","import { clear } from '../../bounds';\nimport { NewElementBuilder } from '../element-builder';\nclass DynamicContentBase {\n    constructor(trusting) {\n        this.trusting = trusting;\n    }\n    retry(env, value) {\n        let { bounds } = this;\n        let parentElement = bounds.parentElement();\n        let nextSibling = clear(bounds);\n        let stack = NewElementBuilder.forInitialRender(env, { element: parentElement, nextSibling });\n        if (this.trusting) {\n            return stack.__appendTrustingDynamicContent(value);\n        } else {\n            return stack.__appendCautiousDynamicContent(value);\n        }\n    }\n}\nexport default DynamicContentBase;\nexport class DynamicContentWrapper {\n    constructor(inner) {\n        this.inner = inner;\n        this.bounds = inner.bounds;\n    }\n    parentElement() {\n        return this.bounds.parentElement();\n    }\n    firstNode() {\n        return this.bounds.firstNode();\n    }\n    lastNode() {\n        return this.bounds.lastNode();\n    }\n    update(env, value) {\n        let inner = this.inner = this.inner.update(env, value);\n        this.bounds = inner.bounds;\n        return this;\n    }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZHluYW1pYy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3J1bnRpbWUvbGliL3ZtL2NvbnRlbnQvZHluYW1pYy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxBQUFlLFNBQUUsQUFBSyxBQUFFLGFBQU0sQUFBYyxBQUFDO0FBRTdDLEFBQU8sU0FBRSxBQUFpQixBQUFFLHlCQUFNLEFBQW9CLEFBQUM7QUFPdkQ7QUFDRSxnQkFBc0IsQUFBaUI7QUFBakIsYUFBUSxXQUFSLEFBQVEsQUFBUyxBQUFHO0FBQUM7QUFNakMsQUFBSyxVQUFDLEFBQWdCLEtBQUUsQUFBYTtBQUM3QyxZQUFJLEVBQUUsQUFBTSxBQUFFLFdBQUcsQUFBSSxBQUFDO0FBQ3RCLFlBQUksQUFBYSxnQkFBRyxBQUFNLE9BQUMsQUFBYSxBQUFFLEFBQUM7QUFDM0MsWUFBSSxBQUFXLGNBQUcsQUFBSyxNQUFDLEFBQU0sQUFBQyxBQUFDO0FBRWhDLFlBQUksQUFBSyxRQUFHLEFBQWlCLGtCQUFDLEFBQWdCLGlCQUFDLEFBQUcsS0FBRSxFQUFFLEFBQU8sU0FBRSxBQUFhLGVBQUUsQUFBVyxBQUFFLEFBQUMsQUFBQztBQUU3RixBQUFFLEFBQUMsWUFBQyxBQUFJLEtBQUMsQUFBUSxBQUFDLFVBQUMsQUFBQztBQUNsQixBQUFNLG1CQUFDLEFBQUssTUFBQyxBQUE4QiwrQkFBQyxBQUFLLEFBQUMsQUFBQyxBQUNyRDtBQUFDLEFBQUMsQUFBSSxlQUFDLEFBQUM7QUFDTixBQUFNLG1CQUFDLEFBQUssTUFBQyxBQUE4QiwrQkFBQyxBQUFLLEFBQUMsQUFBQyxBQUNyRDtBQUFDLEFBQ0g7QUFBQyxBQUNGOztBQUVELGVBQWUsQUFBa0IsQUFBQztBQUVsQyxBQUFNO0FBZUosZ0JBQW9CLEFBQXFCO0FBQXJCLGFBQUssUUFBTCxBQUFLLEFBQWdCO0FBQ3ZDLEFBQUksYUFBQyxBQUFNLFNBQUcsQUFBSyxNQUFDLEFBQU0sQUFBQyxBQUM3QjtBQUFDO0FBaEJELEFBQWE7QUFDWCxBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQU0sT0FBQyxBQUFhLEFBQUUsQUFBQyxBQUNyQztBQUFDO0FBRUQsQUFBUztBQUNQLEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBTSxPQUFDLEFBQVMsQUFBRSxBQUFDLEFBQ2pDO0FBQUM7QUFFRCxBQUFRO0FBQ04sQUFBTSxlQUFDLEFBQUksS0FBQyxBQUFNLE9BQUMsQUFBUSxBQUFFLEFBQUMsQUFDaEM7QUFBQztBQVFELEFBQU0sV0FBQyxBQUFnQixLQUFFLEFBQWE7QUFDcEMsWUFBSSxBQUFLLFFBQUcsQUFBSSxLQUFDLEFBQUssUUFBRyxBQUFJLEtBQUMsQUFBSyxNQUFDLEFBQU0sT0FBQyxBQUFHLEtBQUUsQUFBSyxBQUFDLEFBQUM7QUFDdkQsQUFBSSxhQUFDLEFBQU0sU0FBRyxBQUFLLE1BQUMsQUFBTSxBQUFDO0FBQzNCLEFBQU0sZUFBQyxBQUFJLEFBQUMsQUFDZDtBQUFDLEFBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgRW52aXJvbm1lbnQgZnJvbSAnLi4vLi4vZW52aXJvbm1lbnQnO1xuaW1wb3J0IEJvdW5kcywgeyBjbGVhciB9IGZyb20gJy4uLy4uL2JvdW5kcyc7XG5pbXBvcnQgeyBPcGFxdWUsIFNpbXBsZSwgT3B0aW9uIH0gZnJvbSBcIkBnbGltbWVyL2ludGVyZmFjZXNcIjtcbmltcG9ydCB7IE5ld0VsZW1lbnRCdWlsZGVyIH0gZnJvbSAnLi4vZWxlbWVudC1idWlsZGVyJztcblxuZXhwb3J0IGludGVyZmFjZSBEeW5hbWljQ29udGVudCB7XG4gIGJvdW5kczogQm91bmRzO1xuICB1cGRhdGUoZW52OiBFbnZpcm9ubWVudCwgdmFsdWU6IE9wYXF1ZSk6IER5bmFtaWNDb250ZW50O1xufVxuXG5hYnN0cmFjdCBjbGFzcyBEeW5hbWljQ29udGVudEJhc2UgaW1wbGVtZW50cyBEeW5hbWljQ29udGVudCB7XG4gIGNvbnN0cnVjdG9yKHByb3RlY3RlZCB0cnVzdGluZzogYm9vbGVhbikge31cblxuICBhYnN0cmFjdCB1cGRhdGUoZW52OiBFbnZpcm9ubWVudCwgdmFsdWU6IE9wYXF1ZSk6IER5bmFtaWNDb250ZW50O1xuXG4gIHB1YmxpYyBhYnN0cmFjdCBib3VuZHM6IEJvdW5kcztcblxuICBwcm90ZWN0ZWQgcmV0cnkoZW52OiBFbnZpcm9ubWVudCwgdmFsdWU6IE9wYXF1ZSk6IER5bmFtaWNDb250ZW50IHtcbiAgICBsZXQgeyBib3VuZHMgfSA9IHRoaXM7XG4gICAgbGV0IHBhcmVudEVsZW1lbnQgPSBib3VuZHMucGFyZW50RWxlbWVudCgpO1xuICAgIGxldCBuZXh0U2libGluZyA9IGNsZWFyKGJvdW5kcyk7XG5cbiAgICBsZXQgc3RhY2sgPSBOZXdFbGVtZW50QnVpbGRlci5mb3JJbml0aWFsUmVuZGVyKGVudiwgeyBlbGVtZW50OiBwYXJlbnRFbGVtZW50LCBuZXh0U2libGluZyB9KTtcblxuICAgIGlmICh0aGlzLnRydXN0aW5nKSB7XG4gICAgICByZXR1cm4gc3RhY2suX19hcHBlbmRUcnVzdGluZ0R5bmFtaWNDb250ZW50KHZhbHVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHN0YWNrLl9fYXBwZW5kQ2F1dGlvdXNEeW5hbWljQ29udGVudCh2YWx1ZSk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IER5bmFtaWNDb250ZW50QmFzZTtcblxuZXhwb3J0IGNsYXNzIER5bmFtaWNDb250ZW50V3JhcHBlciBpbXBsZW1lbnRzIER5bmFtaWNDb250ZW50LCBCb3VuZHMge1xuICBwYXJlbnRFbGVtZW50KCk6IFNpbXBsZS5FbGVtZW50IHtcbiAgICByZXR1cm4gdGhpcy5ib3VuZHMucGFyZW50RWxlbWVudCgpO1xuICB9XG5cbiAgZmlyc3ROb2RlKCk6IE9wdGlvbjxTaW1wbGUuTm9kZT4ge1xuICAgIHJldHVybiB0aGlzLmJvdW5kcy5maXJzdE5vZGUoKTtcbiAgfVxuXG4gIGxhc3ROb2RlKCk6IE9wdGlvbjxTaW1wbGUuTm9kZT4ge1xuICAgIHJldHVybiB0aGlzLmJvdW5kcy5sYXN0Tm9kZSgpO1xuICB9XG5cbiAgcHVibGljIGJvdW5kczogQm91bmRzO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgaW5uZXI6IER5bmFtaWNDb250ZW50KSB7XG4gICAgdGhpcy5ib3VuZHMgPSBpbm5lci5ib3VuZHM7XG4gIH1cblxuICB1cGRhdGUoZW52OiBFbnZpcm9ubWVudCwgdmFsdWU6IE9wYXF1ZSk6IER5bmFtaWNDb250ZW50V3JhcHBlciB7XG4gICAgbGV0IGlubmVyID0gdGhpcy5pbm5lciA9IHRoaXMuaW5uZXIudXBkYXRlKGVudiwgdmFsdWUpO1xuICAgIHRoaXMuYm91bmRzID0gaW5uZXIuYm91bmRzO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG59XG4iXX0=","import DynamicContentBase from './dynamic';\nimport { isNode, isSafeString, isEmpty, isString } from '../../dom/normalize';\nexport default class DynamicTextContent extends DynamicContentBase {\n    constructor(bounds, lastValue, trusted) {\n        super(trusted);\n        this.bounds = bounds;\n        this.lastValue = lastValue;\n    }\n    update(env, value) {\n        let { lastValue } = this;\n        if (value === lastValue) return this;\n        if (isNode(value) || isSafeString(value)) return this.retry(env, value);\n        let normalized;\n        if (isEmpty(value)) {\n            normalized = '';\n        } else if (isString(value)) {\n            normalized = value;\n        } else {\n            normalized = String(value);\n        }\n        if (normalized !== lastValue) {\n            let textNode = this.bounds.firstNode();\n            textNode.nodeValue = this.lastValue = normalized;\n        }\n        return this;\n    }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGV4dC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3J1bnRpbWUvbGliL3ZtL2NvbnRlbnQvdGV4dC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEFBQXNDLHdCQUFNLEFBQVcsQUFBQztBQUcvRCxBQUFPLFNBQUUsQUFBTSxRQUFFLEFBQVksY0FBRSxBQUFPLFNBQUUsQUFBUSxBQUFFLGdCQUFNLEFBQXFCLEFBQUM7QUFHOUUsQUFBTSxBQUFDLEFBQU8scUJBQTBCLDJCQUFRLEFBQWtCO0FBQ2hFLGdCQUFtQixBQUF3QixRQUFVLEFBQWlCLFdBQUUsQUFBZ0I7QUFDdEYsQUFBSyxjQUFDLEFBQU8sQUFBQyxBQUFDO0FBREUsYUFBTSxTQUFOLEFBQU0sQUFBa0I7QUFBVSxhQUFTLFlBQVQsQUFBUyxBQUFRLEFBRXRFO0FBQUM7QUFFRCxBQUFNLFdBQUMsQUFBZ0IsS0FBRSxBQUFhO0FBQ3BDLFlBQUksRUFBRSxBQUFTLEFBQUUsY0FBRyxBQUFJLEFBQUM7QUFFekIsQUFBRSxBQUFDLFlBQUMsQUFBSyxVQUFLLEFBQVMsQUFBQyxXQUFDLEFBQU0sT0FBQyxBQUFJLEFBQUM7QUFDckMsQUFBRSxBQUFDLFlBQUMsQUFBTSxPQUFDLEFBQUssQUFBQyxVQUFJLEFBQVksYUFBQyxBQUFLLEFBQUMsQUFBQyxRQUFDLEFBQU0sT0FBQyxBQUFJLEtBQUMsQUFBSyxNQUFDLEFBQUcsS0FBRSxBQUFLLEFBQUMsQUFBQztBQUV4RSxZQUFJLEFBQWtCLEFBQUM7QUFFdkIsQUFBRSxBQUFDLFlBQUMsQUFBTyxRQUFDLEFBQUssQUFBQyxBQUFDLFFBQUMsQUFBQztBQUNuQixBQUFVLHlCQUFHLEFBQUUsQUFBQyxBQUNsQjtBQUFDLEFBQUMsQUFBSSxtQkFBSyxBQUFRLFNBQUMsQUFBSyxBQUFDLEFBQUMsUUFBQyxBQUFDO0FBQzNCLEFBQVUseUJBQUcsQUFBSyxBQUFDLEFBQ3JCO0FBQUMsQUFBQyxBQUFJLFNBRkMsQUFBRSxBQUFDLE1BRUgsQUFBQztBQUNOLEFBQVUseUJBQUcsQUFBTSxPQUFDLEFBQUssQUFBQyxBQUFDLEFBQzdCO0FBQUM7QUFFRCxBQUFFLEFBQUMsWUFBQyxBQUFVLGVBQUssQUFBUyxBQUFDLFdBQUMsQUFBQztBQUM3QixnQkFBSSxBQUFRLFdBQUcsQUFBSSxLQUFDLEFBQU0sT0FBQyxBQUFTLEFBQUUsQUFBQztBQUN2QyxBQUFRLHFCQUFDLEFBQVMsWUFBRyxBQUFJLEtBQUMsQUFBUyxZQUFHLEFBQVUsQUFBQyxBQUNuRDtBQUFDO0FBRUQsQUFBTSxlQUFDLEFBQUksQUFBQyxBQUNkO0FBQUMsQUFDRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBEeW5hbWljQ29udGVudEJhc2UsIHsgRHluYW1pY0NvbnRlbnQgfSBmcm9tICcuL2R5bmFtaWMnO1xuaW1wb3J0IHsgU2luZ2xlTm9kZUJvdW5kcyB9IGZyb20gJy4uLy4uL2JvdW5kcyc7XG5pbXBvcnQgRW52aXJvbm1lbnQgZnJvbSAnLi4vLi4vZW52aXJvbm1lbnQnO1xuaW1wb3J0IHsgaXNOb2RlLCBpc1NhZmVTdHJpbmcsIGlzRW1wdHksIGlzU3RyaW5nIH0gZnJvbSAnLi4vLi4vZG9tL25vcm1hbGl6ZSc7XG5pbXBvcnQgeyBPcGFxdWUgfSBmcm9tIFwiQGdsaW1tZXIvaW50ZXJmYWNlc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEeW5hbWljVGV4dENvbnRlbnQgZXh0ZW5kcyBEeW5hbWljQ29udGVudEJhc2Uge1xuICBjb25zdHJ1Y3RvcihwdWJsaWMgYm91bmRzOiBTaW5nbGVOb2RlQm91bmRzLCBwcml2YXRlIGxhc3RWYWx1ZTogc3RyaW5nLCB0cnVzdGVkOiBib29sZWFuKSB7XG4gICAgc3VwZXIodHJ1c3RlZCk7XG4gIH1cblxuICB1cGRhdGUoZW52OiBFbnZpcm9ubWVudCwgdmFsdWU6IE9wYXF1ZSk6IER5bmFtaWNDb250ZW50IHtcbiAgICBsZXQgeyBsYXN0VmFsdWUgfSA9IHRoaXM7XG5cbiAgICBpZiAodmFsdWUgPT09IGxhc3RWYWx1ZSkgcmV0dXJuIHRoaXM7XG4gICAgaWYgKGlzTm9kZSh2YWx1ZSkgfHwgaXNTYWZlU3RyaW5nKHZhbHVlKSkgcmV0dXJuIHRoaXMucmV0cnkoZW52LCB2YWx1ZSk7XG5cbiAgICBsZXQgbm9ybWFsaXplZDogc3RyaW5nO1xuXG4gICAgaWYgKGlzRW1wdHkodmFsdWUpKSB7XG4gICAgICBub3JtYWxpemVkID0gJyc7XG4gICAgfSBlbHNlIGlmIChpc1N0cmluZyh2YWx1ZSkpIHtcbiAgICAgIG5vcm1hbGl6ZWQgPSB2YWx1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgbm9ybWFsaXplZCA9IFN0cmluZyh2YWx1ZSk7XG4gICAgfVxuXG4gICAgaWYgKG5vcm1hbGl6ZWQgIT09IGxhc3RWYWx1ZSkge1xuICAgICAgbGV0IHRleHROb2RlID0gdGhpcy5ib3VuZHMuZmlyc3ROb2RlKCk7XG4gICAgICB0ZXh0Tm9kZS5ub2RlVmFsdWUgPSB0aGlzLmxhc3RWYWx1ZSA9IG5vcm1hbGl6ZWQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbn1cbiJdfQ==","import DynamicContentBase from './dynamic';\nexport default class DynamicNodeContent extends DynamicContentBase {\n    constructor(bounds, lastValue, trusting) {\n        super(trusting);\n        this.bounds = bounds;\n        this.lastValue = lastValue;\n    }\n    update(env, value) {\n        let { lastValue } = this;\n        if (value === lastValue) return this;\n        return this.retry(env, value);\n    }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm9kZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3J1bnRpbWUvbGliL3ZtL2NvbnRlbnQvbm9kZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEFBQXNDLHdCQUFNLEFBQVcsQUFBQztBQUsvRCxBQUFNLEFBQUMsQUFBTyxxQkFBMEIsMkJBQVEsQUFBa0I7QUFDaEUsZ0JBQW1CLEFBQWMsUUFBVSxBQUFzQixXQUFFLEFBQWlCO0FBQ2xGLEFBQUssY0FBQyxBQUFRLEFBQUMsQUFBQztBQURDLGFBQU0sU0FBTixBQUFNLEFBQVE7QUFBVSxhQUFTLFlBQVQsQUFBUyxBQUFhLEFBRWpFO0FBQUM7QUFFRCxBQUFNLFdBQUMsQUFBZ0IsS0FBRSxBQUFhO0FBQ3BDLFlBQUksRUFBRSxBQUFTLEFBQUUsY0FBRyxBQUFJLEFBQUM7QUFFekIsQUFBRSxBQUFDLFlBQUMsQUFBSyxVQUFLLEFBQVMsQUFBQyxXQUFDLEFBQU0sT0FBQyxBQUFJLEFBQUM7QUFFckMsQUFBTSxlQUFDLEFBQUksS0FBQyxBQUFLLE1BQUMsQUFBRyxLQUFFLEFBQUssQUFBQyxBQUFDLEFBQ2hDO0FBQUMsQUFDRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBEeW5hbWljQ29udGVudEJhc2UsIHsgRHluYW1pY0NvbnRlbnQgfSBmcm9tICcuL2R5bmFtaWMnO1xuaW1wb3J0IEJvdW5kcyBmcm9tICcuLi8uLi9ib3VuZHMnO1xuaW1wb3J0IEVudmlyb25tZW50IGZyb20gJy4uLy4uL2Vudmlyb25tZW50JztcbmltcG9ydCB7IE9wYXF1ZSwgU2ltcGxlIH0gZnJvbSBcIkBnbGltbWVyL2ludGVyZmFjZXNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRHluYW1pY05vZGVDb250ZW50IGV4dGVuZHMgRHluYW1pY0NvbnRlbnRCYXNlIHtcbiAgY29uc3RydWN0b3IocHVibGljIGJvdW5kczogQm91bmRzLCBwcml2YXRlIGxhc3RWYWx1ZTogU2ltcGxlLk5vZGUsIHRydXN0aW5nOiBib29sZWFuKSB7XG4gICAgc3VwZXIodHJ1c3RpbmcpO1xuICB9XG5cbiAgdXBkYXRlKGVudjogRW52aXJvbm1lbnQsIHZhbHVlOiBPcGFxdWUpOiBEeW5hbWljQ29udGVudCB7XG4gICAgbGV0IHsgbGFzdFZhbHVlIH0gPSB0aGlzO1xuXG4gICAgaWYgKHZhbHVlID09PSBsYXN0VmFsdWUpIHJldHVybiB0aGlzO1xuXG4gICAgcmV0dXJuIHRoaXMucmV0cnkoZW52LCB2YWx1ZSk7XG4gIH1cbn1cbiJdfQ==","import DynamicContentBase from './dynamic';\nimport { isSafeString, normalizeTrustedValue } from '../../dom/normalize';\nexport default class DynamicHTMLContent extends DynamicContentBase {\n    constructor(bounds, lastValue, trusted) {\n        super(trusted);\n        this.bounds = bounds;\n        this.lastValue = lastValue;\n    }\n    update(env, value) {\n        let { lastValue } = this;\n        if (value === lastValue) return this;\n        if (isSafeString(value) && value.toHTML() === lastValue.toHTML()) {\n            this.lastValue = value;\n            return this;\n        }\n        return this.retry(env, value);\n    }\n}\nexport class DynamicTrustedHTMLContent extends DynamicContentBase {\n    constructor(bounds, lastValue, trusted) {\n        super(trusted);\n        this.bounds = bounds;\n        this.lastValue = lastValue;\n    }\n    update(env, value) {\n        let { lastValue } = this;\n        if (value === lastValue) return this;\n        let newValue = normalizeTrustedValue(value);\n        if (newValue === lastValue) return this;\n        return this.retry(env, value);\n    }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaHRtbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3J1bnRpbWUvbGliL3ZtL2NvbnRlbnQvaHRtbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEFBQXNDLHdCQUFNLEFBQVcsQUFBQztBQUcvRCxBQUFPLFNBQUUsQUFBWSxjQUFjLEFBQXFCLEFBQUUsNkJBQU0sQUFBcUIsQUFBQztBQUd0RixBQUFNLEFBQUMsQUFBTyxxQkFBMEIsMkJBQVEsQUFBa0I7QUFDaEUsZ0JBQW1CLEFBQWMsUUFBVSxBQUFxQixXQUFFLEFBQWdCO0FBQ2hGLEFBQUssY0FBQyxBQUFPLEFBQUMsQUFBQztBQURFLGFBQU0sU0FBTixBQUFNLEFBQVE7QUFBVSxhQUFTLFlBQVQsQUFBUyxBQUFZLEFBRWhFO0FBQUM7QUFFRCxBQUFNLFdBQUMsQUFBZ0IsS0FBRSxBQUFhO0FBQ3BDLFlBQUksRUFBRSxBQUFTLEFBQUUsY0FBRyxBQUFJLEFBQUM7QUFFekIsQUFBRSxBQUFDLFlBQUMsQUFBSyxVQUFLLEFBQVMsQUFBQyxXQUFDLEFBQU0sT0FBQyxBQUFJLEFBQUM7QUFFckMsQUFBRSxBQUFDLFlBQUMsQUFBWSxhQUFDLEFBQUssQUFBQyxVQUFJLEFBQUssTUFBQyxBQUFNLEFBQUUsYUFBSyxBQUFTLFVBQUMsQUFBTSxBQUFFLEFBQUMsVUFBQyxBQUFDO0FBQ2pFLEFBQUksaUJBQUMsQUFBUyxZQUFHLEFBQUssQUFBQztBQUN2QixBQUFNLG1CQUFDLEFBQUksQUFBQyxBQUNkO0FBQUM7QUFFRCxBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQUssTUFBQyxBQUFHLEtBQUUsQUFBSyxBQUFDLEFBQUMsQUFDaEM7QUFBQyxBQUNGOztBQUVELEFBQU0sYUFBaUMsa0NBQVEsQUFBa0I7QUFDL0QsZ0JBQW1CLEFBQWMsUUFBVSxBQUFpQixXQUFFLEFBQWdCO0FBQzVFLEFBQUssY0FBQyxBQUFPLEFBQUMsQUFBQztBQURFLGFBQU0sU0FBTixBQUFNLEFBQVE7QUFBVSxhQUFTLFlBQVQsQUFBUyxBQUFRLEFBRTVEO0FBQUM7QUFFRCxBQUFNLFdBQUMsQUFBZ0IsS0FBRSxBQUFhO0FBQ3BDLFlBQUksRUFBRSxBQUFTLEFBQUUsY0FBRyxBQUFJLEFBQUM7QUFFekIsQUFBRSxBQUFDLFlBQUMsQUFBSyxVQUFLLEFBQVMsQUFBQyxXQUFDLEFBQU0sT0FBQyxBQUFJLEFBQUM7QUFDckMsWUFBSSxBQUFRLFdBQUcsQUFBcUIsc0JBQUMsQUFBSyxBQUFDLEFBQUM7QUFDNUMsQUFBRSxBQUFDLFlBQUMsQUFBUSxhQUFLLEFBQVMsQUFBQyxXQUFDLEFBQU0sT0FBQyxBQUFJLEFBQUM7QUFFeEMsQUFBTSxlQUFDLEFBQUksS0FBQyxBQUFLLE1BQUMsQUFBRyxLQUFFLEFBQUssQUFBQyxBQUFDLEFBQ2hDO0FBQUMsQUFDRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBEeW5hbWljQ29udGVudEJhc2UsIHsgRHluYW1pY0NvbnRlbnQgfSBmcm9tICcuL2R5bmFtaWMnO1xuaW1wb3J0IEJvdW5kcyBmcm9tICcuLi8uLi9ib3VuZHMnO1xuaW1wb3J0IEVudmlyb25tZW50IGZyb20gJy4uLy4uL2Vudmlyb25tZW50JztcbmltcG9ydCB7IGlzU2FmZVN0cmluZywgU2FmZVN0cmluZywgbm9ybWFsaXplVHJ1c3RlZFZhbHVlIH0gZnJvbSAnLi4vLi4vZG9tL25vcm1hbGl6ZSc7XG5pbXBvcnQgeyBPcGFxdWUgfSBmcm9tIFwiQGdsaW1tZXIvaW50ZXJmYWNlc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEeW5hbWljSFRNTENvbnRlbnQgZXh0ZW5kcyBEeW5hbWljQ29udGVudEJhc2Uge1xuICBjb25zdHJ1Y3RvcihwdWJsaWMgYm91bmRzOiBCb3VuZHMsIHByaXZhdGUgbGFzdFZhbHVlOiBTYWZlU3RyaW5nLCB0cnVzdGVkOiBib29sZWFuKSB7XG4gICAgc3VwZXIodHJ1c3RlZCk7XG4gIH1cblxuICB1cGRhdGUoZW52OiBFbnZpcm9ubWVudCwgdmFsdWU6IE9wYXF1ZSk6IER5bmFtaWNDb250ZW50IHtcbiAgICBsZXQgeyBsYXN0VmFsdWUgfSA9IHRoaXM7XG5cbiAgICBpZiAodmFsdWUgPT09IGxhc3RWYWx1ZSkgcmV0dXJuIHRoaXM7XG5cbiAgICBpZiAoaXNTYWZlU3RyaW5nKHZhbHVlKSAmJiB2YWx1ZS50b0hUTUwoKSA9PT0gbGFzdFZhbHVlLnRvSFRNTCgpKSB7XG4gICAgICB0aGlzLmxhc3RWYWx1ZSA9IHZhbHVlO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMucmV0cnkoZW52LCB2YWx1ZSk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIER5bmFtaWNUcnVzdGVkSFRNTENvbnRlbnQgZXh0ZW5kcyBEeW5hbWljQ29udGVudEJhc2Uge1xuICBjb25zdHJ1Y3RvcihwdWJsaWMgYm91bmRzOiBCb3VuZHMsIHByaXZhdGUgbGFzdFZhbHVlOiBzdHJpbmcsIHRydXN0ZWQ6IGJvb2xlYW4pIHtcbiAgICBzdXBlcih0cnVzdGVkKTtcbiAgfVxuXG4gIHVwZGF0ZShlbnY6IEVudmlyb25tZW50LCB2YWx1ZTogT3BhcXVlKTogRHluYW1pY0NvbnRlbnQge1xuICAgIGxldCB7IGxhc3RWYWx1ZSB9ID0gdGhpcztcblxuICAgIGlmICh2YWx1ZSA9PT0gbGFzdFZhbHVlKSByZXR1cm4gdGhpcztcbiAgICBsZXQgbmV3VmFsdWUgPSBub3JtYWxpemVUcnVzdGVkVmFsdWUodmFsdWUpO1xuICAgIGlmIChuZXdWYWx1ZSA9PT0gbGFzdFZhbHVlKSByZXR1cm4gdGhpcztcblxuICAgIHJldHVybiB0aGlzLnJldHJ5KGVudiwgdmFsdWUpO1xuICB9XG59XG4iXX0=","import { clear, Cursor, single, bounds } from '../bounds';\nimport { isString, isSafeString, isNode, isFragment, isEmpty } from '../dom/normalize';\nimport { Stack, assert } from '@glimmer/util';\nimport { DynamicContentWrapper } from './content/dynamic';\nimport DynamicTextContent from './content/text';\nimport DynamicNodeContent from './content/node';\nimport DynamicHTMLContent, { DynamicTrustedHTMLContent } from './content/html';\nclass First {\n    constructor(node) {\n        this.node = node;\n    }\n    firstNode() {\n        return this.node;\n    }\n}\nclass Last {\n    constructor(node) {\n        this.node = node;\n    }\n    lastNode() {\n        return this.node;\n    }\n}\nexport class Fragment {\n    constructor(bounds) {\n        this.bounds = bounds;\n    }\n    parentElement() {\n        return this.bounds.parentElement();\n    }\n    firstNode() {\n        return this.bounds.firstNode();\n    }\n    lastNode() {\n        return this.bounds.lastNode();\n    }\n}\nexport class NewElementBuilder {\n    constructor(env, parentNode, nextSibling) {\n        this.constructing = null;\n        this.operations = null;\n        this.cursorStack = new Stack();\n        this.blockStack = new Stack();\n        this.pushElement(parentNode, nextSibling);\n        this.env = env;\n        this.dom = env.getAppendOperations();\n        this.updateOperations = env.getDOM();\n    }\n    static forInitialRender(env, cursor) {\n        let builder = new this(env, cursor.element, cursor.nextSibling);\n        builder.pushSimpleBlock();\n        return builder;\n    }\n    static resume(env, tracker, nextSibling) {\n        let parentNode = tracker.parentElement();\n        let stack = new this(env, parentNode, nextSibling);\n        stack.pushSimpleBlock();\n        stack.pushBlockTracker(tracker);\n        return stack;\n    }\n    get element() {\n        return this.cursorStack.current.element;\n    }\n    get nextSibling() {\n        return this.cursorStack.current.nextSibling;\n    }\n    expectConstructing(method) {\n        return this.constructing;\n    }\n    block() {\n        return this.blockStack.current;\n    }\n    popElement() {\n        this.cursorStack.pop();\n        this.cursorStack.current;\n    }\n    pushSimpleBlock() {\n        return this.pushBlockTracker(new SimpleBlockTracker(this.element));\n    }\n    pushUpdatableBlock() {\n        return this.pushBlockTracker(new UpdatableBlockTracker(this.element));\n    }\n    pushBlockList(list) {\n        return this.pushBlockTracker(new BlockListTracker(this.element, list));\n    }\n    pushBlockTracker(tracker, isRemote = false) {\n        let current = this.blockStack.current;\n        if (current !== null) {\n            current.newDestroyable(tracker);\n            if (!isRemote) {\n                current.didAppendBounds(tracker);\n            }\n        }\n        this.__openBlock();\n        this.blockStack.push(tracker);\n        return tracker;\n    }\n    popBlock() {\n        this.block().finalize(this);\n        this.__closeBlock();\n        return this.blockStack.pop();\n    }\n    __openBlock() {}\n    __closeBlock() {}\n    // todo return seems unused\n    openElement(tag) {\n        let element = this.__openElement(tag);\n        this.constructing = element;\n        return element;\n    }\n    __openElement(tag) {\n        return this.dom.createElement(tag, this.element);\n    }\n    flushElement() {\n        let parent = this.element;\n        let element = this.constructing;\n        this.__flushElement(parent, element);\n        this.constructing = null;\n        this.operations = null;\n        this.pushElement(element, null);\n        this.didOpenElement(element);\n    }\n    __flushElement(parent, constructing) {\n        this.dom.insertBefore(parent, constructing, this.nextSibling);\n    }\n    closeElement() {\n        this.willCloseElement();\n        this.popElement();\n    }\n    pushRemoteElement(element, guid, nextSibling = null) {\n        this.__pushRemoteElement(element, guid, nextSibling);\n    }\n    __pushRemoteElement(element, _guid, nextSibling) {\n        this.pushElement(element, nextSibling);\n        let tracker = new RemoteBlockTracker(element);\n        this.pushBlockTracker(tracker, true);\n    }\n    popRemoteElement() {\n        this.popBlock();\n        this.popElement();\n    }\n    pushElement(element, nextSibling) {\n        this.cursorStack.push(new Cursor(element, nextSibling));\n    }\n    didAddDestroyable(d) {\n        this.block().newDestroyable(d);\n    }\n    didAppendBounds(bounds) {\n        this.block().didAppendBounds(bounds);\n        return bounds;\n    }\n    didAppendNode(node) {\n        this.block().didAppendNode(node);\n        return node;\n    }\n    didOpenElement(element) {\n        this.block().openElement(element);\n        return element;\n    }\n    willCloseElement() {\n        this.block().closeElement();\n    }\n    appendText(string) {\n        return this.didAppendNode(this.__appendText(string));\n    }\n    __appendText(text) {\n        let { dom, element, nextSibling } = this;\n        let node = dom.createTextNode(text);\n        dom.insertBefore(element, node, nextSibling);\n        return node;\n    }\n    __appendNode(node) {\n        this.dom.insertBefore(this.element, node, this.nextSibling);\n        return node;\n    }\n    __appendFragment(fragment) {\n        let first = fragment.firstChild;\n        if (first) {\n            let ret = bounds(this.element, first, fragment.lastChild);\n            this.dom.insertBefore(this.element, fragment, this.nextSibling);\n            return ret;\n        } else {\n            return single(this.element, this.__appendComment(''));\n        }\n    }\n    __appendHTML(html) {\n        return this.dom.insertHTMLBefore(this.element, this.nextSibling, html);\n    }\n    appendTrustingDynamicContent(value) {\n        let wrapper = new DynamicContentWrapper(this.__appendTrustingDynamicContent(value));\n        this.didAppendBounds(wrapper);\n        return wrapper;\n    }\n    __appendTrustingDynamicContent(value) {\n        if (isString(value)) {\n            return this.trustedContent(value);\n        } else if (isEmpty(value)) {\n            return this.trustedContent('');\n        } else if (isSafeString(value)) {\n            return this.trustedContent(value.toHTML());\n        }\n        if (isFragment(value)) {\n            let bounds = this.__appendFragment(value);\n            return new DynamicNodeContent(bounds, value, true);\n        } else if (isNode(value)) {\n            let node = this.__appendNode(value);\n            return new DynamicNodeContent(single(this.element, node), node, true);\n        }\n        return this.trustedContent(String(value));\n    }\n    appendCautiousDynamicContent(value) {\n        let wrapper = new DynamicContentWrapper(this.__appendCautiousDynamicContent(value));\n        this.didAppendBounds(wrapper.bounds);\n        return wrapper;\n    }\n    __appendCautiousDynamicContent(value) {\n        if (isString(value)) {\n            return this.untrustedContent(value);\n        } else if (isEmpty(value)) {\n            return this.untrustedContent('');\n        } else if (isFragment(value)) {\n            let bounds = this.__appendFragment(value);\n            return new DynamicNodeContent(bounds, value, false);\n        } else if (isNode(value)) {\n            let node = this.__appendNode(value);\n            return new DynamicNodeContent(single(this.element, node), node, false);\n        } else if (isSafeString(value)) {\n            let normalized = value.toHTML();\n            let bounds = this.__appendHTML(normalized);\n            // let bounds = this.dom.insertHTMLBefore(this.element, this.nextSibling, normalized);\n            return new DynamicHTMLContent(bounds, value, false);\n        }\n        return this.untrustedContent(String(value));\n    }\n    trustedContent(value) {\n        let bounds = this.__appendHTML(value);\n        return new DynamicTrustedHTMLContent(bounds, value, true);\n    }\n    untrustedContent(value) {\n        let textNode = this.__appendText(value);\n        let bounds = single(this.element, textNode);\n        return new DynamicTextContent(bounds, value, false);\n    }\n    appendComment(string) {\n        return this.didAppendNode(this.__appendComment(string));\n    }\n    __appendComment(string) {\n        let { dom, element, nextSibling } = this;\n        let node = dom.createComment(string);\n        dom.insertBefore(element, node, nextSibling);\n        return node;\n    }\n    __setAttribute(name, value, namespace) {\n        this.dom.setAttribute(this.constructing, name, value, namespace);\n    }\n    __setProperty(name, value) {\n        this.constructing[name] = value;\n    }\n    setStaticAttribute(name, value, namespace) {\n        this.__setAttribute(name, value, namespace);\n    }\n    setDynamicAttribute(name, value, trusting, namespace) {\n        let element = this.constructing;\n        let DynamicAttribute = this.env.attributeFor(element, name, trusting, namespace);\n        let attribute = new DynamicAttribute({ element, name, namespace: namespace || null });\n        attribute.set(this, value, this.env);\n        return attribute;\n    }\n}\nexport class SimpleBlockTracker {\n    constructor(parent) {\n        this.parent = parent;\n        this.first = null;\n        this.last = null;\n        this.destroyables = null;\n        this.nesting = 0;\n    }\n    destroy() {\n        let { destroyables } = this;\n        if (destroyables && destroyables.length) {\n            for (let i = 0; i < destroyables.length; i++) {\n                destroyables[i].destroy();\n            }\n        }\n    }\n    parentElement() {\n        return this.parent;\n    }\n    firstNode() {\n        return this.first && this.first.firstNode();\n    }\n    lastNode() {\n        return this.last && this.last.lastNode();\n    }\n    openElement(element) {\n        this.didAppendNode(element);\n        this.nesting++;\n    }\n    closeElement() {\n        this.nesting--;\n    }\n    didAppendNode(node) {\n        if (this.nesting !== 0) return;\n        if (!this.first) {\n            this.first = new First(node);\n        }\n        this.last = new Last(node);\n    }\n    didAppendBounds(bounds) {\n        if (this.nesting !== 0) return;\n        if (!this.first) {\n            this.first = bounds;\n        }\n        this.last = bounds;\n    }\n    newDestroyable(d) {\n        this.destroyables = this.destroyables || [];\n        this.destroyables.push(d);\n    }\n    finalize(stack) {\n        if (!this.first) {\n            stack.appendComment('');\n        }\n    }\n}\nexport class RemoteBlockTracker extends SimpleBlockTracker {\n    destroy() {\n        super.destroy();\n        clear(this);\n    }\n}\nexport class UpdatableBlockTracker extends SimpleBlockTracker {\n    reset(env) {\n        let { destroyables } = this;\n        if (destroyables && destroyables.length) {\n            for (let i = 0; i < destroyables.length; i++) {\n                env.didDestroy(destroyables[i]);\n            }\n        }\n        let nextSibling = clear(this);\n        this.first = null;\n        this.last = null;\n        this.destroyables = null;\n        this.nesting = 0;\n        return nextSibling;\n    }\n}\nclass BlockListTracker {\n    constructor(parent, boundList) {\n        this.parent = parent;\n        this.boundList = boundList;\n        this.parent = parent;\n        this.boundList = boundList;\n    }\n    destroy() {\n        this.boundList.forEachNode(node => node.destroy());\n    }\n    parentElement() {\n        return this.parent;\n    }\n    firstNode() {\n        let head = this.boundList.head();\n        return head && head.firstNode();\n    }\n    lastNode() {\n        let tail = this.boundList.tail();\n        return tail && tail.lastNode();\n    }\n    openElement(_element) {\n        (false && assert(false, 'Cannot openElement directly inside a block list'));\n    }\n    closeElement() {\n        (false && assert(false, 'Cannot closeElement directly inside a block list'));\n    }\n    didAppendNode(_node) {\n        (false && assert(false, 'Cannot create a new node directly inside a block list'));\n    }\n    didAppendBounds(_bounds) {}\n    newDestroyable(_d) {}\n    finalize(_stack) {}\n}\nexport function clientBuilder(env, cursor) {\n    return NewElementBuilder.forInitialRender(env, cursor);\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWxlbWVudC1idWlsZGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcGFja2FnZXMvQGdsaW1tZXIvcnVudGltZS9saWIvdm0vZWxlbWVudC1idWlsZGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLEFBQU8sU0FBRSxBQUFLLE9BQUUsQUFBTSxRQUFxQixBQUFNLFFBQVUsQUFBTSxBQUFFLGNBQU0sQUFBVyxBQUFDO0FBR3JGLEFBQU8sU0FBRSxBQUFRLFVBQUUsQUFBWSxjQUFFLEFBQU0sUUFBRSxBQUFVLFlBQUUsQUFBTyxBQUFFLGVBQU0sQUFBa0IsQUFBQztBQUV2RixBQUFPLFNBQXVCLEFBQUssT0FBOEIsQUFBTSxBQUFFLEFBQU0sQUFBRSxjQUFNLEFBQWUsQUFBQztBQU12RyxBQUFPLFNBQWtCLEFBQXFCLEFBQUUsNkJBQU0sQUFBbUIsQUFBQztBQUMxRSxPQUFPLEFBQWtCLHdCQUFNLEFBQWdCLEFBQUM7QUFDaEQsT0FBTyxBQUFrQix3QkFBTSxBQUFnQixBQUFDO0FBQ2hELE9BQU8sQUFBa0IsQUFBRSxzQkFBRSxBQUF5QixBQUFFLGlDQUFNLEFBQWdCLEFBQUM7QUFjL0U7QUFDRSxnQkFBb0IsQUFBVTtBQUFWLGFBQUksT0FBSixBQUFJLEFBQU0sQUFBSTtBQUFDO0FBRW5DLEFBQVM7QUFDUCxBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQUksQUFBQyxBQUNuQjtBQUFDLEFBQ0Y7O0FBRUQ7QUFDRSxnQkFBb0IsQUFBVTtBQUFWLGFBQUksT0FBSixBQUFJLEFBQU0sQUFBSTtBQUFDO0FBRW5DLEFBQVE7QUFDTixBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQUksQUFBQyxBQUNuQjtBQUFDLEFBQ0Y7O0FBTUQsQUFBTTtBQUdKLGdCQUFZLEFBQWM7QUFDeEIsQUFBSSxhQUFDLEFBQU0sU0FBRyxBQUFNLEFBQUMsQUFDdkI7QUFBQztBQUVELEFBQWE7QUFDWCxBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQU0sT0FBQyxBQUFhLEFBQUUsQUFBQyxBQUNyQztBQUFDO0FBRUQsQUFBUztBQUNQLEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBTSxPQUFDLEFBQVMsQUFBRSxBQUFDLEFBQ2pDO0FBQUM7QUFFRCxBQUFRO0FBQ04sQUFBTSxlQUFDLEFBQUksS0FBQyxBQUFNLE9BQUMsQUFBUSxBQUFFLEFBQUMsQUFDaEM7QUFBQyxBQUNGOztBQXNERCxBQUFNO0FBMEJKLGdCQUFZLEFBQWdCLEtBQUUsQUFBMEIsWUFBRSxBQUFnQztBQXZCbkYsYUFBWSxlQUEyQixBQUFJLEFBQUM7QUFDNUMsYUFBVSxhQUE4QixBQUFJLEFBQUM7QUFHMUMsYUFBVyxjQUFHLElBQUksQUFBSyxBQUFVLEFBQUM7QUFDcEMsYUFBVSxhQUFHLElBQUksQUFBSyxBQUFXLEFBQUM7QUFtQnhDLEFBQUksYUFBQyxBQUFXLFlBQUMsQUFBVSxZQUFFLEFBQVcsQUFBQyxBQUFDO0FBRTFDLEFBQUksYUFBQyxBQUFHLE1BQUcsQUFBRyxBQUFDO0FBQ2YsQUFBSSxhQUFDLEFBQUcsTUFBRyxBQUFHLElBQUMsQUFBbUIsQUFBRSxBQUFDO0FBQ3JDLEFBQUksYUFBQyxBQUFnQixtQkFBRyxBQUFHLElBQUMsQUFBTSxBQUFFLEFBQUMsQUFDdkM7QUFBQztBQXRCRCxBQUFNLFdBQUMsQUFBZ0IsaUJBQUMsQUFBZ0IsS0FBRSxBQUFjO0FBQ3RELFlBQUksQUFBTyxVQUFHLElBQUksQUFBSSxLQUFDLEFBQUcsS0FBRSxBQUFNLE9BQUMsQUFBTyxTQUFFLEFBQU0sT0FBQyxBQUFXLEFBQUMsQUFBQztBQUNoRSxBQUFPLGdCQUFDLEFBQWUsQUFBRSxBQUFDO0FBQzFCLEFBQU0sZUFBQyxBQUFPLEFBQUMsQUFDakI7QUFBQztBQUVELEFBQU0sV0FBQyxBQUFNLE9BQUMsQUFBZ0IsS0FBRSxBQUFnQixTQUFFLEFBQWdDO0FBQ2hGLFlBQUksQUFBVSxhQUFHLEFBQU8sUUFBQyxBQUFhLEFBQUUsQUFBQztBQUV6QyxZQUFJLEFBQUssUUFBRyxJQUFJLEFBQUksS0FBQyxBQUFHLEtBQUUsQUFBVSxZQUFFLEFBQVcsQUFBQyxBQUFDO0FBQ25ELEFBQUssY0FBQyxBQUFlLEFBQUUsQUFBQztBQUN4QixBQUFLLGNBQUMsQUFBZ0IsaUJBQUMsQUFBTyxBQUFDLEFBQUM7QUFFaEMsQUFBTSxlQUFDLEFBQUssQUFBQyxBQUNmO0FBQUM7QUFVRCxRQUFJLEFBQU87QUFDVCxBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQVcsWUFBQyxBQUFRLFFBQUMsQUFBTyxBQUFDLEFBQzNDO0FBQUM7QUFFRCxRQUFJLEFBQVc7QUFDYixBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQVcsWUFBQyxBQUFRLFFBQUMsQUFBVyxBQUFDLEFBQy9DO0FBQUM7QUFFRCxBQUFrQix1QkFBQyxBQUFjO0FBQy9CLEFBQU0sQUFBQyxBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQVksQUFBRSxBQUFHLEFBQU0sQUFBc0QsQUFBQyxBQUFDLEFBQ3BHO0FBQUM7QUFFRCxBQUFLO0FBQ0gsQUFBTSxBQUFDLEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBVSxXQUFDLEFBQU8sQUFBRSxBQUFrQyxBQUFDLEFBQUMsQUFDN0U7QUFBQztBQUVELEFBQVU7QUFDUixBQUFJLGFBQUMsQUFBVyxZQUFDLEFBQUcsQUFBRSxBQUFDO0FBQ2hCLEFBQUksYUFBQyxBQUFXLFlBQUMsQUFBTyxBQUFFLEFBQWlDLEFBQUMsQUFBQyxBQUN0RSxPQURFLEFBQU07QUFDUDtBQUVELEFBQWU7QUFDYixBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQWdCLGlCQUFDLElBQUksQUFBa0IsbUJBQUMsQUFBSSxLQUFDLEFBQU8sQUFBQyxBQUFDLEFBQUMsQUFDckU7QUFBQztBQUVELEFBQWtCO0FBQ2hCLEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBZ0IsaUJBQUMsSUFBSSxBQUFxQixzQkFBQyxBQUFJLEtBQUMsQUFBTyxBQUFDLEFBQUMsQUFBQyxBQUN4RTtBQUFDO0FBRUQsQUFBYSxrQkFBQyxBQUF1RDtBQUNuRSxBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQWdCLGlCQUFDLElBQUksQUFBZ0IsaUJBQUMsQUFBSSxLQUFDLEFBQU8sU0FBRSxBQUFJLEFBQUMsQUFBQyxBQUFDLEFBQ3pFO0FBQUM7QUFFUyxBQUFnQixxQkFBb0IsQUFBVSxTQUFFLEFBQVEsV0FBRyxBQUFLO0FBQ3hFLFlBQUksQUFBTyxVQUFHLEFBQUksS0FBQyxBQUFVLFdBQUMsQUFBTyxBQUFDO0FBRXRDLEFBQUUsQUFBQyxZQUFDLEFBQU8sWUFBSyxBQUFJLEFBQUMsTUFBQyxBQUFDO0FBQ3JCLEFBQU8sb0JBQUMsQUFBYyxlQUFDLEFBQU8sQUFBQyxBQUFDO0FBRWhDLEFBQUUsQUFBQyxnQkFBQyxDQUFDLEFBQVEsQUFBQyxVQUFDLEFBQUM7QUFDZCxBQUFPLHdCQUFDLEFBQWUsZ0JBQUMsQUFBTyxBQUFDLEFBQUMsQUFDbkM7QUFBQyxBQUNIO0FBQUM7QUFFRCxBQUFJLGFBQUMsQUFBVyxBQUFFLEFBQUM7QUFDbkIsQUFBSSxhQUFDLEFBQVUsV0FBQyxBQUFJLEtBQUMsQUFBTyxBQUFDLEFBQUM7QUFDOUIsQUFBTSxlQUFDLEFBQU8sQUFBQyxBQUNqQjtBQUFDO0FBRUQsQUFBUTtBQUNOLEFBQUksYUFBQyxBQUFLLEFBQUUsUUFBQyxBQUFRLFNBQUMsQUFBSSxBQUFDLEFBQUM7QUFDNUIsQUFBSSxhQUFDLEFBQVksQUFBRSxBQUFDO0FBQ3BCLEFBQU0sQUFBQyxBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQVUsV0FBQyxBQUFHLEFBQUUsQUFBRSxBQUFxQyxBQUFDLEFBQUMsQUFDOUU7QUFBQztBQUVELEFBQVcsa0JBQVUsQ0FBQztBQUN0QixBQUFZLG1CQUFVLENBQUM7QUFFdkIsQUFBMkI7QUFDM0IsQUFBVyxnQkFBQyxBQUFXO0FBQ3JCLFlBQUksQUFBTyxVQUFHLEFBQUksS0FBQyxBQUFhLGNBQUMsQUFBRyxBQUFDLEFBQUM7QUFDdEMsQUFBSSxhQUFDLEFBQVksZUFBRyxBQUFPLEFBQUM7QUFFNUIsQUFBTSxlQUFDLEFBQU8sQUFBQyxBQUNqQjtBQUFDO0FBRUQsQUFBYSxrQkFBQyxBQUFXO0FBQ3ZCLEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBRyxJQUFDLEFBQWEsY0FBQyxBQUFHLEtBQUUsQUFBSSxLQUFDLEFBQU8sQUFBQyxBQUFDLEFBQ25EO0FBQUM7QUFFRCxBQUFZO0FBQ1YsWUFBSSxBQUFNLFNBQUcsQUFBSSxLQUFDLEFBQU8sQUFBQztBQUMxQixZQUFJLEFBQU8sQUFBRyxBQUFNLFVBQUMsQUFBSSxLQUFDLEFBQVksQUFBRSxBQUFpRSxBQUFDLEFBQUM7QUFFM0csQUFBSSxhQUFDLEFBQWMsZUFBQyxBQUFNLFFBQUUsQUFBTyxBQUFDLEFBQUM7QUFFckMsQUFBSSxhQUFDLEFBQVksZUFBRyxBQUFJLEFBQUM7QUFDekIsQUFBSSxhQUFDLEFBQVUsYUFBRyxBQUFJLEFBQUM7QUFFdkIsQUFBSSxhQUFDLEFBQVcsWUFBQyxBQUFPLFNBQUUsQUFBSSxBQUFDLEFBQUM7QUFDaEMsQUFBSSxhQUFDLEFBQWMsZUFBQyxBQUFPLEFBQUMsQUFBQyxBQUMvQjtBQUFDO0FBRUQsQUFBYyxtQkFBQyxBQUFzQixRQUFFLEFBQTRCO0FBQ2pFLEFBQUksYUFBQyxBQUFHLElBQUMsQUFBWSxhQUFDLEFBQU0sUUFBRSxBQUFZLGNBQUUsQUFBSSxLQUFDLEFBQVcsQUFBQyxBQUFDLEFBQ2hFO0FBQUM7QUFFRCxBQUFZO0FBQ1YsQUFBSSxhQUFDLEFBQWdCLEFBQUUsQUFBQztBQUN4QixBQUFJLGFBQUMsQUFBVSxBQUFFLEFBQUMsQUFDcEI7QUFBQztBQUVELEFBQWlCLHNCQUFDLEFBQXVCLFNBQUUsQUFBWSxNQUFFLGNBQW1DLEFBQUk7QUFDOUYsQUFBSSxhQUFDLEFBQW1CLG9CQUFDLEFBQU8sU0FBRSxBQUFJLE1BQUUsQUFBVyxBQUFDLEFBQUMsQUFDdkQ7QUFBQztBQUVELEFBQW1CLHdCQUFDLEFBQXVCLFNBQUUsQUFBYSxPQUFFLEFBQWdDO0FBQzFGLEFBQUksYUFBQyxBQUFXLFlBQUMsQUFBTyxTQUFFLEFBQVcsQUFBQyxBQUFDO0FBQ3ZDLFlBQUksQUFBTyxVQUFHLElBQUksQUFBa0IsbUJBQUMsQUFBTyxBQUFDLEFBQUM7QUFDOUMsQUFBSSxhQUFDLEFBQWdCLGlCQUFDLEFBQU8sU0FBRSxBQUFJLEFBQUMsQUFBQyxBQUN2QztBQUFDO0FBRUQsQUFBZ0I7QUFDZCxBQUFJLGFBQUMsQUFBUSxBQUFFLEFBQUM7QUFDaEIsQUFBSSxhQUFDLEFBQVUsQUFBRSxBQUFDLEFBQ3BCO0FBQUM7QUFFUyxBQUFXLGdCQUFDLEFBQXVCLFNBQUUsQUFBZ0M7QUFDN0UsQUFBSSxhQUFDLEFBQVcsWUFBQyxBQUFJLEtBQUMsSUFBSSxBQUFNLE9BQUMsQUFBTyxTQUFFLEFBQVcsQUFBQyxBQUFDLEFBQUMsQUFDMUQ7QUFBQztBQUVELEFBQWlCLHNCQUFDLEFBQWM7QUFDOUIsQUFBSSxhQUFDLEFBQUssQUFBRSxRQUFDLEFBQWMsZUFBQyxBQUFDLEFBQUMsQUFBQyxBQUNqQztBQUFDO0FBRUQsQUFBZSxvQkFBQyxBQUFjO0FBQzVCLEFBQUksYUFBQyxBQUFLLEFBQUUsUUFBQyxBQUFlLGdCQUFDLEFBQU0sQUFBQyxBQUFDO0FBQ3JDLEFBQU0sZUFBQyxBQUFNLEFBQUMsQUFDaEI7QUFBQztBQUVELEFBQWEsa0JBQXdCLEFBQU87QUFDMUMsQUFBSSxhQUFDLEFBQUssQUFBRSxRQUFDLEFBQWEsY0FBQyxBQUFJLEFBQUMsQUFBQztBQUNqQyxBQUFNLGVBQUMsQUFBSSxBQUFDLEFBQ2Q7QUFBQztBQUVELEFBQWMsbUJBQUMsQUFBdUI7QUFDcEMsQUFBSSxhQUFDLEFBQUssQUFBRSxRQUFDLEFBQVcsWUFBQyxBQUFPLEFBQUMsQUFBQztBQUNsQyxBQUFNLGVBQUMsQUFBTyxBQUFDLEFBQ2pCO0FBQUM7QUFFRCxBQUFnQjtBQUNkLEFBQUksYUFBQyxBQUFLLEFBQUUsUUFBQyxBQUFZLEFBQUUsQUFBQyxBQUM5QjtBQUFDO0FBRUQsQUFBVSxlQUFDLEFBQWM7QUFDdkIsQUFBTSxlQUFDLEFBQUksS0FBQyxBQUFhLGNBQUMsQUFBSSxLQUFDLEFBQVksYUFBQyxBQUFNLEFBQUMsQUFBQyxBQUFDLEFBQ3ZEO0FBQUM7QUFFRCxBQUFZLGlCQUFDLEFBQVk7QUFDdkIsWUFBSSxFQUFFLEFBQUcsS0FBRSxBQUFPLFNBQUUsQUFBVyxBQUFFLGdCQUFHLEFBQUksQUFBQztBQUN6QyxZQUFJLEFBQUksT0FBRyxBQUFHLElBQUMsQUFBYyxlQUFDLEFBQUksQUFBQyxBQUFDO0FBQ3BDLEFBQUcsWUFBQyxBQUFZLGFBQUMsQUFBTyxTQUFFLEFBQUksTUFBRSxBQUFXLEFBQUMsQUFBQztBQUM3QyxBQUFNLGVBQUMsQUFBSSxBQUFDLEFBQ2Q7QUFBQztBQUVELEFBQVksaUJBQUMsQUFBaUI7QUFDNUIsQUFBSSxhQUFDLEFBQUcsSUFBQyxBQUFZLGFBQUMsQUFBSSxLQUFDLEFBQU8sU0FBRSxBQUFJLE1BQUUsQUFBSSxLQUFDLEFBQVcsQUFBQyxBQUFDO0FBQzVELEFBQU0sZUFBQyxBQUFJLEFBQUMsQUFDZDtBQUFDO0FBRUQsQUFBZ0IscUJBQUMsQUFBaUM7QUFDaEQsWUFBSSxBQUFLLFFBQUcsQUFBUSxTQUFDLEFBQVUsQUFBQztBQUVoQyxBQUFFLEFBQUMsWUFBQyxBQUFLLEFBQUMsT0FBQyxBQUFDO0FBQ1YsZ0JBQUksQUFBRyxNQUFHLEFBQU0sT0FBQyxBQUFJLEtBQUMsQUFBTyxTQUFFLEFBQUssT0FBRSxBQUFRLFNBQUMsQUFBVSxBQUFDLEFBQUM7QUFDM0QsQUFBSSxpQkFBQyxBQUFHLElBQUMsQUFBWSxhQUFDLEFBQUksS0FBQyxBQUFPLFNBQUUsQUFBUSxVQUFFLEFBQUksS0FBQyxBQUFXLEFBQUMsQUFBQztBQUNoRSxBQUFNLG1CQUFDLEFBQUcsQUFBQyxBQUNiO0FBQUMsQUFBQyxBQUFJLGVBQUMsQUFBQztBQUNOLEFBQU0sbUJBQUMsQUFBTSxPQUFDLEFBQUksS0FBQyxBQUFPLFNBQUUsQUFBSSxLQUFDLEFBQWUsZ0JBQUMsQUFBRSxBQUFDLEFBQUMsQUFBQyxBQUN4RDtBQUFDLEFBQ0g7QUFBQztBQUVELEFBQVksaUJBQUMsQUFBWTtBQUN2QixBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQUcsSUFBQyxBQUFnQixpQkFBQyxBQUFJLEtBQUMsQUFBTyxTQUFFLEFBQUksS0FBQyxBQUFXLGFBQUUsQUFBSSxBQUFDLEFBQUMsQUFDekU7QUFBQztBQUVELEFBQTRCLGlDQUFDLEFBQWE7QUFDeEMsWUFBSSxBQUFPLFVBQUcsSUFBSSxBQUFxQixzQkFBQyxBQUFJLEtBQUMsQUFBOEIsK0JBQUMsQUFBSyxBQUFDLEFBQUMsQUFBQztBQUNwRixBQUFJLGFBQUMsQUFBZSxnQkFBQyxBQUFPLEFBQUMsQUFBQztBQUM5QixBQUFNLGVBQUMsQUFBTyxBQUFDLEFBQ2pCO0FBQUM7QUFFRCxBQUE4QixtQ0FBQyxBQUFhO0FBQzFDLEFBQUUsQUFBQyxZQUFDLEFBQVEsU0FBQyxBQUFLLEFBQUMsQUFBQyxRQUFDLEFBQUM7QUFDcEIsQUFBTSxtQkFBQyxBQUFJLEtBQUMsQUFBYyxlQUFDLEFBQUssQUFBQyxBQUFDLEFBQ3BDO0FBQUMsQUFBQyxBQUFJLG1CQUFLLEFBQU8sUUFBQyxBQUFLLEFBQUMsQUFBQyxRQUFDLEFBQUM7QUFDMUIsQUFBTSxtQkFBQyxBQUFJLEtBQUMsQUFBYyxlQUFDLEFBQUUsQUFBQyxBQUFDLEFBQ2pDO0FBQUMsQUFBQyxBQUFJLFNBRkMsQUFBRSxBQUFDLE1BRUgsQUFBRSxBQUFDLElBQUMsQUFBWSxhQUFDLEFBQUssQUFBQyxBQUFDLFFBQUMsQUFBQztBQUMvQixBQUFNLG1CQUFDLEFBQUksS0FBQyxBQUFjLGVBQUMsQUFBSyxNQUFDLEFBQU0sQUFBRSxBQUFDLEFBQUMsQUFDN0M7QUFBQztBQUFDLEFBQUUsQUFBQyxZQUFDLEFBQVUsV0FBQyxBQUFLLEFBQUMsQUFBQyxRQUFDLEFBQUM7QUFDeEIsZ0JBQUksQUFBTSxTQUFHLEFBQUksS0FBQyxBQUFnQixpQkFBQyxBQUFLLEFBQUMsQUFBQztBQUMxQyxBQUFNLG1CQUFDLElBQUksQUFBa0IsbUJBQUMsQUFBTSxRQUFFLEFBQUssT0FBRSxBQUFJLEFBQUMsQUFBQyxBQUNyRDtBQUFDLEFBQUMsQUFBSSxlQUFDLEFBQUUsQUFBQyxJQUFDLEFBQU0sT0FBQyxBQUFLLEFBQUMsQUFBQyxRQUFDLEFBQUM7QUFDekIsZ0JBQUksQUFBSSxPQUFHLEFBQUksS0FBQyxBQUFZLGFBQUMsQUFBSyxBQUFDLEFBQUM7QUFDcEMsQUFBTSxtQkFBQyxJQUFJLEFBQWtCLG1CQUFDLEFBQU0sT0FBQyxBQUFJLEtBQUMsQUFBTyxTQUFFLEFBQUksQUFBQyxPQUFFLEFBQUksTUFBRSxBQUFJLEFBQUMsQUFBQyxBQUN4RTtBQUFDO0FBRUQsQUFBTSxlQUFDLEFBQUksS0FBQyxBQUFjLGVBQUMsQUFBTSxPQUFDLEFBQUssQUFBQyxBQUFDLEFBQUMsQUFDNUM7QUFBQztBQUVELEFBQTRCLGlDQUFDLEFBQWE7QUFDeEMsWUFBSSxBQUFPLFVBQUcsSUFBSSxBQUFxQixzQkFBQyxBQUFJLEtBQUMsQUFBOEIsK0JBQUMsQUFBSyxBQUFDLEFBQUMsQUFBQztBQUNwRixBQUFJLGFBQUMsQUFBZSxnQkFBQyxBQUFPLFFBQUMsQUFBTSxBQUFDLEFBQUM7QUFDckMsQUFBTSxlQUFDLEFBQU8sQUFBQyxBQUNqQjtBQUFDO0FBRUQsQUFBOEIsbUNBQUMsQUFBYTtBQUMxQyxBQUFFLEFBQUMsWUFBQyxBQUFRLFNBQUMsQUFBSyxBQUFDLEFBQUMsUUFBQyxBQUFDO0FBQ3BCLEFBQU0sbUJBQUMsQUFBSSxLQUFDLEFBQWdCLGlCQUFDLEFBQUssQUFBQyxBQUFDLEFBQ3RDO0FBQUMsQUFBQyxBQUFJLG1CQUFLLEFBQU8sUUFBQyxBQUFLLEFBQUMsQUFBQyxRQUFDLEFBQUM7QUFDMUIsQUFBTSxtQkFBQyxBQUFJLEtBQUMsQUFBZ0IsaUJBQUMsQUFBRSxBQUFDLEFBQUMsQUFDbkM7QUFBQyxBQUFDLEFBQUksU0FGQyxBQUFFLEFBQUMsVUFFQyxBQUFVLFdBQUMsQUFBSyxBQUFDLEFBQUMsUUFBQyxBQUFDO0FBQzdCLGdCQUFJLEFBQU0sU0FBRyxBQUFJLEtBQUMsQUFBZ0IsaUJBQUMsQUFBSyxBQUFDLEFBQUM7QUFDMUMsQUFBTSxtQkFBQyxJQUFJLEFBQWtCLG1CQUFDLEFBQU0sUUFBRSxBQUFLLE9BQUUsQUFBSyxBQUFDLEFBQUMsQUFDdEQ7QUFBQyxBQUFDLEFBQUksU0FIQyxBQUFFLEFBQUMsVUFHQyxBQUFNLE9BQUMsQUFBSyxBQUFDLEFBQUMsUUFBQyxBQUFDO0FBQ3pCLGdCQUFJLEFBQUksT0FBRyxBQUFJLEtBQUMsQUFBWSxhQUFDLEFBQUssQUFBQyxBQUFDO0FBQ3BDLEFBQU0sbUJBQUMsSUFBSSxBQUFrQixtQkFBQyxBQUFNLE9BQUMsQUFBSSxLQUFDLEFBQU8sU0FBRSxBQUFJLEFBQUMsT0FBRSxBQUFJLE1BQUUsQUFBSyxBQUFDLEFBQUMsQUFDekU7QUFBQyxBQUFDLEFBQUksU0FIQyxBQUFFLEFBQUMsTUFHSCxBQUFFLEFBQUMsSUFBQyxBQUFZLGFBQUMsQUFBSyxBQUFDLEFBQUMsUUFBQyxBQUFDO0FBQy9CLGdCQUFJLEFBQVUsYUFBRyxBQUFLLE1BQUMsQUFBTSxBQUFFLEFBQUM7QUFDaEMsZ0JBQUksQUFBTSxTQUFHLEFBQUksS0FBQyxBQUFZLGFBQUMsQUFBVSxBQUFDLEFBQUM7QUFDM0MsQUFBc0Y7QUFDdEYsQUFBTSxtQkFBQyxJQUFJLEFBQWtCLG1CQUFDLEFBQU0sUUFBRSxBQUFLLE9BQUUsQUFBSyxBQUFDLEFBQUMsQUFDdEQ7QUFBQztBQUVELEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBZ0IsaUJBQUMsQUFBTSxPQUFDLEFBQUssQUFBQyxBQUFDLEFBQUMsQUFDOUM7QUFBQztBQUVPLEFBQWMsbUJBQUMsQUFBYTtBQUNsQyxZQUFJLEFBQU0sU0FBRyxBQUFJLEtBQUMsQUFBWSxhQUFDLEFBQUssQUFBQyxBQUFDO0FBQ3RDLEFBQU0sZUFBQyxJQUFJLEFBQXlCLDBCQUFDLEFBQU0sUUFBRSxBQUFLLE9BQUUsQUFBSSxBQUFDLEFBQUMsQUFDNUQ7QUFBQztBQUVPLEFBQWdCLHFCQUFDLEFBQWE7QUFDcEMsWUFBSSxBQUFRLFdBQUcsQUFBSSxLQUFDLEFBQVksYUFBQyxBQUFLLEFBQUMsQUFBQztBQUN4QyxZQUFJLEFBQU0sU0FBRyxBQUFNLE9BQUMsQUFBSSxLQUFDLEFBQU8sU0FBRSxBQUFRLEFBQUMsQUFBQztBQUM1QyxBQUFNLGVBQUMsSUFBSSxBQUFrQixtQkFBQyxBQUFNLFFBQUUsQUFBSyxPQUFFLEFBQUssQUFBQyxBQUFDLEFBQ3REO0FBQUM7QUFFRCxBQUFhLGtCQUFDLEFBQWM7QUFDMUIsQUFBTSxlQUFDLEFBQUksS0FBQyxBQUFhLGNBQUMsQUFBSSxLQUFDLEFBQWUsZ0JBQUMsQUFBTSxBQUFDLEFBQUMsQUFBQyxBQUMxRDtBQUFDO0FBRUQsQUFBZSxvQkFBQyxBQUFjO0FBQzVCLFlBQUksRUFBRSxBQUFHLEtBQUUsQUFBTyxTQUFFLEFBQVcsQUFBRSxnQkFBRyxBQUFJLEFBQUM7QUFDekMsWUFBSSxBQUFJLE9BQUcsQUFBRyxJQUFDLEFBQWEsY0FBQyxBQUFNLEFBQUMsQUFBQztBQUNyQyxBQUFHLFlBQUMsQUFBWSxhQUFDLEFBQU8sU0FBRSxBQUFJLE1BQUUsQUFBVyxBQUFDLEFBQUM7QUFDN0MsQUFBTSxlQUFDLEFBQUksQUFBQyxBQUNkO0FBQUM7QUFFRCxBQUFjLG1CQUFDLEFBQVksTUFBRSxBQUFhLE9BQUUsQUFBeUI7QUFDbkUsQUFBSSxhQUFDLEFBQUcsSUFBQyxBQUFZLGFBQUMsQUFBSSxLQUFDLEFBQWEsY0FBRSxBQUFJLE1BQUUsQUFBSyxPQUFFLEFBQVMsQUFBQyxBQUFDLEFBQ3BFO0FBQUM7QUFFRCxBQUFhLGtCQUFDLEFBQVksTUFBRSxBQUFhO0FBQ3ZDLEFBQUksYUFBQyxBQUFhLGFBQUMsQUFBSSxBQUFDLFFBQUcsQUFBSyxBQUFDLEFBQ25DO0FBQUM7QUFFRCxBQUFrQix1QkFBQyxBQUFZLE1BQUUsQUFBYSxPQUFFLEFBQXlCO0FBQ3ZFLEFBQUksYUFBQyxBQUFjLGVBQUMsQUFBSSxNQUFFLEFBQUssT0FBRSxBQUFTLEFBQUMsQUFBQyxBQUM5QztBQUFDO0FBRUQsQUFBbUIsd0JBQUMsQUFBWSxNQUFFLEFBQWEsT0FBRSxBQUFpQixVQUFFLEFBQXlCO0FBQzNGLFlBQUksQUFBTyxVQUFHLEFBQUksS0FBQyxBQUFhLEFBQUM7QUFDakMsWUFBSSxBQUFnQixtQkFBRyxBQUFJLEtBQUMsQUFBRyxJQUFDLEFBQVksYUFBQyxBQUFPLFNBQUUsQUFBSSxNQUFFLEFBQVEsVUFBRSxBQUFTLEFBQUMsQUFBQztBQUNqRixZQUFJLEFBQVMsWUFBRyxJQUFJLEFBQWdCLGlCQUFDLEVBQUUsQUFBTyxTQUFFLEFBQUksTUFBRSxBQUFTLFdBQUUsQUFBUyxhQUFJLEFBQUksQUFBRSxBQUFDLEFBQUM7QUFFdEYsQUFBUyxrQkFBQyxBQUFHLElBQUMsQUFBSSxNQUFFLEFBQUssT0FBRSxBQUFJLEtBQUMsQUFBRyxBQUFDLEFBQUM7QUFFckMsQUFBTSxlQUFDLEFBQVMsQUFBQyxBQUNuQjtBQUFDLEFBQ0Y7O0FBV0QsQUFBTTtBQU1KLGdCQUFvQixBQUFzQjtBQUF0QixhQUFNLFNBQU4sQUFBTSxBQUFnQjtBQUxoQyxhQUFLLFFBQXNCLEFBQUksQUFBQztBQUNoQyxhQUFJLE9BQXFCLEFBQUksQUFBQztBQUM5QixhQUFZLGVBQTBCLEFBQUksQUFBQztBQUMzQyxhQUFPLFVBQUcsQUFBQyxBQUFDLEFBRXNCO0FBQUM7QUFFN0MsQUFBTztBQUNMLFlBQUksRUFBRSxBQUFZLEFBQUUsaUJBQUcsQUFBSSxBQUFDO0FBRTVCLEFBQUUsQUFBQyxZQUFDLEFBQVksZ0JBQUksQUFBWSxhQUFDLEFBQU0sQUFBQyxRQUFDLEFBQUM7QUFDeEMsQUFBRyxBQUFDLGlCQUFDLElBQUksQUFBQyxJQUFDLEFBQUMsR0FBRSxBQUFDLElBQUMsQUFBWSxhQUFDLEFBQU0sUUFBRSxBQUFDLEFBQUUsS0FBRSxBQUFDO0FBQ3pDLEFBQVksNkJBQUMsQUFBQyxBQUFDLEdBQUMsQUFBTyxBQUFFLEFBQUMsQUFDNUI7QUFBQyxBQUNIO0FBQUMsQUFDSDtBQUFDO0FBRUQsQUFBYTtBQUNYLEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBTSxBQUFDLEFBQ3JCO0FBQUM7QUFFRCxBQUFTO0FBQ1AsQUFBTSxlQUFDLEFBQUksS0FBQyxBQUFLLFNBQUksQUFBSSxLQUFDLEFBQUssTUFBQyxBQUFTLEFBQUUsQUFBQyxBQUM5QztBQUFDO0FBRUQsQUFBUTtBQUNOLEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBSSxRQUFJLEFBQUksS0FBQyxBQUFJLEtBQUMsQUFBUSxBQUFFLEFBQUMsQUFDM0M7QUFBQztBQUVELEFBQVcsZ0JBQUMsQUFBZ0I7QUFDMUIsQUFBSSxhQUFDLEFBQWEsY0FBQyxBQUFPLEFBQUMsQUFBQztBQUM1QixBQUFJLGFBQUMsQUFBTyxBQUFFLEFBQUMsQUFDakI7QUFBQztBQUVELEFBQVk7QUFDVixBQUFJLGFBQUMsQUFBTyxBQUFFLEFBQUMsQUFDakI7QUFBQztBQUVELEFBQWEsa0JBQUMsQUFBVTtBQUN0QixBQUFFLEFBQUMsWUFBQyxBQUFJLEtBQUMsQUFBTyxZQUFLLEFBQUMsQUFBQyxHQUFDLEFBQU0sQUFBQztBQUUvQixBQUFFLEFBQUMsWUFBQyxDQUFDLEFBQUksS0FBQyxBQUFLLEFBQUMsT0FBQyxBQUFDO0FBQ2hCLEFBQUksaUJBQUMsQUFBSyxRQUFHLElBQUksQUFBSyxNQUFDLEFBQUksQUFBQyxBQUFDLEFBQy9CO0FBQUM7QUFFRCxBQUFJLGFBQUMsQUFBSSxPQUFHLElBQUksQUFBSSxLQUFDLEFBQUksQUFBQyxBQUFDLEFBQzdCO0FBQUM7QUFFRCxBQUFlLG9CQUFDLEFBQWM7QUFDNUIsQUFBRSxBQUFDLFlBQUMsQUFBSSxLQUFDLEFBQU8sWUFBSyxBQUFDLEFBQUMsR0FBQyxBQUFNLEFBQUM7QUFFL0IsQUFBRSxBQUFDLFlBQUMsQ0FBQyxBQUFJLEtBQUMsQUFBSyxBQUFDLE9BQUMsQUFBQztBQUNoQixBQUFJLGlCQUFDLEFBQUssUUFBRyxBQUFNLEFBQUMsQUFDdEI7QUFBQztBQUVELEFBQUksYUFBQyxBQUFJLE9BQUcsQUFBTSxBQUFDLEFBQ3JCO0FBQUM7QUFFRCxBQUFjLG1CQUFDLEFBQWM7QUFDM0IsQUFBSSxhQUFDLEFBQVksZUFBRyxBQUFJLEtBQUMsQUFBWSxnQkFBSSxBQUFFLEFBQUM7QUFDNUMsQUFBSSxhQUFDLEFBQVksYUFBQyxBQUFJLEtBQUMsQUFBQyxBQUFDLEFBQUMsQUFDNUI7QUFBQztBQUVELEFBQVEsYUFBQyxBQUFxQjtBQUM1QixBQUFFLEFBQUMsWUFBQyxDQUFDLEFBQUksS0FBQyxBQUFLLEFBQUMsT0FBQyxBQUFDO0FBQ2hCLEFBQUssa0JBQUMsQUFBYSxjQUFDLEFBQUUsQUFBQyxBQUFDLEFBQzFCO0FBQUMsQUFDSDtBQUFDLEFBQ0Y7O0FBRUQsQUFBTSxhQUEwQiwyQkFBUSxBQUFrQjtBQUN4RCxBQUFPO0FBQ0wsQUFBSyxjQUFDLEFBQU8sQUFBRSxBQUFDO0FBRWhCLEFBQUssY0FBQyxBQUFJLEFBQUMsQUFBQyxBQUNkO0FBQUMsQUFDRjs7QUFNRCxBQUFNLGFBQTZCLDhCQUFRLEFBQWtCO0FBQzNELEFBQUssVUFBQyxBQUFnQjtBQUNwQixZQUFJLEVBQUUsQUFBWSxBQUFFLGlCQUFHLEFBQUksQUFBQztBQUU1QixBQUFFLEFBQUMsWUFBQyxBQUFZLGdCQUFJLEFBQVksYUFBQyxBQUFNLEFBQUMsUUFBQyxBQUFDO0FBQ3hDLEFBQUcsQUFBQyxpQkFBQyxJQUFJLEFBQUMsSUFBQyxBQUFDLEdBQUUsQUFBQyxJQUFDLEFBQVksYUFBQyxBQUFNLFFBQUUsQUFBQyxBQUFFLEtBQUUsQUFBQztBQUN6QyxBQUFHLG9CQUFDLEFBQVUsV0FBQyxBQUFZLGFBQUMsQUFBQyxBQUFDLEFBQUMsQUFBQyxBQUNsQztBQUFDLEFBQ0g7QUFBQztBQUVELFlBQUksQUFBVyxjQUFHLEFBQUssTUFBQyxBQUFJLEFBQUMsQUFBQztBQUU5QixBQUFJLGFBQUMsQUFBSyxRQUFHLEFBQUksQUFBQztBQUNsQixBQUFJLGFBQUMsQUFBSSxPQUFHLEFBQUksQUFBQztBQUNqQixBQUFJLGFBQUMsQUFBWSxlQUFHLEFBQUksQUFBQztBQUN6QixBQUFJLGFBQUMsQUFBTyxVQUFHLEFBQUMsQUFBQztBQUVqQixBQUFNLGVBQUMsQUFBVyxBQUFDLEFBQ3JCO0FBQUMsQUFDRjs7QUFFRDtBQUNFLGdCQUFvQixBQUFzQixRQUFVLEFBQTREO0FBQTVGLGFBQU0sU0FBTixBQUFNLEFBQWdCO0FBQVUsYUFBUyxZQUFULEFBQVMsQUFBbUQ7QUFDOUcsQUFBSSxhQUFDLEFBQU0sU0FBRyxBQUFNLEFBQUM7QUFDckIsQUFBSSxhQUFDLEFBQVMsWUFBRyxBQUFTLEFBQUMsQUFDN0I7QUFBQztBQUVELEFBQU87QUFDTCxBQUFJLGFBQUMsQUFBUyxVQUFDLEFBQVcsWUFBQyxBQUFJLFFBQUksQUFBSSxLQUFDLEFBQU8sQUFBRSxBQUFDLEFBQUMsQUFDckQ7QUFBQztBQUVELEFBQWE7QUFDWCxBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQU0sQUFBQyxBQUNyQjtBQUFDO0FBRUQsQUFBUztBQUNQLFlBQUksQUFBSSxPQUFHLEFBQUksS0FBQyxBQUFTLFVBQUMsQUFBSSxBQUFFLEFBQUM7QUFDakMsQUFBTSxlQUFDLEFBQUksUUFBSSxBQUFJLEtBQUMsQUFBUyxBQUFFLEFBQUMsQUFDbEM7QUFBQztBQUVELEFBQVE7QUFDTixZQUFJLEFBQUksT0FBRyxBQUFJLEtBQUMsQUFBUyxVQUFDLEFBQUksQUFBRSxBQUFDO0FBQ2pDLEFBQU0sZUFBQyxBQUFJLFFBQUksQUFBSSxLQUFDLEFBQVEsQUFBRSxBQUFDLEFBQ2pDO0FBQUM7QUFFRCxBQUFXLGdCQUFDLEFBQWlCO2tCQUMzQixBQUFNLE9BQUMsQUFBSyxPQUFFLEFBQWlELEFBQUMsQUFBQyxBQUNuRTtBQUFDO0FBRUQsQUFBWTtrQkFDVixBQUFNLE9BQUMsQUFBSyxPQUFFLEFBQWtELEFBQUMsQUFBQyxBQUNwRTtBQUFDO0FBRUQsQUFBYSxrQkFBQyxBQUFXO2tCQUN2QixBQUFNLE9BQUMsQUFBSyxPQUFFLEFBQXVELEFBQUMsQUFBQyxBQUN6RTtBQUFDO0FBRUQsQUFBZSxvQkFBQyxBQUFlLFNBQy9CLENBQUM7QUFFRCxBQUFjLG1CQUFDLEFBQWUsSUFDOUIsQ0FBQztBQUVELEFBQVEsYUFBQyxBQUFzQixRQUMvQixDQUFDLEFBQ0Y7O0FBRUQsQUFBTSw4QkFBd0IsQUFBZ0IsS0FBRSxBQUFjO0FBQzVELEFBQU0sV0FBQyxBQUFpQixrQkFBQyxBQUFnQixpQkFBQyxBQUFHLEtBQUUsQUFBTSxBQUFDLEFBQUMsQUFDekQ7QUFBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNsZWFyLCBDdXJzb3IsIERlc3Ryb3lhYmxlQm91bmRzLCBzaW5nbGUsIEJvdW5kcywgYm91bmRzIH0gZnJvbSAnLi4vYm91bmRzJztcblxuaW1wb3J0IHsgRE9NQ2hhbmdlcywgRE9NVHJlZUNvbnN0cnVjdGlvbiB9IGZyb20gJy4uL2RvbS9oZWxwZXInO1xuaW1wb3J0IHsgaXNTdHJpbmcsIGlzU2FmZVN0cmluZywgaXNOb2RlLCBpc0ZyYWdtZW50LCBpc0VtcHR5IH0gZnJvbSAnLi4vZG9tL25vcm1hbGl6ZSc7XG5cbmltcG9ydCB7IE9wdGlvbiwgRGVzdHJveWFibGUsIFN0YWNrLCBMaW5rZWRMaXN0LCBMaW5rZWRMaXN0Tm9kZSwgYXNzZXJ0LCBleHBlY3QgfSBmcm9tICdAZ2xpbW1lci91dGlsJztcblxuaW1wb3J0IHsgRW52aXJvbm1lbnQgfSBmcm9tICcuLi9lbnZpcm9ubWVudCc7XG5cbmltcG9ydCB7IFZlcnNpb25lZFJlZmVyZW5jZSB9IGZyb20gJ0BnbGltbWVyL3JlZmVyZW5jZSc7XG5cbmltcG9ydCB7IER5bmFtaWNDb250ZW50LCBEeW5hbWljQ29udGVudFdyYXBwZXIgfSBmcm9tICcuL2NvbnRlbnQvZHluYW1pYyc7XG5pbXBvcnQgRHluYW1pY1RleHRDb250ZW50IGZyb20gJy4vY29udGVudC90ZXh0JztcbmltcG9ydCBEeW5hbWljTm9kZUNvbnRlbnQgZnJvbSAnLi9jb250ZW50L25vZGUnO1xuaW1wb3J0IER5bmFtaWNIVE1MQ29udGVudCwgeyBEeW5hbWljVHJ1c3RlZEhUTUxDb250ZW50IH0gZnJvbSAnLi9jb250ZW50L2h0bWwnO1xuXG5pbXBvcnQgeyBEeW5hbWljQXR0cmlidXRlIH0gZnJvbSAnLi9hdHRyaWJ1dGVzL2R5bmFtaWMnO1xuXG5pbXBvcnQgeyBPcGFxdWUsIFNpbXBsZSB9IGZyb20gXCJAZ2xpbW1lci9pbnRlcmZhY2VzXCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRmlyc3ROb2RlIHtcbiAgZmlyc3ROb2RlKCk6IE9wdGlvbjxTaW1wbGUuTm9kZT47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGFzdE5vZGUge1xuICBsYXN0Tm9kZSgpOiBPcHRpb248U2ltcGxlLk5vZGU+O1xufVxuXG5jbGFzcyBGaXJzdCB7XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgbm9kZTogTm9kZSkgeyB9XG5cbiAgZmlyc3ROb2RlKCk6IE5vZGUge1xuICAgIHJldHVybiB0aGlzLm5vZGU7XG4gIH1cbn1cblxuY2xhc3MgTGFzdCB7XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgbm9kZTogTm9kZSkgeyB9XG5cbiAgbGFzdE5vZGUoKTogTm9kZSB7XG4gICAgcmV0dXJuIHRoaXMubm9kZTtcbiAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEVsZW1lbnRPcGVyYXRpb25zIHtcbiAgc2V0QXR0cmlidXRlKG5hbWU6IHN0cmluZywgdmFsdWU6IFZlcnNpb25lZFJlZmVyZW5jZTxPcGFxdWU+LCB0cnVzdGluZzogYm9vbGVhbiwgbmFtZXNwYWNlOiBPcHRpb248c3RyaW5nPik6IHZvaWQ7XG59XG5cbmV4cG9ydCBjbGFzcyBGcmFnbWVudCBpbXBsZW1lbnRzIEJvdW5kcyB7XG4gIHByaXZhdGUgYm91bmRzOiBCb3VuZHM7XG5cbiAgY29uc3RydWN0b3IoYm91bmRzOiBCb3VuZHMpIHtcbiAgICB0aGlzLmJvdW5kcyA9IGJvdW5kcztcbiAgfVxuXG4gIHBhcmVudEVsZW1lbnQoKTogU2ltcGxlLkVsZW1lbnQge1xuICAgIHJldHVybiB0aGlzLmJvdW5kcy5wYXJlbnRFbGVtZW50KCk7XG4gIH1cblxuICBmaXJzdE5vZGUoKTogT3B0aW9uPFNpbXBsZS5Ob2RlPiB7XG4gICAgcmV0dXJuIHRoaXMuYm91bmRzLmZpcnN0Tm9kZSgpO1xuICB9XG5cbiAgbGFzdE5vZGUoKTogT3B0aW9uPFNpbXBsZS5Ob2RlPiB7XG4gICAgcmV0dXJuIHRoaXMuYm91bmRzLmxhc3ROb2RlKCk7XG4gIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBET01TdGFjayB7XG4gIHB1c2hSZW1vdGVFbGVtZW50KGVsZW1lbnQ6IFNpbXBsZS5FbGVtZW50LCBndWlkOiBzdHJpbmcsIG5leHRTaWJsaW5nOiBPcHRpb248U2ltcGxlLk5vZGU+KTogdm9pZDtcbiAgcG9wUmVtb3RlRWxlbWVudCgpOiB2b2lkO1xuICBwb3BFbGVtZW50KCk6IHZvaWQ7XG4gIG9wZW5FbGVtZW50KHRhZzogc3RyaW5nLCBfb3BlcmF0aW9ucz86IEVsZW1lbnRPcGVyYXRpb25zKTogU2ltcGxlLkVsZW1lbnQ7XG4gIGZsdXNoRWxlbWVudCgpOiB2b2lkO1xuICBhcHBlbmRUZXh0KHN0cmluZzogc3RyaW5nKTogU2ltcGxlLlRleHQ7XG4gIGFwcGVuZENvbW1lbnQoc3RyaW5nOiBzdHJpbmcpOiBTaW1wbGUuQ29tbWVudDtcbiAgYXBwZW5kVHJ1c3RpbmdEeW5hbWljQ29udGVudChyZWZlcmVuY2U6IE9wYXF1ZSk6IER5bmFtaWNDb250ZW50V3JhcHBlcjtcbiAgYXBwZW5kQ2F1dGlvdXNEeW5hbWljQ29udGVudChyZWZlcmVuY2U6IE9wYXF1ZSk6IER5bmFtaWNDb250ZW50V3JhcHBlcjtcbiAgc2V0U3RhdGljQXR0cmlidXRlKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgbmFtZXNwYWNlOiBPcHRpb248c3RyaW5nPik6IHZvaWQ7XG4gIHNldER5bmFtaWNBdHRyaWJ1dGUobmFtZTogc3RyaW5nLCB2YWx1ZTogT3BhcXVlLCBpc1RydXN0aW5nOiBib29sZWFuLCBuYW1lc3BhY2U6IE9wdGlvbjxzdHJpbmc+KTogRHluYW1pY0F0dHJpYnV0ZTtcbiAgY2xvc2VFbGVtZW50KCk6IHZvaWQ7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVHJlZU9wZXJhdGlvbnMge1xuICBfX29wZW5FbGVtZW50KHRhZzogc3RyaW5nKTogU2ltcGxlLkVsZW1lbnQ7XG4gIF9fZmx1c2hFbGVtZW50KHBhcmVudDogU2ltcGxlLkVsZW1lbnQsIGNvbnN0cnVjdGluZzogU2ltcGxlLkVsZW1lbnQpOiB2b2lkO1xuICBfX29wZW5CbG9jaygpOiB2b2lkO1xuICBfX2Nsb3NlQmxvY2soKTogdm9pZDtcbiAgX19hcHBlbmRUZXh0KHRleHQ6IHN0cmluZyk6IFNpbXBsZS5UZXh0O1xuICBfX2FwcGVuZENvbW1lbnQoc3RyaW5nOiBzdHJpbmcpOiBTaW1wbGUuQ29tbWVudDtcbiAgX19hcHBlbmROb2RlKG5vZGU6IFNpbXBsZS5Ob2RlKTogU2ltcGxlLk5vZGU7XG4gIF9fYXBwZW5kSFRNTChodG1sOiBzdHJpbmcpOiBCb3VuZHM7XG4gIF9fYXBwZW5kVHJ1c3RpbmdEeW5hbWljQ29udGVudCh2YWx1ZTogT3BhcXVlKTogRHluYW1pY0NvbnRlbnQ7XG4gIF9fYXBwZW5kQ2F1dGlvdXNEeW5hbWljQ29udGVudCh2YWx1ZTogT3BhcXVlKTogRHluYW1pY0NvbnRlbnQ7XG4gIF9fc2V0QXR0cmlidXRlKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgbmFtZXNwYWNlOiBPcHRpb248c3RyaW5nPik6IHZvaWQ7XG4gIF9fc2V0UHJvcGVydHkobmFtZTogc3RyaW5nLCB2YWx1ZTogT3BhcXVlKTogdm9pZDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBFbGVtZW50QnVpbGRlciBleHRlbmRzIEN1cnNvciwgRE9NU3RhY2ssIFRyZWVPcGVyYXRpb25zIHtcbiAgbmV4dFNpYmxpbmc6IE9wdGlvbjxTaW1wbGUuTm9kZT47XG4gIGRvbTogRE9NVHJlZUNvbnN0cnVjdGlvbjtcbiAgdXBkYXRlT3BlcmF0aW9uczogRE9NQ2hhbmdlcztcbiAgY29uc3RydWN0aW5nOiBPcHRpb248U2ltcGxlLkVsZW1lbnQ+O1xuICBlbGVtZW50OiBTaW1wbGUuRWxlbWVudDtcbiAgZW52OiBFbnZpcm9ubWVudDtcblxuICAvLyBUT0RPOiA/XG4gIGV4cGVjdENvbnN0cnVjdGluZyhtZXRob2Q6IHN0cmluZyk6IFNpbXBsZS5FbGVtZW50O1xuXG4gIGJsb2NrKCk6IFRyYWNrZXI7XG5cbiAgcHVzaFNpbXBsZUJsb2NrKCk6IFRyYWNrZXI7XG4gIHB1c2hVcGRhdGFibGVCbG9jaygpOiBVcGRhdGFibGVUcmFja2VyO1xuICBwdXNoQmxvY2tMaXN0KGxpc3Q6IExpbmtlZExpc3Q8TGlua2VkTGlzdE5vZGUgJiBCb3VuZHMgJiBEZXN0cm95YWJsZT4pOiBUcmFja2VyO1xuICBwb3BCbG9jaygpOiBUcmFja2VyO1xuXG4gIGRpZEFkZERlc3Ryb3lhYmxlKGQ6IERlc3Ryb3lhYmxlKTogdm9pZDtcbiAgZGlkQXBwZW5kQm91bmRzKGJvdW5kczogQm91bmRzKTogdm9pZDtcbn1cblxuZXhwb3J0IGNsYXNzIE5ld0VsZW1lbnRCdWlsZGVyIGltcGxlbWVudHMgRWxlbWVudEJ1aWxkZXIge1xuICBwdWJsaWMgZG9tOiBET01UcmVlQ29uc3RydWN0aW9uO1xuICBwdWJsaWMgdXBkYXRlT3BlcmF0aW9uczogRE9NQ2hhbmdlcztcbiAgcHVibGljIGNvbnN0cnVjdGluZzogT3B0aW9uPFNpbXBsZS5FbGVtZW50PiA9IG51bGw7XG4gIHB1YmxpYyBvcGVyYXRpb25zOiBPcHRpb248RWxlbWVudE9wZXJhdGlvbnM+ID0gbnVsbDtcbiAgcHVibGljIGVudjogRW52aXJvbm1lbnQ7XG5cbiAgcHJvdGVjdGVkIGN1cnNvclN0YWNrID0gbmV3IFN0YWNrPEN1cnNvcj4oKTtcbiAgcHJpdmF0ZSBibG9ja1N0YWNrID0gbmV3IFN0YWNrPFRyYWNrZXI+KCk7XG5cbiAgc3RhdGljIGZvckluaXRpYWxSZW5kZXIoZW52OiBFbnZpcm9ubWVudCwgY3Vyc29yOiBDdXJzb3IpIHtcbiAgICBsZXQgYnVpbGRlciA9IG5ldyB0aGlzKGVudiwgY3Vyc29yLmVsZW1lbnQsIGN1cnNvci5uZXh0U2libGluZyk7XG4gICAgYnVpbGRlci5wdXNoU2ltcGxlQmxvY2soKTtcbiAgICByZXR1cm4gYnVpbGRlcjtcbiAgfVxuXG4gIHN0YXRpYyByZXN1bWUoZW52OiBFbnZpcm9ubWVudCwgdHJhY2tlcjogVHJhY2tlciwgbmV4dFNpYmxpbmc6IE9wdGlvbjxTaW1wbGUuTm9kZT4pIHtcbiAgICBsZXQgcGFyZW50Tm9kZSA9IHRyYWNrZXIucGFyZW50RWxlbWVudCgpO1xuXG4gICAgbGV0IHN0YWNrID0gbmV3IHRoaXMoZW52LCBwYXJlbnROb2RlLCBuZXh0U2libGluZyk7XG4gICAgc3RhY2sucHVzaFNpbXBsZUJsb2NrKCk7XG4gICAgc3RhY2sucHVzaEJsb2NrVHJhY2tlcih0cmFja2VyKTtcblxuICAgIHJldHVybiBzdGFjaztcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKGVudjogRW52aXJvbm1lbnQsIHBhcmVudE5vZGU6IFNpbXBsZS5FbGVtZW50LCBuZXh0U2libGluZzogT3B0aW9uPFNpbXBsZS5Ob2RlPikge1xuICAgIHRoaXMucHVzaEVsZW1lbnQocGFyZW50Tm9kZSwgbmV4dFNpYmxpbmcpO1xuXG4gICAgdGhpcy5lbnYgPSBlbnY7XG4gICAgdGhpcy5kb20gPSBlbnYuZ2V0QXBwZW5kT3BlcmF0aW9ucygpO1xuICAgIHRoaXMudXBkYXRlT3BlcmF0aW9ucyA9IGVudi5nZXRET00oKTtcbiAgfVxuXG4gIGdldCBlbGVtZW50KCk6IFNpbXBsZS5FbGVtZW50IHtcbiAgICByZXR1cm4gdGhpcy5jdXJzb3JTdGFjay5jdXJyZW50IS5lbGVtZW50O1xuICB9XG5cbiAgZ2V0IG5leHRTaWJsaW5nKCk6IE9wdGlvbjxTaW1wbGUuTm9kZT4ge1xuICAgIHJldHVybiB0aGlzLmN1cnNvclN0YWNrLmN1cnJlbnQhLm5leHRTaWJsaW5nO1xuICB9XG5cbiAgZXhwZWN0Q29uc3RydWN0aW5nKG1ldGhvZDogc3RyaW5nKTogU2ltcGxlLkVsZW1lbnQge1xuICAgIHJldHVybiBleHBlY3QodGhpcy5jb25zdHJ1Y3RpbmcsIGAke21ldGhvZH0gc2hvdWxkIG9ubHkgYmUgY2FsbGVkIHdoaWxlIGNvbnN0cnVjdGluZyBhbiBlbGVtZW50YCk7XG4gIH1cblxuICBibG9jaygpOiBUcmFja2VyIHtcbiAgICByZXR1cm4gZXhwZWN0KHRoaXMuYmxvY2tTdGFjay5jdXJyZW50LCBcIkV4cGVjdGVkIGEgY3VycmVudCBibG9jayB0cmFja2VyXCIpO1xuICB9XG5cbiAgcG9wRWxlbWVudCgpIHtcbiAgICB0aGlzLmN1cnNvclN0YWNrLnBvcCgpO1xuICAgIGV4cGVjdCh0aGlzLmN1cnNvclN0YWNrLmN1cnJlbnQsIFwiY2FuJ3QgcG9wIHBhc3QgdGhlIGxhc3QgZWxlbWVudFwiKTtcbiAgfVxuXG4gIHB1c2hTaW1wbGVCbG9jaygpOiBUcmFja2VyIHtcbiAgICByZXR1cm4gdGhpcy5wdXNoQmxvY2tUcmFja2VyKG5ldyBTaW1wbGVCbG9ja1RyYWNrZXIodGhpcy5lbGVtZW50KSk7XG4gIH1cblxuICBwdXNoVXBkYXRhYmxlQmxvY2soKTogVXBkYXRhYmxlVHJhY2tlciB7XG4gICAgcmV0dXJuIHRoaXMucHVzaEJsb2NrVHJhY2tlcihuZXcgVXBkYXRhYmxlQmxvY2tUcmFja2VyKHRoaXMuZWxlbWVudCkpO1xuICB9XG5cbiAgcHVzaEJsb2NrTGlzdChsaXN0OiBMaW5rZWRMaXN0PExpbmtlZExpc3ROb2RlICYgQm91bmRzICYgRGVzdHJveWFibGU+KTogVHJhY2tlciB7XG4gICAgcmV0dXJuIHRoaXMucHVzaEJsb2NrVHJhY2tlcihuZXcgQmxvY2tMaXN0VHJhY2tlcih0aGlzLmVsZW1lbnQsIGxpc3QpKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBwdXNoQmxvY2tUcmFja2VyPFQgZXh0ZW5kcyBUcmFja2VyPih0cmFja2VyOiBULCBpc1JlbW90ZSA9IGZhbHNlKTogVCB7XG4gICAgbGV0IGN1cnJlbnQgPSB0aGlzLmJsb2NrU3RhY2suY3VycmVudDtcblxuICAgIGlmIChjdXJyZW50ICE9PSBudWxsKSB7XG4gICAgICBjdXJyZW50Lm5ld0Rlc3Ryb3lhYmxlKHRyYWNrZXIpO1xuXG4gICAgICBpZiAoIWlzUmVtb3RlKSB7XG4gICAgICAgIGN1cnJlbnQuZGlkQXBwZW5kQm91bmRzKHRyYWNrZXIpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuX19vcGVuQmxvY2soKTtcbiAgICB0aGlzLmJsb2NrU3RhY2sucHVzaCh0cmFja2VyKTtcbiAgICByZXR1cm4gdHJhY2tlcjtcbiAgfVxuXG4gIHBvcEJsb2NrKCk6IFRyYWNrZXIge1xuICAgIHRoaXMuYmxvY2soKS5maW5hbGl6ZSh0aGlzKTtcbiAgICB0aGlzLl9fY2xvc2VCbG9jaygpO1xuICAgIHJldHVybiBleHBlY3QodGhpcy5ibG9ja1N0YWNrLnBvcCgpLCBcIkV4cGVjdGVkIHBvcEJsb2NrIHRvIHJldHVybiBhIGJsb2NrXCIpO1xuICB9XG5cbiAgX19vcGVuQmxvY2soKTogdm9pZCB7fVxuICBfX2Nsb3NlQmxvY2soKTogdm9pZCB7fVxuXG4gIC8vIHRvZG8gcmV0dXJuIHNlZW1zIHVudXNlZFxuICBvcGVuRWxlbWVudCh0YWc6IHN0cmluZyk6IFNpbXBsZS5FbGVtZW50IHtcbiAgICBsZXQgZWxlbWVudCA9IHRoaXMuX19vcGVuRWxlbWVudCh0YWcpO1xuICAgIHRoaXMuY29uc3RydWN0aW5nID0gZWxlbWVudDtcblxuICAgIHJldHVybiBlbGVtZW50O1xuICB9XG5cbiAgX19vcGVuRWxlbWVudCh0YWc6IHN0cmluZyk6IFNpbXBsZS5FbGVtZW50IHtcbiAgICByZXR1cm4gdGhpcy5kb20uY3JlYXRlRWxlbWVudCh0YWcsIHRoaXMuZWxlbWVudCk7XG4gIH1cblxuICBmbHVzaEVsZW1lbnQoKSB7XG4gICAgbGV0IHBhcmVudCA9IHRoaXMuZWxlbWVudDtcbiAgICBsZXQgZWxlbWVudCA9IGV4cGVjdCh0aGlzLmNvbnN0cnVjdGluZywgYGZsdXNoRWxlbWVudCBzaG91bGQgb25seSBiZSBjYWxsZWQgd2hlbiBjb25zdHJ1Y3RpbmcgYW4gZWxlbWVudGApO1xuXG4gICAgdGhpcy5fX2ZsdXNoRWxlbWVudChwYXJlbnQsIGVsZW1lbnQpO1xuXG4gICAgdGhpcy5jb25zdHJ1Y3RpbmcgPSBudWxsO1xuICAgIHRoaXMub3BlcmF0aW9ucyA9IG51bGw7XG5cbiAgICB0aGlzLnB1c2hFbGVtZW50KGVsZW1lbnQsIG51bGwpO1xuICAgIHRoaXMuZGlkT3BlbkVsZW1lbnQoZWxlbWVudCk7XG4gIH1cblxuICBfX2ZsdXNoRWxlbWVudChwYXJlbnQ6IFNpbXBsZS5FbGVtZW50LCBjb25zdHJ1Y3Rpbmc6IFNpbXBsZS5FbGVtZW50KSB7XG4gICAgdGhpcy5kb20uaW5zZXJ0QmVmb3JlKHBhcmVudCwgY29uc3RydWN0aW5nLCB0aGlzLm5leHRTaWJsaW5nKTtcbiAgfVxuXG4gIGNsb3NlRWxlbWVudCgpIHtcbiAgICB0aGlzLndpbGxDbG9zZUVsZW1lbnQoKTtcbiAgICB0aGlzLnBvcEVsZW1lbnQoKTtcbiAgfVxuXG4gIHB1c2hSZW1vdGVFbGVtZW50KGVsZW1lbnQ6IFNpbXBsZS5FbGVtZW50LCBndWlkOiBzdHJpbmcsIG5leHRTaWJsaW5nOiBPcHRpb248U2ltcGxlLk5vZGU+ID0gbnVsbCkge1xuICAgIHRoaXMuX19wdXNoUmVtb3RlRWxlbWVudChlbGVtZW50LCBndWlkLCBuZXh0U2libGluZyk7XG4gIH1cblxuICBfX3B1c2hSZW1vdGVFbGVtZW50KGVsZW1lbnQ6IFNpbXBsZS5FbGVtZW50LCBfZ3VpZDogc3RyaW5nLCBuZXh0U2libGluZzogT3B0aW9uPFNpbXBsZS5Ob2RlPikge1xuICAgIHRoaXMucHVzaEVsZW1lbnQoZWxlbWVudCwgbmV4dFNpYmxpbmcpO1xuICAgIGxldCB0cmFja2VyID0gbmV3IFJlbW90ZUJsb2NrVHJhY2tlcihlbGVtZW50KTtcbiAgICB0aGlzLnB1c2hCbG9ja1RyYWNrZXIodHJhY2tlciwgdHJ1ZSk7XG4gIH1cblxuICBwb3BSZW1vdGVFbGVtZW50KCkge1xuICAgIHRoaXMucG9wQmxvY2soKTtcbiAgICB0aGlzLnBvcEVsZW1lbnQoKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBwdXNoRWxlbWVudChlbGVtZW50OiBTaW1wbGUuRWxlbWVudCwgbmV4dFNpYmxpbmc6IE9wdGlvbjxTaW1wbGUuTm9kZT4pIHtcbiAgICB0aGlzLmN1cnNvclN0YWNrLnB1c2gobmV3IEN1cnNvcihlbGVtZW50LCBuZXh0U2libGluZykpO1xuICB9XG5cbiAgZGlkQWRkRGVzdHJveWFibGUoZDogRGVzdHJveWFibGUpIHtcbiAgICB0aGlzLmJsb2NrKCkubmV3RGVzdHJveWFibGUoZCk7XG4gIH1cblxuICBkaWRBcHBlbmRCb3VuZHMoYm91bmRzOiBCb3VuZHMpOiBCb3VuZHMge1xuICAgIHRoaXMuYmxvY2soKS5kaWRBcHBlbmRCb3VuZHMoYm91bmRzKTtcbiAgICByZXR1cm4gYm91bmRzO1xuICB9XG5cbiAgZGlkQXBwZW5kTm9kZTxUIGV4dGVuZHMgU2ltcGxlLk5vZGU+KG5vZGU6IFQpOiBUIHtcbiAgICB0aGlzLmJsb2NrKCkuZGlkQXBwZW5kTm9kZShub2RlKTtcbiAgICByZXR1cm4gbm9kZTtcbiAgfVxuXG4gIGRpZE9wZW5FbGVtZW50KGVsZW1lbnQ6IFNpbXBsZS5FbGVtZW50KTogU2ltcGxlLkVsZW1lbnQge1xuICAgIHRoaXMuYmxvY2soKS5vcGVuRWxlbWVudChlbGVtZW50KTtcbiAgICByZXR1cm4gZWxlbWVudDtcbiAgfVxuXG4gIHdpbGxDbG9zZUVsZW1lbnQoKSB7XG4gICAgdGhpcy5ibG9jaygpLmNsb3NlRWxlbWVudCgpO1xuICB9XG5cbiAgYXBwZW5kVGV4dChzdHJpbmc6IHN0cmluZyk6IFNpbXBsZS5UZXh0IHtcbiAgICByZXR1cm4gdGhpcy5kaWRBcHBlbmROb2RlKHRoaXMuX19hcHBlbmRUZXh0KHN0cmluZykpO1xuICB9XG5cbiAgX19hcHBlbmRUZXh0KHRleHQ6IHN0cmluZyk6IFNpbXBsZS5UZXh0IHtcbiAgICBsZXQgeyBkb20sIGVsZW1lbnQsIG5leHRTaWJsaW5nIH0gPSB0aGlzO1xuICAgIGxldCBub2RlID0gZG9tLmNyZWF0ZVRleHROb2RlKHRleHQpO1xuICAgIGRvbS5pbnNlcnRCZWZvcmUoZWxlbWVudCwgbm9kZSwgbmV4dFNpYmxpbmcpO1xuICAgIHJldHVybiBub2RlO1xuICB9XG5cbiAgX19hcHBlbmROb2RlKG5vZGU6IFNpbXBsZS5Ob2RlKTogU2ltcGxlLk5vZGUge1xuICAgIHRoaXMuZG9tLmluc2VydEJlZm9yZSh0aGlzLmVsZW1lbnQsIG5vZGUsIHRoaXMubmV4dFNpYmxpbmcpO1xuICAgIHJldHVybiBub2RlO1xuICB9XG5cbiAgX19hcHBlbmRGcmFnbWVudChmcmFnbWVudDogU2ltcGxlLkRvY3VtZW50RnJhZ21lbnQpOiBCb3VuZHMge1xuICAgIGxldCBmaXJzdCA9IGZyYWdtZW50LmZpcnN0Q2hpbGQ7XG5cbiAgICBpZiAoZmlyc3QpIHtcbiAgICAgIGxldCByZXQgPSBib3VuZHModGhpcy5lbGVtZW50LCBmaXJzdCwgZnJhZ21lbnQubGFzdENoaWxkISk7XG4gICAgICB0aGlzLmRvbS5pbnNlcnRCZWZvcmUodGhpcy5lbGVtZW50LCBmcmFnbWVudCwgdGhpcy5uZXh0U2libGluZyk7XG4gICAgICByZXR1cm4gcmV0O1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gc2luZ2xlKHRoaXMuZWxlbWVudCwgdGhpcy5fX2FwcGVuZENvbW1lbnQoJycpKTtcbiAgICB9XG4gIH1cblxuICBfX2FwcGVuZEhUTUwoaHRtbDogc3RyaW5nKTogQm91bmRzIHtcbiAgICByZXR1cm4gdGhpcy5kb20uaW5zZXJ0SFRNTEJlZm9yZSh0aGlzLmVsZW1lbnQsIHRoaXMubmV4dFNpYmxpbmcsIGh0bWwpO1xuICB9XG5cbiAgYXBwZW5kVHJ1c3RpbmdEeW5hbWljQ29udGVudCh2YWx1ZTogT3BhcXVlKTogRHluYW1pY0NvbnRlbnRXcmFwcGVyIHtcbiAgICBsZXQgd3JhcHBlciA9IG5ldyBEeW5hbWljQ29udGVudFdyYXBwZXIodGhpcy5fX2FwcGVuZFRydXN0aW5nRHluYW1pY0NvbnRlbnQodmFsdWUpKTtcbiAgICB0aGlzLmRpZEFwcGVuZEJvdW5kcyh3cmFwcGVyKTtcbiAgICByZXR1cm4gd3JhcHBlcjtcbiAgfVxuXG4gIF9fYXBwZW5kVHJ1c3RpbmdEeW5hbWljQ29udGVudCh2YWx1ZTogT3BhcXVlKTogRHluYW1pY0NvbnRlbnQge1xuICAgIGlmIChpc1N0cmluZyh2YWx1ZSkpIHtcbiAgICAgIHJldHVybiB0aGlzLnRydXN0ZWRDb250ZW50KHZhbHVlKTtcbiAgICB9IGVsc2UgaWYgKGlzRW1wdHkodmFsdWUpKSB7XG4gICAgICByZXR1cm4gdGhpcy50cnVzdGVkQ29udGVudCgnJyk7XG4gICAgfSBlbHNlIGlmIChpc1NhZmVTdHJpbmcodmFsdWUpKSB7XG4gICAgICByZXR1cm4gdGhpcy50cnVzdGVkQ29udGVudCh2YWx1ZS50b0hUTUwoKSk7XG4gICAgfSBpZiAoaXNGcmFnbWVudCh2YWx1ZSkpIHtcbiAgICAgIGxldCBib3VuZHMgPSB0aGlzLl9fYXBwZW5kRnJhZ21lbnQodmFsdWUpO1xuICAgICAgcmV0dXJuIG5ldyBEeW5hbWljTm9kZUNvbnRlbnQoYm91bmRzLCB2YWx1ZSwgdHJ1ZSk7XG4gICAgfSBlbHNlIGlmIChpc05vZGUodmFsdWUpKSB7XG4gICAgICBsZXQgbm9kZSA9IHRoaXMuX19hcHBlbmROb2RlKHZhbHVlKTtcbiAgICAgIHJldHVybiBuZXcgRHluYW1pY05vZGVDb250ZW50KHNpbmdsZSh0aGlzLmVsZW1lbnQsIG5vZGUpLCBub2RlLCB0cnVlKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy50cnVzdGVkQ29udGVudChTdHJpbmcodmFsdWUpKTtcbiAgfVxuXG4gIGFwcGVuZENhdXRpb3VzRHluYW1pY0NvbnRlbnQodmFsdWU6IE9wYXF1ZSk6IER5bmFtaWNDb250ZW50V3JhcHBlciB7XG4gICAgbGV0IHdyYXBwZXIgPSBuZXcgRHluYW1pY0NvbnRlbnRXcmFwcGVyKHRoaXMuX19hcHBlbmRDYXV0aW91c0R5bmFtaWNDb250ZW50KHZhbHVlKSk7XG4gICAgdGhpcy5kaWRBcHBlbmRCb3VuZHMod3JhcHBlci5ib3VuZHMpO1xuICAgIHJldHVybiB3cmFwcGVyO1xuICB9XG5cbiAgX19hcHBlbmRDYXV0aW91c0R5bmFtaWNDb250ZW50KHZhbHVlOiBPcGFxdWUpOiBEeW5hbWljQ29udGVudCB7XG4gICAgaWYgKGlzU3RyaW5nKHZhbHVlKSkge1xuICAgICAgcmV0dXJuIHRoaXMudW50cnVzdGVkQ29udGVudCh2YWx1ZSk7XG4gICAgfSBlbHNlIGlmIChpc0VtcHR5KHZhbHVlKSkge1xuICAgICAgcmV0dXJuIHRoaXMudW50cnVzdGVkQ29udGVudCgnJyk7XG4gICAgfSBlbHNlIGlmIChpc0ZyYWdtZW50KHZhbHVlKSkge1xuICAgICAgbGV0IGJvdW5kcyA9IHRoaXMuX19hcHBlbmRGcmFnbWVudCh2YWx1ZSk7XG4gICAgICByZXR1cm4gbmV3IER5bmFtaWNOb2RlQ29udGVudChib3VuZHMsIHZhbHVlLCBmYWxzZSk7XG4gICAgfSBlbHNlIGlmIChpc05vZGUodmFsdWUpKSB7XG4gICAgICBsZXQgbm9kZSA9IHRoaXMuX19hcHBlbmROb2RlKHZhbHVlKTtcbiAgICAgIHJldHVybiBuZXcgRHluYW1pY05vZGVDb250ZW50KHNpbmdsZSh0aGlzLmVsZW1lbnQsIG5vZGUpLCBub2RlLCBmYWxzZSk7XG4gICAgfSBlbHNlIGlmIChpc1NhZmVTdHJpbmcodmFsdWUpKSB7XG4gICAgICBsZXQgbm9ybWFsaXplZCA9IHZhbHVlLnRvSFRNTCgpO1xuICAgICAgbGV0IGJvdW5kcyA9IHRoaXMuX19hcHBlbmRIVE1MKG5vcm1hbGl6ZWQpO1xuICAgICAgLy8gbGV0IGJvdW5kcyA9IHRoaXMuZG9tLmluc2VydEhUTUxCZWZvcmUodGhpcy5lbGVtZW50LCB0aGlzLm5leHRTaWJsaW5nLCBub3JtYWxpemVkKTtcbiAgICAgIHJldHVybiBuZXcgRHluYW1pY0hUTUxDb250ZW50KGJvdW5kcywgdmFsdWUsIGZhbHNlKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy51bnRydXN0ZWRDb250ZW50KFN0cmluZyh2YWx1ZSkpO1xuICB9XG5cbiAgcHJpdmF0ZSB0cnVzdGVkQ29udGVudCh2YWx1ZTogc3RyaW5nKSB7XG4gICAgbGV0IGJvdW5kcyA9IHRoaXMuX19hcHBlbmRIVE1MKHZhbHVlKTtcbiAgICByZXR1cm4gbmV3IER5bmFtaWNUcnVzdGVkSFRNTENvbnRlbnQoYm91bmRzLCB2YWx1ZSwgdHJ1ZSk7XG4gIH1cblxuICBwcml2YXRlIHVudHJ1c3RlZENvbnRlbnQodmFsdWU6IHN0cmluZykge1xuICAgIGxldCB0ZXh0Tm9kZSA9IHRoaXMuX19hcHBlbmRUZXh0KHZhbHVlKTtcbiAgICBsZXQgYm91bmRzID0gc2luZ2xlKHRoaXMuZWxlbWVudCwgdGV4dE5vZGUpO1xuICAgIHJldHVybiBuZXcgRHluYW1pY1RleHRDb250ZW50KGJvdW5kcywgdmFsdWUsIGZhbHNlKTtcbiAgfVxuXG4gIGFwcGVuZENvbW1lbnQoc3RyaW5nOiBzdHJpbmcpOiBTaW1wbGUuQ29tbWVudCB7XG4gICAgcmV0dXJuIHRoaXMuZGlkQXBwZW5kTm9kZSh0aGlzLl9fYXBwZW5kQ29tbWVudChzdHJpbmcpKTtcbiAgfVxuXG4gIF9fYXBwZW5kQ29tbWVudChzdHJpbmc6IHN0cmluZyk6IFNpbXBsZS5Db21tZW50IHtcbiAgICBsZXQgeyBkb20sIGVsZW1lbnQsIG5leHRTaWJsaW5nIH0gPSB0aGlzO1xuICAgIGxldCBub2RlID0gZG9tLmNyZWF0ZUNvbW1lbnQoc3RyaW5nKTtcbiAgICBkb20uaW5zZXJ0QmVmb3JlKGVsZW1lbnQsIG5vZGUsIG5leHRTaWJsaW5nKTtcbiAgICByZXR1cm4gbm9kZTtcbiAgfVxuXG4gIF9fc2V0QXR0cmlidXRlKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgbmFtZXNwYWNlOiBPcHRpb248c3RyaW5nPik6IHZvaWQge1xuICAgIHRoaXMuZG9tLnNldEF0dHJpYnV0ZSh0aGlzLmNvbnN0cnVjdGluZyEsIG5hbWUsIHZhbHVlLCBuYW1lc3BhY2UpO1xuICB9XG5cbiAgX19zZXRQcm9wZXJ0eShuYW1lOiBzdHJpbmcsIHZhbHVlOiBPcGFxdWUpOiB2b2lkIHtcbiAgICB0aGlzLmNvbnN0cnVjdGluZyFbbmFtZV0gPSB2YWx1ZTtcbiAgfVxuXG4gIHNldFN0YXRpY0F0dHJpYnV0ZShuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIG5hbWVzcGFjZTogT3B0aW9uPHN0cmluZz4pOiB2b2lkIHtcbiAgICB0aGlzLl9fc2V0QXR0cmlidXRlKG5hbWUsIHZhbHVlLCBuYW1lc3BhY2UpO1xuICB9XG5cbiAgc2V0RHluYW1pY0F0dHJpYnV0ZShuYW1lOiBzdHJpbmcsIHZhbHVlOiBPcGFxdWUsIHRydXN0aW5nOiBib29sZWFuLCBuYW1lc3BhY2U6IE9wdGlvbjxzdHJpbmc+KTogRHluYW1pY0F0dHJpYnV0ZSB7XG4gICAgbGV0IGVsZW1lbnQgPSB0aGlzLmNvbnN0cnVjdGluZyE7XG4gICAgbGV0IER5bmFtaWNBdHRyaWJ1dGUgPSB0aGlzLmVudi5hdHRyaWJ1dGVGb3IoZWxlbWVudCwgbmFtZSwgdHJ1c3RpbmcsIG5hbWVzcGFjZSk7XG4gICAgbGV0IGF0dHJpYnV0ZSA9IG5ldyBEeW5hbWljQXR0cmlidXRlKHsgZWxlbWVudCwgbmFtZSwgbmFtZXNwYWNlOiBuYW1lc3BhY2UgfHwgbnVsbCB9KTtcblxuICAgIGF0dHJpYnV0ZS5zZXQodGhpcywgdmFsdWUsIHRoaXMuZW52KTtcblxuICAgIHJldHVybiBhdHRyaWJ1dGU7XG4gIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBUcmFja2VyIGV4dGVuZHMgRGVzdHJveWFibGVCb3VuZHMge1xuICBvcGVuRWxlbWVudChlbGVtZW50OiBTaW1wbGUuRWxlbWVudCk6IHZvaWQ7XG4gIGNsb3NlRWxlbWVudCgpOiB2b2lkO1xuICBkaWRBcHBlbmROb2RlKG5vZGU6IFNpbXBsZS5Ob2RlKTogdm9pZDtcbiAgZGlkQXBwZW5kQm91bmRzKGJvdW5kczogQm91bmRzKTogdm9pZDtcbiAgbmV3RGVzdHJveWFibGUoZDogRGVzdHJveWFibGUpOiB2b2lkO1xuICBmaW5hbGl6ZShzdGFjazogRWxlbWVudEJ1aWxkZXIpOiB2b2lkO1xufVxuXG5leHBvcnQgY2xhc3MgU2ltcGxlQmxvY2tUcmFja2VyIGltcGxlbWVudHMgVHJhY2tlciB7XG4gIHByb3RlY3RlZCBmaXJzdDogT3B0aW9uPEZpcnN0Tm9kZT4gPSBudWxsO1xuICBwcm90ZWN0ZWQgbGFzdDogT3B0aW9uPExhc3ROb2RlPiA9IG51bGw7XG4gIHByb3RlY3RlZCBkZXN0cm95YWJsZXM6IE9wdGlvbjxEZXN0cm95YWJsZVtdPiA9IG51bGw7XG4gIHByb3RlY3RlZCBuZXN0aW5nID0gMDtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHBhcmVudDogU2ltcGxlLkVsZW1lbnQpe31cblxuICBkZXN0cm95KCkge1xuICAgIGxldCB7IGRlc3Ryb3lhYmxlcyB9ID0gdGhpcztcblxuICAgIGlmIChkZXN0cm95YWJsZXMgJiYgZGVzdHJveWFibGVzLmxlbmd0aCkge1xuICAgICAgZm9yIChsZXQgaT0wOyBpPGRlc3Ryb3lhYmxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBkZXN0cm95YWJsZXNbaV0uZGVzdHJveSgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHBhcmVudEVsZW1lbnQoKSB7XG4gICAgcmV0dXJuIHRoaXMucGFyZW50O1xuICB9XG5cbiAgZmlyc3ROb2RlKCk6IE9wdGlvbjxTaW1wbGUuTm9kZT4ge1xuICAgIHJldHVybiB0aGlzLmZpcnN0ICYmIHRoaXMuZmlyc3QuZmlyc3ROb2RlKCk7XG4gIH1cblxuICBsYXN0Tm9kZSgpOiBPcHRpb248U2ltcGxlLk5vZGU+IHtcbiAgICByZXR1cm4gdGhpcy5sYXN0ICYmIHRoaXMubGFzdC5sYXN0Tm9kZSgpO1xuICB9XG5cbiAgb3BlbkVsZW1lbnQoZWxlbWVudDogRWxlbWVudCkge1xuICAgIHRoaXMuZGlkQXBwZW5kTm9kZShlbGVtZW50KTtcbiAgICB0aGlzLm5lc3RpbmcrKztcbiAgfVxuXG4gIGNsb3NlRWxlbWVudCgpIHtcbiAgICB0aGlzLm5lc3RpbmctLTtcbiAgfVxuXG4gIGRpZEFwcGVuZE5vZGUobm9kZTogTm9kZSkge1xuICAgIGlmICh0aGlzLm5lc3RpbmcgIT09IDApIHJldHVybjtcblxuICAgIGlmICghdGhpcy5maXJzdCkge1xuICAgICAgdGhpcy5maXJzdCA9IG5ldyBGaXJzdChub2RlKTtcbiAgICB9XG5cbiAgICB0aGlzLmxhc3QgPSBuZXcgTGFzdChub2RlKTtcbiAgfVxuXG4gIGRpZEFwcGVuZEJvdW5kcyhib3VuZHM6IEJvdW5kcykge1xuICAgIGlmICh0aGlzLm5lc3RpbmcgIT09IDApIHJldHVybjtcblxuICAgIGlmICghdGhpcy5maXJzdCkge1xuICAgICAgdGhpcy5maXJzdCA9IGJvdW5kcztcbiAgICB9XG5cbiAgICB0aGlzLmxhc3QgPSBib3VuZHM7XG4gIH1cblxuICBuZXdEZXN0cm95YWJsZShkOiBEZXN0cm95YWJsZSkge1xuICAgIHRoaXMuZGVzdHJveWFibGVzID0gdGhpcy5kZXN0cm95YWJsZXMgfHwgW107XG4gICAgdGhpcy5kZXN0cm95YWJsZXMucHVzaChkKTtcbiAgfVxuXG4gIGZpbmFsaXplKHN0YWNrOiBFbGVtZW50QnVpbGRlcikge1xuICAgIGlmICghdGhpcy5maXJzdCkge1xuICAgICAgc3RhY2suYXBwZW5kQ29tbWVudCgnJyk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBSZW1vdGVCbG9ja1RyYWNrZXIgZXh0ZW5kcyBTaW1wbGVCbG9ja1RyYWNrZXIge1xuICBkZXN0cm95KCkge1xuICAgIHN1cGVyLmRlc3Ryb3koKTtcblxuICAgIGNsZWFyKHRoaXMpO1xuICB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVXBkYXRhYmxlVHJhY2tlciBleHRlbmRzIFRyYWNrZXIge1xuICByZXNldChlbnY6IEVudmlyb25tZW50KTogT3B0aW9uPFNpbXBsZS5Ob2RlPjtcbn1cblxuZXhwb3J0IGNsYXNzIFVwZGF0YWJsZUJsb2NrVHJhY2tlciBleHRlbmRzIFNpbXBsZUJsb2NrVHJhY2tlciBpbXBsZW1lbnRzIFVwZGF0YWJsZVRyYWNrZXIge1xuICByZXNldChlbnY6IEVudmlyb25tZW50KTogT3B0aW9uPFNpbXBsZS5Ob2RlPiB7XG4gICAgbGV0IHsgZGVzdHJveWFibGVzIH0gPSB0aGlzO1xuXG4gICAgaWYgKGRlc3Ryb3lhYmxlcyAmJiBkZXN0cm95YWJsZXMubGVuZ3RoKSB7XG4gICAgICBmb3IgKGxldCBpPTA7IGk8ZGVzdHJveWFibGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGVudi5kaWREZXN0cm95KGRlc3Ryb3lhYmxlc1tpXSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgbGV0IG5leHRTaWJsaW5nID0gY2xlYXIodGhpcyk7XG5cbiAgICB0aGlzLmZpcnN0ID0gbnVsbDtcbiAgICB0aGlzLmxhc3QgPSBudWxsO1xuICAgIHRoaXMuZGVzdHJveWFibGVzID0gbnVsbDtcbiAgICB0aGlzLm5lc3RpbmcgPSAwO1xuXG4gICAgcmV0dXJuIG5leHRTaWJsaW5nO1xuICB9XG59XG5cbmNsYXNzIEJsb2NrTGlzdFRyYWNrZXIgaW1wbGVtZW50cyBUcmFja2VyIHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSBwYXJlbnQ6IFNpbXBsZS5FbGVtZW50LCBwcml2YXRlIGJvdW5kTGlzdDogTGlua2VkTGlzdDxMaW5rZWRMaXN0Tm9kZSAmIEJvdW5kcyAmIERlc3Ryb3lhYmxlPikge1xuICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICAgIHRoaXMuYm91bmRMaXN0ID0gYm91bmRMaXN0O1xuICB9XG5cbiAgZGVzdHJveSgpIHtcbiAgICB0aGlzLmJvdW5kTGlzdC5mb3JFYWNoTm9kZShub2RlID0+IG5vZGUuZGVzdHJveSgpKTtcbiAgfVxuXG4gIHBhcmVudEVsZW1lbnQoKSB7XG4gICAgcmV0dXJuIHRoaXMucGFyZW50O1xuICB9XG5cbiAgZmlyc3ROb2RlKCk6IE9wdGlvbjxTaW1wbGUuTm9kZT4ge1xuICAgIGxldCBoZWFkID0gdGhpcy5ib3VuZExpc3QuaGVhZCgpO1xuICAgIHJldHVybiBoZWFkICYmIGhlYWQuZmlyc3ROb2RlKCk7XG4gIH1cblxuICBsYXN0Tm9kZSgpOiBPcHRpb248U2ltcGxlLk5vZGU+IHtcbiAgICBsZXQgdGFpbCA9IHRoaXMuYm91bmRMaXN0LnRhaWwoKTtcbiAgICByZXR1cm4gdGFpbCAmJiB0YWlsLmxhc3ROb2RlKCk7XG4gIH1cblxuICBvcGVuRWxlbWVudChfZWxlbWVudDogRWxlbWVudCkge1xuICAgIGFzc2VydChmYWxzZSwgJ0Nhbm5vdCBvcGVuRWxlbWVudCBkaXJlY3RseSBpbnNpZGUgYSBibG9jayBsaXN0Jyk7XG4gIH1cblxuICBjbG9zZUVsZW1lbnQoKSB7XG4gICAgYXNzZXJ0KGZhbHNlLCAnQ2Fubm90IGNsb3NlRWxlbWVudCBkaXJlY3RseSBpbnNpZGUgYSBibG9jayBsaXN0Jyk7XG4gIH1cblxuICBkaWRBcHBlbmROb2RlKF9ub2RlOiBOb2RlKSB7XG4gICAgYXNzZXJ0KGZhbHNlLCAnQ2Fubm90IGNyZWF0ZSBhIG5ldyBub2RlIGRpcmVjdGx5IGluc2lkZSBhIGJsb2NrIGxpc3QnKTtcbiAgfVxuXG4gIGRpZEFwcGVuZEJvdW5kcyhfYm91bmRzOiBCb3VuZHMpIHtcbiAgfVxuXG4gIG5ld0Rlc3Ryb3lhYmxlKF9kOiBEZXN0cm95YWJsZSkge1xuICB9XG5cbiAgZmluYWxpemUoX3N0YWNrOiBFbGVtZW50QnVpbGRlcikge1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjbGllbnRCdWlsZGVyKGVudjogRW52aXJvbm1lbnQsIGN1cnNvcjogQ3Vyc29yKTogRWxlbWVudEJ1aWxkZXIge1xuICByZXR1cm4gTmV3RWxlbWVudEJ1aWxkZXIuZm9ySW5pdGlhbFJlbmRlcihlbnYsIGN1cnNvcik7XG59XG4iXX0=","import { clear, move as moveBounds } from '../bounds';\nimport { NewElementBuilder } from './element-builder';\nimport { Stack, LinkedList, dict } from '@glimmer/util';\nimport { IteratorSynchronizer,\n// Tags\ncombine, UpdatableTag, combineSlice, CONSTANT_TAG, INITIAL } from '@glimmer/reference';\nimport { UpdatingOpcode } from '../opcodes';\nimport VM, { EvaluationStack } from './append';\nexport default class UpdatingVM {\n    constructor(env, program, { alwaysRevalidate = false }) {\n        this.frameStack = new Stack();\n        this.env = env;\n        this.constants = program.constants;\n        this.dom = env.getDOM();\n        this.alwaysRevalidate = alwaysRevalidate;\n    }\n    execute(opcodes, handler) {\n        let { frameStack } = this;\n        this.try(opcodes, handler);\n        while (true) {\n            if (frameStack.isEmpty()) break;\n            let opcode = this.frame.nextStatement();\n            if (opcode === null) {\n                this.frameStack.pop();\n                continue;\n            }\n            opcode.evaluate(this);\n        }\n    }\n    get frame() {\n        return this.frameStack.current;\n    }\n    goto(op) {\n        this.frame.goto(op);\n    }\n    try(ops, handler) {\n        this.frameStack.push(new UpdatingVMFrame(this, ops, handler));\n    }\n    throw() {\n        this.frame.handleException();\n        this.frameStack.pop();\n    }\n}\nexport class BlockOpcode extends UpdatingOpcode {\n    constructor(start, state, bounds, children) {\n        super();\n        this.start = start;\n        this.state = state;\n        this.type = \"block\";\n        this.next = null;\n        this.prev = null;\n        this.children = children;\n        this.bounds = bounds;\n    }\n    parentElement() {\n        return this.bounds.parentElement();\n    }\n    firstNode() {\n        return this.bounds.firstNode();\n    }\n    lastNode() {\n        return this.bounds.lastNode();\n    }\n    evaluate(vm) {\n        vm.try(this.children, null);\n    }\n    destroy() {\n        this.bounds.destroy();\n    }\n    didDestroy() {\n        this.state.env.didDestroy(this.bounds);\n    }\n}\nexport class TryOpcode extends BlockOpcode {\n    constructor(start, state, bounds, children) {\n        super(start, state, bounds, children);\n        this.type = \"try\";\n        this.tag = this._tag = UpdatableTag.create(CONSTANT_TAG);\n    }\n    didInitializeChildren() {\n        this._tag.inner.update(combineSlice(this.children));\n    }\n    evaluate(vm) {\n        vm.try(this.children, this);\n    }\n    handleException() {\n        let { state, bounds, children, start, prev, next } = this;\n        children.clear();\n        let elementStack = NewElementBuilder.resume(state.env, bounds, bounds.reset(state.env));\n        let vm = VM.resume(state, elementStack);\n        let updating = new LinkedList();\n        vm.execute(start, vm => {\n            vm.stack = EvaluationStack.restore(state.stack);\n            vm.updatingOpcodeStack.push(updating);\n            vm.updateWith(this);\n            vm.updatingOpcodeStack.push(children);\n        });\n        this.prev = prev;\n        this.next = next;\n    }\n}\nclass ListRevalidationDelegate {\n    constructor(opcode, marker) {\n        this.opcode = opcode;\n        this.marker = marker;\n        this.didInsert = false;\n        this.didDelete = false;\n        this.map = opcode.map;\n        this.updating = opcode['children'];\n    }\n    insert(key, item, memo, before) {\n        let { map, opcode, updating } = this;\n        let nextSibling = null;\n        let reference = null;\n        if (before) {\n            reference = map[before];\n            nextSibling = reference['bounds'].firstNode();\n        } else {\n            nextSibling = this.marker;\n        }\n        let vm = opcode.vmForInsertion(nextSibling);\n        let tryOpcode = null;\n        let { start } = opcode;\n        vm.execute(start, vm => {\n            map[key] = tryOpcode = vm.iterate(memo, item);\n            vm.updatingOpcodeStack.push(new LinkedList());\n            vm.updateWith(tryOpcode);\n            vm.updatingOpcodeStack.push(tryOpcode.children);\n        });\n        updating.insertBefore(tryOpcode, reference);\n        this.didInsert = true;\n    }\n    retain(_key, _item, _memo) {}\n    move(key, _item, _memo, before) {\n        let { map, updating } = this;\n        let entry = map[key];\n        let reference = map[before] || null;\n        if (before) {\n            moveBounds(entry, reference.firstNode());\n        } else {\n            moveBounds(entry, this.marker);\n        }\n        updating.remove(entry);\n        updating.insertBefore(entry, reference);\n    }\n    delete(key) {\n        let { map } = this;\n        let opcode = map[key];\n        opcode.didDestroy();\n        clear(opcode);\n        this.updating.remove(opcode);\n        delete map[key];\n        this.didDelete = true;\n    }\n    done() {\n        this.opcode.didInitializeChildren(this.didInsert || this.didDelete);\n    }\n}\nexport class ListBlockOpcode extends BlockOpcode {\n    constructor(start, state, bounds, children, artifacts) {\n        super(start, state, bounds, children);\n        this.type = \"list-block\";\n        this.map = dict();\n        this.lastIterated = INITIAL;\n        this.artifacts = artifacts;\n        let _tag = this._tag = UpdatableTag.create(CONSTANT_TAG);\n        this.tag = combine([artifacts.tag, _tag]);\n    }\n    didInitializeChildren(listDidChange = true) {\n        this.lastIterated = this.artifacts.tag.value();\n        if (listDidChange) {\n            this._tag.inner.update(combineSlice(this.children));\n        }\n    }\n    evaluate(vm) {\n        let { artifacts, lastIterated } = this;\n        if (!artifacts.tag.validate(lastIterated)) {\n            let { bounds } = this;\n            let { dom } = vm;\n            let marker = dom.createComment('');\n            dom.insertAfter(bounds.parentElement(), marker, bounds.lastNode());\n            let target = new ListRevalidationDelegate(this, marker);\n            let synchronizer = new IteratorSynchronizer({ target, artifacts });\n            synchronizer.sync();\n            this.parentElement().removeChild(marker);\n        }\n        // Run now-updated updating opcodes\n        super.evaluate(vm);\n    }\n    vmForInsertion(nextSibling) {\n        let { bounds, state } = this;\n        let elementStack = NewElementBuilder.forInitialRender(state.env, { element: bounds.parentElement(), nextSibling });\n        return VM.resume(state, elementStack);\n    }\n}\nclass UpdatingVMFrame {\n    constructor(vm, ops, exceptionHandler) {\n        this.vm = vm;\n        this.ops = ops;\n        this.exceptionHandler = exceptionHandler;\n        this.vm = vm;\n        this.ops = ops;\n        this.current = ops.head();\n    }\n    goto(op) {\n        this.current = op;\n    }\n    nextStatement() {\n        let { current, ops } = this;\n        if (current) this.current = ops.nextNode(current);\n        return current;\n    }\n    handleException() {\n        if (this.exceptionHandler) {\n            this.exceptionHandler.handleException();\n        }\n    }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXBkYXRlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcGFja2FnZXMvQGdsaW1tZXIvcnVudGltZS9saWIvdm0vdXBkYXRlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLEFBQU8sU0FBcUIsQUFBSyxPQUFFLEFBQUksUUFBSSxBQUFVLEFBQUUsa0JBQU0sQUFBVyxBQUFDO0FBQ3pFLEFBQU8sU0FBRSxBQUFpQixBQUE2Qix5QkFBTSxBQUFtQixBQUFDO0FBQ2pGLEFBQU8sU0FBa0IsQUFBSyxPQUFFLEFBQVUsWUFBUSxBQUFJLEFBQUUsQUFBTSxBQUFFLFlBQU0sQUFBZSxBQUFDO0FBQ3RGLEFBQU8sU0FHTCxBQUFvQjtBQUdwQixBQUFPO0FBQ1AsQUFBTyxTQUVQLEFBQVksY0FFWixBQUFZLGNBQ1osQUFBWSxjQUNaLEFBQU8sQUFFUixlQUFNLEFBQW9CLEFBQUM7QUFDNUIsQUFBTyxTQUFFLEFBQWMsQUFBaUIsc0JBQU0sQUFBWSxBQUFDO0FBSTNELE9BQU8sQUFBRSxBQUFFLE1BQWlCLEFBQWUsQUFBRSx1QkFBTSxBQUFVLEFBQUM7QUFHOUQsQUFBTSxBQUFDLEFBQU87QUFRWixnQkFBWSxBQUFnQixLQUFFLEFBQTJCLFNBQUUsRUFBRSxBQUFnQixtQkFBRyxBQUFLLEFBQUU7QUFGL0UsYUFBVSxhQUEyQixJQUFJLEFBQUssQUFBbUIsQUFBQztBQUd4RSxBQUFJLGFBQUMsQUFBRyxNQUFHLEFBQUcsQUFBQztBQUNmLEFBQUksYUFBQyxBQUFTLFlBQUcsQUFBTyxRQUFDLEFBQVMsQUFBQztBQUNuQyxBQUFJLGFBQUMsQUFBRyxNQUFHLEFBQUcsSUFBQyxBQUFNLEFBQUUsQUFBQztBQUN4QixBQUFJLGFBQUMsQUFBZ0IsbUJBQUcsQUFBZ0IsQUFBQyxBQUMzQztBQUFDO0FBRUQsQUFBTyxZQUFDLEFBQXNCLFNBQUUsQUFBeUI7QUFDdkQsWUFBSSxFQUFFLEFBQVUsQUFBRSxlQUFHLEFBQUksQUFBQztBQUUx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QUFBQyxBQUMxQztBQUFDLEFBQ0g7QUFBQyxBQUNGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU2NvcGUsIER5bmFtaWNTY29wZSwgRW52aXJvbm1lbnQgfSBmcm9tICcuLi9lbnZpcm9ubWVudCc7XG5pbXBvcnQgeyBEZXN0cm95YWJsZUJvdW5kcywgY2xlYXIsIG1vdmUgYXMgbW92ZUJvdW5kcyB9IGZyb20gJy4uL2JvdW5kcyc7XG5pbXBvcnQgeyBOZXdFbGVtZW50QnVpbGRlciwgVHJhY2tlciwgVXBkYXRhYmxlVHJhY2tlciB9IGZyb20gJy4vZWxlbWVudC1idWlsZGVyJztcbmltcG9ydCB7IE9wdGlvbiwgT3BhcXVlLCBTdGFjaywgTGlua2VkTGlzdCwgRGljdCwgZGljdCwgZXhwZWN0IH0gZnJvbSAnQGdsaW1tZXIvdXRpbCc7XG5pbXBvcnQge1xuICBQYXRoUmVmZXJlbmNlLFxuICBJdGVyYXRpb25BcnRpZmFjdHMsXG4gIEl0ZXJhdG9yU3luY2hyb25pemVyLFxuICBJdGVyYXRvclN5bmNocm9uaXplckRlbGVnYXRlLFxuXG4gIC8vIFRhZ3NcbiAgY29tYmluZSxcbiAgUmV2aXNpb24sXG4gIFVwZGF0YWJsZVRhZyxcbiAgVGFnV3JhcHBlcixcbiAgY29tYmluZVNsaWNlLFxuICBDT05TVEFOVF9UQUcsXG4gIElOSVRJQUwsXG4gIFRhZ1xufSBmcm9tICdAZ2xpbW1lci9yZWZlcmVuY2UnO1xuaW1wb3J0IHsgVXBkYXRpbmdPcGNvZGUsIFVwZGF0aW5nT3BTZXEgfSBmcm9tICcuLi9vcGNvZGVzJztcbmltcG9ydCB7IERPTUNoYW5nZXMgfSBmcm9tICcuLi9kb20vaGVscGVyJztcbmltcG9ydCB7IFNpbXBsZSwgVk1IYW5kbGUgfSBmcm9tICdAZ2xpbW1lci9pbnRlcmZhY2VzJztcblxuaW1wb3J0IFZNLCB7IENhcHR1cmVkU3RhY2ssIEV2YWx1YXRpb25TdGFjayB9IGZyb20gJy4vYXBwZW5kJztcbmltcG9ydCB7IFJ1bnRpbWVDb25zdGFudHMgYXMgQ29uc3RhbnRzLCBSdW50aW1lUHJvZ3JhbSBhcyBQcm9ncmFtIH0gZnJvbSBcIkBnbGltbWVyL3Byb2dyYW1cIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXBkYXRpbmdWTTxTcGVjaWZpZXIgPSBPcGFxdWU+IHtcbiAgcHVibGljIGVudjogRW52aXJvbm1lbnQ7XG4gIHB1YmxpYyBkb206IERPTUNoYW5nZXM7XG4gIHB1YmxpYyBhbHdheXNSZXZhbGlkYXRlOiBib29sZWFuO1xuICBwdWJsaWMgY29uc3RhbnRzOiBDb25zdGFudHM8U3BlY2lmaWVyPjtcblxuICBwcml2YXRlIGZyYW1lU3RhY2s6IFN0YWNrPFVwZGF0aW5nVk1GcmFtZT4gPSBuZXcgU3RhY2s8VXBkYXRpbmdWTUZyYW1lPigpO1xuXG4gIGNvbnN0cnVjdG9yKGVudjogRW52aXJvbm1lbnQsIHByb2dyYW06IFByb2dyYW08U3BlY2lmaWVyPiwgeyBhbHdheXNSZXZhbGlkYXRlID0gZmFsc2UgfSkge1xuICAgIHRoaXMuZW52ID0gZW52O1xuICAgIHRoaXMuY29uc3RhbnRzID0gcHJvZ3JhbS5jb25zdGFudHM7XG4gICAgdGhpcy5kb20gPSBlbnYuZ2V0RE9NKCk7XG4gICAgdGhpcy5hbHdheXNSZXZhbGlkYXRlID0gYWx3YXlzUmV2YWxpZGF0ZTtcbiAgfVxuXG4gIGV4ZWN1dGUob3Bjb2RlczogVXBkYXRpbmdPcFNlcSwgaGFuZGxlcjogRXhjZXB0aW9uSGFuZGxlcikge1xuICAgIGxldCB7IGZyYW1lU3RhY2sgfSA9IHRoaXM7XG5cbiAgICB0aGlzLnRyeShvcGNvZGVzLCBoYW5kbGVyKTtcblxuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICBpZiAoZnJhbWVTdGFjay5pc0VtcHR5KCkpIGJyZWFrO1xuXG4gICAgICBsZXQgb3Bjb2RlID0gdGhpcy5mcmFtZS5uZXh0U3RhdGVtZW50KCk7XG5cbiAgICAgIGlmIChvcGNvZGUgPT09IG51bGwpIHtcbiAgICAgICAgdGhpcy5mcmFtZVN0YWNrLnBvcCgpO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgb3Bjb2RlLmV2YWx1YXRlKHRoaXMpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0IGZyYW1lKCkge1xuICAgIHJldHVybiBleHBlY3QodGhpcy5mcmFtZVN0YWNrLmN1cnJlbnQsICdidWc6IGV4cGVjdGVkIGEgZnJhbWUnKTtcbiAgfVxuXG4gIGdvdG8ob3A6IFVwZGF0aW5nT3Bjb2RlKSB7XG4gICAgdGhpcy5mcmFtZS5nb3RvKG9wKTtcbiAgfVxuXG4gIHRyeShvcHM6IFVwZGF0aW5nT3BTZXEsIGhhbmRsZXI6IE9wdGlvbjxFeGNlcHRpb25IYW5kbGVyPikge1xuICAgIHRoaXMuZnJhbWVTdGFjay5wdXNoKG5ldyBVcGRhdGluZ1ZNRnJhbWUodGhpcywgb3BzLCBoYW5kbGVyKSk7XG4gIH1cblxuICB0aHJvdygpIHtcbiAgICB0aGlzLmZyYW1lLmhhbmRsZUV4Y2VwdGlvbigpO1xuICAgIHRoaXMuZnJhbWVTdGFjay5wb3AoKTtcbiAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEV4Y2VwdGlvbkhhbmRsZXIge1xuICBoYW5kbGVFeGNlcHRpb24oKTogdm9pZDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBWTVN0YXRlIHtcbiAgZW52OiBFbnZpcm9ubWVudDtcbiAgcHJvZ3JhbTogUHJvZ3JhbTxPcGFxdWU+O1xuICBzY29wZTogU2NvcGU7XG4gIGR5bmFtaWNTY29wZTogRHluYW1pY1Njb3BlO1xuICBzdGFjazogQ2FwdHVyZWRTdGFjaztcbn1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEJsb2NrT3Bjb2RlIGV4dGVuZHMgVXBkYXRpbmdPcGNvZGUgaW1wbGVtZW50cyBEZXN0cm95YWJsZUJvdW5kcyB7XG4gIHB1YmxpYyB0eXBlID0gXCJibG9ja1wiO1xuICBwdWJsaWMgbmV4dCA9IG51bGw7XG4gIHB1YmxpYyBwcmV2ID0gbnVsbDtcbiAgcHVibGljIGNoaWxkcmVuOiBMaW5rZWRMaXN0PFVwZGF0aW5nT3Bjb2RlPjtcblxuICBwcm90ZWN0ZWQgYm91bmRzOiBEZXN0cm95YWJsZUJvdW5kcztcblxuICBjb25zdHJ1Y3RvcihwdWJsaWMgc3RhcnQ6IFZNSGFuZGxlLCBwcm90ZWN0ZWQgc3RhdGU6IFZNU3RhdGUsIGJvdW5kczogRGVzdHJveWFibGVCb3VuZHMsIGNoaWxkcmVuOiBMaW5rZWRMaXN0PFVwZGF0aW5nT3Bjb2RlPikge1xuICAgIHN1cGVyKCk7XG5cbiAgICB0aGlzLmNoaWxkcmVuID0gY2hpbGRyZW47XG4gICAgdGhpcy5ib3VuZHMgPSBib3VuZHM7XG4gIH1cblxuICBhYnN0cmFjdCBkaWRJbml0aWFsaXplQ2hpbGRyZW4oKTogdm9pZDtcblxuICBwYXJlbnRFbGVtZW50KCkge1xuICAgIHJldHVybiB0aGlzLmJvdW5kcy5wYXJlbnRFbGVtZW50KCk7XG4gIH1cblxuICBmaXJzdE5vZGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuYm91bmRzLmZpcnN0Tm9kZSgpO1xuICB9XG5cbiAgbGFzdE5vZGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuYm91bmRzLmxhc3ROb2RlKCk7XG4gIH1cblxuICBldmFsdWF0ZSh2bTogVXBkYXRpbmdWTTxPcGFxdWU+KSB7XG4gICAgdm0udHJ5KHRoaXMuY2hpbGRyZW4sIG51bGwpO1xuICB9XG5cbiAgZGVzdHJveSgpIHtcbiAgICB0aGlzLmJvdW5kcy5kZXN0cm95KCk7XG4gIH1cblxuICBkaWREZXN0cm95KCkge1xuICAgIHRoaXMuc3RhdGUuZW52LmRpZERlc3Ryb3kodGhpcy5ib3VuZHMpO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBUcnlPcGNvZGUgZXh0ZW5kcyBCbG9ja09wY29kZSBpbXBsZW1lbnRzIEV4Y2VwdGlvbkhhbmRsZXIge1xuICBwdWJsaWMgdHlwZSA9IFwidHJ5XCI7XG5cbiAgcHVibGljIHRhZzogVGFnO1xuXG4gIHByaXZhdGUgX3RhZzogVGFnV3JhcHBlcjxVcGRhdGFibGVUYWc+O1xuXG4gIHByb3RlY3RlZCBib3VuZHM6IFVwZGF0YWJsZVRyYWNrZXI7XG5cbiAgY29uc3RydWN0b3Ioc3RhcnQ6IFZNSGFuZGxlLCBzdGF0ZTogVk1TdGF0ZSwgYm91bmRzOiBVcGRhdGFibGVUcmFja2VyLCBjaGlsZHJlbjogTGlua2VkTGlzdDxVcGRhdGluZ09wY29kZT4pIHtcbiAgICBzdXBlcihzdGFydCwgc3RhdGUsIGJvdW5kcywgY2hpbGRyZW4pO1xuICAgIHRoaXMudGFnID0gdGhpcy5fdGFnID0gVXBkYXRhYmxlVGFnLmNyZWF0ZShDT05TVEFOVF9UQUcpO1xuICB9XG5cbiAgZGlkSW5pdGlhbGl6ZUNoaWxkcmVuKCkge1xuICAgIHRoaXMuX3RhZy5pbm5lci51cGRhdGUoY29tYmluZVNsaWNlKHRoaXMuY2hpbGRyZW4pKTtcbiAgfVxuXG4gIGV2YWx1YXRlKHZtOiBVcGRhdGluZ1ZNPE9wYXF1ZT4pIHtcbiAgICB2bS50cnkodGhpcy5jaGlsZHJlbiwgdGhpcyk7XG4gIH1cblxuICBoYW5kbGVFeGNlcHRpb24oKSB7XG4gICAgbGV0IHsgc3RhdGUsIGJvdW5kcywgY2hpbGRyZW4sIHN0YXJ0LCBwcmV2LCBuZXh0IH0gPSB0aGlzO1xuXG4gICAgY2hpbGRyZW4uY2xlYXIoKTtcblxuICAgIGxldCBlbGVtZW50U3RhY2sgPSBOZXdFbGVtZW50QnVpbGRlci5yZXN1bWUoXG4gICAgICBzdGF0ZS5lbnYsXG4gICAgICBib3VuZHMsXG4gICAgICBib3VuZHMucmVzZXQoc3RhdGUuZW52KVxuICAgICk7XG5cbiAgICBsZXQgdm0gPSBWTS5yZXN1bWUoc3RhdGUsIGVsZW1lbnRTdGFjayk7XG5cbiAgICBsZXQgdXBkYXRpbmcgPSBuZXcgTGlua2VkTGlzdDxVcGRhdGluZ09wY29kZT4oKTtcblxuICAgIHZtLmV4ZWN1dGUoc3RhcnQsIHZtID0+IHtcbiAgICAgIHZtLnN0YWNrID0gRXZhbHVhdGlvblN0YWNrLnJlc3RvcmUoc3RhdGUuc3RhY2spO1xuICAgICAgdm0udXBkYXRpbmdPcGNvZGVTdGFjay5wdXNoKHVwZGF0aW5nKTtcbiAgICAgIHZtLnVwZGF0ZVdpdGgodGhpcyk7XG4gICAgICB2bS51cGRhdGluZ09wY29kZVN0YWNrLnB1c2goY2hpbGRyZW4pO1xuICAgIH0pO1xuXG4gICAgdGhpcy5wcmV2ID0gcHJldjtcbiAgICB0aGlzLm5leHQgPSBuZXh0O1xuICB9XG59XG5cbmNsYXNzIExpc3RSZXZhbGlkYXRpb25EZWxlZ2F0ZSBpbXBsZW1lbnRzIEl0ZXJhdG9yU3luY2hyb25pemVyRGVsZWdhdGUge1xuICBwcml2YXRlIG1hcDogRGljdDxCbG9ja09wY29kZT47XG4gIHByaXZhdGUgdXBkYXRpbmc6IExpbmtlZExpc3Q8VXBkYXRpbmdPcGNvZGU+O1xuXG4gIHByaXZhdGUgZGlkSW5zZXJ0ID0gZmFsc2U7XG4gIHByaXZhdGUgZGlkRGVsZXRlID0gZmFsc2U7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBvcGNvZGU6IExpc3RCbG9ja09wY29kZSwgcHJpdmF0ZSBtYXJrZXI6IFNpbXBsZS5Db21tZW50KSB7XG4gICAgdGhpcy5tYXAgPSBvcGNvZGUubWFwO1xuICAgIHRoaXMudXBkYXRpbmcgPSBvcGNvZGVbJ2NoaWxkcmVuJ107XG4gIH1cblxuICBpbnNlcnQoa2V5OiBzdHJpbmcsIGl0ZW06IFBhdGhSZWZlcmVuY2U8T3BhcXVlPiwgbWVtbzogUGF0aFJlZmVyZW5jZTxPcGFxdWU+LCBiZWZvcmU6IHN0cmluZykge1xuICAgIGxldCB7IG1hcCwgb3Bjb2RlLCB1cGRhdGluZyB9ID0gdGhpcztcbiAgICBsZXQgbmV4dFNpYmxpbmc6IE9wdGlvbjxTaW1wbGUuTm9kZT4gPSBudWxsO1xuICAgIGxldCByZWZlcmVuY2U6IE9wdGlvbjxCbG9ja09wY29kZT4gPSBudWxsO1xuXG4gICAgaWYgKGJlZm9yZSkge1xuICAgICAgcmVmZXJlbmNlID0gbWFwW2JlZm9yZV07XG4gICAgICBuZXh0U2libGluZyA9IHJlZmVyZW5jZVsnYm91bmRzJ10uZmlyc3ROb2RlKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG5leHRTaWJsaW5nID0gdGhpcy5tYXJrZXI7XG4gICAgfVxuXG4gICAgbGV0IHZtID0gb3Bjb2RlLnZtRm9ySW5zZXJ0aW9uKG5leHRTaWJsaW5nKTtcbiAgICBsZXQgdHJ5T3Bjb2RlOiBPcHRpb248VHJ5T3Bjb2RlPiA9IG51bGw7XG5cbiAgICBsZXQgeyBzdGFydCB9ID0gb3Bjb2RlO1xuXG4gICAgdm0uZXhlY3V0ZShzdGFydCwgdm0gPT4ge1xuICAgICAgbWFwW2tleV0gPSB0cnlPcGNvZGUgPSB2bS5pdGVyYXRlKG1lbW8sIGl0ZW0pO1xuICAgICAgdm0udXBkYXRpbmdPcGNvZGVTdGFjay5wdXNoKG5ldyBMaW5rZWRMaXN0PFVwZGF0aW5nT3Bjb2RlPigpKTtcbiAgICAgIHZtLnVwZGF0ZVdpdGgodHJ5T3Bjb2RlKTtcbiAgICAgIHZtLnVwZGF0aW5nT3Bjb2RlU3RhY2sucHVzaCh0cnlPcGNvZGUuY2hpbGRyZW4pO1xuICAgIH0pO1xuXG4gICAgdXBkYXRpbmcuaW5zZXJ0QmVmb3JlKHRyeU9wY29kZSEsIHJlZmVyZW5jZSk7XG5cbiAgICB0aGlzLmRpZEluc2VydCA9IHRydWU7XG4gIH1cblxuICByZXRhaW4oX2tleTogc3RyaW5nLCBfaXRlbTogUGF0aFJlZmVyZW5jZTxPcGFxdWU+LCBfbWVtbzogUGF0aFJlZmVyZW5jZTxPcGFxdWU+KSB7XG4gIH1cblxuICBtb3ZlKGtleTogc3RyaW5nLCBfaXRlbTogUGF0aFJlZmVyZW5jZTxPcGFxdWU+LCBfbWVtbzogUGF0aFJlZmVyZW5jZTxPcGFxdWU+LCBiZWZvcmU6IHN0cmluZykge1xuICAgIGxldCB7IG1hcCwgdXBkYXRpbmcgfSA9IHRoaXM7XG5cbiAgICBsZXQgZW50cnkgPSBtYXBba2V5XTtcbiAgICBsZXQgcmVmZXJlbmNlID0gbWFwW2JlZm9yZV0gfHwgbnVsbDtcblxuICAgIGlmIChiZWZvcmUpIHtcbiAgICAgIG1vdmVCb3VuZHMoZW50cnksIHJlZmVyZW5jZS5maXJzdE5vZGUoKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG1vdmVCb3VuZHMoZW50cnksIHRoaXMubWFya2VyKTtcbiAgICB9XG5cbiAgICB1cGRhdGluZy5yZW1vdmUoZW50cnkpO1xuICAgIHVwZGF0aW5nLmluc2VydEJlZm9yZShlbnRyeSwgcmVmZXJlbmNlKTtcbiAgfVxuXG4gIGRlbGV0ZShrZXk6IHN0cmluZykge1xuICAgIGxldCB7IG1hcCB9ID0gdGhpcztcbiAgICBsZXQgb3Bjb2RlID0gbWFwW2tleV07XG4gICAgb3Bjb2RlLmRpZERlc3Ryb3koKTtcbiAgICBjbGVhcihvcGNvZGUpO1xuICAgIHRoaXMudXBkYXRpbmcucmVtb3ZlKG9wY29kZSk7XG4gICAgZGVsZXRlIG1hcFtrZXldO1xuXG4gICAgdGhpcy5kaWREZWxldGUgPSB0cnVlO1xuICB9XG5cbiAgZG9uZSgpIHtcbiAgICB0aGlzLm9wY29kZS5kaWRJbml0aWFsaXplQ2hpbGRyZW4odGhpcy5kaWRJbnNlcnQgfHwgdGhpcy5kaWREZWxldGUpO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBMaXN0QmxvY2tPcGNvZGUgZXh0ZW5kcyBCbG9ja09wY29kZSB7XG4gIHB1YmxpYyB0eXBlID0gXCJsaXN0LWJsb2NrXCI7XG4gIHB1YmxpYyBtYXAgPSBkaWN0PEJsb2NrT3Bjb2RlPigpO1xuICBwdWJsaWMgYXJ0aWZhY3RzOiBJdGVyYXRpb25BcnRpZmFjdHM7XG4gIHB1YmxpYyB0YWc6IFRhZztcblxuICBwcml2YXRlIGxhc3RJdGVyYXRlZDogUmV2aXNpb24gPSBJTklUSUFMO1xuICBwcml2YXRlIF90YWc6IFRhZ1dyYXBwZXI8VXBkYXRhYmxlVGFnPjtcblxuICBjb25zdHJ1Y3RvcihzdGFydDogVk1IYW5kbGUsIHN0YXRlOiBWTVN0YXRlLCBib3VuZHM6IFRyYWNrZXIsIGNoaWxkcmVuOiBMaW5rZWRMaXN0PFVwZGF0aW5nT3Bjb2RlPiwgYXJ0aWZhY3RzOiBJdGVyYXRpb25BcnRpZmFjdHMpIHtcbiAgICBzdXBlcihzdGFydCwgc3RhdGUsIGJvdW5kcywgY2hpbGRyZW4pO1xuICAgIHRoaXMuYXJ0aWZhY3RzID0gYXJ0aWZhY3RzO1xuICAgIGxldCBfdGFnID0gdGhpcy5fdGFnID0gVXBkYXRhYmxlVGFnLmNyZWF0ZShDT05TVEFOVF9UQUcpO1xuICAgIHRoaXMudGFnID0gY29tYmluZShbYXJ0aWZhY3RzLnRhZywgX3RhZ10pO1xuICB9XG5cbiAgZGlkSW5pdGlhbGl6ZUNoaWxkcmVuKGxpc3REaWRDaGFuZ2UgPSB0cnVlKSB7XG4gICAgdGhpcy5sYXN0SXRlcmF0ZWQgPSB0aGlzLmFydGlmYWN0cy50YWcudmFsdWUoKTtcblxuICAgIGlmIChsaXN0RGlkQ2hhbmdlKSB7XG4gICAgICB0aGlzLl90YWcuaW5uZXIudXBkYXRlKGNvbWJpbmVTbGljZSh0aGlzLmNoaWxkcmVuKSk7XG4gICAgfVxuICB9XG5cbiAgZXZhbHVhdGUodm06IFVwZGF0aW5nVk08T3BhcXVlPikge1xuICAgIGxldCB7IGFydGlmYWN0cywgbGFzdEl0ZXJhdGVkIH0gPSB0aGlzO1xuXG4gICAgaWYgKCFhcnRpZmFjdHMudGFnLnZhbGlkYXRlKGxhc3RJdGVyYXRlZCkpIHtcbiAgICAgIGxldCB7IGJvdW5kcyB9ID0gdGhpcztcbiAgICAgIGxldCB7IGRvbSB9ID0gdm07XG5cbiAgICAgIGxldCBtYXJrZXIgPSBkb20uY3JlYXRlQ29tbWVudCgnJyk7XG4gICAgICBkb20uaW5zZXJ0QWZ0ZXIoYm91bmRzLnBhcmVudEVsZW1lbnQoKSwgbWFya2VyLCBleHBlY3QoYm91bmRzLmxhc3ROb2RlKCksIFwiY2FuJ3QgaW5zZXJ0IGFmdGVyIGFuIGVtcHR5IGJvdW5kc1wiKSk7XG5cbiAgICAgIGxldCB0YXJnZXQgPSBuZXcgTGlzdFJldmFsaWRhdGlvbkRlbGVnYXRlKHRoaXMsIG1hcmtlcik7XG4gICAgICBsZXQgc3luY2hyb25pemVyID0gbmV3IEl0ZXJhdG9yU3luY2hyb25pemVyKHsgdGFyZ2V0LCBhcnRpZmFjdHMgfSk7XG5cbiAgICAgIHN5bmNocm9uaXplci5zeW5jKCk7XG5cbiAgICAgIHRoaXMucGFyZW50RWxlbWVudCgpLnJlbW92ZUNoaWxkKG1hcmtlcik7XG4gICAgfVxuXG4gICAgLy8gUnVuIG5vdy11cGRhdGVkIHVwZGF0aW5nIG9wY29kZXNcbiAgICBzdXBlci5ldmFsdWF0ZSh2bSk7XG4gIH1cblxuICB2bUZvckluc2VydGlvbihuZXh0U2libGluZzogT3B0aW9uPFNpbXBsZS5Ob2RlPik6IFZNPE9wYXF1ZT4ge1xuICAgIGxldCB7IGJvdW5kcywgc3RhdGUgfSA9IHRoaXM7XG5cbiAgICBsZXQgZWxlbWVudFN0YWNrID0gTmV3RWxlbWVudEJ1aWxkZXIuZm9ySW5pdGlhbFJlbmRlcihcbiAgICAgIHN0YXRlLmVudixcbiAgICAgIHsgZWxlbWVudDogYm91bmRzLnBhcmVudEVsZW1lbnQoKSwgbmV4dFNpYmxpbmcgfVxuICAgICk7XG5cbiAgICByZXR1cm4gVk0ucmVzdW1lKHN0YXRlLCBlbGVtZW50U3RhY2spO1xuICB9XG59XG5cbmNsYXNzIFVwZGF0aW5nVk1GcmFtZSB7XG4gIHByaXZhdGUgY3VycmVudDogT3B0aW9uPFVwZGF0aW5nT3Bjb2RlPjtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHZtOiBVcGRhdGluZ1ZNPE9wYXF1ZT4sIHByaXZhdGUgb3BzOiBVcGRhdGluZ09wU2VxLCBwcml2YXRlIGV4Y2VwdGlvbkhhbmRsZXI6IE9wdGlvbjxFeGNlcHRpb25IYW5kbGVyPikge1xuICAgIHRoaXMudm0gPSB2bTtcbiAgICB0aGlzLm9wcyA9IG9wcztcbiAgICB0aGlzLmN1cnJlbnQgPSBvcHMuaGVhZCgpO1xuICB9XG5cbiAgZ290byhvcDogVXBkYXRpbmdPcGNvZGUpIHtcbiAgICB0aGlzLmN1cnJlbnQgPSBvcDtcbiAgfVxuXG4gIG5leHRTdGF0ZW1lbnQoKTogT3B0aW9uPFVwZGF0aW5nT3Bjb2RlPiB7XG4gICAgbGV0IHsgY3VycmVudCwgb3BzIH0gPSB0aGlzO1xuICAgIGlmIChjdXJyZW50KSB0aGlzLmN1cnJlbnQgPSBvcHMubmV4dE5vZGUoY3VycmVudCk7XG4gICAgcmV0dXJuIGN1cnJlbnQ7XG4gIH1cblxuICBoYW5kbGVFeGNlcHRpb24oKSB7XG4gICAgaWYgKHRoaXMuZXhjZXB0aW9uSGFuZGxlcikge1xuICAgICAgdGhpcy5leGNlcHRpb25IYW5kbGVyLmhhbmRsZUV4Y2VwdGlvbigpO1xuICAgIH1cbiAgfVxufVxuIl19","import { clear } from '../bounds';\nimport UpdatingVM from './update';\nexport default class RenderResult {\n    constructor(env, program, updating, bounds) {\n        this.env = env;\n        this.program = program;\n        this.updating = updating;\n        this.bounds = bounds;\n    }\n    rerender({ alwaysRevalidate = false } = { alwaysRevalidate: false }) {\n        let { env, program, updating } = this;\n        let vm = new UpdatingVM(env, program, { alwaysRevalidate });\n        vm.execute(updating, this);\n    }\n    parentElement() {\n        return this.bounds.parentElement();\n    }\n    firstNode() {\n        return this.bounds.firstNode();\n    }\n    lastNode() {\n        return this.bounds.lastNode();\n    }\n    handleException() {\n        throw \"this should never happen\";\n    }\n    destroy() {\n        this.bounds.destroy();\n        clear(this.bounds);\n    }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVuZGVyLXJlc3VsdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3J1bnRpbWUvbGliL3ZtL3JlbmRlci1yZXN1bHQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUEsQUFBTyxTQUFxQixBQUFLLEFBQUUsYUFBTSxBQUFXLEFBQUM7QUFDckQsT0FBTyxBQUFnQyxnQkFBTSxBQUFVLEFBQUM7QUFLeEQsQUFBTSxBQUFDLEFBQU87QUFDWixnQkFDUyxBQUFnQixLQUNmLEFBQStCLFNBQy9CLEFBQW9DLFVBQ3BDLEFBQXlCO0FBSDFCLGFBQUcsTUFBSCxBQUFHLEFBQWE7QUFDZixhQUFPLFVBQVAsQUFBTyxBQUF3QjtBQUMvQixhQUFRLFdBQVIsQUFBUSxBQUE0QjtBQUNwQyxhQUFNLFNBQU4sQUFBTSxBQUFtQixBQUNoQztBQUFDO0FBRUosQUFBUSxhQUFDLEVBQUUsQUFBZ0IsbUJBQUcsQUFBSyxBQUFFLFVBQUcsRUFBRSxBQUFnQixrQkFBRSxBQUFLLEFBQUU7QUFDakUsWUFBSSxFQUFFLEFBQUcsS0FBRSxBQUFPLFNBQUUsQUFBUSxBQUFFLGFBQUcsQUFBSSxBQUFDO0FBQ3RDLFlBQUksQUFBRSxLQUFHLElBQUksQUFBVSxXQUFDLEFBQUcsS0FBRSxBQUFPLFNBQUUsRUFBRSxBQUFnQixBQUFFLEFBQUMsQUFBQztBQUM1RCxBQUFFLFdBQUMsQUFBTyxRQUFDLEFBQVEsVUFBRSxBQUFJLEFBQUMsQUFBQyxBQUM3QjtBQUFDO0FBRUQsQUFBYTtBQUNYLEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBTSxPQUFDLEFBQWEsQUFBRSxBQUFDLEFBQ3JDO0FBQUM7QUFFRCxBQUFTO0FBQ1AsQUFBTSxlQUFDLEFBQUksS0FBQyxBQUFNLE9BQUMsQUFBUyxBQUFFLEFBQUMsQUFDakM7QUFBQztBQUVELEFBQVE7QUFDTixBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQU0sT0FBQyxBQUFRLEFBQUUsQUFBQyxBQUNoQztBQUFDO0FBRUQsQUFBZTtBQUNiLGNBQU0sQUFBMEIsQUFBQyxBQUNuQztBQUFDO0FBRUQsQUFBTztBQUNMLEFBQUksYUFBQyxBQUFNLE9BQUMsQUFBTyxBQUFFLEFBQUM7QUFDdEIsQUFBSyxjQUFDLEFBQUksS0FBQyxBQUFNLEFBQUMsQUFBQyxBQUNyQjtBQUFDLEFBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBPcHRpb24sIExpbmtlZExpc3QgfSBmcm9tICdAZ2xpbW1lci91dGlsJztcbmltcG9ydCBFbnZpcm9ubWVudCBmcm9tICcuLi9lbnZpcm9ubWVudCc7XG5pbXBvcnQgeyBEZXN0cm95YWJsZUJvdW5kcywgY2xlYXIgfSBmcm9tICcuLi9ib3VuZHMnO1xuaW1wb3J0IFVwZGF0aW5nVk0sIHsgRXhjZXB0aW9uSGFuZGxlciB9IGZyb20gJy4vdXBkYXRlJztcbmltcG9ydCB7IFVwZGF0aW5nT3Bjb2RlIH0gZnJvbSAnLi4vb3Bjb2Rlcyc7XG5pbXBvcnQgeyBTaW1wbGUsIE9wYXF1ZSB9IGZyb20gJ0BnbGltbWVyL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgUnVudGltZVByb2dyYW0gfSBmcm9tIFwiQGdsaW1tZXIvcHJvZ3JhbVwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSZW5kZXJSZXN1bHQgaW1wbGVtZW50cyBEZXN0cm95YWJsZUJvdW5kcywgRXhjZXB0aW9uSGFuZGxlciB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHB1YmxpYyBlbnY6IEVudmlyb25tZW50LFxuICAgIHByaXZhdGUgcHJvZ3JhbTogUnVudGltZVByb2dyYW08T3BhcXVlPixcbiAgICBwcml2YXRlIHVwZGF0aW5nOiBMaW5rZWRMaXN0PFVwZGF0aW5nT3Bjb2RlPixcbiAgICBwcml2YXRlIGJvdW5kczogRGVzdHJveWFibGVCb3VuZHNcbiAgKSB7fVxuXG4gIHJlcmVuZGVyKHsgYWx3YXlzUmV2YWxpZGF0ZSA9IGZhbHNlIH0gPSB7IGFsd2F5c1JldmFsaWRhdGU6IGZhbHNlIH0pIHtcbiAgICBsZXQgeyBlbnYsIHByb2dyYW0sIHVwZGF0aW5nIH0gPSB0aGlzO1xuICAgIGxldCB2bSA9IG5ldyBVcGRhdGluZ1ZNKGVudiwgcHJvZ3JhbSwgeyBhbHdheXNSZXZhbGlkYXRlIH0pO1xuICAgIHZtLmV4ZWN1dGUodXBkYXRpbmcsIHRoaXMpO1xuICB9XG5cbiAgcGFyZW50RWxlbWVudCgpOiBTaW1wbGUuRWxlbWVudCB7XG4gICAgcmV0dXJuIHRoaXMuYm91bmRzLnBhcmVudEVsZW1lbnQoKTtcbiAgfVxuXG4gIGZpcnN0Tm9kZSgpOiBPcHRpb248U2ltcGxlLk5vZGU+IHtcbiAgICByZXR1cm4gdGhpcy5ib3VuZHMuZmlyc3ROb2RlKCk7XG4gIH1cblxuICBsYXN0Tm9kZSgpOiBPcHRpb248U2ltcGxlLk5vZGU+IHtcbiAgICByZXR1cm4gdGhpcy5ib3VuZHMubGFzdE5vZGUoKTtcbiAgfVxuXG4gIGhhbmRsZUV4Y2VwdGlvbigpIHtcbiAgICB0aHJvdyBcInRoaXMgc2hvdWxkIG5ldmVyIGhhcHBlblwiO1xuICB9XG5cbiAgZGVzdHJveSgpIHtcbiAgICB0aGlzLmJvdW5kcy5kZXN0cm95KCk7XG4gICAgY2xlYXIodGhpcy5ib3VuZHMpO1xuICB9XG59XG4iXX0=","import { Register } from '@glimmer/vm';\nimport { Scope } from '../environment';\nimport { Stack, LinkedList, ListSlice, assert } from '@glimmer/util';\nimport { combineSlice } from '@glimmer/reference';\nimport { LabelOpcode, JumpIfNotModifiedOpcode, DidModifyOpcode } from '../compiled/opcodes/vm';\nimport { ListBlockOpcode, TryOpcode } from './update';\nimport RenderResult from './render-result';\n\nimport { APPEND_OPCODES } from '../opcodes';\nexport class EvaluationStack {\n    constructor(stack, fp, sp) {\n        this.stack = stack;\n        this.fp = fp;\n        this.sp = sp;\n        if (false) {\n            Object.seal(this);\n        }\n    }\n    static empty() {\n        return new this([], 0, -1);\n    }\n    static restore(snapshot) {\n        return new this(snapshot.slice(), 0, snapshot.length - 1);\n    }\n    push(value) {\n        this.stack[++this.sp] = value;\n    }\n    dup(position = this.sp) {\n        this.push(this.stack[position]);\n    }\n    pop(n = 1) {\n        let top = this.stack[this.sp];\n        this.sp -= n;\n        return top;\n    }\n    peek(offset = 0) {\n        return this.stack[this.sp - offset];\n    }\n    get(offset, base = this.fp) {\n        return this.stack[base + offset];\n    }\n    set(value, offset, base = this.fp) {\n        this.stack[base + offset] = value;\n    }\n    slice(start, end) {\n        return this.stack.slice(start, end);\n    }\n    capture(items) {\n        let end = this.sp + 1;\n        let start = end - items;\n        return this.stack.slice(start, end);\n    }\n    reset() {\n        this.stack.length = 0;\n    }\n    toArray() {\n        return this.stack.slice(this.fp, this.sp + 1);\n    }\n}\nexport default class VM {\n    constructor(program, env, scope, dynamicScope, elementStack) {\n        this.program = program;\n        this.env = env;\n        this.elementStack = elementStack;\n        this.dynamicScopeStack = new Stack();\n        this.scopeStack = new Stack();\n        this.updatingOpcodeStack = new Stack();\n        this.cacheGroups = new Stack();\n        this.listBlockStack = new Stack();\n        this.stack = EvaluationStack.empty();\n        /* Registers */\n        this._pc = -1;\n        this.ra = -1;\n        this.currentOpSize = 0;\n        this.s0 = null;\n        this.s1 = null;\n        this.t0 = null;\n        this.t1 = null;\n        this.v0 = null;\n        this.env = env;\n        this.heap = program.heap;\n        this.constants = program.constants;\n        this.elementStack = elementStack;\n        this.scopeStack.push(scope);\n        this.dynamicScopeStack.push(dynamicScope);\n    }\n    get pc() {\n        return this._pc;\n    }\n    set pc(value) {\n        (false && assert(typeof value === 'number' && value >= -1, `invalid pc: ${value}`));\n\n        this._pc = value;\n    }\n    get fp() {\n        return this.stack.fp;\n    }\n    set fp(fp) {\n        this.stack.fp = fp;\n    }\n    get sp() {\n        return this.stack.sp;\n    }\n    set sp(sp) {\n        this.stack.sp = sp;\n    }\n    // Fetch a value from a register onto the stack\n    fetch(register) {\n        this.stack.push(this[Register[register]]);\n    }\n    // Load a value from the stack into a register\n    load(register) {\n        this[Register[register]] = this.stack.pop();\n    }\n    // Fetch a value from a register\n    fetchValue(register) {\n        return this[Register[register]];\n    }\n    // Load a value into a register\n    loadValue(register, value) {\n        this[Register[register]] = value;\n    }\n    // Start a new frame and save $ra and $fp on the stack\n    pushFrame() {\n        this.stack.push(this.ra);\n        this.stack.push(this.fp);\n        this.fp = this.sp - 1;\n    }\n    // Restore $ra, $sp and $fp\n    popFrame() {\n        this.sp = this.fp - 1;\n        this.ra = this.stack.get(0);\n        this.fp = this.stack.get(1);\n    }\n    // Jump to an address in `program`\n    goto(offset) {\n        let addr = this.pc + offset - this.currentOpSize;\n        this.pc = addr;\n    }\n    // Save $pc into $ra, then jump to a new address in `program` (jal in MIPS)\n    call(handle) {\n        this.ra = this.pc;\n        this.pc = this.heap.getaddr(handle);\n    }\n    // Put a specific `program` address in $ra\n    returnTo(offset) {\n        let addr = this.pc + offset - this.currentOpSize;\n        this.ra = addr;\n    }\n    // Return to the `program` address stored in $ra\n    return() {\n        this.pc = this.ra;\n    }\n    static initial(program, env, self, args, dynamicScope, elementStack, handle) {\n        let scopeSize = program.heap.scopesizeof(handle);\n        let scope = Scope.root(self, scopeSize);\n        if (args) {}\n        let vm = new VM(program, env, scope, dynamicScope, elementStack);\n        vm.pc = vm.heap.getaddr(handle);\n        vm.updatingOpcodeStack.push(new LinkedList());\n        return vm;\n    }\n    static resume({ program, env, scope, dynamicScope }, stack) {\n        return new VM(program, env, scope, dynamicScope, stack);\n    }\n    capture(args) {\n        return {\n            env: this.env,\n            program: this.program,\n            dynamicScope: this.dynamicScope(),\n            scope: this.scope(),\n            stack: this.stack.capture(args)\n        };\n    }\n    beginCacheGroup() {\n        this.cacheGroups.push(this.updating().tail());\n    }\n    commitCacheGroup() {\n        //        JumpIfNotModified(END)\n        //        (head)\n        //        (....)\n        //        (tail)\n        //        DidModify\n        // END:   Noop\n        let END = new LabelOpcode(\"END\");\n        let opcodes = this.updating();\n        let marker = this.cacheGroups.pop();\n        let head = marker ? opcodes.nextNode(marker) : opcodes.head();\n        let tail = opcodes.tail();\n        let tag = combineSlice(new ListSlice(head, tail));\n        let guard = new JumpIfNotModifiedOpcode(tag, END);\n        opcodes.insertBefore(guard, head);\n        opcodes.append(new DidModifyOpcode(guard));\n        opcodes.append(END);\n    }\n    enter(args) {\n        let updating = new LinkedList();\n        let state = this.capture(args);\n        let tracker = this.elements().pushUpdatableBlock();\n        let tryOpcode = new TryOpcode(this.heap.gethandle(this.pc), state, tracker, updating);\n        this.didEnter(tryOpcode);\n    }\n    iterate(memo, value) {\n        let stack = this.stack;\n        stack.push(value);\n        stack.push(memo);\n        let state = this.capture(2);\n        let tracker = this.elements().pushUpdatableBlock();\n        // let ip = this.ip;\n        // this.ip = end + 4;\n        // this.frames.push(ip);\n        return new TryOpcode(this.heap.gethandle(this.pc), state, tracker, new LinkedList());\n    }\n    enterItem(key, opcode) {\n        this.listBlock().map[key] = opcode;\n        this.didEnter(opcode);\n    }\n    enterList(relativeStart) {\n        let updating = new LinkedList();\n        let state = this.capture(0);\n        let tracker = this.elements().pushBlockList(updating);\n        let artifacts = this.stack.peek().artifacts;\n        let addr = this.pc + relativeStart - this.currentOpSize;\n        let start = this.heap.gethandle(addr);\n        let opcode = new ListBlockOpcode(start, state, tracker, updating, artifacts);\n        this.listBlockStack.push(opcode);\n        this.didEnter(opcode);\n    }\n    didEnter(opcode) {\n        this.updateWith(opcode);\n        this.updatingOpcodeStack.push(opcode.children);\n    }\n    exit() {\n        this.elements().popBlock();\n        this.updatingOpcodeStack.pop();\n        let parent = this.updating().tail();\n        parent.didInitializeChildren();\n    }\n    exitList() {\n        this.exit();\n        this.listBlockStack.pop();\n    }\n    updateWith(opcode) {\n        this.updating().append(opcode);\n    }\n    listBlock() {\n        return this.listBlockStack.current;\n    }\n    updating() {\n        return this.updatingOpcodeStack.current;\n    }\n    elements() {\n        return this.elementStack;\n    }\n    scope() {\n        return this.scopeStack.current;\n    }\n    dynamicScope() {\n        return this.dynamicScopeStack.current;\n    }\n    pushChildScope() {\n        this.scopeStack.push(this.scope().child());\n    }\n    pushDynamicScope() {\n        let child = this.dynamicScope().child();\n        this.dynamicScopeStack.push(child);\n        return child;\n    }\n    pushRootScope(size, bindCaller) {\n        let scope = Scope.sized(size);\n        if (bindCaller) scope.bindCallerScope(this.scope());\n        this.scopeStack.push(scope);\n        return scope;\n    }\n    pushScope(scope) {\n        this.scopeStack.push(scope);\n    }\n    popScope() {\n        this.scopeStack.pop();\n    }\n    popDynamicScope() {\n        this.dynamicScopeStack.pop();\n    }\n    newDestroyable(d) {\n        this.elements().didAddDestroyable(d);\n    }\n    /// SCOPE HELPERS\n    getSelf() {\n        return this.scope().getSelf();\n    }\n    referenceForSymbol(symbol) {\n        return this.scope().getSymbol(symbol);\n    }\n    /// EXECUTION\n    execute(start, initialize) {\n        this.pc = this.heap.getaddr(start);\n        if (initialize) initialize(this);\n        let result;\n        while (true) {\n            result = this.next();\n            if (result.done) break;\n        }\n        return result.value;\n    }\n    next() {\n        let { env, program, updatingOpcodeStack, elementStack } = this;\n        let opcode = this.nextStatement();\n        let result;\n        if (opcode !== null) {\n            APPEND_OPCODES.evaluate(this, opcode, opcode.type);\n            result = { done: false, value: null };\n        } else {\n            // Unload the stack\n            this.stack.reset();\n            result = {\n                done: true,\n                value: new RenderResult(env, program, updatingOpcodeStack.pop(), elementStack.popBlock())\n            };\n        }\n        return result;\n    }\n    nextStatement() {\n        let { pc, program } = this;\n        if (pc === -1) {\n            return null;\n        }\n        // We have to save off the current operations size so that\n        // when we do a jump we can calculate the correct offset\n        // to where we are going. We can't simply ask for the size\n        // in a jump because we have have already incremented the\n        // program counter to the next instruction prior to executing.\n        let { size } = this.program.opcode(pc);\n        let operationSize = this.currentOpSize = size;\n        this.pc += operationSize;\n        return program.opcode(pc);\n    }\n    bindDynamicScope(names) {\n        let scope = this.dynamicScope();\n        for (let i = names.length - 1; i >= 0; i--) {\n            let name = this.constants.getString(names[i]);\n            scope.set(name, this.stack.pop());\n        }\n    }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwZW5kLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcGFja2FnZXMvQGdsaW1tZXIvcnVudGltZS9saWIvdm0vYXBwZW5kLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLEFBQU8sU0FBRSxBQUFRLEFBQUUsZ0JBQU0sQUFBYSxBQUFDO0FBQ3ZDLEFBQU8sU0FBRSxBQUFLLEFBQTZCLGFBQU0sQUFBZ0IsQUFBQztBQUVsRSxBQUFPLFNBQXVCLEFBQUssT0FBRSxBQUFVLFlBQUUsQUFBUyxBQUFVLEFBQU0sV0FBRSxBQUFNLEFBQUUsY0FBTSxBQUFlLEFBQUM7QUFDMUcsQUFBTyxTQUE0RCxBQUFZLEFBQUUsb0JBQU0sQUFBb0IsQUFBQztBQUM1RyxBQUFPLFNBQUUsQUFBVyxhQUFFLEFBQXVCLHlCQUFFLEFBQWUsQUFBRSx1QkFBTSxBQUF3QixBQUFDO0FBQy9GLEFBQU8sU0FBVyxBQUFlLGlCQUFFLEFBQVMsQUFBZSxpQkFBTSxBQUFVLEFBQUM7QUFDNUUsT0FBTyxBQUFZLGtCQUFNLEFBQWlCLEFBQUMsQUFDM0MsQUFBTyxBQUFFLEFBQUssQUFBRSxBQUFNLEFBQTRCLEFBQUM7O0FBRW5ELEFBQU8sU0FDTCxBQUFjLEFBRWYsc0JBQU0sQUFBWSxBQUFDO0FBY3BCLEFBQU07QUFTSixnQkFBb0IsQUFBZSxPQUFTLEFBQVUsSUFBUyxBQUFVO0FBQXJELGFBQUssUUFBTCxBQUFLLEFBQVU7QUFBUyxhQUFFLEtBQUYsQUFBRSxBQUFRO0FBQVMsYUFBRSxLQUFGLEFBQUUsQUFBUTtBQUN2RSxBQUFFLEFBQUMsQUFBQyxBQUFLLEFBQUMsbUJBQUMsQUFBQztBQUNWLEFBQU0sbUJBQUMsQUFBSSxLQUFDLEFBQUksQUFBQyxBQUFDLEFBQ3BCO0FBQUMsQUFDSDtBQUFDO0FBWkQsQUFBTSxXQUFDLEFBQUs7QUFDVixBQUFNLGVBQUMsSUFBSSxBQUFJLEtBQUMsQUFBRSxJQUFFLEFBQUMsR0FBRSxDQUFDLEFBQUMsQUFB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QUFBOEQ7QUFDOUQsWUFBSSxFQUFFLEFBQUksQUFBRSxTQUFHLEFBQUksS0FBQyxBQUFPLFFBQUMsQUFBTSxPQUFDLEFBQUUsQUFBQyxBQUFDO0FBQ3ZDLFlBQUksQUFBYSxnQkFBRyxBQUFJLEtBQUMsQUFBYSxnQkFBRyxBQUFJLEFBQUM7QUFDOUMsQUFBSSxhQUFDLEFBQUUsTUFBSSxBQUFhLEFBQUM7QUFFekIsQUFBTSxlQUFDLEFBQU8sUUFBQyxBQUFNLE9BQUMsQUFBRSxBQUFDLEFBQUMsQUFDNUI7QUFBQztBQUVELEFBQWdCLHFCQUFDLEFBQWU7QUFDOUIsWUFBSSxBQUFLLFFBQUcsQUFBSSxLQUFDLEFBQVksQUFBRSxBQUFDO0FBRWhDLEFBQUcsYUFBQyxJQUFJLEFBQUMsSUFBQyxBQUFLLE1BQUMsQUFBTSxTQUFHLEFBQUMsR0FBRSxBQUFDLEtBQUUsQUFBQyxHQUFFLEFBQUMsQUFBRSxLQUFFLEFBQUM7QUFDdEMsZ0JBQUksQUFBSSxPQUFHLEFBQUksS0FBQyxBQUFTLFVBQUMsQUFBUyxVQUFDLEFBQUssTUFBQyxBQUFDLEFBQUMsQUFBQyxBQUFDO0FBQzlDLEFBQUssa0JBQUMsQUFBRyxJQUFDLEFBQUksTUFBRSxBQUFJLEtBQUMsQUFBSyxNQUFDLEFBQUcsQUFBa0MsQUFBQyxBQUFDLEFBQ3BFO0FBQUMsQUFDSDtBQUFDLEFBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJQ2FwdHVyZWRBcmd1bWVudHMgfSBmcm9tICcuL2FyZ3VtZW50cyc7XG5pbXBvcnQgeyBSZWdpc3RlciB9IGZyb20gJ0BnbGltbWVyL3ZtJztcbmltcG9ydCB7IFNjb3BlLCBEeW5hbWljU2NvcGUsIEVudmlyb25tZW50IH0gZnJvbSAnLi4vZW52aXJvbm1lbnQnO1xuaW1wb3J0IHsgRWxlbWVudEJ1aWxkZXIgfSBmcm9tICcuL2VsZW1lbnQtYnVpbGRlcic7XG5pbXBvcnQgeyBPcHRpb24sIERlc3Ryb3lhYmxlLCBTdGFjaywgTGlua2VkTGlzdCwgTGlzdFNsaWNlLCBPcGFxdWUsIGV4cGVjdCwgYXNzZXJ0IH0gZnJvbSAnQGdsaW1tZXIvdXRpbCc7XG5pbXBvcnQgeyBSZWZlcmVuY2VJdGVyYXRvciwgUGF0aFJlZmVyZW5jZSwgVmVyc2lvbmVkUGF0aFJlZmVyZW5jZSwgY29tYmluZVNsaWNlIH0gZnJvbSAnQGdsaW1tZXIvcmVmZXJlbmNlJztcbmltcG9ydCB7IExhYmVsT3Bjb2RlLCBKdW1wSWZOb3RNb2RpZmllZE9wY29kZSwgRGlkTW9kaWZ5T3Bjb2RlIH0gZnJvbSAnLi4vY29tcGlsZWQvb3Bjb2Rlcy92bSc7XG5pbXBvcnQgeyBWTVN0YXRlLCBMaXN0QmxvY2tPcGNvZGUsIFRyeU9wY29kZSwgQmxvY2tPcGNvZGUgfSBmcm9tICcuL3VwZGF0ZSc7XG5pbXBvcnQgUmVuZGVyUmVzdWx0IGZyb20gJy4vcmVuZGVyLXJlc3VsdCc7XG5pbXBvcnQgeyBERUJVRyB9IGZyb20gJ0BnbGltbWVyL2xvY2FsLWRlYnVnLWZsYWdzJztcblxuaW1wb3J0IHtcbiAgQVBQRU5EX09QQ09ERVMsXG4gIFVwZGF0aW5nT3Bjb2RlXG59IGZyb20gJy4uL29wY29kZXMnO1xuXG5pbXBvcnQgeyBPcGNvZGUsIFZNSGFuZGxlIH0gZnJvbSBcIkBnbGltbWVyL2ludGVyZmFjZXNcIjtcbmltcG9ydCB7IEhlYXAsIFJ1bnRpbWVQcm9ncmFtIGFzIFByb2dyYW0sIFJ1bnRpbWVDb25zdGFudHMsIFJ1bnRpbWVQcm9ncmFtIH0gZnJvbSBcIkBnbGltbWVyL3Byb2dyYW1cIjtcblxuZXhwb3J0IGludGVyZmFjZSBQdWJsaWNWTSB7XG4gIGVudjogRW52aXJvbm1lbnQ7XG4gIGR5bmFtaWNTY29wZSgpOiBEeW5hbWljU2NvcGU7XG4gIGdldFNlbGYoKTogUGF0aFJlZmVyZW5jZTxPcGFxdWU+O1xuICBuZXdEZXN0cm95YWJsZShkOiBEZXN0cm95YWJsZSk6IHZvaWQ7XG59XG5cbmV4cG9ydCB0eXBlIENhcHR1cmVkU3RhY2sgPSBPcGFxdWVbXTtcblxuZXhwb3J0IGNsYXNzIEV2YWx1YXRpb25TdGFjayB7XG4gIHN0YXRpYyBlbXB0eSgpOiBFdmFsdWF0aW9uU3RhY2sge1xuICAgIHJldHVybiBuZXcgdGhpcyhbXSwgMCwgLTEpO1xuICB9XG5cbiAgc3RhdGljIHJlc3RvcmUoc25hcHNob3Q6IENhcHR1cmVkU3RhY2spOiBFdmFsdWF0aW9uU3RhY2sge1xuICAgIHJldHVybiBuZXcgdGhpcyhzbmFwc2hvdC5zbGljZSgpLCAwLCBzbmFwc2hvdC5sZW5ndGggLSAxKTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgc3RhY2s6IE9wYXF1ZVtdLCBwdWJsaWMgZnA6IG51bWJlciwgcHVibGljIHNwOiBudW1iZXIpIHtcbiAgICBpZiAoREVCVUcpIHtcbiAgICAgIE9iamVjdC5zZWFsKHRoaXMpO1xuICAgIH1cbiAgfVxuXG4gIHB1c2godmFsdWU6IE9wYXF1ZSk6IHZvaWQge1xuICAgIHRoaXMuc3RhY2tbKyt0aGlzLnNwXSA9IHZhbHVlO1xuICB9XG5cbiAgZHVwKHBvc2l0aW9uID0gdGhpcy5zcCk6IHZvaWQge1xuICAgIHRoaXMucHVzaCh0aGlzLnN0YWNrW3Bvc2l0aW9uXSk7XG4gIH1cblxuICBwb3A8VD4obiA9IDEpOiBUIHtcbiAgICBsZXQgdG9wID0gdGhpcy5zdGFja1t0aGlzLnNwXSBhcyBUO1xuICAgIHRoaXMuc3AgLT0gbjtcbiAgICByZXR1cm4gdG9wO1xuICB9XG5cbiAgcGVlazxUPihvZmZzZXQgPSAwKTogVCB7XG4gICAgcmV0dXJuIHRoaXMuc3RhY2tbdGhpcy5zcCAtIG9mZnNldF0gYXMgVDtcbiAgfVxuXG4gIGdldDxUPihvZmZzZXQ6IG51bWJlciwgYmFzZSA9IHRoaXMuZnApOiBUIHtcbiAgICByZXR1cm4gdGhpcy5zdGFja1tiYXNlICsgb2Zmc2V0XSBhcyBUO1xuICB9XG5cbiAgc2V0KHZhbHVlOiBPcGFxdWUsIG9mZnNldDogbnVtYmVyLCBiYXNlID0gdGhpcy5mcCkge1xuICAgIHRoaXMuc3RhY2tbYmFzZSArIG9mZnNldF0gPSB2YWx1ZTtcbiAgfVxuXG4gIHNsaWNlPFQgPSBPcGFxdWU+KHN0YXJ0OiBudW1iZXIsIGVuZDogbnVtYmVyKTogVFtdIHtcbiAgICByZXR1cm4gdGhpcy5zdGFjay5zbGljZShzdGFydCwgZW5kKSBhcyBUW107XG4gIH1cblxuICBjYXB0dXJlKGl0ZW1zOiBudW1iZXIpOiBDYXB0dXJlZFN0YWNrIHtcbiAgICBsZXQgZW5kID0gdGhpcy5zcCArIDE7XG4gICAgbGV0IHN0YXJ0ID0gZW5kIC0gaXRlbXM7XG4gICAgcmV0dXJuIHRoaXMuc3RhY2suc2xpY2Uoc3RhcnQsIGVuZCk7XG4gIH1cblxuICByZXNldCgpIHtcbiAgICB0aGlzLnN0YWNrLmxlbmd0aCA9IDA7XG4gIH1cblxuICB0b0FycmF5KCkge1xuICAgIHJldHVybiB0aGlzLnN0YWNrLnNsaWNlKHRoaXMuZnAsIHRoaXMuc3AgKyAxKTtcbiAgfVxufVxuXG5leHBvcnQgdHlwZSBJdGVyYXRvclJlc3VsdDxUPiA9IHtcbiAgZG9uZTogZmFsc2U7XG4gIHZhbHVlOiBudWxsO1xufSB8IHtcbiAgZG9uZTogdHJ1ZTtcbiAgdmFsdWU6IFQ7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBWTTxTcGVjaWZpZXI+IGltcGxlbWVudHMgUHVibGljVk0ge1xuICBwcml2YXRlIGR5bmFtaWNTY29wZVN0YWNrID0gbmV3IFN0YWNrPER5bmFtaWNTY29wZT4oKTtcbiAgcHJpdmF0ZSBzY29wZVN0YWNrID0gbmV3IFN0YWNrPFNjb3BlPigpO1xuICBwdWJsaWMgdXBkYXRpbmdPcGNvZGVTdGFjayA9IG5ldyBTdGFjazxMaW5rZWRMaXN0PFVwZGF0aW5nT3Bjb2RlPj4oKTtcbiAgcHVibGljIGNhY2hlR3JvdXBzID0gbmV3IFN0YWNrPE9wdGlvbjxVcGRhdGluZ09wY29kZT4+KCk7XG4gIHB1YmxpYyBsaXN0QmxvY2tTdGFjayA9IG5ldyBTdGFjazxMaXN0QmxvY2tPcGNvZGU+KCk7XG4gIHB1YmxpYyBjb25zdGFudHM6IFJ1bnRpbWVDb25zdGFudHM8U3BlY2lmaWVyPjtcbiAgcHVibGljIGhlYXA6IEhlYXA7XG5cbiAgcHVibGljIHN0YWNrID0gRXZhbHVhdGlvblN0YWNrLmVtcHR5KCk7XG5cbiAgLyogUmVnaXN0ZXJzICovXG5cbiAgcHJpdmF0ZSBfcGMgPSAtMTtcbiAgcHJpdmF0ZSByYSA9IC0xO1xuXG4gIHByaXZhdGUgY3VycmVudE9wU2l6ZSA9IDA7XG5cbiAgZ2V0IHBjKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuX3BjO1xuICB9XG5cbiAgc2V0IHBjKHZhbHVlOiBudW1iZXIpIHtcbiAgICBhc3NlcnQodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJyAmJiB2YWx1ZSA+PSAtMSwgYGludmFsaWQgcGM6ICR7dmFsdWV9YCk7XG4gICAgdGhpcy5fcGMgPSB2YWx1ZTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0IGZwKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuc3RhY2suZnA7XG4gIH1cblxuICBwcml2YXRlIHNldCBmcChmcDogbnVtYmVyKSB7XG4gICAgdGhpcy5zdGFjay5mcCA9IGZwO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXQgc3AoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5zdGFjay5zcDtcbiAgfVxuXG4gIHByaXZhdGUgc2V0IHNwKHNwOiBudW1iZXIpIHtcbiAgICB0aGlzLnN0YWNrLnNwID0gc3A7XG4gIH1cblxuICBwdWJsaWMgczA6IGFueSA9IG51bGw7XG4gIHB1YmxpYyBzMTogYW55ID0gbnVsbDtcbiAgcHVibGljIHQwOiBhbnkgPSBudWxsO1xuICBwdWJsaWMgdDE6IGFueSA9IG51bGw7XG4gIHB1YmxpYyB2MDogYW55ID0gbnVsbDtcblxuICAvLyBGZXRjaCBhIHZhbHVlIGZyb20gYSByZWdpc3RlciBvbnRvIHRoZSBzdGFja1xuICBmZXRjaChyZWdpc3RlcjogUmVnaXN0ZXIpIHtcbiAgICB0aGlzLnN0YWNrLnB1c2godGhpc1tSZWdpc3RlcltyZWdpc3Rlcl1dKTtcbiAgfVxuXG4gIC8vIExvYWQgYSB2YWx1ZSBmcm9tIHRoZSBzdGFjayBpbnRvIGEgcmVnaXN0ZXJcbiAgbG9hZChyZWdpc3RlcjogUmVnaXN0ZXIpIHtcbiAgICB0aGlzW1JlZ2lzdGVyW3JlZ2lzdGVyXV0gPSB0aGlzLnN0YWNrLnBvcCgpO1xuICB9XG5cbiAgLy8gRmV0Y2ggYSB2YWx1ZSBmcm9tIGEgcmVnaXN0ZXJcbiAgZmV0Y2hWYWx1ZTxUPihyZWdpc3RlcjogUmVnaXN0ZXIpOiBUIHtcbiAgICByZXR1cm4gdGhpc1tSZWdpc3RlcltyZWdpc3Rlcl1dO1xuICB9XG5cbiAgLy8gTG9hZCBhIHZhbHVlIGludG8gYSByZWdpc3RlclxuICBsb2FkVmFsdWU8VD4ocmVnaXN0ZXI6IFJlZ2lzdGVyLCB2YWx1ZTogVCkge1xuICAgIHRoaXNbUmVnaXN0ZXJbcmVnaXN0ZXJdXSA9IHZhbHVlO1xuICB9XG5cbiAgLy8gU3RhcnQgYSBuZXcgZnJhbWUgYW5kIHNhdmUgJHJhIGFuZCAkZnAgb24gdGhlIHN0YWNrXG4gIHB1c2hGcmFtZSgpIHtcbiAgICB0aGlzLnN0YWNrLnB1c2godGhpcy5yYSk7XG4gICAgdGhpcy5zdGFjay5wdXNoKHRoaXMuZnApO1xuICAgIHRoaXMuZnAgPSB0aGlzLnNwIC0gMTtcbiAgfVxuXG4gIC8vIFJlc3RvcmUgJHJhLCAkc3AgYW5kICRmcFxuICBwb3BGcmFtZSgpIHtcbiAgICB0aGlzLnNwID0gdGhpcy5mcCAtIDE7XG4gICAgdGhpcy5yYSA9IHRoaXMuc3RhY2suZ2V0PG51bWJlcj4oMCk7XG4gICAgdGhpcy5mcCA9IHRoaXMuc3RhY2suZ2V0PG51bWJlcj4oMSk7XG4gIH1cblxuICAvLyBKdW1wIHRvIGFuIGFkZHJlc3MgaW4gYHByb2dyYW1gXG4gIGdvdG8ob2Zmc2V0OiBudW1iZXIpIHtcbiAgICBsZXQgYWRkciA9ICh0aGlzLnBjICsgb2Zmc2V0KSAtIHRoaXMuY3VycmVudE9wU2l6ZTtcbiAgICB0aGlzLnBjID0gYWRkcjtcbiAgfVxuXG4gIC8vIFNhdmUgJHBjIGludG8gJHJhLCB0aGVuIGp1bXAgdG8gYSBuZXcgYWRkcmVzcyBpbiBgcHJvZ3JhbWAgKGphbCBpbiBNSVBTKVxuICBjYWxsKGhhbmRsZTogVk1IYW5kbGUpIHtcbiAgICB0aGlzLnJhID0gdGhpcy5wYztcbiAgICB0aGlzLnBjID0gdGhpcy5oZWFwLmdldGFkZHIoaGFuZGxlKTtcbiAgfVxuXG4gIC8vIFB1dCBhIHNwZWNpZmljIGBwcm9ncmFtYCBhZGRyZXNzIGluICRyYVxuICByZXR1cm5UbyhvZmZzZXQ6IG51bWJlcikge1xuICAgIGxldCBhZGRyID0gKHRoaXMucGMgKyBvZmZzZXQpIC0gdGhpcy5jdXJyZW50T3BTaXplO1xuICAgIHRoaXMucmEgPSBhZGRyO1xuICB9XG5cbiAgLy8gUmV0dXJuIHRvIHRoZSBgcHJvZ3JhbWAgYWRkcmVzcyBzdG9yZWQgaW4gJHJhXG4gIHJldHVybigpIHtcbiAgICB0aGlzLnBjID0gdGhpcy5yYTtcbiAgfVxuXG4gIHN0YXRpYyBpbml0aWFsPFNwZWNpZmllcj4oXG4gICAgcHJvZ3JhbTogUnVudGltZVByb2dyYW08U3BlY2lmaWVyPixcbiAgICBlbnY6IEVudmlyb25tZW50LFxuICAgIHNlbGY6IFBhdGhSZWZlcmVuY2U8T3BhcXVlPixcbiAgICBhcmdzOiBPcHRpb248SUNhcHR1cmVkQXJndW1lbnRzPixcbiAgICBkeW5hbWljU2NvcGU6IER5bmFtaWNTY29wZSxcbiAgICBlbGVtZW50U3RhY2s6IEVsZW1lbnRCdWlsZGVyLFxuICAgIGhhbmRsZTogVk1IYW5kbGVcbiAgKSB7XG4gICAgbGV0IHNjb3BlU2l6ZSA9IHByb2dyYW0uaGVhcC5zY29wZXNpemVvZihoYW5kbGUpO1xuICAgIGxldCBzY29wZSA9IFNjb3BlLnJvb3Qoc2VsZiwgc2NvcGVTaXplKTtcblxuICAgIGlmIChhcmdzKSB7XG5cbiAgICB9XG5cbiAgICBsZXQgdm0gPSBuZXcgVk0ocHJvZ3JhbSwgZW52LCBzY29wZSwgZHluYW1pY1Njb3BlLCBlbGVtZW50U3RhY2spO1xuICAgIHZtLnBjID0gdm0uaGVhcC5nZXRhZGRyKGhhbmRsZSk7XG4gICAgdm0udXBkYXRpbmdPcGNvZGVTdGFjay5wdXNoKG5ldyBMaW5rZWRMaXN0PFVwZGF0aW5nT3Bjb2RlPigpKTtcbiAgICByZXR1cm4gdm07XG4gIH1cblxuICBzdGF0aWMgcmVzdW1lKHsgcHJvZ3JhbSwgZW52LCBzY29wZSwgZHluYW1pY1Njb3BlIH06IFZNU3RhdGUsIHN0YWNrOiBFbGVtZW50QnVpbGRlcikge1xuICAgIHJldHVybiBuZXcgVk0ocHJvZ3JhbSwgZW52LCBzY29wZSwgZHluYW1pY1Njb3BlLCBzdGFjayk7XG4gIH1cblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIHByb2dyYW06IFByb2dyYW08U3BlY2lmaWVyPixcbiAgICBwdWJsaWMgZW52OiBFbnZpcm9ubWVudCxcbiAgICBzY29wZTogU2NvcGUsXG4gICAgZHluYW1pY1Njb3BlOiBEeW5hbWljU2NvcGUsXG4gICAgcHJpdmF0ZSBlbGVtZW50U3RhY2s6IEVsZW1lbnRCdWlsZGVyLFxuICApIHtcbiAgICB0aGlzLmVudiA9IGVudjtcbiAgICB0aGlzLmhlYXAgPSBwcm9ncmFtLmhlYXA7XG4gICAgdGhpcy5jb25zdGFudHMgPSBwcm9ncmFtLmNvbnN0YW50cztcbiAgICB0aGlzLmVsZW1lbnRTdGFjayA9IGVsZW1lbnRTdGFjaztcbiAgICB0aGlzLnNjb3BlU3RhY2sucHVzaChzY29wZSk7XG4gICAgdGhpcy5keW5hbWljU2NvcGVTdGFjay5wdXNoKGR5bmFtaWNTY29wZSk7XG4gIH1cblxuICBjYXB0dXJlKGFyZ3M6IG51bWJlcik6IFZNU3RhdGUge1xuICAgIHJldHVybiB7XG4gICAgICBlbnY6IHRoaXMuZW52LFxuICAgICAgcHJvZ3JhbTogdGhpcy5wcm9ncmFtLFxuICAgICAgZHluYW1pY1Njb3BlOiB0aGlzLmR5bmFtaWNTY29wZSgpLFxuICAgICAgc2NvcGU6IHRoaXMuc2NvcGUoKSxcbiAgICAgIHN0YWNrOiB0aGlzLnN0YWNrLmNhcHR1cmUoYXJncylcbiAgICB9O1xuICB9XG5cbiAgYmVnaW5DYWNoZUdyb3VwKCkge1xuICAgIHRoaXMuY2FjaGVHcm91cHMucHVzaCh0aGlzLnVwZGF0aW5nKCkudGFpbCgpKTtcbiAgfVxuXG4gIGNvbW1pdENhY2hlR3JvdXAoKSB7XG4gICAgLy8gICAgICAgIEp1bXBJZk5vdE1vZGlmaWVkKEVORClcbiAgICAvLyAgICAgICAgKGhlYWQpXG4gICAgLy8gICAgICAgICguLi4uKVxuICAgIC8vICAgICAgICAodGFpbClcbiAgICAvLyAgICAgICAgRGlkTW9kaWZ5XG4gICAgLy8gRU5EOiAgIE5vb3BcblxuICAgIGxldCBFTkQgPSBuZXcgTGFiZWxPcGNvZGUoXCJFTkRcIik7XG5cbiAgICBsZXQgb3Bjb2RlcyA9IHRoaXMudXBkYXRpbmcoKTtcbiAgICBsZXQgbWFya2VyID0gdGhpcy5jYWNoZUdyb3Vwcy5wb3AoKTtcbiAgICBsZXQgaGVhZCA9IG1hcmtlciA/IG9wY29kZXMubmV4dE5vZGUobWFya2VyKSA6IG9wY29kZXMuaGVhZCgpO1xuICAgIGxldCB0YWlsID0gb3Bjb2Rlcy50YWlsKCk7XG4gICAgbGV0IHRhZyA9IGNvbWJpbmVTbGljZShuZXcgTGlzdFNsaWNlKGhlYWQsIHRhaWwpKTtcblxuICAgIGxldCBndWFyZCA9IG5ldyBKdW1wSWZOb3RNb2RpZmllZE9wY29kZSh0YWcsIEVORCk7XG5cbiAgICBvcGNvZGVzLmluc2VydEJlZm9yZShndWFyZCwgaGVhZCk7XG4gICAgb3Bjb2Rlcy5hcHBlbmQobmV3IERpZE1vZGlmeU9wY29kZShndWFyZCkpO1xuICAgIG9wY29kZXMuYXBwZW5kKEVORCk7XG4gIH1cblxuICBlbnRlcihhcmdzOiBudW1iZXIpIHtcbiAgICBsZXQgdXBkYXRpbmcgPSBuZXcgTGlua2VkTGlzdDxVcGRhdGluZ09wY29kZT4oKTtcblxuICAgIGxldCBzdGF0ZSA9IHRoaXMuY2FwdHVyZShhcmdzKTtcbiAgICBsZXQgdHJhY2tlciA9IHRoaXMuZWxlbWVudHMoKS5wdXNoVXBkYXRhYmxlQmxvY2soKTtcblxuICAgIGxldCB0cnlPcGNvZGUgPSBuZXcgVHJ5T3Bjb2RlKHRoaXMuaGVhcC5nZXRoYW5kbGUodGhpcy5wYyksIHN0YXRlLCB0cmFja2VyLCB1cGRhdGluZyk7XG5cbiAgICB0aGlzLmRpZEVudGVyKHRyeU9wY29kZSk7XG4gIH1cblxuICBpdGVyYXRlKG1lbW86IFZlcnNpb25lZFBhdGhSZWZlcmVuY2U8T3BhcXVlPiwgdmFsdWU6IFZlcnNpb25lZFBhdGhSZWZlcmVuY2U8T3BhcXVlPik6IFRyeU9wY29kZSB7XG4gICAgbGV0IHN0YWNrID0gdGhpcy5zdGFjaztcbiAgICBzdGFjay5wdXNoKHZhbHVlKTtcbiAgICBzdGFjay5wdXNoKG1lbW8pO1xuXG4gICAgbGV0IHN0YXRlID0gdGhpcy5jYXB0dXJlKDIpO1xuICAgIGxldCB0cmFja2VyID0gdGhpcy5lbGVtZW50cygpLnB1c2hVcGRhdGFibGVCbG9jaygpO1xuXG4gICAgLy8gbGV0IGlwID0gdGhpcy5pcDtcbiAgICAvLyB0aGlzLmlwID0gZW5kICsgNDtcbiAgICAvLyB0aGlzLmZyYW1lcy5wdXNoKGlwKTtcblxuICAgIHJldHVybiBuZXcgVHJ5T3Bjb2RlKHRoaXMuaGVhcC5nZXRoYW5kbGUodGhpcy5wYyksIHN0YXRlLCB0cmFja2VyLCBuZXcgTGlua2VkTGlzdDxVcGRhdGluZ09wY29kZT4oKSk7XG4gIH1cblxuICBlbnRlckl0ZW0oa2V5OiBzdHJpbmcsIG9wY29kZTogVHJ5T3Bjb2RlKSB7XG4gICAgdGhpcy5saXN0QmxvY2soKS5tYXBba2V5XSA9IG9wY29kZTtcbiAgICB0aGlzLmRpZEVudGVyKG9wY29kZSk7XG4gIH1cblxuICBlbnRlckxpc3QocmVsYXRpdmVTdGFydDogbnVtYmVyKSB7XG4gICAgbGV0IHVwZGF0aW5nID0gbmV3IExpbmtlZExpc3Q8QmxvY2tPcGNvZGU+KCk7XG5cbiAgICBsZXQgc3RhdGUgPSB0aGlzLmNhcHR1cmUoMCk7XG4gICAgbGV0IHRyYWNrZXIgPSB0aGlzLmVsZW1lbnRzKCkucHVzaEJsb2NrTGlzdCh1cGRhdGluZyk7XG4gICAgbGV0IGFydGlmYWN0cyA9IHRoaXMuc3RhY2sucGVlazxSZWZlcmVuY2VJdGVyYXRvcj4oKS5hcnRpZmFjdHM7XG5cbiAgICBsZXQgYWRkciA9ICh0aGlzLnBjICsgcmVsYXRpdmVTdGFydCkgLSB0aGlzLmN1cnJlbnRPcFNpemU7XG4gICAgbGV0IHN0YXJ0ID0gdGhpcy5oZWFwLmdldGhhbmRsZShhZGRyKTtcblxuICAgIGxldCBvcGNvZGUgPSBuZXcgTGlzdEJsb2NrT3Bjb2RlKHN0YXJ0LCBzdGF0ZSwgdHJhY2tlciwgdXBkYXRpbmcsIGFydGlmYWN0cyk7XG5cbiAgICB0aGlzLmxpc3RCbG9ja1N0YWNrLnB1c2gob3Bjb2RlKTtcblxuICAgIHRoaXMuZGlkRW50ZXIob3Bjb2RlKTtcbiAgfVxuXG4gIHByaXZhdGUgZGlkRW50ZXIob3Bjb2RlOiBCbG9ja09wY29kZSkge1xuICAgIHRoaXMudXBkYXRlV2l0aChvcGNvZGUpO1xuICAgIHRoaXMudXBkYXRpbmdPcGNvZGVTdGFjay5wdXNoKG9wY29kZS5jaGlsZHJlbik7XG4gIH1cblxuICBleGl0KCkge1xuICAgIHRoaXMuZWxlbWVudHMoKS5wb3BCbG9jaygpO1xuICAgIHRoaXMudXBkYXRpbmdPcGNvZGVTdGFjay5wb3AoKTtcblxuICAgIGxldCBwYXJlbnQgPSB0aGlzLnVwZGF0aW5nKCkudGFpbCgpIGFzIEJsb2NrT3Bjb2RlO1xuXG4gICAgcGFyZW50LmRpZEluaXRpYWxpemVDaGlsZHJlbigpO1xuICB9XG5cbiAgZXhpdExpc3QoKSB7XG4gICAgdGhpcy5leGl0KCk7XG4gICAgdGhpcy5saXN0QmxvY2tTdGFjay5wb3AoKTtcbiAgfVxuXG4gIHVwZGF0ZVdpdGgob3Bjb2RlOiBVcGRhdGluZ09wY29kZSkge1xuICAgIHRoaXMudXBkYXRpbmcoKS5hcHBlbmQob3Bjb2RlKTtcbiAgfVxuXG4gIGxpc3RCbG9jaygpOiBMaXN0QmxvY2tPcGNvZGUge1xuICAgIHJldHVybiBleHBlY3QodGhpcy5saXN0QmxvY2tTdGFjay5jdXJyZW50LCAnZXhwZWN0ZWQgYSBsaXN0IGJsb2NrJyk7XG4gIH1cblxuICB1cGRhdGluZygpOiBMaW5rZWRMaXN0PFVwZGF0aW5nT3Bjb2RlPiB7XG4gICAgcmV0dXJuIGV4cGVjdCh0aGlzLnVwZGF0aW5nT3Bjb2RlU3RhY2suY3VycmVudCwgJ2V4cGVjdGVkIHVwZGF0aW5nIG9wY29kZSBvbiB0aGUgdXBkYXRpbmcgb3Bjb2RlIHN0YWNrJyk7XG4gIH1cblxuICBlbGVtZW50cygpOiBFbGVtZW50QnVpbGRlciB7XG4gICAgcmV0dXJuIHRoaXMuZWxlbWVudFN0YWNrO1xuICB9XG5cbiAgc2NvcGUoKTogU2NvcGUge1xuICAgIHJldHVybiBleHBlY3QodGhpcy5zY29wZVN0YWNrLmN1cnJlbnQsICdleHBlY3RlZCBzY29wZSBvbiB0aGUgc2NvcGUgc3RhY2snKTtcbiAgfVxuXG4gIGR5bmFtaWNTY29wZSgpOiBEeW5hbWljU2NvcGUge1xuICAgIHJldHVybiBleHBlY3QodGhpcy5keW5hbWljU2NvcGVTdGFjay5jdXJyZW50LCAnZXhwZWN0ZWQgZHluYW1pYyBzY29wZSBvbiB0aGUgZHluYW1pYyBzY29wZSBzdGFjaycpO1xuICB9XG5cbiAgcHVzaENoaWxkU2NvcGUoKSB7XG4gICAgdGhpcy5zY29wZVN0YWNrLnB1c2godGhpcy5zY29wZSgpLmNoaWxkKCkpO1xuICB9XG5cbiAgcHVzaER5bmFtaWNTY29wZSgpOiBEeW5hbWljU2NvcGUge1xuICAgIGxldCBjaGlsZCA9IHRoaXMuZHluYW1pY1Njb3BlKCkuY2hpbGQoKTtcbiAgICB0aGlzLmR5bmFtaWNTY29wZVN0YWNrLnB1c2goY2hpbGQpO1xuICAgIHJldHVybiBjaGlsZDtcbiAgfVxuXG4gIHB1c2hSb290U2NvcGUoc2l6ZTogbnVtYmVyLCBiaW5kQ2FsbGVyOiBib29sZWFuKTogU2NvcGUge1xuICAgIGxldCBzY29wZSA9IFNjb3BlLnNpemVkKHNpemUpO1xuICAgIGlmIChiaW5kQ2FsbGVyKSBzY29wZS5iaW5kQ2FsbGVyU2NvcGUodGhpcy5zY29wZSgpKTtcbiAgICB0aGlzLnNjb3BlU3RhY2sucHVzaChzY29wZSk7XG4gICAgcmV0dXJuIHNjb3BlO1xuICB9XG5cbiAgcHVzaFNjb3BlKHNjb3BlOiBTY29wZSkge1xuICAgIHRoaXMuc2NvcGVTdGFjay5wdXNoKHNjb3BlKTtcbiAgfVxuXG4gIHBvcFNjb3BlKCkge1xuICAgIHRoaXMuc2NvcGVTdGFjay5wb3AoKTtcbiAgfVxuXG4gIHBvcER5bmFtaWNTY29wZSgpIHtcbiAgICB0aGlzLmR5bmFtaWNTY29wZVN0YWNrLnBvcCgpO1xuICB9XG5cbiAgbmV3RGVzdHJveWFibGUoZDogRGVzdHJveWFibGUpIHtcbiAgICB0aGlzLmVsZW1lbnRzKCkuZGlkQWRkRGVzdHJveWFibGUoZCk7XG4gIH1cblxuICAvLy8gU0NPUEUgSEVMUEVSU1xuXG4gIGdldFNlbGYoKTogUGF0aFJlZmVyZW5jZTxhbnk+IHtcbiAgICByZXR1cm4gdGhpcy5zY29wZSgpLmdldFNlbGYoKTtcbiAgfVxuXG4gIHJlZmVyZW5jZUZvclN5bWJvbChzeW1ib2w6IG51bWJlcik6IFBhdGhSZWZlcmVuY2U8YW55PiB7XG4gICAgcmV0dXJuIHRoaXMuc2NvcGUoKS5nZXRTeW1ib2woc3ltYm9sKTtcbiAgfVxuXG4gIC8vLyBFWEVDVVRJT05cblxuICBleGVjdXRlKHN0YXJ0OiBWTUhhbmRsZSwgaW5pdGlhbGl6ZT86ICh2bTogVk08U3BlY2lmaWVyPikgPT4gdm9pZCk6IFJlbmRlclJlc3VsdCB7XG4gICAgdGhpcy5wYyA9IHRoaXMuaGVhcC5nZXRhZGRyKHN0YXJ0KTtcblxuICAgIGlmIChpbml0aWFsaXplKSBpbml0aWFsaXplKHRoaXMpO1xuXG4gICAgbGV0IHJlc3VsdDogSXRlcmF0b3JSZXN1bHQ8UmVuZGVyUmVzdWx0PjtcblxuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICByZXN1bHQgPSB0aGlzLm5leHQoKTtcbiAgICAgIGlmIChyZXN1bHQuZG9uZSkgYnJlYWs7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdC52YWx1ZSBhcyBSZW5kZXJSZXN1bHQ7XG4gIH1cblxuICBuZXh0KCk6IEl0ZXJhdG9yUmVzdWx0PFJlbmRlclJlc3VsdD4ge1xuICAgIGxldCB7IGVudiwgcHJvZ3JhbSwgdXBkYXRpbmdPcGNvZGVTdGFjaywgZWxlbWVudFN0YWNrIH0gPSB0aGlzO1xuICAgIGxldCBvcGNvZGUgPSB0aGlzLm5leHRTdGF0ZW1lbnQoKTtcbiAgICBsZXQgcmVzdWx0OiBJdGVyYXRvclJlc3VsdDxSZW5kZXJSZXN1bHQ+O1xuICAgIGlmIChvcGNvZGUgIT09IG51bGwpIHtcbiAgICAgIEFQUEVORF9PUENPREVTLmV2YWx1YXRlKHRoaXMsIG9wY29kZSwgb3Bjb2RlLnR5cGUpO1xuICAgICAgcmVzdWx0ID0geyBkb25lOiBmYWxzZSwgdmFsdWU6IG51bGwgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gVW5sb2FkIHRoZSBzdGFja1xuICAgICAgdGhpcy5zdGFjay5yZXNldCgpO1xuXG4gICAgICByZXN1bHQgPSB7XG4gICAgICAgIGRvbmU6IHRydWUsXG4gICAgICAgIHZhbHVlOiBuZXcgUmVuZGVyUmVzdWx0KFxuICAgICAgICAgIGVudixcbiAgICAgICAgICBwcm9ncmFtLFxuICAgICAgICAgIGV4cGVjdCh1cGRhdGluZ09wY29kZVN0YWNrLnBvcCgpLCAndGhlcmUgc2hvdWxkIGJlIGEgZmluYWwgdXBkYXRpbmcgb3Bjb2RlIHN0YWNrJyksXG4gICAgICAgICAgZWxlbWVudFN0YWNrLnBvcEJsb2NrKClcbiAgICAgICAgKVxuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHByaXZhdGUgbmV4dFN0YXRlbWVudCgpOiBPcHRpb248T3Bjb2RlPiB7XG4gICAgbGV0IHsgcGMsIHByb2dyYW0gfSA9IHRoaXM7XG5cbiAgICBpZiAocGMgPT09IC0xKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgLy8gV2UgaGF2ZSB0byBzYXZlIG9mZiB0aGUgY3VycmVudCBvcGVyYXRpb25zIHNpemUgc28gdGhhdFxuICAgIC8vIHdoZW4gd2UgZG8gYSBqdW1wIHdlIGNhbiBjYWxjdWxhdGUgdGhlIGNvcnJlY3Qgb2Zmc2V0XG4gICAgLy8gdG8gd2hlcmUgd2UgYXJlIGdvaW5nLiBXZSBjYW4ndCBzaW1wbHkgYXNrIGZvciB0aGUgc2l6ZVxuICAgIC8vIGluIGEganVtcCBiZWNhdXNlIHdlIGhhdmUgaGF2ZSBhbHJlYWR5IGluY3JlbWVudGVkIHRoZVxuICAgIC8vIHByb2dyYW0gY291bnRlciB0byB0aGUgbmV4dCBpbnN0cnVjdGlvbiBwcmlvciB0byBleGVjdXRpbmcuXG4gICAgbGV0IHsgc2l6ZSB9ID0gdGhpcy5wcm9ncmFtLm9wY29kZShwYyk7XG4gICAgbGV0IG9wZXJhdGlvblNpemUgPSB0aGlzLmN1cnJlbnRPcFNpemUgPSBzaXplO1xuICAgIHRoaXMucGMgKz0gb3BlcmF0aW9uU2l6ZTtcblxuICAgIHJldHVybiBwcm9ncmFtLm9wY29kZShwYyk7XG4gIH1cblxuICBiaW5kRHluYW1pY1Njb3BlKG5hbWVzOiBudW1iZXJbXSkge1xuICAgIGxldCBzY29wZSA9IHRoaXMuZHluYW1pY1Njb3BlKCk7XG5cbiAgICBmb3IobGV0IGk9bmFtZXMubGVuZ3RoIC0gMTsgaT49MDsgaS0tKSB7XG4gICAgICBsZXQgbmFtZSA9IHRoaXMuY29uc3RhbnRzLmdldFN0cmluZyhuYW1lc1tpXSk7XG4gICAgICBzY29wZS5zZXQobmFtZSwgdGhpcy5zdGFjay5wb3A8VmVyc2lvbmVkUGF0aFJlZmVyZW5jZTxPcGFxdWU+PigpKTtcbiAgICB9XG4gIH1cbn1cbiJdfQ==","import { assign } from '@glimmer/util';\nimport { VM } from './vm';\nimport { EMPTY_ARGS } from './vm/arguments';\nimport { CompilableTemplate } from \"@glimmer/opcode-compiler\";\nexport class TemplateIterator {\n    constructor(vm) {\n        this.vm = vm;\n    }\n    next() {\n        return this.vm.next();\n    }\n}\nlet clientId = 0;\nexport default function templateFactory({ id: templateId, meta, block }) {\n    let parsedBlock;\n    let id = templateId || `client-${clientId++}`;\n    let create = (options, envMeta) => {\n        let newMeta = envMeta ? assign({}, envMeta, meta) : meta;\n        if (!parsedBlock) {\n            parsedBlock = JSON.parse(block);\n        }\n        return new ScannableTemplate(options, { id, block: parsedBlock, referrer: newMeta });\n    };\n    return { id, meta, create };\n}\nexport class ScannableTemplate {\n    constructor(options, parsedLayout) {\n        this.options = options;\n        this.parsedLayout = parsedLayout;\n        this.layout = null;\n        this.partial = null;\n        let { block } = parsedLayout;\n        this.symbols = block.symbols;\n        this.hasEval = block.hasEval;\n        this.statements = block.statements;\n        this.referrer = parsedLayout.referrer;\n        this.id = parsedLayout.id || `client-${clientId++}`;\n    }\n    renderLayout(options) {\n        let { env, self, dynamicScope, args = EMPTY_ARGS, builder } = options;\n        let layout = this.asLayout();\n        let handle = layout.compile();\n        let vm = VM.initial(this.options.program, env, self, args, dynamicScope, builder, handle);\n        return new TemplateIterator(vm);\n    }\n    asLayout() {\n        if (this.layout) return this.layout;\n        return this.layout = compilable(this.parsedLayout, this.options, false);\n    }\n    asPartial() {\n        if (this.partial) return this.partial;\n        return this.partial = compilable(this.parsedLayout, this.options, true);\n    }\n}\nexport function compilable(layout, options, asPartial) {\n    let { block, referrer } = layout;\n    let { hasEval, symbols } = block;\n    let compileOptions = assign({}, options, { asPartial, referrer });\n    return new CompilableTemplate(block.statements, layout, compileOptions, { referrer, hasEval, symbols });\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGVtcGxhdGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci9ydW50aW1lL2xpYi90ZW1wbGF0ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFFQSxBQUFPLFNBQUUsQUFBTSxBQUFFLGNBQU0sQUFBZSxBQUFDO0FBU3ZDLEFBQU8sU0FBZ0MsQUFBRSxBQUFFLFVBQU0sQUFBTSxBQUFDO0FBQ3hELEFBQU8sU0FBRSxBQUFVLEFBQXNCLGtCQUFNLEFBQWdCLEFBQUM7QUFDaEUsQUFBTyxTQUNMLEFBQWtCLEFBR25CLDBCQUFNLEFBQTBCLEFBQUM7QUFxRWxDLEFBQU07QUFDSixnQkFBb0IsQUFBYztBQUFkLGFBQUUsS0FBRixBQUFFLEFBQVksQUFBRztBQUFDO0FBQ3RDLEFBQUk7QUFDRixBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQUUsR0FBQyxBQUFJLEFBQUUsQUFBQyxBQUN4QjtBQUFDLEFBQ0Y7O0FBRUQsSUFBSSxBQUFRLFdBQUcsQUFBQyxBQUFDO0FBU2pCLEFBQU0sQUFBQyxBQUFPLHdDQUEwQixFQUFFLEFBQUUsSUFBRSxBQUFVLFlBQUUsQUFBSSxNQUFFLEFBQUssQUFBd0M7QUFDM0csUUFBSSxBQUFvQyxBQUFDO0FBQ3pDLFFBQUksQUFBRSxLQUFHLEFBQVUsQUFBSSx3QkFBVSxBQUFRLEFBQUUsVUFBRSxBQUFDO0FBQzlDLFFBQUksQUFBTSxTQUFHLENBQUMsQUFBZ0MsU0FBRSxBQUFZO0FBQzFELFlBQUksQUFBTyxVQUFHLEFBQU8sVUFBRyxBQUFNLE9BQUMsQUFBRSxJQUFFLEFBQU8sU0FBRSxBQUFJLEFBQUMsUUFBRyxBQUFJLEFBQUM7QUFDekQsQUFBRSxBQUFDLFlBQUMsQ0FBQyxBQUFXLEFBQUMsYUFBQyxBQUFDO0FBQ2pCLEFBQVcsMEJBQUcsQUFBSSxLQUFDLEFBQUssTUFBQyxBQUFLLEFBQUMsQUFBQyxBQUNsQztBQUFDO0FBQ0QsQUFBTSxlQUFDLElBQUksQUFBaUIs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WyJpbXBvcnQgeyBPcGFxdWUsIE9wdGlvbiB9IGZyb20gJ0BnbGltbWVyL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgUGF0aFJlZmVyZW5jZSB9IGZyb20gJ0BnbGltbWVyL3JlZmVyZW5jZSc7XG5pbXBvcnQgeyBhc3NpZ24gfSBmcm9tICdAZ2xpbW1lci91dGlsJztcbmltcG9ydCB7XG4gIFNlcmlhbGl6ZWRUZW1wbGF0ZUJsb2NrLFxuICBTZXJpYWxpemVkVGVtcGxhdGVXaXRoTGF6eUJsb2NrLFxuICBTdGF0ZW1lbnRcbn0gZnJvbSAnQGdsaW1tZXIvd2lyZS1mb3JtYXQnO1xuaW1wb3J0IHsgRWxlbWVudEJ1aWxkZXIgfSBmcm9tICcuL3ZtL2VsZW1lbnQtYnVpbGRlcic7XG5pbXBvcnQgeyBEeW5hbWljU2NvcGUsIEVudmlyb25tZW50IH0gZnJvbSAnLi9lbnZpcm9ubWVudCc7XG5pbXBvcnQgeyBUb3BMZXZlbFN5bnRheCB9IGZyb20gJy4vc3ludGF4L2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgSXRlcmF0b3JSZXN1bHQsIFJlbmRlclJlc3VsdCwgVk0gfSBmcm9tICcuL3ZtJztcbmltcG9ydCB7IEVNUFRZX0FSR1MsIElDYXB0dXJlZEFyZ3VtZW50cyB9IGZyb20gJy4vdm0vYXJndW1lbnRzJztcbmltcG9ydCB7XG4gIENvbXBpbGFibGVUZW1wbGF0ZSxcbiAgUGFyc2VkTGF5b3V0LFxuICBUZW1wbGF0ZU9wdGlvbnNcbn0gZnJvbSBcIkBnbGltbWVyL29wY29kZS1jb21waWxlclwiO1xuaW1wb3J0IHsgUnVudGltZVByb2dyYW0gfSBmcm9tIFwiQGdsaW1tZXIvcHJvZ3JhbVwiO1xuXG5leHBvcnQgaW50ZXJmYWNlIFJlbmRlckxheW91dE9wdGlvbnMge1xuICBlbnY6IEVudmlyb25tZW50O1xuICBzZWxmOiBQYXRoUmVmZXJlbmNlPE9wYXF1ZT47XG4gIGFyZ3M/OiBJQ2FwdHVyZWRBcmd1bWVudHM7XG4gIGR5bmFtaWNTY29wZTogRHluYW1pY1Njb3BlO1xuICBidWlsZGVyOiBFbGVtZW50QnVpbGRlcjtcbn1cblxuLyoqXG4gKiBFbnZpcm9ubWVudCBzcGVjaWZpYyB0ZW1wbGF0ZS5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBUZW1wbGF0ZTxTcGVjaWZpZXIgPSBPcGFxdWU+IHtcbiAgLyoqXG4gICAqIFRlbXBsYXRlIGlkZW50aWZpZXIsIGlmIHByZWNvbXBpbGVkIHdpbGwgYmUgdGhlIGlkIG9mIHRoZVxuICAgKiBwcmVjb21waWxlZCB0ZW1wbGF0ZS5cbiAgICovXG4gIGlkOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRlbXBsYXRlIG1ldGEgKGJvdGggY29tcGlsZSB0aW1lIGFuZCBlbnZpcm9ubWVudCBzcGVjaWZpYykuXG4gICAqL1xuICByZWZlcnJlcjogU3BlY2lmaWVyO1xuXG4gIGhhc0V2YWw6IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIFN5bWJvbHMgY29tcHV0ZWQgYXQgY29tcGlsZSB0aW1lLlxuICAgKi9cbiAgc3ltYm9sczogc3RyaW5nW107XG5cbiAgcmVuZGVyTGF5b3V0KG9wdGlvbnM6IFJlbmRlckxheW91dE9wdGlvbnMpOiBUZW1wbGF0ZUl0ZXJhdG9yO1xuXG4gIC8vIGludGVybmFsIGNhc3RzLCB0aGVzZSBhcmUgbGF6aWx5IGNyZWF0ZWQgYW5kIGNhY2hlZFxuICBhc0xheW91dCgpOiBUb3BMZXZlbFN5bnRheDtcbiAgYXNQYXJ0aWFsKCk6IFRvcExldmVsU3ludGF4O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRlbXBsYXRlRmFjdG9yeTxTcGVjaWZpZXI+IHtcbiAgLyoqXG4gICAqIFRlbXBsYXRlIGlkZW50aWZpZXIsIGlmIHByZWNvbXBpbGVkIHdpbGwgYmUgdGhlIGlkIG9mIHRoZVxuICAgKiBwcmVjb21waWxlZCB0ZW1wbGF0ZS5cbiAgICovXG4gIGlkOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIENvbXBpbGUgdGltZSBtZXRhLlxuICAgKi9cbiAgbWV0YTogU3BlY2lmaWVyO1xuXG4gIC8qKlxuICAgKiBVc2VkIHRvIGNyZWF0ZSBhbiBlbnZpcm9ubWVudCBzcGVjaWZpYyBzaW5nbGV0b24gaW5zdGFuY2VcbiAgICogb2YgdGhlIHRlbXBsYXRlLlxuICAgKlxuICAgKiBAcGFyYW0ge0Vudmlyb25tZW50fSBlbnYgZ2xpbW1lciBFbnZpcm9ubWVudFxuICAgKi9cbiAgY3JlYXRlKGVudjogVGVtcGxhdGVPcHRpb25zPE9wYXF1ZT4pOiBUZW1wbGF0ZTxTcGVjaWZpZXI+O1xuICAvKipcbiAgICogVXNlZCB0byBjcmVhdGUgYW4gZW52aXJvbm1lbnQgc3BlY2lmaWMgc2luZ2xldG9uIGluc3RhbmNlXG4gICAqIG9mIHRoZSB0ZW1wbGF0ZS5cbiAgICpcbiAgICogQHBhcmFtIHtFbnZpcm9ubWVudH0gZW52IGdsaW1tZXIgRW52aXJvbm1lbnRcbiAgICogQHBhcmFtIHtPYmplY3R9IG1ldGEgZW52aXJvbm1lbnQgc3BlY2lmaWMgaW5qZWN0aW9ucyBpbnRvIG1ldGFcbiAgICovXG4gIGNyZWF0ZTxVPihlbnY6IFRlbXBsYXRlT3B0aW9uczxPcGFxdWU+LCBtZXRhOiBVKTogVGVtcGxhdGU8U3BlY2lmaWVyICYgVT47XG59XG5cbmV4cG9ydCBjbGFzcyBUZW1wbGF0ZUl0ZXJhdG9yIHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSB2bTogVk08T3BhcXVlPikge31cbiAgbmV4dCgpOiBJdGVyYXRvclJlc3VsdDxSZW5kZXJSZXN1bHQ+IHtcbiAgICByZXR1cm4gdGhpcy52bS5uZXh0KCk7XG4gIH1cbn1cblxubGV0IGNsaWVudElkID0gMDtcblxuLyoqXG4gKiBXcmFwcyBhIHRlbXBsYXRlIGpzIGluIGEgdGVtcGxhdGUgbW9kdWxlIHRvIGNoYW5nZSBpdCBpbnRvIGEgZmFjdG9yeVxuICogdGhhdCBoYW5kbGVzIGxhenkgcGFyc2luZyB0aGUgdGVtcGxhdGUgYW5kIHRvIGNyZWF0ZSBwZXIgZW52IHNpbmdsZXRvbnNcbiAqIG9mIHRoZSB0ZW1wbGF0ZS5cbiAqL1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gdGVtcGxhdGVGYWN0b3J5PFNwZWNpZmllcj4oc2VyaWFsaXplZFRlbXBsYXRlOiBTZXJpYWxpemVkVGVtcGxhdGVXaXRoTGF6eUJsb2NrPFNwZWNpZmllcj4pOiBUZW1wbGF0ZUZhY3Rvcnk8U3BlY2lmaWVyPjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHRlbXBsYXRlRmFjdG9yeTxTcGVjaWZpZXIsIFU+KHNlcmlhbGl6ZWRUZW1wbGF0ZTogU2VyaWFsaXplZFRlbXBsYXRlV2l0aExhenlCbG9jazxTcGVjaWZpZXI+KTogVGVtcGxhdGVGYWN0b3J5PFNwZWNpZmllciAmIFU+O1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gdGVtcGxhdGVGYWN0b3J5KHsgaWQ6IHRlbXBsYXRlSWQsIG1ldGEsIGJsb2NrIH06IFNlcmlhbGl6ZWRUZW1wbGF0ZVdpdGhMYXp5QmxvY2s8YW55Pik6IFRlbXBsYXRlRmFjdG9yeTx7fT4ge1xuICBsZXQgcGFyc2VkQmxvY2s6IFNlcmlhbGl6ZWRUZW1wbGF0ZUJsb2NrO1xuICBsZXQgaWQgPSB0ZW1wbGF0ZUlkIHx8IGBjbGllbnQtJHtjbGllbnRJZCsrfWA7XG4gIGxldCBjcmVhdGUgPSAob3B0aW9uczogVGVtcGxhdGVPcHRpb25zPE9wYXF1ZT4sIGVudk1ldGE/OiB7fSkgPT4ge1xuICAgIGxldCBuZXdNZXRhID0gZW52TWV0YSA/IGFzc2lnbih7fSwgZW52TWV0YSwgbWV0YSkgOiBtZXRhO1xuICAgIGlmICghcGFyc2VkQmxvY2spIHtcbiAgICAgIHBhcnNlZEJsb2NrID0gSlNPTi5wYXJzZShibG9jayk7XG4gICAgfVxuICAgIHJldHVybiBuZXcgU2Nhbm5hYmxlVGVtcGxhdGUob3B0aW9ucywgeyBpZCwgYmxvY2s6IHBhcnNlZEJsb2NrLCByZWZlcnJlcjogbmV3TWV0YSB9KTtcbiAgfTtcbiAgcmV0dXJuIHsgaWQsIG1ldGEsIGNyZWF0ZSB9O1xufVxuXG5leHBvcnQgY2xhc3MgU2Nhbm5hYmxlVGVtcGxhdGU8U3BlY2lmaWVyID0gT3BhcXVlPiBpbXBsZW1lbnRzIFRlbXBsYXRlPFNwZWNpZmllcj4ge1xuICBwcml2YXRlIGxheW91dDogT3B0aW9uPFRvcExldmVsU3ludGF4PiA9IG51bGw7XG4gIHByaXZhdGUgcGFydGlhbDogT3B0aW9uPFRvcExldmVsU3ludGF4PiA9IG51bGw7XG4gIHB1YmxpYyBzeW1ib2xzOiBzdHJpbmdbXTtcbiAgcHVibGljIGhhc0V2YWw6IGJvb2xlYW47XG4gIHB1YmxpYyBpZDogc3RyaW5nO1xuICBwdWJsaWMgcmVmZXJyZXI6IFNwZWNpZmllcjtcbiAgcHJpdmF0ZSBzdGF0ZW1lbnRzOiBTdGF0ZW1lbnRbXTtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIG9wdGlvbnM6IFRlbXBsYXRlT3B0aW9uczxTcGVjaWZpZXI+LCBwcml2YXRlIHBhcnNlZExheW91dDogUGFyc2VkTGF5b3V0PFNwZWNpZmllcj4pIHtcbiAgICBsZXQgeyBibG9jayB9ID0gcGFyc2VkTGF5b3V0O1xuICAgIHRoaXMuc3ltYm9scyA9IGJsb2NrLnN5bWJvbHM7XG4gICAgdGhpcy5oYXNFdmFsID0gYmxvY2suaGFzRXZhbDtcbiAgICB0aGlzLnN0YXRlbWVudHMgPSBibG9jay5zdGF0ZW1lbnRzO1xuICAgIHRoaXMucmVmZXJyZXIgPSBwYXJzZWRMYXlvdXQucmVmZXJyZXI7XG4gICAgdGhpcy5pZCA9IHBhcnNlZExheW91dC5pZCB8fCBgY2xpZW50LSR7Y2xpZW50SWQrK31gO1xuICB9XG5cbiAgcmVuZGVyTGF5b3V0KG9wdGlvbnM6IFJlbmRlckxheW91dE9wdGlvbnMpOiBUZW1wbGF0ZUl0ZXJhdG9yIHtcbiAgICBsZXQgeyBlbnYsIHNlbGYsIGR5bmFtaWNTY29wZSwgYXJncyA9IEVNUFRZX0FSR1MsIGJ1aWxkZXIgfSA9IG9wdGlvbnM7XG5cbiAgICBsZXQgbGF5b3V0ID0gdGhpcy5hc0xheW91dCgpO1xuICAgIGxldCBoYW5kbGUgPSBsYXlvdXQuY29tcGlsZSgpO1xuXG4gICAgbGV0IHZtID0gVk0uaW5pdGlhbCh0aGlzLm9wdGlvbnMucHJvZ3JhbSBhcyBhbnkgYXMgUnVudGltZVByb2dyYW08T3BhcXVlPiwgZW52LCBzZWxmLCBhcmdzLCBkeW5hbWljU2NvcGUsIGJ1aWxkZXIsIGhhbmRsZSk7XG4gICAgcmV0dXJuIG5ldyBUZW1wbGF0ZUl0ZXJhdG9yKHZtKTtcbiAgfVxuXG4gIGFzTGF5b3V0KCk6IFRvcExldmVsU3ludGF4IHtcbiAgICBpZiAodGhpcy5sYXlvdXQpIHJldHVybiB0aGlzLmxheW91dDtcbiAgICByZXR1cm4gdGhpcy5sYXlvdXQgPSBjb21waWxhYmxlKHRoaXMucGFyc2VkTGF5b3V0LCB0aGlzLm9wdGlvbnMsIGZhbHNlKTtcbiAgfVxuXG4gIGFzUGFydGlhbCgpOiBUb3BMZXZlbFN5bnRheCB7XG4gICAgaWYgKHRoaXMucGFydGlhbCkgcmV0dXJuIHRoaXMucGFydGlhbDtcbiAgICByZXR1cm4gdGhpcy5wYXJ0aWFsID0gY29tcGlsYWJsZSh0aGlzLnBhcnNlZExheW91dCwgdGhpcy5vcHRpb25zLCB0cnVlKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY29tcGlsYWJsZTxTcGVjaWZpZXI+KGxheW91dDogUGFyc2VkTGF5b3V0PFNwZWNpZmllcj4sIG9wdGlvbnM6IFRlbXBsYXRlT3B0aW9uczxPcGFxdWU+LCBhc1BhcnRpYWw6IGJvb2xlYW4pIHtcbiAgbGV0IHsgYmxvY2ssIHJlZmVycmVyIH0gPSBsYXlvdXQ7XG4gIGxldCB7IGhhc0V2YWwsIHN5bWJvbHMgfSA9IGJsb2NrO1xuICBsZXQgY29tcGlsZU9wdGlvbnMgPSBhc3NpZ24oe30sIG9wdGlvbnMsIHsgYXNQYXJ0aWFsLCByZWZlcnJlciB9KTtcblxuICByZXR1cm4gbmV3IENvbXBpbGFibGVUZW1wbGF0ZShibG9jay5zdGF0ZW1lbnRzLCBsYXlvdXQsIGNvbXBpbGVPcHRpb25zLCB7IHJlZmVycmVyLCBoYXNFdmFsLCBzeW1ib2xzIH0pO1xufVxuIl19","import { NewElementBuilder, RemoteBlockTracker } from \"./element-builder\";\nimport { bounds, Cursor } from '../bounds';\nimport { assert } from \"@glimmer/util\";\nimport { SVG_NAMESPACE } from '../dom/helper';\nexport class RehydratingCursor extends Cursor {\n    constructor(element, nextSibling, startingBlockDepth) {\n        super(element, nextSibling);\n        this.startingBlockDepth = startingBlockDepth;\n        this.candidate = null;\n        this.injectedOmittedNode = false;\n        this.openBlockDepth = startingBlockDepth - 1;\n    }\n}\nexport class RehydrateBuilder extends NewElementBuilder {\n    // private candidate: Option<Simple.Node> = null;\n    constructor(env, parentNode, nextSibling) {\n        super(env, parentNode, nextSibling);\n        this.unmatchedAttributes = null;\n        this.blockDepth = 0;\n        if (nextSibling) throw new Error(\"Rehydration with nextSibling not supported\");\n        this.candidate = this.currentCursor.element.firstChild;\n        (false && assert(this.candidate && isComment(this.candidate) && this.candidate.nodeValue === '%+block:0%', 'Must have opening comment <!--%+block:0%--> for rehydration.'));\n    }\n    get currentCursor() {\n        return this.cursorStack.current;\n    }\n    get candidate() {\n        if (this.currentCursor) {\n            return this.currentCursor.candidate;\n        }\n        return null;\n    }\n    set candidate(node) {\n        this.currentCursor.candidate = node;\n    }\n    pushElement(element, nextSibling) {\n        let { blockDepth = 0 } = this;\n        let cursor = new RehydratingCursor(element, nextSibling, blockDepth);\n        let currentCursor = this.currentCursor;\n        if (currentCursor) {\n            if (currentCursor.candidate) {\n                /**\n                 * <div>   <---------------  currentCursor.element\n                 *   <!--%+block:1%-->\n                 *   <div> <---------------  currentCursor.candidate -> cursor.element\n                 *     <!--%+block:2%--> <-  currentCursor.candidate.firstChild -> cursor.candidate\n                 *     Foo\n                 *     <!--%-block:2%-->\n                 *   </div>\n                 *   <!--%-block:1%-->  <--  becomes currentCursor.candidate\n                 */\n                // where to rehydrate from if we are in rehydration mode\n                cursor.candidate = element.firstChild;\n                // where to continue when we pop\n                currentCursor.candidate = element.nextSibling;\n            }\n        }\n        this.cursorStack.push(cursor);\n    }\n    clearMismatch(candidate) {\n        let current = candidate;\n        let currentCursor = this.currentCursor;\n        if (currentCursor !== null) {\n            let openBlockDepth = currentCursor.openBlockDepth;\n            if (openBlockDepth >= currentCursor.startingBlockDepth) {\n                while (current && !(isComment(current) && getCloseBlockDepth(current) === openBlockDepth)) {\n                    current = this.remove(current);\n                }\n                (false && assert(current !== null, 'should have found closing block'));\n            } else {\n                while (current !== null) {\n                    current = this.remove(current);\n                }\n            }\n            // current cursor parentNode should be openCandidate if element\n            // or openCandidate.parentNode if comment\n            currentCursor.nextSibling = current;\n            // disable rehydration until we popElement or closeBlock for openBlockDepth\n            currentCursor.candidate = null;\n        }\n    }\n    __openBlock() {\n        let { currentCursor } = this;\n        if (currentCursor === null) return;\n        let blockDepth = this.blockDepth;\n        this.blockDepth++;\n        let { candidate } = currentCursor;\n        if (candidate === null) return;\n        if (isComment(candidate) && getOpenBlockDepth(candidate) === blockDepth) {\n            currentCursor.candidate = this.remove(candidate);\n            currentCursor.openBlockDepth = blockDepth;\n        } else {\n            this.clearMismatch(candidate);\n        }\n    }\n    __closeBlock() {\n        let { currentCursor } = this;\n        if (currentCursor === null) return;\n        // openBlock is the last rehydrated open block\n        let openBlockDepth = currentCursor.openBlockDepth;\n        // this currently is the expected next open block depth\n        this.blockDepth--;\n        let { candidate } = currentCursor;\n        // rehydrating\n        if (candidate !== null) {\n            (false && assert(openBlockDepth === this.blockDepth, 'when rehydrating, openBlockDepth should match this.blockDepth here'));\n\n            if (isComment(candidate) && getCloseBlockDepth(candidate) === openBlockDepth) {\n                currentCursor.candidate = this.remove(candidate);\n                currentCursor.openBlockDepth--;\n            } else {\n                this.clearMismatch(candidate);\n            }\n            // if the openBlockDepth matches the blockDepth we just closed to\n            // then restore rehydration\n        }\n        if (currentCursor.openBlockDepth === this.blockDepth) {\n            (false && assert(currentCursor.nextSibling !== null && isComment(currentCursor.nextSibling) && getCloseBlockDepth(currentCursor.nextSibling) === openBlockDepth, \"expected close block to match rehydrated open block\"));\n\n            currentCursor.candidate = this.remove(currentCursor.nextSibling);\n            currentCursor.openBlockDepth--;\n        }\n    }\n    __appendNode(node) {\n        let { candidate } = this;\n        // This code path is only used when inserting precisely one node. It needs more\n        // comparison logic, but we can probably lean on the cases where this code path\n        // is actually used.\n        if (candidate) {\n            return candidate;\n        } else {\n            return super.__appendNode(node);\n        }\n    }\n    __appendHTML(html) {\n        let candidateBounds = this.markerBounds();\n        if (candidateBounds) {\n            let first = candidateBounds.firstNode();\n            let last = candidateBounds.lastNode();\n            let newBounds = bounds(this.element, first.nextSibling, last.previousSibling);\n            this.remove(first);\n            this.remove(last);\n            return newBounds;\n        } else {\n            return super.__appendHTML(html);\n        }\n    }\n    remove(node) {\n        let element = node.parentNode;\n        let next = node.nextSibling;\n        element.removeChild(node);\n        return next;\n    }\n    markerBounds() {\n        let _candidate = this.candidate;\n        if (_candidate && isMarker(_candidate)) {\n            let first = _candidate;\n            let last = first.nextSibling;\n            while (last && !isMarker(last)) {\n                last = last.nextSibling;\n            }\n            return bounds(this.element, first, last);\n        } else {\n            return null;\n        }\n    }\n    __appendText(string) {\n        let { candidate } = this;\n        if (candidate) {\n            if (isTextNode(candidate)) {\n                if (candidate.nodeValue !== string) {\n                    candidate.nodeValue = string;\n                }\n                this.candidate = candidate.nextSibling;\n                return candidate;\n            } else if (candidate && (isSeparator(candidate) || isEmpty(candidate))) {\n                this.candidate = candidate.nextSibling;\n                this.remove(candidate);\n                return this.__appendText(string);\n            } else if (isEmpty(candidate)) {\n                let next = this.remove(candidate);\n                this.candidate = next;\n                let text = this.dom.createTextNode(string);\n                this.dom.insertBefore(this.element, text, next);\n                return text;\n            } else {\n                this.clearMismatch(candidate);\n                return super.__appendText(string);\n            }\n        } else {\n            return super.__appendText(string);\n        }\n    }\n    __appendComment(string) {\n        let _candidate = this.candidate;\n        if (_candidate && isComment(_candidate)) {\n            if (_candidate.nodeValue !== string) {\n                _candidate.nodeValue = string;\n            }\n            this.candidate = _candidate.nextSibling;\n            return _candidate;\n        } else if (_candidate) {\n            this.clearMismatch(_candidate);\n        }\n        return super.__appendComment(string);\n    }\n    __openElement(tag) {\n        let _candidate = this.candidate;\n        if (_candidate && isElement(_candidate) && isSameNodeType(_candidate, tag)) {\n            this.unmatchedAttributes = [].slice.call(_candidate.attributes);\n            return _candidate;\n        } else if (_candidate) {\n            if (isElement(_candidate) && _candidate.tagName === 'TBODY') {\n                this.pushElement(_candidate, null);\n                this.currentCursor.injectedOmittedNode = true;\n                return this.__openElement(tag);\n            }\n            this.clearMismatch(_candidate);\n        }\n        return super.__openElement(tag);\n    }\n    __setAttribute(name, value, namespace) {\n        let unmatched = this.unmatchedAttributes;\n        if (unmatched) {\n            let attr = findByName(unmatched, name);\n            if (attr) {\n                if (attr.value !== value) {\n                    attr.value = value;\n                }\n                unmatched.splice(unmatched.indexOf(attr), 1);\n                return;\n            }\n        }\n        return super.__setAttribute(name, value, namespace);\n    }\n    __setProperty(name, value) {\n        let unmatched = this.unmatchedAttributes;\n        if (unmatched) {\n            let attr = findByName(unmatched, name);\n            if (attr) {\n                if (attr.value !== value) {\n                    attr.value = value;\n                }\n                unmatched.splice(unmatched.indexOf(attr), 1);\n                return;\n            }\n        }\n        return super.__setProperty(name, value);\n    }\n    __flushElement(parent, constructing) {\n        let { unmatchedAttributes: unmatched } = this;\n        if (unmatched) {\n            for (let i = 0; i < unmatched.length; i++) {\n                this.constructing.removeAttribute(unmatched[i].name);\n            }\n            this.unmatchedAttributes = null;\n        } else {\n            super.__flushElement(parent, constructing);\n        }\n    }\n    appendCautiousDynamicContent(value) {\n        let content = super.appendCautiousDynamicContent(value);\n        content.update(this.env, value);\n        return content;\n    }\n    willCloseElement() {\n        let { candidate, currentCursor } = this;\n        if (candidate !== null) {\n            this.clearMismatch(candidate);\n        }\n        if (currentCursor && currentCursor.injectedOmittedNode) {\n            this.popElement();\n        }\n        super.willCloseElement();\n    }\n    getMarker(element, guid) {\n        let marker = element.querySelector(`script[glmr=\"${guid}\"]`);\n        if (marker) {\n            return marker;\n        }\n        throw new Error('Cannot find serialized cursor for `in-element`');\n    }\n    __pushRemoteElement(element, cursorId, nextSibling = null) {\n        let marker = this.getMarker(element, cursorId);\n        if (marker.parentNode === element) {\n            let currentCursor = this.currentCursor;\n            let candidate = currentCursor.candidate;\n            this.pushElement(element, nextSibling);\n            currentCursor.candidate = candidate;\n            this.candidate = this.remove(marker);\n            let tracker = new RemoteBlockTracker(element);\n            this.pushBlockTracker(tracker, true);\n        }\n    }\n    didAppendBounds(bounds) {\n        super.didAppendBounds(bounds);\n        if (this.candidate) {\n            let last = bounds.lastNode();\n            this.candidate = last && last.nextSibling;\n        }\n        return bounds;\n    }\n}\nfunction isTextNode(node) {\n    return node.nodeType === 3;\n}\nfunction isComment(node) {\n    return node.nodeType === 8;\n}\nfunction getOpenBlockDepth(node) {\n    let boundsDepth = node.nodeValue.match(/^%\\+block:(\\d+)%$/);\n    if (boundsDepth && boundsDepth[1]) {\n        return Number(boundsDepth[1]);\n    } else {\n        return null;\n    }\n}\nfunction getCloseBlockDepth(node) {\n    let boundsDepth = node.nodeValue.match(/^%\\-block:(\\d+)%$/);\n    if (boundsDepth && boundsDepth[1]) {\n        return Number(boundsDepth[1]);\n    } else {\n        return null;\n    }\n}\nfunction isElement(node) {\n    return node.nodeType === 1;\n}\nfunction isMarker(node) {\n    return node.nodeType === 8 && node.nodeValue === '%glimmer%';\n}\nfunction isSeparator(node) {\n    return node.nodeType === 8 && node.nodeValue === '%sep%';\n}\nfunction isEmpty(node) {\n    return node.nodeType === 8 && node.nodeValue === '%empty%';\n}\nfunction isSameNodeType(candidate, tag) {\n    if (candidate.namespaceURI === SVG_NAMESPACE) {\n        return candidate.tagName === tag;\n    }\n    return candidate.tagName === tag.toUpperCase();\n}\nfunction findByName(array, name) {\n    for (let i = 0; i < array.length; i++) {\n        let attr = array[i];\n        if (attr.name === name) return attr;\n    }\n    return undefined;\n}\nexport function rehydrationBuilder(env, cursor) {\n    return RehydrateBuilder.forInitialRender(env, cursor);\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVoeWRyYXRlLWJ1aWxkZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci9ydW50aW1lL2xpYi92bS9yZWh5ZHJhdGUtYnVpbGRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxBQUFPLFNBQUUsQUFBaUIsbUJBQWtCLEFBQWtCLEFBQUUsMEJBQU0sQUFBbUIsQUFBQztBQUcxRixBQUFlLFNBQUUsQUFBTSxRQUFFLEFBQU0sQUFBRSxjQUFNLEFBQVcsQUFBQztBQUduRCxBQUFPLEFBQUUsQUFBTSxTQUFFLEFBQU0sQUFBUyxjQUFNLEFBQWUsQUFBQztBQUN0RCxBQUFPLFNBQUUsQUFBYSxBQUFFLHFCQUFNLEFBQWUsQUFBQztBQUU5QyxBQUFNLGFBQXlCLDBCQUFRLEFBQU07QUFJM0MsZ0JBQVksQUFBdUIsU0FBRSxBQUFnQyxhQUFrQixBQUEwQjtBQUMvRyxBQUFLLGNBQUMsQUFBTyxTQUFFLEFBQVcsQUFBQyxBQUFDO0FBRHlELGFBQWtCLHFCQUFsQixBQUFrQixBQUFRO0FBSGpILGFBQVMsWUFBd0IsQUFBSSxBQUFDO0FBRXRDLGFBQW1CLHNCQUFHLEFBQUssQUFBQztBQUcxQixBQUFJLGFBQUMsQUFBYyxpQkFBRyxBQUFrQixxQkFBRyxBQUFDLEFBQUMsQUFDL0M7QUFBQyxBQUNGOztBQUVELEFBQU0sYUFBd0IseUJBQVEsQUFBaUI7QUFLckQsQUFBaUQ7QUFFakQsZ0JBQVksQUFBZ0IsS0FBRSxBQUEwQixZQUFFLEFBQWdDO0FBQ3hGLEFBQUssY0FBQyxBQUFHLEtBQUUsQUFBVSxZQUFFLEFBQVcsQUFBQyxBQUFDO0FBUDlCLGFBQW1CLHNCQUErQixBQUFJLEFBQUM7QUFFdkQsYUFBVSxhQUFHLEFBQUMsQUFBQztBQU1yQixBQUFFLEFBQUMsWUFBQyxBQUFXLEFBQUMsYUFBQyxNQUFNLElBQUksQUFBSyxNQUFDLEFBQTRDLEFBQUMsQUFBQztBQUMvRSxBQUFJLGFBQUMs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RyxBQUFLLE1BQUMsQUFBQyxBQUFDLEFBQUM7QUFDcEIsQUFBRSxBQUFDLFlBQUMsQUFBSSxLQUFDLEFBQUksU0FBSyxBQUFJLEFBQUMsTUFBQyxBQUFNLE9BQUMsQUFBSSxBQUFDLEFBQ3RDO0FBQUM7QUFFRCxBQUFNLFdBQUMsQUFBUyxBQUFDLEFBQ25CO0FBQUM7QUFFRCxBQUFNLG1DQUE2QixBQUFnQixLQUFFLEFBQWM7QUFDakUsQUFBTSxXQUFDLEFBQWdCLGlCQUFDLEFBQWdCLGlCQUFDLEFBQUcsS0FBRSxBQUFNLEFBQUMsQUFBQyxBQUN4RDtBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV3RWxlbWVudEJ1aWxkZXIsIEVsZW1lbnRCdWlsZGVyLCBSZW1vdGVCbG9ja1RyYWNrZXIgfSBmcm9tIFwiLi9lbGVtZW50LWJ1aWxkZXJcIjtcblxuaW1wb3J0IHsgRW52aXJvbm1lbnQgfSBmcm9tICcuLi9lbnZpcm9ubWVudCc7XG5pbXBvcnQgQm91bmRzLCB7IGJvdW5kcywgQ3Vyc29yIH0gZnJvbSAnLi4vYm91bmRzJztcbmltcG9ydCB7IFNpbXBsZSwgT3B0aW9uLCBPcGFxdWUgfSBmcm9tIFwiQGdsaW1tZXIvaW50ZXJmYWNlc1wiO1xuaW1wb3J0IHsgRHluYW1pY0NvbnRlbnRXcmFwcGVyIH0gZnJvbSAnLi9jb250ZW50L2R5bmFtaWMnO1xuaW1wb3J0IHsgZXhwZWN0LCBhc3NlcnQsIFN0YWNrIH0gZnJvbSBcIkBnbGltbWVyL3V0aWxcIjtcbmltcG9ydCB7IFNWR19OQU1FU1BBQ0UgfSBmcm9tICcuLi9kb20vaGVscGVyJztcblxuZXhwb3J0IGNsYXNzIFJlaHlkcmF0aW5nQ3Vyc29yIGV4dGVuZHMgQ3Vyc29yIHtcbiAgY2FuZGlkYXRlOiBPcHRpb248U2ltcGxlLk5vZGU+ID0gbnVsbDtcbiAgb3BlbkJsb2NrRGVwdGg6IG51bWJlcjtcbiAgaW5qZWN0ZWRPbWl0dGVkTm9kZSA9IGZhbHNlO1xuICBjb25zdHJ1Y3RvcihlbGVtZW50OiBTaW1wbGUuRWxlbWVudCwgbmV4dFNpYmxpbmc6IE9wdGlvbjxTaW1wbGUuTm9kZT4sIHB1YmxpYyByZWFkb25seSBzdGFydGluZ0Jsb2NrRGVwdGg6IG51bWJlcikge1xuICAgIHN1cGVyKGVsZW1lbnQsIG5leHRTaWJsaW5nKTtcbiAgICB0aGlzLm9wZW5CbG9ja0RlcHRoID0gc3RhcnRpbmdCbG9ja0RlcHRoIC0gMTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgUmVoeWRyYXRlQnVpbGRlciBleHRlbmRzIE5ld0VsZW1lbnRCdWlsZGVyIGltcGxlbWVudHMgRWxlbWVudEJ1aWxkZXIge1xuICBwcml2YXRlIHVubWF0Y2hlZEF0dHJpYnV0ZXM6IE9wdGlvbjxTaW1wbGUuQXR0cmlidXRlW10+ID0gbnVsbDtcbiAgcHJvdGVjdGVkIGN1cnNvclN0YWNrOiBTdGFjazxSZWh5ZHJhdGluZ0N1cnNvcj47XG4gIHByaXZhdGUgYmxvY2tEZXB0aCA9IDA7XG5cbiAgLy8gcHJpdmF0ZSBjYW5kaWRhdGU6IE9wdGlvbjxTaW1wbGUuTm9kZT4gPSBudWxsO1xuXG4gIGNvbnN0cnVjdG9yKGVudjogRW52aXJvbm1lbnQsIHBhcmVudE5vZGU6IFNpbXBsZS5FbGVtZW50LCBuZXh0U2libGluZzogT3B0aW9uPFNpbXBsZS5Ob2RlPikge1xuICAgIHN1cGVyKGVudiwgcGFyZW50Tm9kZSwgbmV4dFNpYmxpbmcpO1xuICAgIGlmIChuZXh0U2libGluZykgdGhyb3cgbmV3IEVycm9yKFwiUmVoeWRyYXRpb24gd2l0aCBuZXh0U2libGluZyBub3Qgc3VwcG9ydGVkXCIpO1xuICAgIHRoaXMuY2FuZGlkYXRlID0gdGhpcy5jdXJyZW50Q3Vyc29yIS5lbGVtZW50LmZpcnN0Q2hpbGQ7XG4gICAgYXNzZXJ0KHRoaXMuY2FuZGlkYXRlICYmIGlzQ29tbWVudCh0aGlzLmNhbmRpZGF0ZSkgJiYgdGhpcy5jYW5kaWRhdGUubm9kZVZhbHVlID09PSAnJStibG9jazowJScsICdNdXN0IGhhdmUgb3BlbmluZyBjb21tZW50IDwhLS0lK2Jsb2NrOjAlLS0+IGZvciByZWh5ZHJhdGlvbi4nKTtcbiAgfVxuXG4gIGdldCBjdXJyZW50Q3Vyc29yKCk6IE9wdGlvbjxSZWh5ZHJhdGluZ0N1cnNvcj4ge1xuICAgIHJldHVybiB0aGlzLmN1cnNvclN0YWNrLmN1cnJlbnQ7XG4gIH1cblxuICBnZXQgY2FuZGlkYXRlKCk6IE9wdGlvbjxTaW1wbGUuTm9kZT4ge1xuICAgIGlmICh0aGlzLmN1cnJlbnRDdXJzb3IpIHtcbiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRDdXJzb3IuY2FuZGlkYXRlITtcbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHNldCBjYW5kaWRhdGUobm9kZTogT3B0aW9uPFNpbXBsZS5Ob2RlPikge1xuICAgIHRoaXMuY3VycmVudEN1cnNvciEuY2FuZGlkYXRlID0gbm9kZTtcbiAgfVxuXG4gIHB1c2hFbGVtZW50KGVsZW1lbnQ6IFNpbXBsZS5FbGVtZW50LCBuZXh0U2libGluZzogT3B0aW9uPFNpbXBsZS5Ob2RlPikge1xuICAgIGxldCB7IGJsb2NrRGVwdGggPSAwIH0gPSB0aGlzO1xuICAgIGxldCBjdXJzb3IgPSBuZXcgUmVoeWRyYXRpbmdDdXJzb3IoZWxlbWVudCwgbmV4dFNpYmxpbmcsIGJsb2NrRGVwdGgpO1xuICAgIGxldCBjdXJyZW50Q3Vyc29yID0gdGhpcy5jdXJyZW50Q3Vyc29yO1xuICAgIGlmIChjdXJyZW50Q3Vyc29yKSB7XG4gICAgICBpZiAoY3VycmVudEN1cnNvci5jYW5kaWRhdGUpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIDxkaXY+ICAgPC0tLS0tLS0tLS0tLS0tLSAgY3VycmVudEN1cnNvci5lbGVtZW50XG4gICAgICAgICAqICAgPCEtLSUrYmxvY2s6MSUtLT5cbiAgICAgICAgICogICA8ZGl2PiA8LS0tLS0tLS0tLS0tLS0tICBjdXJyZW50Q3Vyc29yLmNhbmRpZGF0ZSAtPiBjdXJzb3IuZWxlbWVudFxuICAgICAgICAgKiAgICAgPCEtLSUrYmxvY2s6MiUtLT4gPC0gIGN1cnJlbnRDdXJzb3IuY2FuZGlkYXRlLmZpcnN0Q2hpbGQgLT4gY3Vyc29yLmNhbmRpZGF0ZVxuICAgICAgICAgKiAgICAgRm9vXG4gICAgICAgICAqICAgICA8IS0tJS1ibG9jazoyJS0tPlxuICAgICAgICAgKiAgIDwvZGl2PlxuICAgICAgICAgKiAgIDwhLS0lLWJsb2NrOjElLS0+ICA8LS0gIGJlY29tZXMgY3VycmVudEN1cnNvci5jYW5kaWRhdGVcbiAgICAgICAgICovXG5cbiAgICAgICAgLy8gd2hlcmUgdG8gcmVoeWRyYXRlIGZyb20gaWYgd2UgYXJlIGluIHJlaHlkcmF0aW9uIG1vZGVcbiAgICAgICAgY3Vyc29yLmNhbmRpZGF0ZSA9IGVsZW1lbnQuZmlyc3RDaGlsZDtcbiAgICAgICAgLy8gd2hlcmUgdG8gY29udGludWUgd2hlbiB3ZSBwb3BcbiAgICAgICAgY3VycmVudEN1cnNvci5jYW5kaWRhdGUgPSBlbGVtZW50Lm5leHRTaWJsaW5nO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLmN1cnNvclN0YWNrLnB1c2goY3Vyc29yKTtcbiAgfVxuXG4gIHByaXZhdGUgY2xlYXJNaXNtYXRjaChjYW5kaWRhdGU6IFNpbXBsZS5Ob2RlKSB7XG4gICAgbGV0IGN1cnJlbnQ6IE9wdGlvbjxTaW1wbGUuTm9kZT4gPSBjYW5kaWRhdGU7XG4gICAgbGV0IGN1cnJlbnRDdXJzb3IgPSB0aGlzLmN1cnJlbnRDdXJzb3I7XG4gICAgaWYgKGN1cnJlbnRDdXJzb3IgIT09IG51bGwpIHtcbiAgICAgIGxldCBvcGVuQmxvY2tEZXB0aCA9IGN1cnJlbnRDdXJzb3Iub3BlbkJsb2NrRGVwdGg7XG4gICAgICBpZiAob3BlbkJsb2NrRGVwdGggPj0gY3VycmVudEN1cnNvci5zdGFydGluZ0Jsb2NrRGVwdGgpIHtcbiAgICAgICAgd2hpbGUgKGN1cnJlbnQgJiYgIShpc0NvbW1lbnQoY3VycmVudCkgJiYgZ2V0Q2xvc2VCbG9ja0RlcHRoKGN1cnJlbnQpID09PSBvcGVuQmxvY2tEZXB0aCkpIHtcbiAgICAgICAgICBjdXJyZW50ID0gdGhpcy5yZW1vdmUoY3VycmVudCk7XG4gICAgICAgIH1cbiAgICAgICAgYXNzZXJ0KGN1cnJlbnQgIT09IG51bGwsICdzaG91bGQgaGF2ZSBmb3VuZCBjbG9zaW5nIGJsb2NrJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB3aGlsZSAoY3VycmVudCAhPT0gbnVsbCkge1xuICAgICAgICAgIGN1cnJlbnQgPSB0aGlzLnJlbW92ZShjdXJyZW50KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgLy8gY3VycmVudCBjdXJzb3IgcGFyZW50Tm9kZSBzaG91bGQgYmUgb3BlbkNhbmRpZGF0ZSBpZiBlbGVtZW50XG4gICAgICAvLyBvciBvcGVuQ2FuZGlkYXRlLnBhcmVudE5vZGUgaWYgY29tbWVudFxuICAgICAgY3VycmVudEN1cnNvci5uZXh0U2libGluZyA9IGN1cnJlbnQ7XG4gICAgICAvLyBkaXNhYmxlIHJlaHlkcmF0aW9uIHVudGlsIHdlIHBvcEVsZW1lbnQgb3IgY2xvc2VCbG9jayBmb3Igb3BlbkJsb2NrRGVwdGhcbiAgICAgIGN1cnJlbnRDdXJzb3IuY2FuZGlkYXRlID0gbnVsbDtcbiAgICB9XG4gIH1cblxuICBfX29wZW5CbG9jaygpOiB2b2lkIHtcbiAgICBsZXQgeyBjdXJyZW50Q3Vyc29yIH0gPSB0aGlzO1xuICAgIGlmIChjdXJyZW50Q3Vyc29yID09PSBudWxsKSByZXR1cm47XG5cbiAgICBsZXQgYmxvY2tEZXB0aCA9IHRoaXMuYmxvY2tEZXB0aDtcblxuICAgIHRoaXMuYmxvY2tEZXB0aCsrO1xuXG4gICAgbGV0IHsgY2FuZGlkYXRlIH0gPSBjdXJyZW50Q3Vyc29yO1xuICAgIGlmIChjYW5kaWRhdGUgPT09IG51bGwpIHJldHVybjtcblxuICAgIGlmIChpc0NvbW1lbnQoY2FuZGlkYXRlKSAmJiBnZXRPcGVuQmxvY2tEZXB0aChjYW5kaWRhdGUpID09PSBibG9ja0RlcHRoKSB7XG4gICAgICBjdXJyZW50Q3Vyc29yLmNhbmRpZGF0ZSA9IHRoaXMucmVtb3ZlKGNhbmRpZGF0ZSk7XG4gICAgICBjdXJyZW50Q3Vyc29yLm9wZW5CbG9ja0RlcHRoID0gYmxvY2tEZXB0aDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jbGVhck1pc21hdGNoKGNhbmRpZGF0ZSk7XG4gICAgfVxuICB9XG5cbiAgX19jbG9zZUJsb2NrKCk6IHZvaWQge1xuICAgIGxldCB7IGN1cnJlbnRDdXJzb3IgfSA9IHRoaXM7XG4gICAgaWYgKGN1cnJlbnRDdXJzb3IgPT09IG51bGwpIHJldHVybjtcblxuICAgIC8vIG9wZW5CbG9jayBpcyB0aGUgbGFzdCByZWh5ZHJhdGVkIG9wZW4gYmxvY2tcbiAgICBsZXQgb3BlbkJsb2NrRGVwdGggPSBjdXJyZW50Q3Vyc29yLm9wZW5CbG9ja0RlcHRoO1xuXG4gICAgLy8gdGhpcyBjdXJyZW50bHkgaXMgdGhlIGV4cGVjdGVkIG5leHQgb3BlbiBibG9jayBkZXB0aFxuICAgIHRoaXMuYmxvY2tEZXB0aC0tO1xuXG4gICAgbGV0IHsgY2FuZGlkYXRlIH0gPSBjdXJyZW50Q3Vyc29yO1xuICAgIC8vIHJlaHlkcmF0aW5nXG4gICAgaWYgKGNhbmRpZGF0ZSAhPT0gbnVsbCkge1xuICAgICAgYXNzZXJ0KG9wZW5CbG9ja0RlcHRoID09PSB0aGlzLmJsb2NrRGVwdGgsICd3aGVuIHJlaHlkcmF0aW5nLCBvcGVuQmxvY2tEZXB0aCBzaG91bGQgbWF0Y2ggdGhpcy5ibG9ja0RlcHRoIGhlcmUnKTtcbiAgICAgIGlmIChpc0NvbW1lbnQoY2FuZGlkYXRlKSAmJlxuICAgICAgICAgIGdldENsb3NlQmxvY2tEZXB0aChjYW5kaWRhdGUpID09PSBvcGVuQmxvY2tEZXB0aFxuICAgICAgICApIHtcbiAgICAgICAgY3VycmVudEN1cnNvci5jYW5kaWRhdGUgPSB0aGlzLnJlbW92ZShjYW5kaWRhdGUpO1xuICAgICAgICBjdXJyZW50Q3Vyc29yLm9wZW5CbG9ja0RlcHRoLS07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmNsZWFyTWlzbWF0Y2goY2FuZGlkYXRlKTtcbiAgICAgIH1cbiAgICAvLyBpZiB0aGUgb3BlbkJsb2NrRGVwdGggbWF0Y2hlcyB0aGUgYmxvY2tEZXB0aCB3ZSBqdXN0IGNsb3NlZCB0b1xuICAgIC8vIHRoZW4gcmVzdG9yZSByZWh5ZHJhdGlvblxuICAgIH1cbiAgICBpZiAoY3VycmVudEN1cnNvci5vcGVuQmxvY2tEZXB0aCA9PT0gdGhpcy5ibG9ja0RlcHRoKSB7XG4gICAgICBhc3NlcnQoXG4gICAgICAgIGN1cnJlbnRDdXJzb3IubmV4dFNpYmxpbmcgIT09IG51bGwgJiZcbiAgICAgICAgaXNDb21tZW50KGN1cnJlbnRDdXJzb3IubmV4dFNpYmxpbmcpICYmXG4gICAgICAgIGdldENsb3NlQmxvY2tEZXB0aChjdXJyZW50Q3Vyc29yLm5leHRTaWJsaW5nKSA9PT0gb3BlbkJsb2NrRGVwdGgsIFwiZXhwZWN0ZWQgY2xvc2UgYmxvY2sgdG8gbWF0Y2ggcmVoeWRyYXRlZCBvcGVuIGJsb2NrXCIpO1xuICAgICAgY3VycmVudEN1cnNvci5jYW5kaWRhdGUgPSB0aGlzLnJlbW92ZShjdXJyZW50Q3Vyc29yLm5leHRTaWJsaW5nISk7XG4gICAgICBjdXJyZW50Q3Vyc29yLm9wZW5CbG9ja0RlcHRoLS07XG4gICAgfVxuICB9XG5cbiAgX19hcHBlbmROb2RlKG5vZGU6IFNpbXBsZS5Ob2RlKTogU2ltcGxlLk5vZGUge1xuICAgIGxldCB7IGNhbmRpZGF0ZSB9ID0gdGhpcztcblxuICAgIC8vIFRoaXMgY29kZSBwYXRoIGlzIG9ubHkgdXNlZCB3aGVuIGluc2VydGluZyBwcmVjaXNlbHkgb25lIG5vZGUuIEl0IG5lZWRzIG1vcmVcbiAgICAvLyBjb21wYXJpc29uIGxvZ2ljLCBidXQgd2UgY2FuIHByb2JhYmx5IGxlYW4gb24gdGhlIGNhc2VzIHdoZXJlIHRoaXMgY29kZSBwYXRoXG4gICAgLy8gaXMgYWN0dWFsbHkgdXNlZC5cbiAgICBpZiAoY2FuZGlkYXRlKSB7XG4gICAgICByZXR1cm4gY2FuZGlkYXRlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gc3VwZXIuX19hcHBlbmROb2RlKG5vZGUpO1xuICAgIH1cbiAgfVxuXG4gIF9fYXBwZW5kSFRNTChodG1sOiBzdHJpbmcpOiBCb3VuZHMge1xuICAgIGxldCBjYW5kaWRhdGVCb3VuZHMgPSB0aGlzLm1hcmtlckJvdW5kcygpO1xuXG4gICAgaWYgKGNhbmRpZGF0ZUJvdW5kcykge1xuICAgICAgbGV0IGZpcnN0ID0gY2FuZGlkYXRlQm91bmRzLmZpcnN0Tm9kZSgpITtcbiAgICAgIGxldCBsYXN0ID0gY2FuZGlkYXRlQm91bmRzLmxhc3ROb2RlKCkhO1xuXG4gICAgICBsZXQgbmV3Qm91bmRzID0gYm91bmRzKHRoaXMuZWxlbWVudCwgZmlyc3QubmV4dFNpYmxpbmchLCBsYXN0LnByZXZpb3VzU2libGluZyEpO1xuXG4gICAgICB0aGlzLnJlbW92ZShmaXJzdCk7XG4gICAgICB0aGlzLnJlbW92ZShsYXN0KTtcblxuICAgICAgcmV0dXJuIG5ld0JvdW5kcztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHN1cGVyLl9fYXBwZW5kSFRNTChodG1sKTtcbiAgICB9XG4gIH1cblxuICBwcm90ZWN0ZWQgcmVtb3ZlKG5vZGU6IFNpbXBsZS5Ob2RlKTogT3B0aW9uPFNpbXBsZS5Ob2RlPiB7XG4gICAgbGV0IGVsZW1lbnQgPSBleHBlY3Qobm9kZS5wYXJlbnROb2RlLCBgY2Fubm90IHJlbW92ZSBhIGRldGFjaGVkIG5vZGVgKSBhcyBTaW1wbGUuRWxlbWVudDtcbiAgICBsZXQgbmV4dCA9IG5vZGUubmV4dFNpYmxpbmc7XG4gICAgZWxlbWVudC5yZW1vdmVDaGlsZChub2RlKTtcbiAgICByZXR1cm4gbmV4dDtcbiAgfVxuXG4gIHByaXZhdGUgbWFya2VyQm91bmRzKCk6IE9wdGlvbjxCb3VuZHM+IHtcbiAgICBsZXQgX2NhbmRpZGF0ZSA9IHRoaXMuY2FuZGlkYXRlO1xuXG4gICAgaWYgKF9jYW5kaWRhdGUgJiYgaXNNYXJrZXIoX2NhbmRpZGF0ZSkpIHtcbiAgICAgIGxldCBmaXJzdCA9IF9jYW5kaWRhdGU7XG4gICAgICBsZXQgbGFzdCA9IGV4cGVjdChmaXJzdC5uZXh0U2libGluZywgYEJVRzogc2VyaWFsaXphdGlvbiBtYXJrZXJzIG11c3QgYmUgcGFpcmVkYCk7XG5cbiAgICAgIHdoaWxlIChsYXN0ICYmICFpc01hcmtlcihsYXN0KSkge1xuICAgICAgICBsYXN0ID0gZXhwZWN0KGxhc3QubmV4dFNpYmxpbmcsIGBCVUc6IHNlcmlhbGl6YXRpb24gbWFya2VycyBtdXN0IGJlIHBhaXJlZGApO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gYm91bmRzKHRoaXMuZWxlbWVudCwgZmlyc3QsIGxhc3QpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1cblxuICBfX2FwcGVuZFRleHQoc3RyaW5nOiBzdHJpbmcpOiBTaW1wbGUuVGV4dCB7XG4gICAgbGV0IHsgY2FuZGlkYXRlIH0gPSB0aGlzO1xuXG4gICAgaWYgKGNhbmRpZGF0ZSkge1xuICAgICAgaWYgKGlzVGV4dE5vZGUoY2FuZGlkYXRlKSkge1xuICAgICAgICBpZiAoY2FuZGlkYXRlLm5vZGVWYWx1ZSAhPT0gc3RyaW5nKSB7XG4gICAgICAgICAgY2FuZGlkYXRlLm5vZGVWYWx1ZSA9IHN0cmluZztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNhbmRpZGF0ZSA9IGNhbmRpZGF0ZS5uZXh0U2libGluZztcbiAgICAgICAgcmV0dXJuIGNhbmRpZGF0ZTtcbiAgICAgIH0gZWxzZSBpZiAoY2FuZGlkYXRlICYmIChpc1NlcGFyYXRvcihjYW5kaWRhdGUpIHx8IGlzRW1wdHkoY2FuZGlkYXRlKSkpIHtcbiAgICAgICAgdGhpcy5jYW5kaWRhdGUgPSBjYW5kaWRhdGUubmV4dFNpYmxpbmc7XG4gICAgICAgIHRoaXMucmVtb3ZlKGNhbmRpZGF0ZSk7XG4gICAgICAgIHJldHVybiB0aGlzLl9fYXBwZW5kVGV4dChzdHJpbmcpO1xuICAgICAgfSBlbHNlIGlmIChpc0VtcHR5KGNhbmRpZGF0ZSkpIHtcbiAgICAgICAgbGV0IG5leHQgPSB0aGlzLnJlbW92ZShjYW5kaWRhdGUpO1xuICAgICAgICB0aGlzLmNhbmRpZGF0ZSA9IG5leHQ7XG4gICAgICAgIGxldCB0ZXh0ID0gdGhpcy5kb20uY3JlYXRlVGV4dE5vZGUoc3RyaW5nKTtcbiAgICAgICAgdGhpcy5kb20uaW5zZXJ0QmVmb3JlKHRoaXMuZWxlbWVudCwgdGV4dCwgbmV4dCk7XG4gICAgICAgIHJldHVybiB0ZXh0O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5jbGVhck1pc21hdGNoKGNhbmRpZGF0ZSk7XG4gICAgICAgIHJldHVybiBzdXBlci5fX2FwcGVuZFRleHQoc3RyaW5nKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHN1cGVyLl9fYXBwZW5kVGV4dChzdHJpbmcpO1xuICAgIH1cbiAgfVxuXG4gIF9fYXBwZW5kQ29tbWVudChzdHJpbmc6IHN0cmluZyk6IFNpbXBsZS5Db21tZW50IHtcbiAgICBsZXQgX2NhbmRpZGF0ZSA9IHRoaXMuY2FuZGlkYXRlO1xuICAgIGlmIChfY2FuZGlkYXRlICYmIGlzQ29tbWVudChfY2FuZGlkYXRlKSkge1xuXG4gICAgICBpZiAoX2NhbmRpZGF0ZS5ub2RlVmFsdWUgIT09IHN0cmluZykge1xuICAgICAgICBfY2FuZGlkYXRlLm5vZGVWYWx1ZSA9IHN0cmluZztcbiAgICAgIH1cblxuICAgICAgdGhpcy5jYW5kaWRhdGUgPV9jYW5kaWRhdGUubmV4dFNpYmxpbmc7XG4gICAgICByZXR1cm4gX2NhbmRpZGF0ZTtcbiAgICB9IGVsc2UgaWYgKF9jYW5kaWRhdGUpIHtcbiAgICAgIHRoaXMuY2xlYXJNaXNtYXRjaChfY2FuZGlkYXRlKTtcbiAgICB9XG5cbiAgICByZXR1cm4gc3VwZXIuX19hcHBlbmRDb21tZW50KHN0cmluZyk7XG4gIH1cblxuICBfX29wZW5FbGVtZW50KHRhZzogc3RyaW5nKTogU2ltcGxlLkVsZW1lbnQge1xuICAgIGxldCBfY2FuZGlkYXRlID0gdGhpcy5jYW5kaWRhdGU7XG5cbiAgICBpZiAoX2NhbmRpZGF0ZSAmJiBpc0VsZW1lbnQoX2NhbmRpZGF0ZSkgJiYgaXNTYW1lTm9kZVR5cGUoX2NhbmRpZGF0ZSwgdGFnKSkge1xuICAgICAgdGhpcy51bm1hdGNoZWRBdHRyaWJ1dGVzID0gW10uc2xpY2UuY2FsbChfY2FuZGlkYXRlLmF0dHJpYnV0ZXMpO1xuICAgICAgcmV0dXJuIF9jYW5kaWRhdGU7XG4gICAgfSBlbHNlIGlmIChfY2FuZGlkYXRlKSB7XG4gICAgICBpZiAoaXNFbGVtZW50KF9jYW5kaWRhdGUpICYmIF9jYW5kaWRhdGUudGFnTmFtZSA9PT0gJ1RCT0RZJykge1xuICAgICAgICB0aGlzLnB1c2hFbGVtZW50KF9jYW5kaWRhdGUsIG51bGwpO1xuICAgICAgICB0aGlzLmN1cnJlbnRDdXJzb3IhLmluamVjdGVkT21pdHRlZE5vZGUgPSB0cnVlO1xuICAgICAgICByZXR1cm4gdGhpcy5fX29wZW5FbGVtZW50KHRhZyk7XG4gICAgICB9XG4gICAgICB0aGlzLmNsZWFyTWlzbWF0Y2goX2NhbmRpZGF0ZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHN1cGVyLl9fb3BlbkVsZW1lbnQodGFnKTtcbiAgfVxuXG4gIF9fc2V0QXR0cmlidXRlKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgbmFtZXNwYWNlOiBPcHRpb248c3RyaW5nPik6IHZvaWQge1xuICAgIGxldCB1bm1hdGNoZWQgPSB0aGlzLnVubWF0Y2hlZEF0dHJpYnV0ZXM7XG5cbiAgICBpZiAodW5tYXRjaGVkKSB7XG4gICAgICBsZXQgYXR0ciA9IGZpbmRCeU5hbWUodW5tYXRjaGVkLCBuYW1lKTtcbiAgICAgIGlmIChhdHRyKSB7XG4gICAgICAgIGlmIChhdHRyLnZhbHVlICE9PSB2YWx1ZSkge1xuICAgICAgICAgIGF0dHIudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICB1bm1hdGNoZWQuc3BsaWNlKHVubWF0Y2hlZC5pbmRleE9mKGF0dHIpLCAxKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBzdXBlci5fX3NldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSwgbmFtZXNwYWNlKTtcbiAgfVxuXG4gIF9fc2V0UHJvcGVydHkobmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKTogdm9pZCB7XG4gICAgbGV0IHVubWF0Y2hlZCA9IHRoaXMudW5tYXRjaGVkQXR0cmlidXRlcztcblxuICAgIGlmICh1bm1hdGNoZWQpIHtcbiAgICAgIGxldCBhdHRyID0gZmluZEJ5TmFtZSh1bm1hdGNoZWQsIG5hbWUpO1xuICAgICAgaWYgKGF0dHIpIHtcbiAgICAgICAgaWYgKGF0dHIudmFsdWUgIT09IHZhbHVlKSB7XG4gICAgICAgICAgYXR0ci52YWx1ZSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIHVubWF0Y2hlZC5zcGxpY2UodW5tYXRjaGVkLmluZGV4T2YoYXR0ciksIDEpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHN1cGVyLl9fc2V0UHJvcGVydHkobmFtZSwgdmFsdWUpO1xuICB9XG5cbiAgX19mbHVzaEVsZW1lbnQocGFyZW50OiBTaW1wbGUuRWxlbWVudCwgY29uc3RydWN0aW5nOiBTaW1wbGUuRWxlbWVudCk6IHZvaWQge1xuICAgIGxldCB7IHVubWF0Y2hlZEF0dHJpYnV0ZXM6IHVubWF0Y2hlZCB9ID0gdGhpcztcbiAgICBpZiAodW5tYXRjaGVkKSB7XG4gICAgICBmb3IgKGxldCBpPTA7IGk8dW5tYXRjaGVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRoaXMuY29uc3RydWN0aW5nIS5yZW1vdmVBdHRyaWJ1dGUodW5tYXRjaGVkW2ldLm5hbWUpO1xuICAgICAgfVxuICAgICAgdGhpcy51bm1hdGNoZWRBdHRyaWJ1dGVzID0gbnVsbDtcbiAgICB9IGVsc2Uge1xuICAgICAgc3VwZXIuX19mbHVzaEVsZW1lbnQocGFyZW50LCBjb25zdHJ1Y3RpbmcpO1xuICAgIH1cbiAgfVxuXG4gIGFwcGVuZENhdXRpb3VzRHluYW1pY0NvbnRlbnQodmFsdWU6IE9wYXF1ZSk6IER5bmFtaWNDb250ZW50V3JhcHBlciB7XG4gICAgbGV0IGNvbnRlbnQgPSBzdXBlci5hcHBlbmRDYXV0aW91c0R5bmFtaWNDb250ZW50KHZhbHVlKTtcbiAgICBjb250ZW50LnVwZGF0ZSh0aGlzLmVudiwgdmFsdWUpO1xuICAgIHJldHVybiBjb250ZW50O1xuICB9XG5cbiAgd2lsbENsb3NlRWxlbWVudCgpIHtcbiAgICBsZXQgeyBjYW5kaWRhdGUsIGN1cnJlbnRDdXJzb3IgfSA9IHRoaXM7XG5cbiAgICBpZiAoY2FuZGlkYXRlICE9PSBudWxsKSB7XG4gICAgICB0aGlzLmNsZWFyTWlzbWF0Y2goY2FuZGlkYXRlKTtcbiAgICB9XG5cbiAgICBpZiAoY3VycmVudEN1cnNvciAmJiBjdXJyZW50Q3Vyc29yLmluamVjdGVkT21pdHRlZE5vZGUpIHtcbiAgICAgIHRoaXMucG9wRWxlbWVudCgpO1xuICAgIH1cblxuICAgIHN1cGVyLndpbGxDbG9zZUVsZW1lbnQoKTtcbiAgfVxuXG4gIGdldE1hcmtlcihlbGVtZW50OiBIVE1MRWxlbWVudCwgZ3VpZDogc3RyaW5nKTogU2ltcGxlLk5vZGUge1xuICAgIGxldCBtYXJrZXIgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFtnbG1yPVwiJHtndWlkfVwiXWApO1xuICAgIGlmIChtYXJrZXIpIHtcbiAgICAgIHJldHVybiBtYXJrZXI7XG4gICAgfVxuXG4gICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgZmluZCBzZXJpYWxpemVkIGN1cnNvciBmb3IgYGluLWVsZW1lbnRgJyk7XG4gIH1cblxuICBfX3B1c2hSZW1vdGVFbGVtZW50KGVsZW1lbnQ6IFNpbXBsZS5FbGVtZW50LCBjdXJzb3JJZDogc3RyaW5nLCBuZXh0U2libGluZzogT3B0aW9uPFNpbXBsZS5Ob2RlPiA9IG51bGwpIHtcbiAgICBsZXQgbWFya2VyID0gdGhpcy5nZXRNYXJrZXIoZWxlbWVudCBhcyBIVE1MRWxlbWVudCwgY3Vyc29ySWQpO1xuXG4gICAgaWYgKG1hcmtlci5wYXJlbnROb2RlID09PSBlbGVtZW50KSB7XG4gICAgICBsZXQgY3VycmVudEN1cnNvciA9IHRoaXMuY3VycmVudEN1cnNvcjtcbiAgICAgIGxldCBjYW5kaWRhdGUgPSBjdXJyZW50Q3Vyc29yIS5jYW5kaWRhdGU7XG5cbiAgICAgIHRoaXMucHVzaEVsZW1lbnQoZWxlbWVudCwgbmV4dFNpYmxpbmcpO1xuXG4gICAgICBjdXJyZW50Q3Vyc29yIS5jYW5kaWRhdGUgPSBjYW5kaWRhdGU7XG4gICAgICB0aGlzLmNhbmRpZGF0ZSA9IHRoaXMucmVtb3ZlKG1hcmtlcik7XG5cbiAgICAgIGxldCB0cmFja2VyID0gbmV3IFJlbW90ZUJsb2NrVHJhY2tlcihlbGVtZW50KTtcbiAgICAgIHRoaXMucHVzaEJsb2NrVHJhY2tlcih0cmFja2VyLCB0cnVlKTtcbiAgICB9XG4gIH1cblxuICBkaWRBcHBlbmRCb3VuZHMoYm91bmRzOiBCb3VuZHMpOiBCb3VuZHMge1xuICAgIHN1cGVyLmRpZEFwcGVuZEJvdW5kcyhib3VuZHMpO1xuICAgIGlmICh0aGlzLmNhbmRpZGF0ZSkge1xuICAgICAgbGV0IGxhc3QgPSBib3VuZHMubGFzdE5vZGUoKTtcbiAgICAgIHRoaXMuY2FuZGlkYXRlID0gbGFzdCAmJiBsYXN0Lm5leHRTaWJsaW5nO1xuICAgIH1cbiAgICByZXR1cm4gYm91bmRzO1xuICB9XG59XG5cbmZ1bmN0aW9uIGlzVGV4dE5vZGUobm9kZTogU2ltcGxlLk5vZGUpOiBub2RlIGlzIFNpbXBsZS5UZXh0IHtcbiAgcmV0dXJuIG5vZGUubm9kZVR5cGUgPT09IDM7XG59XG5cbmZ1bmN0aW9uIGlzQ29tbWVudChub2RlOiBTaW1wbGUuTm9kZSk6IG5vZGUgaXMgU2ltcGxlLkNvbW1lbnQge1xuICByZXR1cm4gbm9kZS5ub2RlVHlwZSA9PT0gODtcbn1cblxuZnVuY3Rpb24gZ2V0T3BlbkJsb2NrRGVwdGgobm9kZTogU2ltcGxlLkNvbW1lbnQpOiBPcHRpb248bnVtYmVyPiB7XG4gIGxldCBib3VuZHNEZXB0aCA9IG5vZGUubm9kZVZhbHVlIS5tYXRjaCgvXiVcXCtibG9jazooXFxkKyklJC8pO1xuXG4gIGlmIChib3VuZHNEZXB0aCAmJiBib3VuZHNEZXB0aFsxXSkge1xuICAgIHJldHVybiBOdW1iZXIoYm91bmRzRGVwdGhbMV0gYXMgc3RyaW5nKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5mdW5jdGlvbiBnZXRDbG9zZUJsb2NrRGVwdGgobm9kZTogU2ltcGxlLkNvbW1lbnQpOiBPcHRpb248bnVtYmVyPiB7XG4gIGxldCBib3VuZHNEZXB0aCA9IG5vZGUubm9kZVZhbHVlIS5tYXRjaCgvXiVcXC1ibG9jazooXFxkKyklJC8pO1xuXG4gIGlmIChib3VuZHNEZXB0aCAmJiBib3VuZHNEZXB0aFsxXSkge1xuICAgIHJldHVybiBOdW1iZXIoYm91bmRzRGVwdGhbMV0gYXMgc3RyaW5nKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5mdW5jdGlvbiBpc0VsZW1lbnQobm9kZTogU2ltcGxlLk5vZGUpOiBub2RlIGlzIFNpbXBsZS5FbGVtZW50IHtcbiAgcmV0dXJuIG5vZGUubm9kZVR5cGUgPT09IDE7XG59XG5cbmZ1bmN0aW9uIGlzTWFya2VyKG5vZGU6IFNpbXBsZS5Ob2RlKTogYm9vbGVhbiB7XG4gIHJldHVybiBub2RlLm5vZGVUeXBlID09PSA4ICYmIG5vZGUubm9kZVZhbHVlID09PSAnJWdsaW1tZXIlJztcbn1cblxuZnVuY3Rpb24gaXNTZXBhcmF0b3Iobm9kZTogU2ltcGxlLk5vZGUpOiBib29sZWFuIHtcbiAgcmV0dXJuIG5vZGUubm9kZVR5cGUgPT09IDggJiYgbm9kZS5ub2RlVmFsdWUgPT09ICclc2VwJSc7XG59XG5cbmZ1bmN0aW9uIGlzRW1wdHkobm9kZTogU2ltcGxlLk5vZGUpOiBib29sZWFuIHtcbiAgcmV0dXJuIG5vZGUubm9kZVR5cGUgPT09IDggJiYgbm9kZS5ub2RlVmFsdWUgPT09ICclZW1wdHklJztcbn1cbmZ1bmN0aW9uIGlzU2FtZU5vZGVUeXBlKGNhbmRpZGF0ZTogU2ltcGxlLkVsZW1lbnQsIHRhZzogc3RyaW5nKSB7XG4gIGlmIChjYW5kaWRhdGUubmFtZXNwYWNlVVJJID09PSBTVkdfTkFNRVNQQUNFKSB7XG4gICAgcmV0dXJuIGNhbmRpZGF0ZS50YWdOYW1lID09PSB0YWc7XG4gIH1cbiAgcmV0dXJuIGNhbmRpZGF0ZS50YWdOYW1lID09PSB0YWcudG9VcHBlckNhc2UoKTtcbn1cblxuZnVuY3Rpb24gZmluZEJ5TmFtZShhcnJheTogU2ltcGxlLkF0dHJpYnV0ZVtdLCBuYW1lOiBzdHJpbmcpOiBTaW1wbGUuQXR0cmlidXRlIHwgdW5kZWZpbmVkIHtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuICAgIGxldCBhdHRyID0gYXJyYXlbaV07XG4gICAgaWYgKGF0dHIubmFtZSA9PT0gbmFtZSkgcmV0dXJuIGF0dHI7XG4gIH1cblxuICByZXR1cm4gdW5kZWZpbmVkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVoeWRyYXRpb25CdWlsZGVyKGVudjogRW52aXJvbm1lbnQsIGN1cnNvcjogQ3Vyc29yKTogRWxlbWVudEJ1aWxkZXIge1xuICByZXR1cm4gUmVoeWRyYXRlQnVpbGRlci5mb3JJbml0aWFsUmVuZGVyKGVudiwgY3Vyc29yKTtcbn1cbiJdfQ==","import {\n  dict\n} from \"@glimmer/util\";\nimport {\n  PathReference,\n  CONSTANT_TAG,\n  ConstReference,\n  DirtyableTag,\n  UpdatableTag,\n  combine,\n  isConst,\n  Tag,\n  TagWrapper\n} from \"@glimmer/reference\";\nimport {\n  ConditionalReference as GlimmerConditionalReference,\n  PrimitiveReference\n} from \"@glimmer/runtime\";\nimport { tagForProperty } from \"./tracked\";\n\n/**\n * The base PathReference.\n */\nexport abstract class ComponentPathReference<T> implements PathReference<T> {\n  abstract value(): T;\n  abstract get tag(): Tag;\n\n  get(key: string): PathReference<any> {\n    return PropertyReference.create(this, key);\n  }\n}\n\nexport abstract class CachedReference<T> extends ComponentPathReference<T> {\n  private _lastRevision: number | null = null;\n  private _lastValue: any = null;\n\n  abstract compute(): T;\n\n  value() {\n    let { tag, _lastRevision, _lastValue } = this;\n\n    if (!_lastRevision || !tag.validate(_lastRevision)) {\n      _lastValue = this._lastValue = this.compute();\n      this._lastRevision = tag.value();\n    }\n\n    return _lastValue;\n  }\n}\n\nexport class RootReference extends ConstReference<object> {\n  private children = dict<RootPropertyReference>();\n\n  get(propertyKey: string): RootPropertyReference{\n    let ref = this.children[propertyKey];\n\n    if (!ref) {\n      ref = this.children[propertyKey] = new RootPropertyReference(this.inner, propertyKey);\n    }\n\n    return ref;\n  }\n}\n\nexport abstract class PropertyReference extends CachedReference<any> {\n  static create(parentReference: PathReference<any>, propertyKey: string) {\n    if (isConst(parentReference)) {\n      return new RootPropertyReference(parentReference.value(), propertyKey);\n    } else {\n      return new NestedPropertyReference(parentReference, propertyKey);\n    }\n  }\n\n  get(key: string): PathReference<any>  {\n    return new NestedPropertyReference(this, key);\n  }\n}\n\nexport class RootPropertyReference extends PropertyReference {\n  tag: Tag;\n  private _parentValue: object;\n  private _propertyKey: string;\n\n  constructor(parentValue: object, propertyKey: string) {\n    super();\n\n    this._parentValue = parentValue;\n    this._propertyKey = propertyKey;\n    this.tag = tagForProperty(parentValue, propertyKey);\n  }\n\n  compute(): any {\n    return (this._parentValue as any)[this._propertyKey];\n  }\n}\n\nexport class NestedPropertyReference extends PropertyReference {\n  public tag: Tag;\n  private _parentReference: PathReference<any>;\n  private _parentObjectTag: TagWrapper<UpdatableTag>;\n  private _propertyKey: string;\n\n  constructor(parentReference: PathReference<any>, propertyKey: string) {\n    super();\n\n    let parentReferenceTag = parentReference.tag;\n    let parentObjectTag = UpdatableTag.create(CONSTANT_TAG);\n\n    this._parentReference = parentReference;\n    this._parentObjectTag = parentObjectTag;\n    this._propertyKey = propertyKey;\n\n    this.tag = combine([parentReferenceTag, parentObjectTag]);\n  }\n\n  compute() {\n    let { _parentReference, _parentObjectTag, _propertyKey } = this;\n\n    let parentValue = _parentReference.value();\n\n    _parentObjectTag.inner.update(tagForProperty(parentValue, _propertyKey));\n\n    if (typeof parentValue === \"string\" && _propertyKey === \"length\") {\n      return parentValue.length;\n    }\n\n    if (typeof parentValue === \"object\" && parentValue) {\n      return parentValue[_propertyKey];\n    } else {\n      return undefined;\n    }\n  }\n}\n\nexport class UpdatableReference<T> extends ComponentPathReference<T> {\n  public tag: TagWrapper<DirtyableTag>;\n  private _value: T;\n\n  constructor(value: T) {\n    super();\n\n    this.tag = DirtyableTag.create();\n    this._value = value;\n  }\n\n  value() {\n    return this._value;\n  }\n\n  update(value: T) {\n    let { _value } = this;\n\n    if (value !== _value) {\n      this.tag.inner.dirty();\n      this._value = value;\n    }\n  }\n}\n\nexport class ConditionalReference extends GlimmerConditionalReference {\n  static create(reference: PathReference<any>) {\n    if (isConst(reference)) {\n      let value = reference.value();\n      return PrimitiveReference.create(value);\n    }\n\n    return new ConditionalReference(reference);\n  }\n}\n","import {\n  getOwner,\n  setOwner,\n  Owner\n} from \"@glimmer/di\";\nimport {\n  Bounds as VMBounds,\n  ComponentManager as IComponentManager,\n  DynamicScope,\n  Environment,\n  Arguments,\n  CapturedArguments,\n  WithStaticLayout,\n  Invocation,\n} from \"@glimmer/runtime\";\nimport { Dict, Destroyable, Opaque, Option } from \"@glimmer/util\";\nimport { Tag } from \"@glimmer/reference\";\nimport { RuntimeResolver, ComponentCapabilities } from \"@glimmer/interfaces\";\nimport { VersionedPathReference } from '@glimmer/reference';\n\nimport Component from \"./component\";\nimport Bounds from './bounds';\nimport { DefinitionState } from \"./component-definition\";\nimport { RootReference } from \"./references\";\n\nexport interface ConstructorOptions {\n  env: Environment;\n}\n\nexport class ComponentStateBucket {\n  public name: string;\n  public component: Component;\n  private args: CapturedArguments;\n\n  constructor(definition: DefinitionState, args: CapturedArguments, owner: Owner) {\n    let componentFactory = definition.ComponentClass;\n    let name = definition.name;\n\n    this.args = args;\n\n    let injections = {\n      debugName: name,\n      args: this.namedArgsSnapshot()\n    };\n\n    setOwner(injections, owner);\n    this.component = componentFactory.create(injections);\n  }\n\n  get tag(): Tag {\n    return this.args.tag;\n  }\n\n  namedArgsSnapshot(): Readonly<Dict<Opaque>> {\n    return Object.freeze(this.args.named.value());\n  }\n}\n\nexport interface CompilableRuntimeResolver extends RuntimeResolver<Opaque> {\n  compileTemplate(name: string, layout: Option<number>): Invocation;\n}\n\nexport default class ComponentManager implements IComponentManager<ComponentStateBucket, DefinitionState>, WithStaticLayout<ComponentStateBucket, DefinitionState, Opaque, CompilableRuntimeResolver> {\n  private env: Environment;\n\n  static create(options: ConstructorOptions): ComponentManager {\n    return new ComponentManager(options);\n  }\n\n  constructor(options: ConstructorOptions) {\n    this.env = options.env;\n  }\n\n  prepareArgs(state: DefinitionState, args: Arguments): null {\n    return null;\n  }\n\n  getCapabilities(state: DefinitionState): ComponentCapabilities {\n    return state.capabilities;\n  }\n\n  getLayout({ name, layout }: DefinitionState, resolver: CompilableRuntimeResolver): Invocation {\n    return resolver.compileTemplate(name, layout);\n  }\n\n  create(_env: Environment, definition: DefinitionState, args: Arguments, _dynamicScope: DynamicScope, _caller: VersionedPathReference<Opaque>, _hasDefaultBlock: boolean): ComponentStateBucket {\n    let owner = getOwner(this.env);\n    return new ComponentStateBucket(definition, args.capture(), owner);\n  }\n\n  getSelf(bucket: ComponentStateBucket): RootReference {\n    return new RootReference(bucket.component);\n  }\n\n  didCreateElement(bucket: ComponentStateBucket, element: HTMLElement) { }\n\n  didRenderLayout(bucket: ComponentStateBucket, bounds: VMBounds) {\n    bucket.component.bounds = new Bounds(bounds);\n  }\n\n  didCreate(bucket: ComponentStateBucket) {\n    if (bucket) { bucket.component.didInsertElement(); }\n  }\n\n  getTag({ tag }: ComponentStateBucket): Tag {\n    return tag;\n  }\n\n  update(bucket: ComponentStateBucket, scope: DynamicScope) {\n    bucket.component.args = bucket.namedArgsSnapshot();\n  }\n\n  didUpdateLayout() {}\n\n  didUpdate({ component }: ComponentStateBucket) {\n    component.didUpdate();\n  }\n\n  getDestructor(bucket: ComponentStateBucket): Destroyable {\n    return bucket.component;\n  }\n}\n","export function EMPTY_CACHE() {}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci9vYmplY3QtcmVmZXJlbmNlL2xpYi91dGlscy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxBQUFNLDhCQUF5QixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIEVNUFRZX0NBQ0hFKCkge31cbiJdfQ==","import { EMPTY_CACHE } from '../utils';\nimport { dict } from '@glimmer/util';\nimport Meta from '../meta';\nimport { PropertyReference } from './descriptors';\nimport { VOLATILE_TAG } from '@glimmer/reference';\nexport default class PathReference {\n    constructor(parent, property) {\n        this.cache = EMPTY_CACHE;\n        this.inner = null;\n        this.chains = null;\n        this.lastParentValue = EMPTY_CACHE;\n        this._guid = 0;\n        this.tag = VOLATILE_TAG;\n        this.parent = parent;\n        this.property = property;\n    }\n    value() {\n        let { lastParentValue, property, inner } = this;\n        let parentValue = this._parentValue();\n        if (parentValue === null || parentValue === undefined) {\n            return this.cache = undefined;\n        }\n        if (lastParentValue === parentValue) {\n            inner = this.inner;\n        } else {\n            let ReferenceType = typeof parentValue === 'object' ? Meta.for(parentValue).referenceTypeFor(property) : PropertyReference;\n            inner = this.inner = new ReferenceType(parentValue, property, this);\n        }\n        // if (typeof parentValue === 'object') {\n        //   Meta.for(parentValue).addReference(property, this);\n        // }\n        return this.cache = inner.value();\n    }\n    get(prop) {\n        let chains = this._getChains();\n        if (prop in chains) return chains[prop];\n        return chains[prop] = new PathReference(this, prop);\n    }\n    label() {\n        return '[reference Direct]';\n    }\n    _getChains() {\n        if (this.chains) return this.chains;\n        return this.chains = dict();\n    }\n    _parentValue() {\n        let parent = this.parent.value();\n        this.lastParentValue = parent;\n        return parent;\n    }\n}\nexport { PathReference };\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGF0aC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL29iamVjdC1yZWZlcmVuY2UvbGliL3JlZmVyZW5jZXMvcGF0aC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxBQUFPLFNBQUUsQUFBVyxBQUFFLG1CQUFNLEFBQVUsQUFBQztBQUN2QyxBQUFPLFNBQUUsQUFBSSxBQUFFLFlBQU0sQUFBZSxBQUFDO0FBQ3JDLE9BQU8sQUFBSSxVQUFNLEFBQVMsQUFBQztBQUMzQixBQUFPLFNBQUUsQUFBaUIsQUFBRSx5QkFBTSxBQUFlLEFBQUM7QUFDbEQsQUFBTyxTQUFFLEFBQVksQUFBbUQsb0JBQU0sQUFBb0IsQUFBQztBQUluRyxBQUFNLEFBQUMsQUFBTztBQVVaLGdCQUFZLEFBQXlCLFFBQUUsQUFBZ0I7QUFQN0MsYUFBSyxRQUFRLEFBQVcsQUFBQztBQUMzQixhQUFLLFFBQXlCLEFBQUksQUFBQztBQUNuQyxhQUFNLFNBQXFDLEFBQUksQUFBQztBQUNoRCxhQUFlLGtCQUFRLEFBQVcsQUFBQztBQUNwQyxhQUFLLFFBQUcsQUFBQyxBQUFDO0FBQ1YsYUFBRyxNQUFRLEFBQVksQUFBQztBQUc3QixBQUFJLGFBQUMsQUFBTSxTQUFHLEFBQU0sQUFBQztBQUNyQixBQUFJLGFBQUMsQUFBUSxXQUFHLEFBQVEsQUFBQyxBQUMzQjtBQUFDO0FBRUQsQUFBSztBQUNILFlBQUksRUFBRSxBQUFlLGlCQUFFLEFBQVEsVUFBRSxBQUFLLEFBQUUsVUFBRyxBQUFJLEFBQUM7QUFDaEQsWUFBSSxBQUFXLGNBQUcsQUFBSSxLQUFDLEFBQVksQUFBRSxBQUFDO0FBRXRDLEFBQUUsQUFBQyxZQUFDLEFBQVcsZ0JBQUssQUFBSSxRQUFJLEFBQVcsZ0JBQUssQUFBUyxBQUFDLFdBQUMsQUFBQztBQUN0RCxBQUFNLEFBQUMsbUJBQUMsQUFBSSxLQUFDLEFBQUssUUFBRyxBQUFTLEFBQUMsQUFBQyxBQUNsQztBQUFDO0FBRUQsQUFBRSxBQUFDLFlBQUMsQUFBZSxvQkFBSyxBQUFXLEFBQUMsYUFBQyxBQUFDO0FBQ3BDLEFBQUssb0JBQUcsQUFBSSxLQUFDLEFBQUssQUFBQyxBQUNyQjtBQUFDLEFBQUMsQUFBSSxlQUFDLEFBQUM7QUFDTixnQkFBSSxBQUFhLGdCQUFHLE9BQU8sQUFBVyxnQkFBSyxBQUFRLFdBQUcsQUFBSSxLQUFDLEFBQUcsSUFBQyxBQUFXLEFBQUMsYUFBQyxBQUFnQixpQkFBQyxBQUFRLEFBQUMsWUFBRyxBQUFpQixBQUFDO0FBQzNILEFBQUssb0JBQUcsQUFBSSxLQUFDLEFBQUssUUFBRyxJQUFJLEFBQWEsY0FBQyxBQUFXLGFBQUUsQUFBUSxVQUFFLEFBQUksQUFBQyxBQUFDLEFBQ3RFO0FBQUM7QUFFRCxBQUF5QztBQUN6QyxBQUF3RDtBQUN4RCxBQUFJO0FBRUosQUFBTSxBQUFDLGVBQUMsQUFBSSxLQUFDLEFBQUssUUFBRyxBQUFNLE1BQUMsQUFBSyxBQUFFLEFBQUMsQUFBQyxBQUN2QztBQUFDO0FBRUQsQUFBRyxRQUFDLEFBQVk7QUFDZCxZQUFJLEFBQU0sU0FBRyxBQUFJLEtBQUMsQUFBVSxBQUFFLEFBQUM7QUFDL0IsQUFBRSxBQUFDLFlBQUMsQUFBYyxRQUFJLEFBQU0sQUFBQyxRQUFDLEFBQU0sT0FBQyxBQUFNLE9BQUMsQUFBSSxBQUFDLEFBQUM7QUFDbEQsQUFBTSxBQUFDLGVBQUMsQUFBTSxPQUFDLEFBQUksQUFBQyxRQUFHLElBQUksQUFBYSxjQUFDLEFBQUksTUFBRSxBQUFJLEFBQUMsQUFBQyxBQUFDLEFBQ3hEO0FBQUM7QUFFRCxBQUFLO0FBQ0gsQUFBTSxlQUFDLEFBQW9CLEFBQUMsQUFDOUI7QUFBQztBQUVPLEFBQVU7QUFDaEIsQUFBRSxBQUFDLFlBQUMsQUFBSSxLQUFDLEFBQU0sQUFBQyxRQUFDLEFBQU0sT0FBQyxBQUFJLEtBQUMsQUFBTSxBQUFDO0FBQ3BDLEFBQU0sQUFBQyxlQUFDLEFBQUksS0FBQyxBQUFNLFNBQUcsQUFBSSxBQUFzQixBQUFDLEFBQUMsQUFDcEQ7QUFBQztBQUVPLEFBQVk7QUFDbEIsWUFBSSxBQUFNLFNBQUcsQUFBSSxLQUFDLEFBQU0sT0FBQyxBQUFLLEFBQUUsQUFBQztBQUNqQyxBQUFJLGFBQUMsQUFBZSxrQkFBRyxBQUFNLEFBQUM7QUFDOUIsQUFBTSxlQUFDLEFBQU0sQUFBQyxBQUNoQjtBQUFDLEFBQ0Y7O0FBRUQsQUFBTyxTQUFFLEFBQWEsQUFBRSxBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRU1QVFlfQ0FDSEUgfSBmcm9tICcuLi91dGlscyc7XG5pbXBvcnQgeyBkaWN0IH0gZnJvbSAnQGdsaW1tZXIvdXRpbCc7XG5pbXBvcnQgTWV0YSBmcm9tICcuLi9tZXRhJztcbmltcG9ydCB7IFByb3BlcnR5UmVmZXJlbmNlIH0gZnJvbSAnLi9kZXNjcmlwdG9ycyc7XG5pbXBvcnQgeyBWT0xBVElMRV9UQUcsIFBhdGhSZWZlcmVuY2UgYXMgSVBhdGhSZWZlcmVuY2UsIFJlZmVyZW5jZSwgVGFnIH0gZnJvbSAnQGdsaW1tZXIvcmVmZXJlbmNlJztcbmltcG9ydCB7IERpY3QsIEhhc0d1aWQgfSBmcm9tICdAZ2xpbW1lci91dGlsJztcbmltcG9ydCB7IE9wdGlvbiB9IGZyb20gXCJAZ2xpbW1lci9pbnRlcmZhY2VzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBhdGhSZWZlcmVuY2U8VD4gaW1wbGVtZW50cyBJUGF0aFJlZmVyZW5jZTxUPiwgSGFzR3VpZCB7XG4gIHByaXZhdGUgcGFyZW50OiBJUGF0aFJlZmVyZW5jZTxhbnk+O1xuICBwcml2YXRlIHByb3BlcnR5OiBzdHJpbmc7XG4gIHByb3RlY3RlZCBjYWNoZTogYW55ID0gRU1QVFlfQ0FDSEU7XG4gIHByaXZhdGUgaW5uZXI6IE9wdGlvbjxSZWZlcmVuY2U8VD4+ID0gbnVsbDtcbiAgcHJpdmF0ZSBjaGFpbnM6IE9wdGlvbjxEaWN0PFBhdGhSZWZlcmVuY2U8YW55Pj4+ID0gbnVsbDtcbiAgcHJpdmF0ZSBsYXN0UGFyZW50VmFsdWU6IGFueSA9IEVNUFRZX0NBQ0hFO1xuICBwdWJsaWMgX2d1aWQgPSAwO1xuICBwdWJsaWMgdGFnOiBUYWcgPSBWT0xBVElMRV9UQUc7XG5cbiAgY29uc3RydWN0b3IocGFyZW50OiBJUGF0aFJlZmVyZW5jZTxUPiwgcHJvcGVydHk6IHN0cmluZykge1xuICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICAgIHRoaXMucHJvcGVydHkgPSBwcm9wZXJ0eTtcbiAgfVxuXG4gIHZhbHVlKCk6IGFueSB7XG4gICAgbGV0IHsgbGFzdFBhcmVudFZhbHVlLCBwcm9wZXJ0eSwgaW5uZXIgfSA9IHRoaXM7XG4gICAgbGV0IHBhcmVudFZhbHVlID0gdGhpcy5fcGFyZW50VmFsdWUoKTtcblxuICAgIGlmIChwYXJlbnRWYWx1ZSA9PT0gbnVsbCB8fCBwYXJlbnRWYWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gKHRoaXMuY2FjaGUgPSB1bmRlZmluZWQpO1xuICAgIH1cblxuICAgIGlmIChsYXN0UGFyZW50VmFsdWUgPT09IHBhcmVudFZhbHVlKSB7XG4gICAgICBpbm5lciA9IHRoaXMuaW5uZXI7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBSZWZlcmVuY2VUeXBlID0gdHlwZW9mIHBhcmVudFZhbHVlID09PSAnb2JqZWN0JyA/IE1ldGEuZm9yKHBhcmVudFZhbHVlKS5yZWZlcmVuY2VUeXBlRm9yKHByb3BlcnR5KSA6IFByb3BlcnR5UmVmZXJlbmNlO1xuICAgICAgaW5uZXIgPSB0aGlzLmlubmVyID0gbmV3IFJlZmVyZW5jZVR5cGUocGFyZW50VmFsdWUsIHByb3BlcnR5LCB0aGlzKTtcbiAgICB9XG5cbiAgICAvLyBpZiAodHlwZW9mIHBhcmVudFZhbHVlID09PSAnb2JqZWN0Jykge1xuICAgIC8vICAgTWV0YS5mb3IocGFyZW50VmFsdWUpLmFkZFJlZmVyZW5jZShwcm9wZXJ0eSwgdGhpcyk7XG4gICAgLy8gfVxuXG4gICAgcmV0dXJuICh0aGlzLmNhY2hlID0gaW5uZXIhLnZhbHVlKCkpO1xuICB9XG5cbiAgZ2V0KHByb3A6IHN0cmluZyk6IElQYXRoUmVmZXJlbmNlPGFueT4ge1xuICAgIGxldCBjaGFpbnMgPSB0aGlzLl9nZXRDaGFpbnMoKTtcbiAgICBpZiAocHJvcCBhcyBzdHJpbmcgaW4gY2hhaW5zKSByZXR1cm4gY2hhaW5zW3Byb3BdO1xuICAgIHJldHVybiAoY2hhaW5zW3Byb3BdID0gbmV3IFBhdGhSZWZlcmVuY2UodGhpcywgcHJvcCkpO1xuICB9XG5cbiAgbGFiZWwoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gJ1tyZWZlcmVuY2UgRGlyZWN0XSc7XG4gIH1cblxuICBwcml2YXRlIF9nZXRDaGFpbnMoKTogRGljdDxQYXRoUmVmZXJlbmNlPGFueT4+IHtcbiAgICBpZiAodGhpcy5jaGFpbnMpIHJldHVybiB0aGlzLmNoYWlucztcbiAgICByZXR1cm4gKHRoaXMuY2hhaW5zID0gZGljdDxQYXRoUmVmZXJlbmNlPGFueT4+KCkpO1xuICB9XG5cbiAgcHJpdmF0ZSBfcGFyZW50VmFsdWUoKSB7XG4gICAgbGV0IHBhcmVudCA9IHRoaXMucGFyZW50LnZhbHVlKCk7XG4gICAgdGhpcy5sYXN0UGFyZW50VmFsdWUgPSBwYXJlbnQ7XG4gICAgcmV0dXJuIHBhcmVudDtcbiAgfVxufVxuXG5leHBvcnQgeyBQYXRoUmVmZXJlbmNlIH07XG4iXX0=","import { dict } from '@glimmer/util';\nimport { PathReference } from './path';\nimport { VOLATILE_TAG } from '@glimmer/reference';\nexport default class RootReference {\n    constructor(object) {\n        this.chains = dict();\n        this.tag = VOLATILE_TAG;\n        this.object = object;\n    }\n    value() {\n        return this.object;\n    }\n    update(object) {\n        this.object = object;\n        // this.notify();\n    }\n    get(prop) {\n        let chains = this.chains;\n        if (prop in chains) return chains[prop];\n        return chains[prop] = new PathReference(this, prop);\n    }\n    chainFor(prop) {\n        let chains = this.chains;\n        if (prop in chains) return chains[prop];\n        return null;\n    }\n    path(string) {\n        return this.referenceFromParts(string.split('.'));\n    }\n    referenceFromParts(parts) {\n        return parts.reduce((ref, part) => ref.get(part), this);\n    }\n    label() {\n        return '[reference Root]';\n    }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm9vdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL29iamVjdC1yZWZlcmVuY2UvbGliL3JlZmVyZW5jZXMvcm9vdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxBQUFPLFNBQWtCLEFBQUksQUFBRSxZQUFNLEFBQWUsQUFBQztBQUNyRCxBQUFPLFNBQUUsQUFBYSxBQUFFLHFCQUFNLEFBQVEsQUFBQztBQUV2QyxBQUFPLFNBQUUsQUFBWSxBQUF3QyxvQkFBTSxBQUFvQixBQUFDO0FBRXhGLEFBQU0sQUFBQyxBQUFPO0FBS1osZ0JBQVksQUFBUztBQUhiLGFBQU0sU0FBRyxBQUFJLEFBQXNCLEFBQUM7QUFDckMsYUFBRyxNQUFRLEFBQVksQUFBQztBQUc3QixBQUFJLGFBQUMsQUFBTSxTQUFHLEFBQU0sQUFBQyxBQUN2QjtBQUFDO0FBRUQsQUFBSztBQUFRLEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBTSxBQUFDLEFBQUM7QUFBQztBQUVsQyxBQUFNLFdBQUMsQUFBUztBQUNkLEFBQUksYUFBQyxBQUFNLFNBQUcsQUFBTSxBQUFDO0FBQ3JCLEFBQWlCLEFBQ25CO0FBQUM7QUFFRCxBQUFHLFFBQUksQUFBWTtBQUNqQixZQUFJLEFBQU0sU0FBRyxBQUFJLEtBQUMsQUFBTSxBQUFDO0FBQ3pCLEFBQUUsQUFBQyxZQUFDLEFBQWMsUUFBSSxBQUFNLEFBQUMsUUFBQyxBQUFNLE9BQUMsQUFBTSxPQUFDLEFBQUksQUFBQyxBQUFDO0FBQ2xELEFBQU0sQUFBQyxlQUFDLEFBQU0sT0FBQyxBQUFJLEFBQUMsUUFBRyxJQUFJLEFBQWEsY0FBQyxBQUFJLE1BQUUsQUFBSSxBQUFDLEFBQUMsQUFBQyxBQUN4RDtBQUFDO0FBRUQsQUFBUSxhQUFJLEFBQVk7QUFDdEIsWUFBSSxBQUFNLFNBQUcsQUFBSSxLQUFDLEFBQU0sQUFBQztBQUN6QixBQUFFLEFBQUMsWUFBQyxBQUFjLFFBQUksQUFBTSxBQUFDLFFBQUMsQUFBTSxPQUFDLEFBQU0sT0FBQyxBQUFJLEFBQUMsQUFBQztBQUNsRCxBQUFNLGVBQUMsQUFBSSxBQUFDLEFBQ2Q7QUFBQztBQUVELEFBQUksU0FBQyxBQUFjO0FBQ2pCLEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBa0IsbUJBQUMsQUFBTSxPQUFDLEFBQUssTUFBQyxBQUFHLEFBQUMsQUFBQyxBQUFDLEFBQ3BEO0FBQUM7QUFFRCxBQUFrQix1QkFBQyxBQUFlO0FBQ2hDLEFBQU0sZUFBQyxBQUFLLE1BQUMsQUFBTSxPQUFDLENBQUMsQUFBRyxLQUFFLEFBQUksU0FBSyxBQUFHLElBQUMsQUFBRyxJQUFDLEFBQUksQUFBMkIsT0FBRSxBQUE4QixBQUFDLEFBQUMsQUFDOUc7QUFBQztBQUVELEFBQUs7QUFDSCxBQUFNLGVBQUMsQUFBa0IsQUFBQyxBQUM1QjtBQUFDLEFBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBPcHRpb24sIE9wYXF1ZSwgZGljdCB9IGZyb20gJ0BnbGltbWVyL3V0aWwnO1xuaW1wb3J0IHsgUGF0aFJlZmVyZW5jZSB9IGZyb20gJy4vcGF0aCc7XG5pbXBvcnQgeyBSb290UmVmZXJlbmNlIGFzIElSb290UmVmZXJlbmNlIH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgVk9MQVRJTEVfVEFHLCBQYXRoUmVmZXJlbmNlIGFzIElQYXRoUmVmZXJlbmNlLCBUYWcgfSBmcm9tICdAZ2xpbW1lci9yZWZlcmVuY2UnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSb290UmVmZXJlbmNlPFQ+IGltcGxlbWVudHMgSVJvb3RSZWZlcmVuY2U8VD4sIElQYXRoUmVmZXJlbmNlPFQ+IHtcbiAgcHJpdmF0ZSBvYmplY3Q6IFQ7XG4gIHByaXZhdGUgY2hhaW5zID0gZGljdDxQYXRoUmVmZXJlbmNlPGFueT4+KCk7XG4gIHB1YmxpYyB0YWc6IFRhZyA9IFZPTEFUSUxFX1RBRztcblxuICBjb25zdHJ1Y3RvcihvYmplY3Q6IFQpIHtcbiAgICB0aGlzLm9iamVjdCA9IG9iamVjdDtcbiAgfVxuXG4gIHZhbHVlKCk6IFQgeyByZXR1cm4gdGhpcy5vYmplY3Q7IH1cblxuICB1cGRhdGUob2JqZWN0OiBUKSB7XG4gICAgdGhpcy5vYmplY3QgPSBvYmplY3Q7XG4gICAgLy8gdGhpcy5ub3RpZnkoKTtcbiAgfVxuXG4gIGdldDxVPihwcm9wOiBzdHJpbmcpOiBJUGF0aFJlZmVyZW5jZTxVPiB7XG4gICAgbGV0IGNoYWlucyA9IHRoaXMuY2hhaW5zO1xuICAgIGlmIChwcm9wIGFzIHN0cmluZyBpbiBjaGFpbnMpIHJldHVybiBjaGFpbnNbcHJvcF07XG4gICAgcmV0dXJuIChjaGFpbnNbcHJvcF0gPSBuZXcgUGF0aFJlZmVyZW5jZSh0aGlzLCBwcm9wKSk7XG4gIH1cblxuICBjaGFpbkZvcjxVPihwcm9wOiBzdHJpbmcpOiBPcHRpb248SVBhdGhSZWZlcmVuY2U8VT4+IHtcbiAgICBsZXQgY2hhaW5zID0gdGhpcy5jaGFpbnM7XG4gICAgaWYgKHByb3AgYXMgc3RyaW5nIGluIGNoYWlucykgcmV0dXJuIGNoYWluc1twcm9wXTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHBhdGgoc3RyaW5nOiBzdHJpbmcpOiBJUGF0aFJlZmVyZW5jZTxPcGFxdWU+IHtcbiAgICByZXR1cm4gdGhpcy5yZWZlcmVuY2VGcm9tUGFydHMoc3RyaW5nLnNwbGl0KCcuJykpO1xuICB9XG5cbiAgcmVmZXJlbmNlRnJvbVBhcnRzKHBhcnRzOiBzdHJpbmdbXSk6IElQYXRoUmVmZXJlbmNlPE9wYXF1ZT4ge1xuICAgIHJldHVybiBwYXJ0cy5yZWR1Y2UoKHJlZiwgcGFydCkgPT4gcmVmLmdldChwYXJ0KSBhcyBJUGF0aFJlZmVyZW5jZTxPcGFxdWU+LCB0aGlzIGFzIElQYXRoUmVmZXJlbmNlPE9wYXF1ZT4pO1xuICB9XG5cbiAgbGFiZWwoKSB7XG4gICAgcmV0dXJuICdbcmVmZXJlbmNlIFJvb3RdJztcbiAgfVxufVxuIl19","import { PropertyReference } from './references/descriptors';\nimport RootReference from './references/root';\nimport { DictSet, dict } from '@glimmer/util';\nimport { VOLATILE_TAG } from '@glimmer/reference';\nconst NOOP_DESTROY = { destroy() {} };\nclass ConstPath {\n    constructor(parent, _property) {\n        this.tag = VOLATILE_TAG;\n        this.parent = parent;\n    }\n    chain() {\n        return NOOP_DESTROY;\n    }\n    notify() {}\n    value() {\n        return this.parent[this.property];\n    }\n    get(prop) {\n        return new ConstPath(this.parent[this.property], prop);\n    }\n}\nclass ConstRoot {\n    constructor(value) {\n        this.tag = VOLATILE_TAG;\n        this.inner = value;\n    }\n    update(inner) {\n        this.inner = inner;\n    }\n    chain() {\n        return NOOP_DESTROY;\n    }\n    notify() {}\n    value() {\n        return this.inner;\n    }\n    referenceFromParts(_parts) {\n        throw new Error(\"Not implemented\");\n    }\n    chainFor(_prop) {\n        throw new Error(\"Not implemented\");\n    }\n    get(prop) {\n        return new ConstPath(this.inner, prop);\n    }\n}\nclass ConstMeta /*implements IMeta*/ {\n    constructor(object) {\n        this.object = object;\n    }\n    root() {\n        return new ConstRoot(this.object);\n    }\n}\nexport const CLASS_META = \"df8be4c8-4e89-44e2-a8f9-550c8dacdca7\";\nconst hasOwnProperty = Object.hasOwnProperty;\nclass Meta {\n    constructor(object, { RootReferenceFactory, DefaultPathReferenceFactory }) {\n        this.references = null;\n        this.slots = null;\n        this.referenceTypes = null;\n        this.propertyMetadata = null;\n        this.object = object;\n        this.RootReferenceFactory = RootReferenceFactory || RootReference;\n        this.DefaultPathReferenceFactory = DefaultPathReferenceFactory || PropertyReference;\n    }\n    static for(obj) {\n        if (obj === null || obj === undefined) return new Meta(obj, {});\n        if (hasOwnProperty.call(obj, '_meta') && obj._meta) return obj._meta;\n        if (!Object.isExtensible(obj)) return new ConstMeta(obj);\n        let MetaToUse = Meta;\n        if (obj.constructor && obj.constructor[CLASS_META]) {\n            let classMeta = obj.constructor[CLASS_META];\n            MetaToUse = classMeta.InstanceMetaConstructor;\n        } else if (obj[CLASS_META]) {\n            MetaToUse = obj[CLASS_META].InstanceMetaConstructor;\n        }\n        return obj._meta = new MetaToUse(obj, {});\n    }\n    static exists(obj) {\n        return typeof obj === 'object' && obj._meta;\n    }\n    static metadataForProperty(_key) {\n        return null;\n    }\n    addReference(property, reference) {\n        let refs = this.references = this.references || dict();\n        let set = refs[property] = refs[property] || new DictSet();\n        set.add(reference);\n    }\n    addReferenceTypeFor(property, type) {\n        this.referenceTypes = this.referenceTypes || dict();\n        this.referenceTypes[property] = type;\n    }\n    referenceTypeFor(property) {\n        if (!this.referenceTypes) return PropertyReference;\n        return this.referenceTypes[property] || PropertyReference;\n    }\n    removeReference(property, reference) {\n        if (!this.references) return;\n        let set = this.references[property];\n        set.delete(reference);\n    }\n    getReferenceTypes() {\n        this.referenceTypes = this.referenceTypes || dict();\n        return this.referenceTypes;\n    }\n    referencesFor(property) {\n        if (!this.references) return null;\n        return this.references[property];\n    }\n    getSlots() {\n        return this.slots = this.slots || dict();\n    }\n    root() {\n        return this.rootCache = this.rootCache || new this.RootReferenceFactory(this.object);\n    }\n}\nexport default Meta;\nexport function metaFor(obj) {\n    return Meta.for(obj);\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWV0YS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL29iamVjdC1yZWZlcmVuY2UvbGliL21ldGEudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsQUFBTyxTQUFFLEFBQWlCLEFBQUUseUJBQU0sQUFBMEIsQUFBQztBQUM3RCxPQUFPLEFBQWEsbUJBQU0sQUFBbUIsQUFBQztBQUc5QyxBQUFPLFNBQWdCLEFBQU8sU0FBZ0IsQUFBSSxBQUFFLFlBQU0sQUFBZSxBQUFDO0FBUzFFLEFBQU8sU0FBbUMsQUFBWSxBQUFFLG9CQUFNLEFBQW9CLEFBQUM7QUFJbkYsTUFBTSxBQUFZLGVBQUcsRUFBRSxBQUFPLFVBQUksQ0FBQyxBQUFFLEFBQUM7QUFFdEM7QUFLRSxnQkFBWSxBQUFXLFFBQUUsQUFBaUI7QUFGbkMsYUFBRyxNQUFHLEFBQVksQUFBQztBQUd4QixBQUFJLGFBQUMsQUFBTSxTQUFHLEFBQU0sQUFBQyxBQUN2QjtBQUFDO0FBRUQsQUFBSztBQUFLLEFBQU0sZUFBQyxBQUFZLEFBQUMsQUFBQztBQUFDO0FBQ2hDLEFBQU0sYUFBSSxDQUFDO0FBRVgsQUFBSztBQUNILEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBTSxPQUFDLEFBQUksS0FBQyxBQUFRLEFBQUMsQUFBQyxBQUNwQztBQUFDO0FBRUQsQUFBRyxRQUFDLEFBQVk7QUFDZCxBQUFNLGVBQUMsSUFBSSxBQUFTLFVBQUMsQUFBSSxLQUFDLEFBQU0sT0FBQyxBQUFJLEtBQUMsQUFBUSxBQUFDLFdBQUUsQUFBSSxBQUFDLEFBQUMsQUFDekQ7QUFBQyxBQUNGOztBQUVEO0FBSUUsZ0JBQVksQUFBVTtBQUZmLGFBQUcsTUFBRyxBQUFZLEFBQUM7QUFHeEIsQUFBSSxhQUFDLEFBQUssUUFBRyxBQUFLLEFBQUMsQUFDckI7QUFBQztBQUVELEFBQU0sV0FBQyxBQUFVO0FBQ2YsQUFBSSxhQUFDLEFBQUssUUFBRyxBQUFLLEFBQUMsQUFDckI7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QUFDLEFBQVMsQUFBQyxBQUFDLEFBQ3hCO0FBQUM7QUFFRCxBQUFpQjtBQUNmLEFBQUksYUFBQyxBQUFjLGlCQUFHLEFBQUksS0FBQyxBQUFjLGtCQUFJLEFBQUksQUFBNkIsQUFBQztBQUMvRSxBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQWMsQUFBQyxBQUM3QjtBQUFDO0FBRUQsQUFBYSxrQkFBQyxBQUFnQjtBQUM1QixBQUFFLEFBQUMsWUFBQyxDQUFDLEFBQUksS0FBQyxBQUFVLEFBQUMsWUFBQyxBQUFNLE9BQUMsQUFBSSxBQUFDO0FBQ2xDLEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBVSxXQUFDLEFBQVEsQUFBQyxBQUFDLEFBQ25DO0FBQUM7QUFFRCxBQUFRO0FBQ04sQUFBTSxBQUFDLGVBQUMsQUFBSSxLQUFDLEFBQUssUUFBRyxBQUFJLEtBQUMsQUFBSyxTQUFJLEFBQUksQUFBRSxBQUFDLEFBQUMsQUFDN0M7QUFBQztBQUVELEFBQUk7QUFDRixBQUFNLEFBQUMsZUFBQyxBQUFJLEtBQUMsQUFBUyxZQUFHLEFBQUksS0FBQyxBQUFTLGFBQUksSUFBSSxBQUFJLEtBQUMsQUFBb0IscUJBQUMsQUFBSSxLQUFDLEFBQU0sQUFBQyxBQUFDLEFBQUMsQUFDekY7QUFBQyxBQUNGOztBQUVELGVBQWUsQUFBSSxBQUFDO0FBTXBCLEFBQU0sd0JBQWtCLEFBQVE7QUFDOUIsQUFBTSxXQUFDLEFBQUksS0FBQyxBQUFHLElBQUMsQUFBRyxBQUFDLEFBQUMsQUFDdkI7QUFBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFByb3BlcnR5UmVmZXJlbmNlIH0gZnJvbSAnLi9yZWZlcmVuY2VzL2Rlc2NyaXB0b3JzJztcbmltcG9ydCBSb290UmVmZXJlbmNlIGZyb20gJy4vcmVmZXJlbmNlcy9yb290JztcbmltcG9ydCB7IE1ldGFPcHRpb25zIH0gZnJvbSAnLi90eXBlcyc7XG5cbmltcG9ydCB7IE9wdGlvbiwgRGljdCwgRGljdFNldCwgSGFzR3VpZCwgU2V0LCBkaWN0IH0gZnJvbSAnQGdsaW1tZXIvdXRpbCc7XG5cbmltcG9ydCB7XG4gIFJvb3RSZWZlcmVuY2VGYWN0b3J5LFxuICBQYXRoUmVmZXJlbmNlRmFjdG9yeSxcbiAgTWV0YSBhcyBJTWV0YSxcbiAgUm9vdFJlZmVyZW5jZSBhcyBJUm9vdFJlZmVyZW5jZVxufSBmcm9tICcuL3R5cGVzJztcblxuaW1wb3J0IHsgUGF0aFJlZmVyZW5jZSBhcyBJUGF0aFJlZmVyZW5jZSwgVk9MQVRJTEVfVEFHIH0gZnJvbSAnQGdsaW1tZXIvcmVmZXJlbmNlJztcblxuaW1wb3J0IHsgSW5uZXJSZWZlcmVuY2VGYWN0b3J5IH0gZnJvbSAnLi9yZWZlcmVuY2VzL2Rlc2NyaXB0b3JzJztcblxuY29uc3QgTk9PUF9ERVNUUk9ZID0geyBkZXN0cm95KCkge30gfTtcblxuY2xhc3MgQ29uc3RQYXRoIGltcGxlbWVudHMgSVBhdGhSZWZlcmVuY2U8YW55PiB7XG4gIHByaXZhdGUgcGFyZW50OiBhbnk7XG4gIHByaXZhdGUgcHJvcGVydHk6IHN0cmluZztcbiAgcHVibGljIHRhZyA9IFZPTEFUSUxFX1RBRztcblxuICBjb25zdHJ1Y3RvcihwYXJlbnQ6IGFueSwgX3Byb3BlcnR5OiBzdHJpbmcpIHtcbiAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgfVxuXG4gIGNoYWluKCkgeyByZXR1cm4gTk9PUF9ERVNUUk9ZOyB9XG4gIG5vdGlmeSgpIHt9XG5cbiAgdmFsdWUoKSB7XG4gICAgcmV0dXJuIHRoaXMucGFyZW50W3RoaXMucHJvcGVydHldO1xuICB9XG5cbiAgZ2V0KHByb3A6IHN0cmluZyk6IElQYXRoUmVmZXJlbmNlPGFueT4ge1xuICAgIHJldHVybiBuZXcgQ29uc3RQYXRoKHRoaXMucGFyZW50W3RoaXMucHJvcGVydHldLCBwcm9wKTtcbiAgfVxufVxuXG5jbGFzcyBDb25zdFJvb3QgaW1wbGVtZW50cyBJUm9vdFJlZmVyZW5jZTxhbnk+IHtcbiAgcHJpdmF0ZSBpbm5lcjogYW55O1xuICBwdWJsaWMgdGFnID0gVk9MQVRJTEVfVEFHO1xuXG4gIGNvbnN0cnVjdG9yKHZhbHVlOiBhbnkpIHtcbiAgICB0aGlzLmlubmVyID0gdmFsdWU7XG4gIH1cblxuICB1cGRhdGUoaW5uZXI6IGFueSkge1xuICAgIHRoaXMuaW5uZXIgPSBpbm5lcjtcbiAgfVxuXG4gIGNoYWluKCkgeyByZXR1cm4gTk9PUF9ERVNUUk9ZOyB9XG4gIG5vdGlmeSgpIHt9XG5cbiAgdmFsdWUoKTogYW55IHtcbiAgICByZXR1cm4gdGhpcy5pbm5lcjtcbiAgfVxuXG4gIHJlZmVyZW5jZUZyb21QYXJ0cyhfcGFydHM6IHN0cmluZ1tdKTogSVBhdGhSZWZlcmVuY2U8YW55PiB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiTm90IGltcGxlbWVudGVkXCIpO1xuICB9XG5cbiAgY2hhaW5Gb3IoX3Byb3A6IHN0cmluZyk6IElQYXRoUmVmZXJlbmNlPGFueT4ge1xuICAgIHRocm93IG5ldyBFcnJvcihcIk5vdCBpbXBsZW1lbnRlZFwiKTtcbiAgfVxuXG4gIGdldChwcm9wOiBzdHJpbmcpOiBJUGF0aFJlZmVyZW5jZTxhbnk+IHtcbiAgICByZXR1cm4gbmV3IENvbnN0UGF0aCh0aGlzLmlubmVyLCBwcm9wKTtcbiAgfVxufVxuXG5jbGFzcyBDb25zdE1ldGEgLyppbXBsZW1lbnRzIElNZXRhKi8ge1xuICBwcml2YXRlIG9iamVjdDogYW55O1xuXG4gIGNvbnN0cnVjdG9yKG9iamVjdDogYW55KSB7XG4gICAgdGhpcy5vYmplY3QgPSBvYmplY3Q7XG4gIH1cblxuICByb290KCk6IENvbnN0Um9vdCB7XG4gICAgcmV0dXJuIG5ldyBDb25zdFJvb3QodGhpcy5vYmplY3QpO1xuICB9XG59XG5cbmV4cG9ydCBjb25zdCBDTEFTU19NRVRBID0gXCJkZjhiZTRjOC00ZTg5LTQ0ZTItYThmOS01NTBjOGRhY2RjYTdcIjtcblxuY29uc3QgaGFzT3duUHJvcGVydHkgPSBPYmplY3QuaGFzT3duUHJvcGVydHk7XG5cbmNsYXNzIE1ldGEgaW1wbGVtZW50cyBJTWV0YSwgSGFzR3VpZCB7XG4gIHN0YXRpYyBmb3Iob2JqOiBhbnkpOiBJTWV0YSB7XG4gICAgaWYgKG9iaiA9PT0gbnVsbCB8fCBvYmogPT09IHVuZGVmaW5lZCkgcmV0dXJuIG5ldyBNZXRhKG9iaiwge30pO1xuICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgJ19tZXRhJykgJiYgb2JqLl9tZXRhKSByZXR1cm4gb2JqLl9tZXRhO1xuICAgIGlmICghT2JqZWN0LmlzRXh0ZW5zaWJsZShvYmopKSByZXR1cm4gbmV3IENvbnN0TWV0YShvYmopIGFzIGFueTtcblxuICAgIGxldCBNZXRhVG9Vc2U6IHR5cGVvZiBNZXRhID0gTWV0YTtcblxuICAgIGlmIChvYmouY29uc3RydWN0b3IgJiYgb2JqLmNvbnN0cnVjdG9yW0NMQVNTX01FVEFdKSB7XG4gICAgICBsZXQgY2xhc3NNZXRhOiBDbGFzc01ldGEgPSBvYmouY29uc3RydWN0b3JbQ0xBU1NfTUVUQV07XG4gICAgICBNZXRhVG9Vc2UgPSBjbGFzc01ldGEuSW5zdGFuY2VNZXRhQ29uc3RydWN0b3I7XG4gICAgfSBlbHNlIGlmIChvYmpbQ0xBU1NfTUVUQV0pIHtcbiAgICAgIE1ldGFUb1VzZSA9IG9ialtDTEFTU19NRVRBXS5JbnN0YW5jZU1ldGFDb25zdHJ1Y3RvcjtcbiAgICB9XG5cbiAgICByZXR1cm4gKG9iai5fbWV0YSA9IG5ldyBNZXRhVG9Vc2Uob2JqLCB7fSkpO1xuICB9XG5cbiAgc3RhdGljIGV4aXN0cyhvYmo6IGFueSk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0eXBlb2Ygb2JqID09PSAnb2JqZWN0JyAmJiBvYmouX21ldGE7XG4gIH1cblxuICBzdGF0aWMgbWV0YWRhdGFGb3JQcm9wZXJ0eShfa2V5OiBzdHJpbmcpOiBhbnkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcHJpdmF0ZSBvYmplY3Q6IGFueTtcbiAgcHJpdmF0ZSBSb290UmVmZXJlbmNlRmFjdG9yeTogUm9vdFJlZmVyZW5jZUZhY3Rvcnk8YW55PjtcbiAgcHJpdmF0ZSBEZWZhdWx0UGF0aFJlZmVyZW5jZUZhY3Rvcnk6IElubmVyUmVmZXJlbmNlRmFjdG9yeTxhbnk+O1xuICBwcml2YXRlIHJvb3RDYWNoZTogSVJvb3RSZWZlcmVuY2U8YW55PjtcbiAgcHJpdmF0ZSByZWZlcmVuY2VzOiBPcHRpb248RGljdDxEaWN0U2V0PElQYXRoUmVmZXJlbmNlPGFueT4gJiBIYXNHdWlkPj4+ID0gbnVsbDtcbiAgcHVibGljIF9ndWlkOiBudW1iZXI7XG4gIHByb3RlY3RlZCBzbG90czogT3B0aW9uPERpY3Q8YW55Pj4gPSBudWxsO1xuICBwcm90ZWN0ZWQgcmVmZXJlbmNlVHlwZXM6IE9wdGlvbjxEaWN0PElubmVyUmVmZXJlbmNlRmFjdG9yeTxhbnk+Pj4gPSBudWxsO1xuICBwcm90ZWN0ZWQgcHJvcGVydHlNZXRhZGF0YTogT3B0aW9uPERpY3Q8YW55Pj4gPSBudWxsO1xuXG4gIGNvbnN0cnVjdG9yKG9iamVjdDogYW55LCB7IFJvb3RSZWZlcmVuY2VGYWN0b3J5LCBEZWZhdWx0UGF0aFJlZmVyZW5jZUZhY3RvcnkgfTogTWV0YU9wdGlvbnMpIHtcbiAgICB0aGlzLm9iamVjdCA9IG9iamVjdDtcbiAgICB0aGlzLlJvb3RSZWZlcmVuY2VGYWN0b3J5ID0gKFJvb3RSZWZlcmVuY2VGYWN0b3J5IHx8IFJvb3RSZWZlcmVuY2UpIGFzIFJvb3RSZWZlcmVuY2VGYWN0b3J5PGFueT47XG4gICAgdGhpcy5EZWZhdWx0UGF0aFJlZmVyZW5jZUZhY3RvcnkgPSBEZWZhdWx0UGF0aFJlZmVyZW5jZUZhY3RvcnkgfHwgUHJvcGVydHlSZWZlcmVuY2U7XG4gIH1cblxuICBhZGRSZWZlcmVuY2UocHJvcGVydHk6IHN0cmluZywgcmVmZXJlbmNlOiBJUGF0aFJlZmVyZW5jZTxhbnk+ICYgSGFzR3VpZCkge1xuICAgIGxldCByZWZzID0gdGhpcy5yZWZlcmVuY2VzID0gdGhpcy5yZWZlcmVuY2VzIHx8IGRpY3Q8RGljdFNldDxJUGF0aFJlZmVyZW5jZTxhbnk+ICYgSGFzR3VpZD4+KCk7XG4gICAgbGV0IHNldCA9IHJlZnNbcHJvcGVydHldID0gcmVmc1twcm9wZXJ0eV0gfHwgbmV3IERpY3RTZXQ8SVBhdGhSZWZlcmVuY2U8YW55PiAmIEhhc0d1aWQ+KCk7XG4gICAgc2V0LmFkZChyZWZlcmVuY2UpO1xuICB9XG5cbiAgYWRkUmVmZXJlbmNlVHlwZUZvcihwcm9wZXJ0eTogc3RyaW5nLCB0eXBlOiBQYXRoUmVmZXJlbmNlRmFjdG9yeTxhbnk+KSB7XG4gICAgdGhpcy5yZWZlcmVuY2VUeXBlcyA9IHRoaXMucmVmZXJlbmNlVHlwZXMgfHwgZGljdDxQYXRoUmVmZXJlbmNlRmFjdG9yeTxhbnk+PigpO1xuICAgIHRoaXMucmVmZXJlbmNlVHlwZXNbcHJvcGVydHldID0gdHlwZTtcbiAgfVxuXG4gIHJlZmVyZW5jZVR5cGVGb3IocHJvcGVydHk6IHN0cmluZyk6IElubmVyUmVmZXJlbmNlRmFjdG9yeTxhbnk+IHtcbiAgICBpZiAoIXRoaXMucmVmZXJlbmNlVHlwZXMpIHJldHVybiBQcm9wZXJ0eVJlZmVyZW5jZTtcbiAgICByZXR1cm4gdGhpcy5yZWZlcmVuY2VUeXBlc1twcm9wZXJ0eV0gfHwgUHJvcGVydHlSZWZlcmVuY2U7XG4gIH1cblxuICByZW1vdmVSZWZlcmVuY2UocHJvcGVydHk6IHN0cmluZywgcmVmZXJlbmNlOiBJUGF0aFJlZmVyZW5jZTxhbnk+ICYgSGFzR3VpZCkge1xuICAgIGlmICghdGhpcy5yZWZlcmVuY2VzKSByZXR1cm47XG4gICAgbGV0IHNldCA9IHRoaXMucmVmZXJlbmNlc1twcm9wZXJ0eV07XG4gICAgc2V0LmRlbGV0ZShyZWZlcmVuY2UpO1xuICB9XG5cbiAgZ2V0UmVmZXJlbmNlVHlwZXMoKTogRGljdDxJbm5lclJlZmVyZW5jZUZhY3Rvcnk8YW55Pj4ge1xuICAgIHRoaXMucmVmZXJlbmNlVHlwZXMgPSB0aGlzLnJlZmVyZW5jZVR5cGVzIHx8IGRpY3Q8UGF0aFJlZmVyZW5jZUZhY3Rvcnk8YW55Pj4oKTtcbiAgICByZXR1cm4gdGhpcy5yZWZlcmVuY2VUeXBlcztcbiAgfVxuXG4gIHJlZmVyZW5jZXNGb3IocHJvcGVydHk6IHN0cmluZyk6IE9wdGlvbjxTZXQ8SVBhdGhSZWZlcmVuY2U8YW55Pj4+IHtcbiAgICBpZiAoIXRoaXMucmVmZXJlbmNlcykgcmV0dXJuIG51bGw7XG4gICAgcmV0dXJuIHRoaXMucmVmZXJlbmNlc1twcm9wZXJ0eV07XG4gIH1cblxuICBnZXRTbG90cygpIHtcbiAgICByZXR1cm4gKHRoaXMuc2xvdHMgPSB0aGlzLnNsb3RzIHx8IGRpY3QoKSk7XG4gIH1cblxuICByb290KCk6IElSb290UmVmZXJlbmNlPGFueT4ge1xuICAgIHJldHVybiAodGhpcy5yb290Q2FjaGUgPSB0aGlzLnJvb3RDYWNoZSB8fCBuZXcgdGhpcy5Sb290UmVmZXJlbmNlRmFjdG9yeSh0aGlzLm9iamVjdCkpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IE1ldGE7XG5cbmludGVyZmFjZSBDbGFzc01ldGEge1xuICBJbnN0YW5jZU1ldGFDb25zdHJ1Y3RvcjogdHlwZW9mIE1ldGE7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtZXRhRm9yKG9iajogYW55KTogSU1ldGEge1xuICByZXR1cm4gTWV0YS5mb3Iob2JqKTtcbn1cbiJdfQ==","import Meta from '../meta';\nimport { VOLATILE_TAG } from '@glimmer/reference';\nexport class PropertyReference {\n    constructor(object, property, _outer) {\n        this.tag = VOLATILE_TAG;\n        this.object = object;\n        this.property = property;\n    }\n    value() {\n        return this.object[this.property];\n    }\n    label() {\n        return '[reference Property]';\n    }\n}\nexport function ComputedReferenceBlueprint(_property, dependencies) {\n    return class ComputedReference {\n        constructor(object, property, outer) {\n            this.installed = false;\n            this.tag = VOLATILE_TAG;\n            this.object = object;\n            this.property = property;\n            this.dependencies = dependencies;\n            this.outer = outer;\n        }\n        value() {\n            if (!this.installed) {\n                let root = Meta.for(this.object).root();\n                this.dependencies.forEach(dep => {\n                    let ref = root.referenceFromParts(dep);\n                    ref.value();\n                });\n                this.installed = true;\n            }\n            return this.object[this.property];\n        }\n        label() {\n            return '[reference Computed]';\n        }\n    };\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVzY3JpcHRvcnMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci9vYmplY3QtcmVmZXJlbmNlL2xpYi9yZWZlcmVuY2VzL2Rlc2NyaXB0b3JzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sQUFBSSxVQUFNLEFBQVMsQUFBQztBQUMzQixBQUFPLFNBQWEsQUFBWSxBQUFPLG9CQUFNLEFBQW9CLEFBQUM7QUFPbEUsQUFBTTtBQUtKLGdCQUFZLEFBQVcsUUFBRSxBQUFnQixVQUFFLEFBQThCO0FBRmxFLGFBQUcsTUFBUSxBQUFZLEFBQUM7QUFHN0IsQUFBSSxhQUFDLEFBQU0sU0FBRyxBQUFNLEFBQUM7QUFDckIsQUFBSSxhQUFDLEFBQVEsV0FBRyxBQUFRLEFBQUMsQUFDM0I7QUFBQztBQUVELEFBQUs7QUFBSyxBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQU0sT0FBQyxBQUFJLEtBQUMsQUFBUSxBQUFDLEFBQUMsQUFBQztBQUFDO0FBRTlDLEFBQUs7QUFDSCxBQUFNLGVBQUMsQUFBc0IsQUFBQyxBQUNoQztBQUFDLEFBQ0Y7O0FBRUQsQUFBTSwyQ0FBd0MsQUFBYyxXQUFFLEFBQWlCO0FBQzdFLEFBQU0sV0FBQztBQVFMLG9CQUFZLEFBQVcsUUFBRSxBQUFnQixVQUFFLEFBQTZCO0FBSGhFLGlCQUFTLFlBQUcsQUFBSyxBQUFDO0FBQ25CLGlCQUFHLE1BQVEsQUFBWSxBQUFDO0FBRzdCLEFBQUksaUJBQUMsQUFBTSxTQUFHLEFBQU0sQUFBQztBQUNyQixBQUFJLGlCQUFDLEFBQVEsV0FBRyxBQUFRLEFBQUM7QUFDekIsQUFBSSxpQkFBQyxBQUFZLGVBQUcsQUFBWSxBQUFDO0FBQ2pDLEFBQUksaUJBQUMsQUFBSyxRQUFHLEFBQUssQUFBQyxBQUNyQjtBQUFDO0FBRUQsQUFBSztBQUNILEFBQUUsQUFBQyxnQkFBQyxDQUFDLEFBQUksS0FBQyxBQUFTLEFBQUMsV0FBQyxBQUFDO0FBQ3BCLG9CQUFJLEFBQUksT0FBRyxBQUFJLEtBQUMsQUFBRyxJQUFDLEFBQUksS0FBQyxBQUFNLEFBQUMsUUFBQyxBQUFJLEFBQUUsQUFBQztBQUV4QyxBQUFJLHFCQUFDLEFBQVksYUFBQyxBQUFPLFFBQUMsQUFBRztBQUMzQix3QkFBSSxBQUFHLE1BQUcsQUFBSSxLQUFDLEFBQWtCLG1CQUFDLEFBQUcsQUFBQyxBQUFDO0FBQ3ZDLEFBQUcsd0JBQUMsQUFBSyxBQUFFLEFBQUMsQUFDZDtBQUFDLEFBQUMsQUFBQztBQUVILEFBQUkscUJBQUMsQUFBUyxZQUFHLEFBQUksQUFBQyxBQUN4QjtBQUFDO0FBRUQsQUFBTSxtQkFBQyxBQUFJLEtBQUMsQUFBTSxPQUFDLEFBQUksS0FBQyxBQUFRLEFBQUMsQUFBQyxBQUNwQztBQUFDO0FBRUQsQUFBSztBQUNILEFBQU0sbUJBQUMsQUFBc0IsQUFBQyxBQUNoQztBQUFDLEFBQ0YsQUFBQyxBQUNKOztBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IE1ldGEgZnJvbSAnLi4vbWV0YSc7XG5pbXBvcnQgeyBSZWZlcmVuY2UsIFZPTEFUSUxFX1RBRywgVGFnIH0gZnJvbSAnQGdsaW1tZXIvcmVmZXJlbmNlJztcbmltcG9ydCB7IE5vdGlmaWFibGVSZWZlcmVuY2UgfSBmcm9tICcuLi90eXBlcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSW5uZXJSZWZlcmVuY2VGYWN0b3J5PFQ+IHtcbiAgbmV3IChvYmplY3Q6IGFueSwgcHJvcGVydHk6IHN0cmluZywgb3V0ZXI6IE5vdGlmaWFibGVSZWZlcmVuY2U8YW55Pik6IFJlZmVyZW5jZTxUPjtcbn1cblxuZXhwb3J0IGNsYXNzIFByb3BlcnR5UmVmZXJlbmNlPFQ+IGltcGxlbWVudHMgUmVmZXJlbmNlPFQ+IHtcbiAgcHJpdmF0ZSBvYmplY3Q6IGFueTtcbiAgcHJpdmF0ZSBwcm9wZXJ0eTogc3RyaW5nO1xuICBwdWJsaWMgdGFnOiBUYWcgPSBWT0xBVElMRV9UQUc7XG5cbiAgY29uc3RydWN0b3Iob2JqZWN0OiBhbnksIHByb3BlcnR5OiBzdHJpbmcsIF9vdXRlcjogTm90aWZpYWJsZVJlZmVyZW5jZTxUPikge1xuICAgIHRoaXMub2JqZWN0ID0gb2JqZWN0O1xuICAgIHRoaXMucHJvcGVydHkgPSBwcm9wZXJ0eTtcbiAgfVxuXG4gIHZhbHVlKCkgeyByZXR1cm4gdGhpcy5vYmplY3RbdGhpcy5wcm9wZXJ0eV07IH1cblxuICBsYWJlbCgpIHtcbiAgICByZXR1cm4gJ1tyZWZlcmVuY2UgUHJvcGVydHldJztcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gQ29tcHV0ZWRSZWZlcmVuY2VCbHVlcHJpbnQ8VD4oX3Byb3BlcnR5OiBhbnksIGRlcGVuZGVuY2llczogYW55KTogSW5uZXJSZWZlcmVuY2VGYWN0b3J5PFQ+IHtcbiAgcmV0dXJuIGNsYXNzIENvbXB1dGVkUmVmZXJlbmNlPFQ+IGltcGxlbWVudHMgUmVmZXJlbmNlPFQ+IHtcbiAgICBwcml2YXRlIG9iamVjdDogYW55O1xuICAgIHByaXZhdGUgcHJvcGVydHk6IHN0cmluZztcbiAgICBwcml2YXRlIGRlcGVuZGVuY2llczogc3RyaW5nW11bXTtcbiAgICBwcml2YXRlIG91dGVyOiBOb3RpZmlhYmxlUmVmZXJlbmNlPFQ+O1xuICAgIHByaXZhdGUgaW5zdGFsbGVkID0gZmFsc2U7XG4gICAgcHVibGljIHRhZzogVGFnID0gVk9MQVRJTEVfVEFHO1xuXG4gICAgY29uc3RydWN0b3Iob2JqZWN0OiBhbnksIHByb3BlcnR5OiBzdHJpbmcsIG91dGVyOiBOb3RpZmlhYmxlUmVmZXJlbmNlPFQ+KSB7XG4gICAgICB0aGlzLm9iamVjdCA9IG9iamVjdDtcbiAgICAgIHRoaXMucHJvcGVydHkgPSBwcm9wZXJ0eTtcbiAgICAgIHRoaXMuZGVwZW5kZW5jaWVzID0gZGVwZW5kZW5jaWVzO1xuICAgICAgdGhpcy5vdXRlciA9IG91dGVyO1xuICAgIH1cblxuICAgIHZhbHVlKCk6IFQge1xuICAgICAgaWYgKCF0aGlzLmluc3RhbGxlZCkge1xuICAgICAgICBsZXQgcm9vdCA9IE1ldGEuZm9yKHRoaXMub2JqZWN0KS5yb290KCk7XG5cbiAgICAgICAgdGhpcy5kZXBlbmRlbmNpZXMuZm9yRWFjaChkZXAgPT4ge1xuICAgICAgICAgIGxldCByZWYgPSByb290LnJlZmVyZW5jZUZyb21QYXJ0cyhkZXApO1xuICAgICAgICAgIHJlZi52YWx1ZSgpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmluc3RhbGxlZCA9IHRydWU7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLm9iamVjdFt0aGlzLnByb3BlcnR5XTtcbiAgICB9XG5cbiAgICBsYWJlbCgpIHtcbiAgICAgIHJldHVybiAnW3JlZmVyZW5jZSBDb21wdXRlZF0nO1xuICAgIH1cbiAgfTtcbn1cbiJdfQ==","// import { metaFor } from './meta';\n// import { intern } from '@glimmer/util';\nexport function setProperty(parent, property, val) {\n    // let rootProp = metaFor(parent).root().chainFor(property));\n    // let referencesToNotify = metaFor(parent).referencesFor(property));\n    parent[property] = val;\n    // if (referencesToNotify) {\n    //   referencesToNotify.forEach(function(ref) { ref.notify(); });\n    // }\n    // if (rootProp) rootProp.notify();\n}\nexport function notifyProperty(_parent, _property) {\n    // let rootProp = metaFor(parent).root().chainFor(property));\n    // let referencesToNotify = metaFor(parent).referencesFor(property));\n    // if (referencesToNotify) {\n    //   referencesToNotify.forEach(function(ref) { ref.notify(); });\n    // }\n    // if (rootProp) rootProp.notify();\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2JqZWN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcGFja2FnZXMvQGdsaW1tZXIvb2JqZWN0LXJlZmVyZW5jZS9saWIvb2JqZWN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLEFBQW9DO0FBQ3BDLEFBQTBDO0FBRTFDLEFBQU0sNEJBQXNCLEFBQVcsUUFBRSxBQUFnQixVQUFFLEFBQVE7QUFDakUsQUFBNkQ7QUFFN0QsQUFBcUU7QUFFckUsQUFBTSxXQUFDLEFBQVEsQUFBQyxZQUFHLEFBQUcsQUFBQztBQUV2QixBQUE0QjtBQUM1QixBQUFpRTtBQUNqRSxBQUFJO0FBRUosQUFBbUMsQUFDckM7QUFBQztBQUVELEFBQU0sK0JBQXlCLEFBQVksU0FBRSxBQUFpQjtBQUM1RCxBQUE2RDtBQUU3RCxBQUFxRTtBQUVyRSxBQUE0QjtBQUM1QixBQUFpRTtBQUNqRSxBQUFJO0FBRUosQUFBbUMsQUFDckM7QUFBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vIGltcG9ydCB7IG1ldGFGb3IgfSBmcm9tICcuL21ldGEnO1xuLy8gaW1wb3J0IHsgaW50ZXJuIH0gZnJvbSAnQGdsaW1tZXIvdXRpbCc7XG5cbmV4cG9ydCBmdW5jdGlvbiBzZXRQcm9wZXJ0eShwYXJlbnQ6IGFueSwgcHJvcGVydHk6IHN0cmluZywgdmFsOiBhbnkpIHtcbiAgLy8gbGV0IHJvb3RQcm9wID0gbWV0YUZvcihwYXJlbnQpLnJvb3QoKS5jaGFpbkZvcihwcm9wZXJ0eSkpO1xuXG4gIC8vIGxldCByZWZlcmVuY2VzVG9Ob3RpZnkgPSBtZXRhRm9yKHBhcmVudCkucmVmZXJlbmNlc0Zvcihwcm9wZXJ0eSkpO1xuXG4gIHBhcmVudFtwcm9wZXJ0eV0gPSB2YWw7XG5cbiAgLy8gaWYgKHJlZmVyZW5jZXNUb05vdGlmeSkge1xuICAvLyAgIHJlZmVyZW5jZXNUb05vdGlmeS5mb3JFYWNoKGZ1bmN0aW9uKHJlZikgeyByZWYubm90aWZ5KCk7IH0pO1xuICAvLyB9XG5cbiAgLy8gaWYgKHJvb3RQcm9wKSByb290UHJvcC5ub3RpZnkoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG5vdGlmeVByb3BlcnR5KF9wYXJlbnQ6IGFueSwgX3Byb3BlcnR5OiBzdHJpbmcpIHtcbiAgLy8gbGV0IHJvb3RQcm9wID0gbWV0YUZvcihwYXJlbnQpLnJvb3QoKS5jaGFpbkZvcihwcm9wZXJ0eSkpO1xuXG4gIC8vIGxldCByZWZlcmVuY2VzVG9Ob3RpZnkgPSBtZXRhRm9yKHBhcmVudCkucmVmZXJlbmNlc0Zvcihwcm9wZXJ0eSkpO1xuXG4gIC8vIGlmIChyZWZlcmVuY2VzVG9Ob3RpZnkpIHtcbiAgLy8gICByZWZlcmVuY2VzVG9Ob3RpZnkuZm9yRWFjaChmdW5jdGlvbihyZWYpIHsgcmVmLm5vdGlmeSgpOyB9KTtcbiAgLy8gfVxuXG4gIC8vIGlmIChyb290UHJvcCkgcm9vdFByb3Aubm90aWZ5KCk7XG59XG4iXX0=","import {\n  Registry,\n  RegistryAccessor,\n  RegistrationOptions,\n  Injection,\n  Resolver\n} from '@glimmer/di';\n\nfunction isTypeSpecifier(specifier: string) {\n  return specifier.indexOf(':') === -1;\n}\n\nexport default class ApplicationRegistry implements RegistryAccessor {\n  private _registry: Registry;\n  private _resolver: Resolver;\n\n  constructor(registry: Registry, resolver: Resolver) {\n    this._registry = registry;\n    this._resolver = resolver;\n  }\n\n  register(specifier: string, factory: any, options?: RegistrationOptions): void {\n    let normalizedSpecifier = this._toAbsoluteSpecifier(specifier);\n    this._registry.register(normalizedSpecifier, factory, options);\n  }\n\n  registration(specifier: string): any {\n    let normalizedSpecifier = this._toAbsoluteSpecifier(specifier);\n    return this._registry.registration(normalizedSpecifier);\n  }\n\n  unregister(specifier: string) {\n    let normalizedSpecifier = this._toAbsoluteSpecifier(specifier);\n    this._registry.unregister(normalizedSpecifier);\n  }\n\n  registerOption(specifier: string, option: string, value: any): void {\n    let normalizedSpecifier = this._toAbsoluteOrTypeSpecifier(specifier);\n    this._registry.registerOption(normalizedSpecifier, option, value);\n  }\n\n  registeredOption(specifier: string, option: string): any {\n    let normalizedSpecifier = this._toAbsoluteOrTypeSpecifier(specifier);\n    return this._registry.registeredOption(normalizedSpecifier, option);\n  }\n\n  registeredOptions(specifier: string): any {\n    let normalizedSpecifier = this._toAbsoluteOrTypeSpecifier(specifier);\n    return this._registry.registeredOptions(normalizedSpecifier);\n  }\n\n  unregisterOption(specifier: string, option: string): void {\n    let normalizedSpecifier = this._toAbsoluteOrTypeSpecifier(specifier);\n    this._registry.unregisterOption(normalizedSpecifier, option);\n  }\n\n  registerInjection(specifier: string, property: string, injection: string): void {\n    let normalizedSpecifier = this._toAbsoluteOrTypeSpecifier(specifier);\n    let normalizedInjection = this._toAbsoluteSpecifier(injection);\n    this._registry.registerInjection(normalizedSpecifier, property, normalizedInjection);\n  }\n\n  registeredInjections(specifier: string): Injection[] {\n    let normalizedSpecifier = this._toAbsoluteOrTypeSpecifier(specifier);\n    return this._registry.registeredInjections(normalizedSpecifier);\n  }\n\n  private _toAbsoluteSpecifier(specifier: string, referrer?: string): string {\n    return this._resolver.identify(specifier, referrer);\n  }\n\n  private _toAbsoluteOrTypeSpecifier(specifier: string): string {\n    if (isTypeSpecifier(specifier)) {\n      return specifier;\n    } else {\n      return this._toAbsoluteSpecifier(specifier);\n    }\n  }\n}","import {\n  assign,\n  Opaque\n} from '@glimmer/util';\nimport {\n  DynamicScope as GlimmerDynamicScope\n} from '@glimmer/runtime';\nimport {\n  PathReference\n} from '@glimmer/reference';\n\nexport default class DynamicScope implements GlimmerDynamicScope {\n  private bucket;\n\n  constructor(bucket=null) {\n    if (bucket) {\n      this.bucket = assign({}, bucket);\n    } else {\n      this.bucket = {};\n    }\n  }\n\n  get(key: string): PathReference<Opaque> {\n    return this.bucket[key];\n  }\n\n  set(key: string, reference: PathReference<Opaque>) {\n    return this.bucket[key] = reference;\n  }\n\n  child(): DynamicScope {\n    return new DynamicScope(this.bucket);\n  }\n}\n","import {\n  Opaque\n} from '@glimmer/util';\n\nimport {\n  Reference,\n  OpaqueIterator,\n  AbstractIterable,\n  IterationItem,\n  Tag\n} from \"@glimmer/reference\";\n\nimport {\n  UpdatableReference\n} from \"@glimmer/component\";\n\nexport type KeyFor<T> = (item: Opaque, index: T) => string;\n\nclass ArrayIterator implements OpaqueIterator {\n  private array: Opaque[];\n  private keyFor: KeyFor<number>;\n  private position = 0;\n\n  constructor(array: Opaque[], keyFor: KeyFor<number>) {\n    this.array = array;\n    this.keyFor = keyFor;\n  }\n\n  isEmpty(): boolean {\n    return this.array.length === 0;\n  }\n\n  next(): IterationItem<Opaque, number> {\n    let { position, array, keyFor } = this;\n\n    if (position >= array.length) return null;\n\n    let value = array[position];\n    let key = keyFor(value, position);\n    let memo = position;\n\n    this.position++;\n\n    return { key, value, memo };\n  }\n}\n\nclass ObjectKeysIterator implements OpaqueIterator {\n  private keys: string[];\n  private values: Opaque[];\n  private keyFor: KeyFor<string>;\n  private position = 0;\n\n  constructor(keys: string[], values: Opaque[], keyFor: KeyFor<string>) {\n    this.keys = keys;\n    this.values = values;\n    this.keyFor = keyFor;\n  }\n\n  isEmpty(): boolean {\n    return this.keys.length === 0;\n  }\n\n  next(): IterationItem<Opaque, string> {\n    let { position, keys, values, keyFor } = this;\n\n    if (position >= keys.length) return null;\n\n    let value = values[position];\n    let memo = keys[position];\n    let key = keyFor(value, memo);\n\n    this.position++;\n\n    return { key, value, memo };\n  }\n}\n\nclass EmptyIterator implements OpaqueIterator {\n  isEmpty(): boolean {\n    return true;\n  }\n\n  next(): IterationItem<Opaque, Opaque> {\n    throw new Error(`Cannot call next() on an empty iterator`);\n  }\n}\n\nconst EMPTY_ITERATOR = new EmptyIterator();\n\nexport default class Iterable implements AbstractIterable<Opaque, Opaque, IterationItem<Opaque, Opaque>, UpdatableReference<Opaque>, UpdatableReference<Opaque>> {\n  public tag: Tag;\n  private ref: Reference<Opaque>;\n  private keyFor: KeyFor<Opaque>;\n\n  constructor(ref: Reference<Opaque>, keyFor: KeyFor<Opaque>) {\n    this.tag = ref.tag;\n    this.ref = ref;\n    this.keyFor = keyFor;\n  }\n\n  iterate(): OpaqueIterator {\n    let { ref, keyFor } = this;\n\n    let iterable = ref.value() as any;\n\n    if (Array.isArray(iterable)) {\n      return iterable.length > 0 ? new ArrayIterator(iterable, keyFor) : EMPTY_ITERATOR;\n    } else if (iterable === undefined || iterable === null) {\n      return EMPTY_ITERATOR;\n    } else if (iterable.forEach !== undefined) {\n      let array = [];\n      iterable.forEach(function(item) {\n        array.push(item);\n      });\n      return array.length > 0 ? new ArrayIterator(array, keyFor) : EMPTY_ITERATOR;\n    } else if (typeof iterable === 'object') {\n       let keys = Object.keys(iterable);\n       return keys.length > 0 ? new ObjectKeysIterator(keys, keys.map(key => iterable[key]), keyFor) : EMPTY_ITERATOR;\n     } else {\n      throw new Error(`Don't know how to {{#each ${iterable}}}`);\n    }\n  }\n\n  valueReferenceFor(item: IterationItem<Opaque, Opaque>): UpdatableReference<Opaque> {\n    return new UpdatableReference(item.value);\n  }\n\n  updateValueReference(reference: UpdatableReference<Opaque>, item: IterationItem<Opaque, Opaque>) {\n    reference.update(item.value);\n  }\n\n  memoReferenceFor(item: IterationItem<Opaque, Opaque>): UpdatableReference<Opaque> {\n    return new UpdatableReference(item.memo);\n  }\n\n  updateMemoReference(reference: UpdatableReference<Opaque>, item: IterationItem<Opaque, Opaque>) {\n    reference.update(item.memo);\n  }\n}\n","const UNRESOLVED = {};\nconst WELL_KNOWN_EMPTY_ARRAY_POSITION = 0;\nconst WELL_KNOW_EMPTY_ARRAY = Object.freeze([]);\nexport class WriteOnlyConstants {\n    constructor() {\n        // `0` means NULL\n        this.strings = [];\n        this.arrays = [WELL_KNOW_EMPTY_ARRAY];\n        this.tables = [];\n        this.handles = [];\n        this.serializables = [];\n        this.resolved = [];\n        this.floats = [];\n        this.negatives = [];\n    }\n    float(float) {\n        let index = this.floats.indexOf(float);\n        if (index > -1) {\n            return index;\n        }\n        return this.floats.push(float) - 1;\n    }\n    negative(negative) {\n        return this.negatives.push(negative) - 1;\n    }\n    string(value) {\n        let index = this.strings.indexOf(value);\n        if (index > -1) {\n            return index;\n        }\n        return this.strings.push(value) - 1;\n    }\n    stringArray(strings) {\n        let _strings = new Array(strings.length);\n        for (let i = 0; i < strings.length; i++) {\n            _strings[i] = this.string(strings[i]);\n        }\n        return this.array(_strings);\n    }\n    array(values) {\n        if (values.length === 0) {\n            return WELL_KNOWN_EMPTY_ARRAY_POSITION;\n        }\n        let index = this.arrays.indexOf(values);\n        if (index > -1) {\n            return index;\n        }\n        return this.arrays.push(values) - 1;\n    }\n    table(t) {\n        let index = this.tables.indexOf(t);\n        if (index > -1) {\n            return index;\n        }\n        return this.tables.push(t) - 1;\n    }\n    handle(handle) {\n        this.resolved.push(UNRESOLVED);\n        return this.handles.push(handle);\n    }\n    serializable(value) {\n        let index = this.serializables.indexOf(value);\n        if (index > -1) {\n            return index;\n        }\n        return this.serializables.push(value) - 1;\n    }\n    toPool() {\n        return {\n            strings: this.strings,\n            arrays: this.arrays,\n            tables: this.tables,\n            handles: this.handles,\n            serializables: this.serializables,\n            floats: this.floats,\n            negatives: this.negatives\n        };\n    }\n}\nexport class RuntimeConstants {\n    constructor(resolver, pool) {\n        this.resolver = resolver;\n        this.strings = pool.strings;\n        this.arrays = pool.arrays;\n        this.tables = pool.tables;\n        this.handles = pool.handles;\n        this.serializables = pool.serializables;\n        this.floats = pool.floats;\n        this.negatives = pool.negatives;\n        this.resolved = this.handles.map(() => UNRESOLVED);\n    }\n    // `0` means NULL\n    getFloat(value) {\n        return this.floats[value];\n    }\n    getNegative(value) {\n        return this.negatives[value];\n    }\n    getString(value) {\n        return this.strings[value];\n    }\n    getStringArray(value) {\n        let names = this.getArray(value);\n        let _names = new Array(names.length);\n        for (let i = 0; i < names.length; i++) {\n            let n = names[i];\n            _names[i] = this.getString(n);\n        }\n        return _names;\n    }\n    getArray(value) {\n        return this.arrays[value];\n    }\n    getSymbolTable(value) {\n        return this.tables[value];\n    }\n    resolveHandle(s) {\n        let index = s - 1;\n        let resolved = this.resolved[index];\n        if (resolved === UNRESOLVED) {\n            let handle = this.handles[index];\n            resolved = this.resolved[index] = this.resolver.resolve(handle);\n        }\n        return resolved;\n    }\n    getSerializable(s) {\n        return this.serializables[s];\n    }\n}\nexport class Constants extends WriteOnlyConstants {\n    constructor(resolver, pool) {\n        super();\n        this.resolver = resolver;\n        if (pool) {\n            this.strings = pool.strings;\n            this.arrays = pool.arrays;\n            this.tables = pool.tables;\n            this.handles = pool.handles;\n            this.serializables = pool.serializables;\n            this.floats = pool.floats;\n            this.negatives = pool.negatives;\n            this.resolved = this.handles.map(() => UNRESOLVED);\n        }\n    }\n    // `0` means NULL\n    getFloat(value) {\n        return this.floats[value];\n    }\n    getNegative(value) {\n        return this.negatives[value];\n    }\n    getString(value) {\n        return this.strings[value];\n    }\n    getStringArray(value) {\n        let names = this.getArray(value);\n        let _names = new Array(names.length);\n        for (let i = 0; i < names.length; i++) {\n            let n = names[i];\n            _names[i] = this.getString(n);\n        }\n        return _names;\n    }\n    getArray(value) {\n        return this.arrays[value];\n    }\n    getSymbolTable(value) {\n        return this.tables[value];\n    }\n    resolveHandle(s) {\n        let index = s - 1;\n        let resolved = this.resolved[index];\n        if (resolved === UNRESOLVED) {\n            let handle = this.handles[index];\n            resolved = this.resolved[index] = this.resolver.resolve(handle);\n        }\n        return resolved;\n    }\n    getSerializable(s) {\n        return this.serializables[s];\n    }\n}\nexport class LazyConstants extends Constants {\n    constructor() {\n        super(...arguments);\n        this.others = [];\n    }\n    getOther(value) {\n        return this.others[value - 1];\n    }\n    other(other) {\n        return this.others.push(other);\n    }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uc3RhbnRzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcGFja2FnZXMvQGdsaW1tZXIvcHJvZ3JhbS9saWIvY29uc3RhbnRzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLE1BQU0sQUFBVSxhQUFHLEFBQUUsQUFBQztBQUV0QixNQUFNLEFBQStCLGtDQUFHLEFBQUMsQUFBQztBQUMxQyxNQUFNLEFBQXFCLHdCQUFHLEFBQU0sT0FBQyxBQUFNLE9BQUMsQUFBRSxBQUFDLEFBQUM7QUFxQmhELEFBQU07QUFBTjtBQUNFLEFBQWlCO0FBRVAsYUFBTyxVQUFhLEFBQUUsQUFBQztBQUN2QixhQUFNLFNBQTZCLENBQUMsQUFBcUIsQUFBQyxBQUFDO0FBQzNELGFBQU0sU0FBa0IsQUFBRSxBQUFDO0FBQzNCLGFBQU8sVUFBYSxBQUFFLEFBQUM7QUFDdkIsYUFBYSxnQkFBYSxBQUFFLEFBQUM7QUFDN0IsYUFBUSxXQUFhLEFBQUUsQUFBQztBQUN4QixhQUFNLFNBQWEsQUFBRSxBQUFDO0FBQ3RCLGFBQVMsWUFBYSxBQUFFLEFBQUMsQUFzRnJDO0FBQUM7QUFwRkMsQUFBSyxVQUFDLEFBQWE7QUFDakIsWUFBSSxBQUFLLFFBQUcsQUFBSSxLQUFDLEFBQU0sT0FBQyxBQUFPLFFBQUMsQUFBSyxBQUFDLEFBQUM7QUFFdkMsQUFBRSxBQUFDLFlBQUMsQUFBSyxRQUFHLENBQUMsQUFBQyxBQUFDLEdBQUMsQUFBQztBQUNmLEFBQU0sbUJBQUMsQUFBSyxBQUFDLEFBQ2Y7QUFBQztBQUVELEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBTSxPQUFDLEFBQUksS0FBQyxBQUFLLEFBQUMsU0FBRyxBQUFDLEFBQUMsQUFDckM7QUFBQztBQUVELEFBQVEsYUFBQyxBQUFnQjtBQUN2QixBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQVMsVUFBQyxBQUFJLEtBQUMsQUFBUSxBQUFDLFlBQUcsQUFBQyxBQUFDLEFBQzNDO0FBQUM7QUFFRCxBQUFNLFdBQUMsQUFBYTtBQUNsQixZQUFJLEFBQUssUUFBRyxBQUFJLEtBQUMsQUFBTyxRQUFDLEFBQU8sUUFBQyxBQUFLLEFBQUMsQUFBQztBQUV4QyxBQUFFLEFBQUMsWUFBQyxBQUFLLFFBQUcsQ0FBQyxBQUFDLEFBQUMsR0FBQyxBQUFDO0FBQ2YsQUFBTSxtQkFBQyxBQUFLLEFBQUMsQUFDZjtBQUFDO0FBRUQsQUFBTSxlQUFDLEFBQUksS0FBQyxBQUFPLFFBQUMsQUFBSSxLQUFDLEFBQUssQUFBQyxTQUFHLEFBQUMsQUFBQyxBQUN0QztBQUFDO0FBRUQsQUFBVyxnQkFBQyxBQUFpQjtBQUMzQixZQUFJLEFBQVEsV0FBYSxJQUFJLEFBQUssTUFBQyxBQUFPLFFBQUMsQUFBTSxBQUFDLEFBQUM7QUFFbkQsQUFBRyxBQUFDLGFBQUMsSUFBSSxBQUFDLElBQUcsQUFBQyxHQUFFLEFBQUMsSUFBRyxBQUFPLFFBQUMsQUFBTSxRQUFFLEFBQUMsQUFBRSxLQUFFLEFBQUM7QUFDeEMsQUFBUSxxQkFBQyxBQUFDLEFBQUMsS0FBRyxBQUFJLEtBQUMsQUFBTSxPQUFDLEFBQU8sUUFBQyxBQUFDLEFBQUMsQUFBQyxBQUFDLEFBQ3hDO0FBQUM7QUFFRCxBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQUssTUFBQyxBQUFRLEFBQUMsQUFBQyxBQUM5QjtBQUFDO0FBRUQsQUFBSyxVQUFDLEFBQWdCO0FBQ3BCLEFBQUUsQUFBQyxZQUFDLEFBQU0sT0FBQyxBQUFNLFdBQUssQUFBQyxBQUFDLEdBQUMsQUFBQztBQUN4QixBQUFNLG1CQUFDLEFBQStCLEFBQUMsQUFDekM7QUFBQztBQUVELFlBQUksQUFBSyxRQUFJLEFBQUksS0FBQyxBQUFxQixPQUFDLEFBQU8sUUFBQyxBQUFNLEFBQUMsQUFBQztBQUV4RCxBQUFFLEFBQUMsWUFBQyxBQUFLLFFBQUcsQ0FBQyxBQUFDLEFBQUMsR0FBQyxBQUFDO0FBQ2YsQUFBTSxtQkFBQyxBQUFLLEFBQUMsQUFDZjtBQUFDO0FBRUQsQUFBTSxlQUFFLEFBQUksS0FBQyxBQUFxQixPQUFDLEFBQUksS0FBQyxBQUFNLEFBQUMsVUFBRyxBQUFDLEFBQUMsQUFDdEQ7QUFBQztBQUVELEFBQUssVUFBQyxBQUFjO0FBQ2xCLFlBQUksQUFBSyxRQUFHLEFBQUksS0FBQyxBQUFNLE9BQUMsQUFBTyxRQUFDLEFBQUMsQUFBQyxBQUFDO0FBRW5DLEFBQUUsQUFBQyxZQUFDLEFBQUssUUFBRyxDQUFDLEFBQUMsQUFBQyxHQUFDLEFBQUM7QUFDZixBQUFNLG1CQUFDLEFBQUssQUFBQyxBQUNmO0FBQUM7QUFFRCxBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQU0sT0FBQyxBQUFJLEtBQUMsQUFBQyxBQUFDLEtBQUcsQUFBQyxBQUFDLEFBQ2pDO0FBQUM7QUFFRCxBQUFNLFdBQUMsQUFBYztBQUNuQixBQUFJLGFBQUMsQUFBUSxTQUFDLEFBQUksS0FBQyxBQUFVLEFBQUMsQUFBQztBQUMvQixBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQU8sUUFBQyxBQUFJLEtBQUMsQUFBTSxBQUFDLEFBQUMsQUFDbkM7QUFBQztBQUVELEFBQVksaUJBQUMsQUFBYTtBQUN4QixZQUFJLEFBQUssUUFBRyxBQUFJLEtBQUMsQUFBYSxjQUFDLEFBQU8sUUFBQyxBQUFLLEFBQUMsQUFBQztBQUU5QyxBQUFFLEFBQUMsWUFBQyxBQUFLLFFBQUcsQ0FBQyxBQUFDLEFBQUMsR0FBQyxBQUFDO0FBQ2YsQUFBTSxtQkFBQyxBQUFLLEFBQUMsQUFDZjtBQUFDO0FBRUQsQUFBTSxlQUFDLEFBQUksS0FBQyxBQUFhLGNBQUMsQUFBSSxLQUFDLEFBQUssQUFBQyxTQUFHLEFBQUMsQUFBQyxBQUM1QztBQUFDO0FBRUQsQUFBTTtBQUNKLEFBQU07QUFDSixBQUFPLHFCQUFFLEFBQUksS0FBQyxBQUFPO0FBQ3JCLEFBQU0sb0JBQUUsQUFBSSxLQUFDLEFBQU07QUFDbkIsQUFBTSxvQkFBRSxBQUFJLEtBQUMsQUFBTTtBQUNuQixBQUFPLHFCQUFFLEFBQUksS0FBQyxBQUFPO0FBQ3JCLEFBQWEsMkJBQUUsQUFBSSxLQUFDLEFBQWE7QUFDakMsQUFBTSxvQkFBRSxBQUFJLEtBQUMsQUFBTTtBQUNuQixBQUFTLHVCQUFFLEFBQUksS0FBQyxBQUFTLEFBQzFCLEFBQUMsQUFDSjtBQVRTO0FBU1IsQUFDRjs7QUFFRCxBQUFNO0FBVUosZ0JBQW1CLEFBQW9DLFVBQUUsQUFBa0I7QUFBeEQsYUFBUSxXQUFSLEFBQVEsQUFBNEI7QUFDckQsQUFBSSxhQUFDLEFBQU8sVUFBRyxBQUFJLEtBQUMsQUFBTyxBQUFDO0FBQzVCLEFBQUksYUFBQyxBQUFNLFNBQUcsQUFBSSxLQUFDLEFBQU0sQUFBQztBQUMxQixBQUFJLGFBQUMsQUFBTSxTQUFHLEFBQUksS0FBQyxBQUFNLEFBQUM7QUFDMUIsQUFBSSxhQUFDLEFBQU8sVUFBRyxBQUFJLEtBQUMsQUFBTyxBQUFDO0FBQzVCLEFBQUksYUFBQyxBQUFhLGdCQUFHLEFBQUksS0FBQyxBQUFhLEFBQUM7QUFDeEMsQUFBSSxhQUFDLEFBQU0sU0FBRyxBQUFJLEtBQUMsQUFBTSxBQUFDO0FBQzFCLEFBQUksYUFBQyxBQUFTLFlBQUcsQUFBSSxLQUFDLEFBQVMsQUFBQztBQUNoQyxBQUFJLGFBQUMsQUFBUSxXQUFHLEFBQUksS0FBQyxBQUFPLFFBQUMsQUFBRyxJQUFDLE1BQU0sQUFBVSxBQUFDLEFBQUMsQUFDckQ7QUFBQztBQUVELEFBQWlCO0FBRWpCLEFBQVEsYUFBQyxBQUFhO0FBQ3BCLEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBTSxPQUFDLEFBQUssQUFBQyxBQUFDLEFBQzVCO0FBQUM7QUFFRCxBQUFXLGdCQUFDLEFBQWE7QUFDdkIsQUFBTSxlQUFDLEFBQUksS0FBQyxBQUFTLFVBQUMsQUFBSyxBQUFDLEFBQUMsQUFDL0I7QUFBQztBQUVELEFBQVMsY0FBQyxBQUFhO0FBQ3JCLEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBTyxRQUFDLEFBQUssQUFBQyxBQUFDLEFBQzdCO0FBQUM7QUFFRCxBQUFjLG1CQUFDLEFBQWE7QUFDMUIsWUFBSSxBQUFLLFFBQUcsQUFBSSxLQUFDLEFBQVEsU0FBQyxBQUFLLEFBQUMsQUFBQztBQUNqQyxZQUFJLEFBQU0sU0FBYSxJQUFJLEFBQUssTUFBQyxBQUFLLE1BQUMsQUFBTSxBQUFDLEFBQUM7QUFFL0MsQUFBRyxBQUFDLGFBQUMsSUFBSSxBQUFDLElBQUcsQUFBQyxHQUFFLEFBQUMsSUFBRyxBQUFLLE1BQUMsQUFBTSxRQUFFLEFBQUMsQUFBRSxLQUFFLEFBQUM7QUFDdEMsZ0JBQUksQUFBQyxJQUFHLEFBQUssTUFBQyxBQUFDLEFBQUMsQUFBQztBQUNqQixBQUFNLG1CQUFDLEFBQUMsQUFBQyxLQUFHLEFBQUksS0FBQyxBQUFTLFVBQUMsQUFBQyxBQUFDLEFBQUMsQUFDaEM7QUFBQztBQUVELEFBQU0sZUFBQyxBQUFNLEFBQUMsQUFDaEI7QUFBQztBQUVELEFBQVEsYUFBQyxBQUFhO0FBQ3BCLEFBQU0sZUFBRSxBQUFJLEtBQUMsQUFBcUIsT0FBQyxBQUFLLEFBQUMsQUFBQyxBQUM1QztBQUFDO0FBRUQsQUFBYyxtQkFBd0IsQUFBYTtBQUNqRCxBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQU0sT0FBQyxBQUFLLEFBQU0sQUFBQyxBQUNqQztBQUFDO0FBRUQsQUFBYSxrQkFBSSxBQUFTO0FBQ3hCLFlBQUksQUFBSyxRQUFHLEFBQUMsSUFBRyxBQUFDLEFBQUM7QUFDbEIsWUFBSSxBQUFRLFdBQUcsQUFBSSxLQUFDLEFBQVEsU0FBQyxBQUFLLEFBQUMsQUFBQztBQUVwQyxBQUFFLEFBQUMsWUFBQyxBQUFRLGFBQUssQUFBVSxBQUFDLFlBQUMsQUFBQztBQUM1QixnQkFBSSxBQUFNLFNBQUcsQUFBSSxLQUFDLEFBQU8sUUFBQyxBQUFLLEFBQUMsQUFBQztBQUNqQyxBQUFRLHVCQUFHLEFBQUksS0FBQyxBQUFRLFNBQUMsQUFBSyxBQUFDLFNBQUcsQUFBSSxLQUFDLEFBQVEsU0FBQyxBQUFPLFFBQUMsQUFBTSxBQUFDLEFBQUMsQUFDbEU7QUFBQztBQUVELEFBQU0sZUFBQyxBQUFhLEFBQUMsQUFDdkI7QUFBQztBQUVELEFBQWUsb0JBQUksQUFBUztBQUMxQixBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQWEsY0FBQyxBQUFDLEFBQU0sQUFBQyxBQUNwQztBQUFDLEFBQ0Y7O0FBRUQsQUFBTSxhQUE0QixrQkFBUSxBQUFrQjtBQUMxRCxnQkFBbUIsQUFBb0MsVUFBRSxBQUFtQjtBQUMxRSxBQUFLLEFBQUUsQUFBQztBQURTLGFBQVEsV0FBUixBQUFRLEFBQTRCO0FBR3JELEFBQUUsQUFBQyxZQUFDLEFBQUksQUFBQyxNQUFDLEFBQUM7QUFDVCxBQUFJLGlCQUFDLEFBQU8sVUFBRyxBQUFJLEtBQUMsQUFBTyxBQUFDO0FBQzVCLEFBQUksaUJBQUMsQUFBTSxTQUFHLEFBQUksS0FBQyxBQUFNLEFBQUM7QUFDMUIsQUFBSSxpQkFBQyxBQUFNLFNBQUcsQUFBSSxLQUFDLEFBQU0sQUFBQztBQUMxQixBQUFJLGlCQUFDLEFBQU8sVUFBRyxBQUFJLEtBQUMsQUFBTyxBQUFDO0FBQzVCLEFBQUksaUJBQUMsQUFBYSxnQkFBRyxBQUFJLEtBQUMsQUFBYSxBQUFDO0FBQ3hDLEFBQUksaUJBQUMsQUFBTSxTQUFHLEFBQUksS0FBQyxBQUFNLEFBQUM7QUFDMUIsQUFBSSxpQkFBQyxBQUFTLFlBQUcsQUFBSSxLQUFDLEFBQVMsQUFBQztBQUNoQyxBQUFJLGlCQUFDLEFBQVEsV0FBRyxBQUFJLEtBQUMsQUFBTyxRQUFDLEFBQUcsSUFBQyxNQUFNLEFBQVUsQUFBQyxBQUFDLEFBQ3JEO0FBQUMsQUFDSDtBQUFDO0FBRUQsQUFBaUI7QUFDakIsQUFBUSxhQUFDLEFBQWE7QUFDcEIsQUFBTSxlQUFDLEFBQUksS0FBQyxBQUFNLE9BQUMsQUFBSyxBQUFDLEFBQUMsQUFDNUI7QUFBQztBQUVELEFBQVcsZ0JBQUMsQUFBYTtBQUN2QixBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQVMsVUFBQyxBQUFLLEFBQUMsQUFBQyxBQUMvQjtBQUFDO0FBRUQsQUFBUyxjQUFDLEFBQWE7QUFDckIsQUFBTSxlQUFDLEFBQUksS0FBQyxBQUFPLFFBQUMsQUFBSyxBQUFDLEFBQUMsQUFDN0I7QUFBQztBQUVELEFBQWMsbUJBQUMsQUFBYTtBQUMxQixZQUFJLEFBQUssUUFBRyxBQUFJLEtBQUMsQUFBUSxTQUFDLEFBQUssQUFBQyxBQUFDO0FBQ2pDLFlBQUksQUFBTSxTQUFhLElBQUksQUFBSyxNQUFDLEFBQUssTUFBQyxBQUFNLEFBQUMsQUFBQztBQUUvQyxBQUFHLEFBQUMsYUFBQyxJQUFJLEFBQUMsSUFBRyxBQUFDLEdBQUUsQUFBQyxJQUFHLEFBQUssTUFBQyxBQUFNLFFBQUUsQUFBQyxBQUFFLEtBQUUsQUFBQztBQUN0QyxnQkFBSSxBQUFDLElBQUcsQUFBSyxNQUFDLEFBQUMsQUFBQyxBQUFDO0FBQ2pCLEFBQU0sbUJBQUMsQUFBQyxBQUFDLEtBQUcsQUFBSSxLQUFDLEFBQVMsVUFBQyxBQUFDLEFBQUMsQUFBQyxBQUNoQztBQUFDO0FBRUQsQUFBTSxlQUFDLEFBQU0sQUFBQyxBQUNoQjtBQUFDO0FBRUQsQUFBUSxhQUFDLEFBQWE7QUFDcEIsQUFBTSxlQUFFLEFBQUksS0FBQyxBQUFxQixPQUFDLEFBQUssQUFBQyxBQUFDLEFBQzVDO0FBQUM7QUFFRCxBQUFjLG1CQUF3QixBQUFhO0FBQ2pELEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBTSxPQUFDLEFBQUssQUFBTSxBQUFDLEFBQ2pDO0FBQUM7QUFFRCxBQUFhLGtCQUFJLEFBQVM7QUFDeEIsWUFBSSxBQUFLLFFBQUcsQUFBQyxJQUFHLEFBQUMsQUFBQztBQUNsQixZQUFJLEFBQVEsV0FBRyxBQUFJLEtBQUMsQUFBUSxTQUFDLEFBQUssQUFBQyxBQUFDO0FBRXBDLEFBQUUsQUFBQyxZQUFDLEFBQVEsYUFBSyxBQUFVLEFBQUMsWUFBQyxBQUFDO0FBQzVCLGdCQUFJLEFBQU0sU0FBRyxBQUFJLEtBQUMsQUFBTyxRQUFDLEFBQUssQUFBQyxBQUFDO0FBQ2pDLEFBQVEsdUJBQUcsQUFBSSxLQUFDLEFBQVEsU0FBQyxBQUFLLEFBQUMsU0FBRyxBQUFJLEtBQUMsQUFBUSxTQUFDLEFBQU8sUUFBQyxBQUFNLEFBQUMsQUFBQyxBQUNsRTtBQUFDO0FBRUQsQUFBTSxlQUFDLEFBQWEsQUFBQyxBQUN2QjtBQUFDO0FBRUQsQUFBZSxvQkFBSSxBQUFTO0FBQzFCLEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBYSxjQUFDLEFBQUMsQUFBTSxBQUFDLEFBQ3BDO0FBQUMsQUFDRjs7QUFFRCxBQUFNLGFBQXFCLHNCQUFRLEFBQWlCO0FBQXBEOztBQUNVLGFBQU0sU0FBYSxBQUFFLEFBQUMsQUFTaEM7QUFBQztBQVBDLEFBQVEsYUFBSSxBQUFhO0FBQ3ZCLEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBTSxPQUFDLEFBQUssUUFBRyxBQUFDLEFBQU0sQUFBQyxBQUNyQztBQUFDO0FBRUQsQUFBSyxVQUFDLEFBQWE7QUFDakIsQUFBTSxlQUFDLEFBQUksS0FBQyxBQUFNLE9BQUMsQUFBSSxLQUFDLEFBQUssQUFBQyxBQUFDLEFBQ2pDO0FBQUMsQUFDRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE9wYXF1ZSwgU3ltYm9sVGFibGUsIFJ1bnRpbWVSZXNvbHZlciwgQ29tcGlsZVRpbWVDb25zdGFudHMgfSBmcm9tIFwiQGdsaW1tZXIvaW50ZXJmYWNlc1wiO1xuXG5jb25zdCBVTlJFU09MVkVEID0ge307XG5cbmNvbnN0IFdFTExfS05PV05fRU1QVFlfQVJSQVlfUE9TSVRJT04gPSAwO1xuY29uc3QgV0VMTF9LTk9XX0VNUFRZX0FSUkFZID0gT2JqZWN0LmZyZWV6ZShbXSk7XG5leHBvcnQgdHlwZSBFTVBUWV9BUlJBWSA9IEFycmF5PFJlYWRvbmx5QXJyYXk8bmV2ZXI+PjtcblxuZXhwb3J0IGludGVyZmFjZSBDb25zdGFudFBvb2wge1xuICBzdHJpbmdzOiBzdHJpbmdbXTtcbiAgYXJyYXlzOiBudW1iZXJbXVtdIHwgRU1QVFlfQVJSQVk7XG4gIHRhYmxlczogU3ltYm9sVGFibGVbXTtcbiAgaGFuZGxlczogbnVtYmVyW107XG4gIHNlcmlhbGl6YWJsZXM6IE9wYXF1ZVtdO1xuICBmbG9hdHM6IG51bWJlcltdO1xuICBuZWdhdGl2ZXM6IG51bWJlcltdO1xufVxuXG5leHBvcnQgY29uc3QgZW51bSBQcmltaXRpdmVUeXBlIHtcbiAgTlVNQkVSICAgICAgICAgID0gMGIwMDAsXG4gIEZMT0FUICAgICAgICAgICA9IDBiMDAxLFxuICBTVFJJTkcgICAgICAgICAgPSAwYjAxMCxcbiAgQk9PTEVBTl9PUl9WT0lEID0gMGIwMTEsXG4gIE5FR0FUSVZFICAgICAgICA9IDBiMTAwXG59XG5cbmV4cG9ydCBjbGFzcyBXcml0ZU9ubHlDb25zdGFudHMgaW1wbGVtZW50cyBDb21waWxlVGltZUNvbnN0YW50cyB7XG4gIC8vIGAwYCBtZWFucyBOVUxMXG5cbiAgcHJvdGVjdGVkIHN0cmluZ3M6IHN0cmluZ1tdID0gW107XG4gIHByb3RlY3RlZCBhcnJheXM6IG51bWJlcltdW10gfCBFTVBUWV9BUlJBWSA9IFtXRUxMX0tOT1dfRU1QVFlfQVJSQVldO1xuICBwcm90ZWN0ZWQgdGFibGVzOiBTeW1ib2xUYWJsZVtdID0gW107XG4gIHByb3RlY3RlZCBoYW5kbGVzOiBudW1iZXJbXSA9IFtdO1xuICBwcm90ZWN0ZWQgc2VyaWFsaXphYmxlczogT3BhcXVlW10gPSBbXTtcbiAgcHJvdGVjdGVkIHJlc29sdmVkOiBPcGFxdWVbXSA9IFtdO1xuICBwcm90ZWN0ZWQgZmxvYXRzOiBudW1iZXJbXSA9IFtdO1xuICBwcm90ZWN0ZWQgbmVnYXRpdmVzOiBudW1iZXJbXSA9IFtdO1xuXG4gIGZsb2F0KGZsb2F0OiBudW1iZXIpIHtcbiAgICBsZXQgaW5kZXggPSB0aGlzLmZsb2F0cy5pbmRleE9mKGZsb2F0KTtcblxuICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICByZXR1cm4gaW5kZXg7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuZmxvYXRzLnB1c2goZmxvYXQpIC0gMTtcbiAgfVxuXG4gIG5lZ2F0aXZlKG5lZ2F0aXZlOiBudW1iZXIpIHtcbiAgICByZXR1cm4gdGhpcy5uZWdhdGl2ZXMucHVzaChuZWdhdGl2ZSkgLSAxO1xuICB9XG5cbiAgc3RyaW5nKHZhbHVlOiBzdHJpbmcpOiBudW1iZXIge1xuICAgIGxldCBpbmRleCA9IHRoaXMuc3RyaW5ncy5pbmRleE9mKHZhbHVlKTtcblxuICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICByZXR1cm4gaW5kZXg7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuc3RyaW5ncy5wdXNoKHZhbHVlKSAtIDE7XG4gIH1cblxuICBzdHJpbmdBcnJheShzdHJpbmdzOiBzdHJpbmdbXSk6IG51bWJlciB7XG4gICAgbGV0IF9zdHJpbmdzOiBudW1iZXJbXSA9IG5ldyBBcnJheShzdHJpbmdzLmxlbmd0aCk7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0cmluZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgIF9zdHJpbmdzW2ldID0gdGhpcy5zdHJpbmcoc3RyaW5nc1tpXSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuYXJyYXkoX3N0cmluZ3MpO1xuICB9XG5cbiAgYXJyYXkodmFsdWVzOiBudW1iZXJbXSk6IG51bWJlciB7XG4gICAgaWYgKHZhbHVlcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBXRUxMX0tOT1dOX0VNUFRZX0FSUkFZX1BPU0lUSU9OO1xuICAgIH1cblxuICAgIGxldCBpbmRleCA9ICh0aGlzLmFycmF5cyBhcyBudW1iZXJbXVtdKS5pbmRleE9mKHZhbHVlcyk7XG5cbiAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgcmV0dXJuIGluZGV4O1xuICAgIH1cblxuICAgIHJldHVybiAodGhpcy5hcnJheXMgYXMgbnVtYmVyW11bXSkucHVzaCh2YWx1ZXMpIC0gMTtcbiAgfVxuXG4gIHRhYmxlKHQ6IFN5bWJvbFRhYmxlKTogbnVtYmVyIHtcbiAgICBsZXQgaW5kZXggPSB0aGlzLnRhYmxlcy5pbmRleE9mKHQpO1xuXG4gICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgIHJldHVybiBpbmRleDtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy50YWJsZXMucHVzaCh0KSAtIDE7XG4gIH1cblxuICBoYW5kbGUoaGFuZGxlOiBudW1iZXIpOiBudW1iZXIge1xuICAgIHRoaXMucmVzb2x2ZWQucHVzaChVTlJFU09MVkVEKTtcbiAgICByZXR1cm4gdGhpcy5oYW5kbGVzLnB1c2goaGFuZGxlKTtcbiAgfVxuXG4gIHNlcmlhbGl6YWJsZSh2YWx1ZTogT3BhcXVlKTogbnVtYmVyIHtcbiAgICBsZXQgaW5kZXggPSB0aGlzLnNlcmlhbGl6YWJsZXMuaW5kZXhPZih2YWx1ZSk7XG5cbiAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgcmV0dXJuIGluZGV4O1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnNlcmlhbGl6YWJsZXMucHVzaCh2YWx1ZSkgLSAxO1xuICB9XG5cbiAgdG9Qb29sKCk6IENvbnN0YW50UG9vbCB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN0cmluZ3M6IHRoaXMuc3RyaW5ncyxcbiAgICAgIGFycmF5czogdGhpcy5hcnJheXMsXG4gICAgICB0YWJsZXM6IHRoaXMudGFibGVzLFxuICAgICAgaGFuZGxlczogdGhpcy5oYW5kbGVzLFxuICAgICAgc2VyaWFsaXphYmxlczogdGhpcy5zZXJpYWxpemFibGVzLFxuICAgICAgZmxvYXRzOiB0aGlzLmZsb2F0cyxcbiAgICAgIG5lZ2F0aXZlczogdGhpcy5uZWdhdGl2ZXNcbiAgICB9O1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBSdW50aW1lQ29uc3RhbnRzPFNwZWNpZmllcj4ge1xuICBwcm90ZWN0ZWQgc3RyaW5nczogc3RyaW5nW107XG4gIHByb3RlY3RlZCBhcnJheXM6IG51bWJlcltdW10gfCBFTVBUWV9BUlJBWTtcbiAgcHJvdGVjdGVkIHRhYmxlczogU3ltYm9sVGFibGVbXTtcbiAgcHJvdGVjdGVkIGhhbmRsZXM6IG51bWJlcltdO1xuICBwcm90ZWN0ZWQgc2VyaWFsaXphYmxlczogT3BhcXVlW107XG4gIHByb3RlY3RlZCByZXNvbHZlZDogT3BhcXVlW107XG4gIHByb3RlY3RlZCBmbG9hdHM6IG51bWJlcltdO1xuICBwcm90ZWN0ZWQgbmVnYXRpdmVzOiBudW1iZXJbXTtcblxuICBjb25zdHJ1Y3RvcihwdWJsaWMgcmVzb2x2ZXI6IFJ1bnRpbWVSZXNvbHZlcjxTcGVjaWZpZXI+LCBwb29sOiBDb25zdGFudFBvb2wpIHtcbiAgICB0aGlzLnN0cmluZ3MgPSBwb29sLnN0cmluZ3M7XG4gICAgdGhpcy5hcnJheXMgPSBwb29sLmFycmF5cztcbiAgICB0aGlzLnRhYmxlcyA9IHBvb2wudGFibGVzO1xuICAgIHRoaXMuaGFuZGxlcyA9IHBvb2wuaGFuZGxlcztcbiAgICB0aGlzLnNlcmlhbGl6YWJsZXMgPSBwb29sLnNlcmlhbGl6YWJsZXM7XG4gICAgdGhpcy5mbG9hdHMgPSBwb29sLmZsb2F0cztcbiAgICB0aGlzLm5lZ2F0aXZlcyA9IHBvb2wubmVnYXRpdmVzO1xuICAgIHRoaXMucmVzb2x2ZWQgPSB0aGlzLmhhbmRsZXMubWFwKCgpID0+IFVOUkVTT0xWRUQpO1xuICB9XG5cbiAgLy8gYDBgIG1lYW5zIE5VTExcblxuICBnZXRGbG9hdCh2YWx1ZTogbnVtYmVyKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5mbG9hdHNbdmFsdWVdO1xuICB9XG5cbiAgZ2V0TmVnYXRpdmUodmFsdWU6IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMubmVnYXRpdmVzW3ZhbHVlXTtcbiAgfVxuXG4gIGdldFN0cmluZyh2YWx1ZTogbnVtYmVyKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5zdHJpbmdzW3ZhbHVlXTtcbiAgfVxuXG4gIGdldFN0cmluZ0FycmF5KHZhbHVlOiBudW1iZXIpOiBzdHJpbmdbXSB7XG4gICAgbGV0IG5hbWVzID0gdGhpcy5nZXRBcnJheSh2YWx1ZSk7XG4gICAgbGV0IF9uYW1lczogc3RyaW5nW10gPSBuZXcgQXJyYXkobmFtZXMubGVuZ3RoKTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbmFtZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGxldCBuID0gbmFtZXNbaV07XG4gICAgICBfbmFtZXNbaV0gPSB0aGlzLmdldFN0cmluZyhuKTtcbiAgICB9XG5cbiAgICByZXR1cm4gX25hbWVzO1xuICB9XG5cbiAgZ2V0QXJyYXkodmFsdWU6IG51bWJlcik6IG51bWJlcltdIHtcbiAgICByZXR1cm4gKHRoaXMuYXJyYXlzIGFzIG51bWJlcltdW10pW3ZhbHVlXTtcbiAgfVxuXG4gIGdldFN5bWJvbFRhYmxlPFQgZXh0ZW5kcyBTeW1ib2xUYWJsZT4odmFsdWU6IG51bWJlcik6IFQge1xuICAgIHJldHVybiB0aGlzLnRhYmxlc1t2YWx1ZV0gYXMgVDtcbiAgfVxuXG4gIHJlc29sdmVIYW5kbGU8VD4oczogbnVtYmVyKTogVCB7XG4gICAgbGV0IGluZGV4ID0gcyAtIDE7XG4gICAgbGV0IHJlc29sdmVkID0gdGhpcy5yZXNvbHZlZFtpbmRleF07XG5cbiAgICBpZiAocmVzb2x2ZWQgPT09IFVOUkVTT0xWRUQpIHtcbiAgICAgIGxldCBoYW5kbGUgPSB0aGlzLmhhbmRsZXNbaW5kZXhdO1xuICAgICAgcmVzb2x2ZWQgPSB0aGlzLnJlc29sdmVkW2luZGV4XSA9IHRoaXMucmVzb2x2ZXIucmVzb2x2ZShoYW5kbGUpO1xuICAgIH1cblxuICAgIHJldHVybiByZXNvbHZlZCBhcyBUO1xuICB9XG5cbiAgZ2V0U2VyaWFsaXphYmxlPFQ+KHM6IG51bWJlcik6IFQge1xuICAgIHJldHVybiB0aGlzLnNlcmlhbGl6YWJsZXNbc10gYXMgVDtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgQ29uc3RhbnRzPFNwZWNpZmllcj4gZXh0ZW5kcyBXcml0ZU9ubHlDb25zdGFudHMge1xuICBjb25zdHJ1Y3RvcihwdWJsaWMgcmVzb2x2ZXI6IFJ1bnRpbWVSZXNvbHZlcjxTcGVjaWZpZXI+LCBwb29sPzogQ29uc3RhbnRQb29sKSB7XG4gICAgc3VwZXIoKTtcblxuICAgIGlmIChwb29sKSB7XG4gICAgICB0aGlzLnN0cmluZ3MgPSBwb29sLnN0cmluZ3M7XG4gICAgICB0aGlzLmFycmF5cyA9IHBvb2wuYXJyYXlzO1xuICAgICAgdGhpcy50YWJsZXMgPSBwb29sLnRhYmxlcztcbiAgICAgIHRoaXMuaGFuZGxlcyA9IHBvb2wuaGFuZGxlcztcbiAgICAgIHRoaXMuc2VyaWFsaXphYmxlcyA9IHBvb2wuc2VyaWFsaXphYmxlcztcbiAgICAgIHRoaXMuZmxvYXRzID0gcG9vbC5mbG9hdHM7XG4gICAgICB0aGlzLm5lZ2F0aXZlcyA9IHBvb2wubmVnYXRpdmVzO1xuICAgICAgdGhpcy5yZXNvbHZlZCA9IHRoaXMuaGFuZGxlcy5tYXAoKCkgPT4gVU5SRVNPTFZFRCk7XG4gICAgfVxuICB9XG5cbiAgLy8gYDBgIG1lYW5zIE5VTExcbiAgZ2V0RmxvYXQodmFsdWU6IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuZmxvYXRzW3ZhbHVlXTtcbiAgfVxuXG4gIGdldE5lZ2F0aXZlKHZhbHVlOiBudW1iZXIpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLm5lZ2F0aXZlc1t2YWx1ZV07XG4gIH1cblxuICBnZXRTdHJpbmcodmFsdWU6IG51bWJlcik6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaW5nc1t2YWx1ZV07XG4gIH1cblxuICBnZXRTdHJpbmdBcnJheSh2YWx1ZTogbnVtYmVyKTogc3RyaW5nW10ge1xuICAgIGxldCBuYW1lcyA9IHRoaXMuZ2V0QXJyYXkodmFsdWUpO1xuICAgIGxldCBfbmFtZXM6IHN0cmluZ1tdID0gbmV3IEFycmF5KG5hbWVzLmxlbmd0aCk7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5hbWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgbiA9IG5hbWVzW2ldO1xuICAgICAgX25hbWVzW2ldID0gdGhpcy5nZXRTdHJpbmcobik7XG4gICAgfVxuXG4gICAgcmV0dXJuIF9uYW1lcztcbiAgfVxuXG4gIGdldEFycmF5KHZhbHVlOiBudW1iZXIpOiBudW1iZXJbXSB7XG4gICAgcmV0dXJuICh0aGlzLmFycmF5cyBhcyBudW1iZXJbXVtdKVt2YWx1ZV07XG4gIH1cblxuICBnZXRTeW1ib2xUYWJsZTxUIGV4dGVuZHMgU3ltYm9sVGFibGU+KHZhbHVlOiBudW1iZXIpOiBUIHtcbiAgICByZXR1cm4gdGhpcy50YWJsZXNbdmFsdWVdIGFzIFQ7XG4gIH1cblxuICByZXNvbHZlSGFuZGxlPFQ+KHM6IG51bWJlcik6IFQge1xuICAgIGxldCBpbmRleCA9IHMgLSAxO1xuICAgIGxldCByZXNvbHZlZCA9IHRoaXMucmVzb2x2ZWRbaW5kZXhdO1xuXG4gICAgaWYgKHJlc29sdmVkID09PSBVTlJFU09MVkVEKSB7XG4gICAgICBsZXQgaGFuZGxlID0gdGhpcy5oYW5kbGVzW2luZGV4XTtcbiAgICAgIHJlc29sdmVkID0gdGhpcy5yZXNvbHZlZFtpbmRleF0gPSB0aGlzLnJlc29sdmVyLnJlc29sdmUoaGFuZGxlKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzb2x2ZWQgYXMgVDtcbiAgfVxuXG4gIGdldFNlcmlhbGl6YWJsZTxUPihzOiBudW1iZXIpOiBUIHtcbiAgICByZXR1cm4gdGhpcy5zZXJpYWxpemFibGVzW3NdIGFzIFQ7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIExhenlDb25zdGFudHMgZXh0ZW5kcyBDb25zdGFudHM8T3BhcXVlPiB7XG4gIHByaXZhdGUgb3RoZXJzOiBPcGFxdWVbXSA9IFtdO1xuXG4gIGdldE90aGVyPFQ+KHZhbHVlOiBudW1iZXIpOiBUIHtcbiAgICByZXR1cm4gdGhpcy5vdGhlcnNbdmFsdWUgLSAxXSBhcyBUO1xuICB9XG5cbiAgb3RoZXIob3RoZXI6IE9wYXF1ZSk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMub3RoZXJzLnB1c2gob3RoZXIpO1xuICB9XG59XG4iXX0=","import { TYPE_MASK, OPERAND_LEN_MASK, ARG_SHIFT } from \"@glimmer/encoder\";\nexport class Opcode {\n    constructor(heap) {\n        this.heap = heap;\n        this.offset = 0;\n    }\n    get size() {\n        let rawType = this.heap.getbyaddr(this.offset);\n        return ((rawType & OPERAND_LEN_MASK) >> ARG_SHIFT) + 1;\n    }\n    get type() {\n        return this.heap.getbyaddr(this.offset) & TYPE_MASK;\n    }\n    get op1() {\n        return this.heap.getbyaddr(this.offset + 1);\n    }\n    get op2() {\n        return this.heap.getbyaddr(this.offset + 2);\n    }\n    get op3() {\n        return this.heap.getbyaddr(this.offset + 3);\n    }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3Bjb2RlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcGFja2FnZXMvQGdsaW1tZXIvcHJvZ3JhbS9saWIvb3Bjb2RlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLEFBQU8sU0FBRSxBQUFTLFdBQUUsQUFBZ0Isa0JBQUUsQUFBUyxBQUFFLGlCQUFNLEFBQWtCLEFBQUM7QUFFMUUsQUFBTTtBQUVKLGdCQUFvQixBQUFVO0FBQVYsYUFBSSxPQUFKLEFBQUksQUFBTTtBQUR2QixhQUFNLFNBQUcsQUFBQyxBQUFDLEFBQ2U7QUFBQztBQUVsQyxRQUFJLEFBQUk7QUFDTixZQUFJLEFBQU8sVUFBRyxBQUFJLEtBQUMsQUFBSSxLQUFDLEFBQVMsVUFBQyxBQUFJLEtBQUMsQUFBTSxBQUFDLEFBQUM7QUFDL0MsQUFBTSxlQUFDLENBQUMsQ0FBQyxBQUFPLFVBQUcsQUFBZ0IsQUFBQyxxQkFBSSxBQUFTLEFBQUMsYUFBRyxBQUFDLEFBQUMsQUFDekQ7QUFBQztBQUVELFFBQUksQUFBSTtBQUNOLEFBQU0sQUFBQyxlQUFDLEFBQUksS0FBQyxBQUFJLEtBQUMsQUFBUyxVQUFDLEFBQUksS0FBQyxBQUFNLEFBQUMsVUFBRyxBQUFTLEFBQUMsQUFBQyxBQUN4RDtBQUFDO0FBRUQsUUFBSSxBQUFHO0FBQ0wsQUFBTSxlQUFDLEFBQUksS0FBQyxBQUFJLEtBQUMsQUFBUyxVQUFDLEFBQUksS0FBQyxBQUFNLFNBQUcsQUFBQyxBQUFDLEFBQUMsQUFDOUM7QUFBQztBQUVELFFBQUksQUFBRztBQUNMLEFBQU0sZUFBQyxBQUFJLEtBQUMsQUFBSSxLQUFDLEFBQVMsVUFBQyxBQUFJLEtBQUMsQUFBTSxTQUFHLEFBQUMsQUFBQyxBQUFDLEFBQzlDO0FBQUM7QUFFRCxRQUFJLEFBQUc7QUFDTCxBQUFNLGVBQUMsQUFBSSxLQUFDLEFBQUksS0FBQyxBQUFTLFVBQUMsQUFBSSxLQUFDLEFBQU0sU0FBRyxBQUFDLEFBQUMsQUFBQyxBQUM5QztBQUFDLEFBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBIZWFwIH0gZnJvbSAnLi9wcm9ncmFtJztcbmltcG9ydCB7IFRZUEVfTUFTSywgT1BFUkFORF9MRU5fTUFTSywgQVJHX1NISUZUIH0gZnJvbSBcIkBnbGltbWVyL2VuY29kZXJcIjtcblxuZXhwb3J0IGNsYXNzIE9wY29kZSB7XG4gIHB1YmxpYyBvZmZzZXQgPSAwO1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGhlYXA6IEhlYXApIHt9XG5cbiAgZ2V0IHNpemUoKSB7XG4gICAgbGV0IHJhd1R5cGUgPSB0aGlzLmhlYXAuZ2V0YnlhZGRyKHRoaXMub2Zmc2V0KTtcbiAgICByZXR1cm4gKChyYXdUeXBlICYgT1BFUkFORF9MRU5fTUFTSykgPj4gQVJHX1NISUZUKSArIDE7XG4gIH1cblxuICBnZXQgdHlwZSgpIHtcbiAgICByZXR1cm4gKHRoaXMuaGVhcC5nZXRieWFkZHIodGhpcy5vZmZzZXQpICYgVFlQRV9NQVNLKTtcbiAgfVxuXG4gIGdldCBvcDEoKSB7XG4gICAgcmV0dXJuIHRoaXMuaGVhcC5nZXRieWFkZHIodGhpcy5vZmZzZXQgKyAxKTtcbiAgfVxuXG4gIGdldCBvcDIoKSB7XG4gICAgcmV0dXJuIHRoaXMuaGVhcC5nZXRieWFkZHIodGhpcy5vZmZzZXQgKyAyKTtcbiAgfVxuXG4gIGdldCBvcDMoKSB7XG4gICAgcmV0dXJuIHRoaXMuaGVhcC5nZXRieWFkZHIodGhpcy5vZmZzZXQgKyAzKTtcbiAgfVxufVxuIl19","\nimport { WriteOnlyConstants } from './constants';\nimport { Opcode } from './opcode';\nvar TableSlotState;\n(function (TableSlotState) {\n    TableSlotState[TableSlotState[\"Allocated\"] = 0] = \"Allocated\";\n    TableSlotState[TableSlotState[\"Freed\"] = 1] = \"Freed\";\n    TableSlotState[TableSlotState[\"Purged\"] = 2] = \"Purged\";\n    TableSlotState[TableSlotState[\"Pointer\"] = 3] = \"Pointer\";\n})(TableSlotState || (TableSlotState = {}));\nconst ENTRY_SIZE = 2;\nconst INFO_OFFSET = 1;\nconst SIZE_MASK = 0b00000000000000001111111111111111;\nconst SCOPE_MASK = 0b00111111111111110000000000000000;\nconst STATE_MASK = 0b11000000000000000000000000000000;\nfunction encodeTableInfo(size, scopeSize, state) {\n    return size | scopeSize << 16 | state << 30;\n}\nfunction changeState(info, newState) {\n    return info | newState << 30;\n}\n/**\n * The Heap is responsible for dynamically allocating\n * memory in which we read/write the VM's instructions\n * from/to. When we malloc we pass out a VMHandle, which\n * is used as an indirect way of accessing the memory during\n * execution of the VM. Internally we track the different\n * regions of the memory in an int array known as the table.\n *\n * The table 32-bit aligned and has the following layout:\n *\n * | ... | hp (u32) |       info (u32)          |\n * | ... |  Handle  | Size | Scope Size | State |\n * | ... | 32-bits  | 16b  |    14b     |  2b   |\n *\n * With this information we effectively have the ability to\n * control when we want to free memory. That being said you\n * can not free during execution as raw address are only\n * valid during the execution. This means you cannot close\n * over them as you will have a bad memory access exception.\n */\nexport class Heap {\n    constructor(serializedHeap) {\n        this.offset = 0;\n        this.handle = 0;\n        if (serializedHeap) {\n            let { buffer, table, handle } = serializedHeap;\n            this.heap = new Uint16Array(buffer);\n            this.table = table;\n            this.offset = this.heap.length;\n            this.handle = handle;\n        } else {\n            this.heap = new Uint16Array(0x100000);\n            this.table = [];\n        }\n    }\n    push(item) {\n        this.heap[this.offset++] = item;\n    }\n    getbyaddr(address) {\n        return this.heap[address];\n    }\n    setbyaddr(address, value) {\n        this.heap[address] = value;\n    }\n    malloc() {\n        this.table.push(this.offset, 0);\n        let handle = this.handle;\n        this.handle += ENTRY_SIZE;\n        return handle;\n    }\n    finishMalloc(handle, scopeSize) {\n        let start = this.table[handle];\n        let finish = this.offset;\n        let instructionSize = finish - start;\n        let info = encodeTableInfo(instructionSize, scopeSize, TableSlotState.Allocated);\n        this.table[handle + INFO_OFFSET] = info;\n    }\n    size() {\n        return this.offset;\n    }\n    // It is illegal to close over this address, as compaction\n    // may move it. However, it is legal to use this address\n    // multiple times between compactions.\n    getaddr(handle) {\n        return this.table[handle];\n    }\n    gethandle(address) {\n        this.table.push(address, encodeTableInfo(0, 0, TableSlotState.Pointer));\n        let handle = this.handle;\n        this.handle += ENTRY_SIZE;\n        return handle;\n    }\n    sizeof(handle) {\n        if (false) {\n            let info = this.table[handle + INFO_OFFSET];\n            return info & SIZE_MASK;\n        }\n        return -1;\n    }\n    scopesizeof(handle) {\n        let info = this.table[handle + INFO_OFFSET];\n        return (info & SCOPE_MASK) >> 16;\n    }\n    free(handle) {\n        let info = this.table[handle + INFO_OFFSET];\n        this.table[handle + INFO_OFFSET] = changeState(info, TableSlotState.Freed);\n    }\n    /**\n     * The heap uses the [Mark-Compact Algorithm](https://en.wikipedia.org/wiki/Mark-compact_algorithm) to shift\n     * reachable memory to the bottom of the heap and freeable\n     * memory to the top of the heap. When we have shifted all\n     * the reachable memory to the top of the heap, we move the\n     * offset to the next free position.\n     */\n    compact() {\n        let compactedSize = 0;\n        let { table, table: { length }, heap } = this;\n        for (let i = 0; i < length; i += ENTRY_SIZE) {\n            let offset = table[i];\n            let info = table[i + INFO_OFFSET];\n            let size = info & SIZE_MASK;\n            let state = info & STATE_MASK >> 30;\n            if (state === TableSlotState.Purged) {\n                continue;\n            } else if (state === TableSlotState.Freed) {\n                // transition to \"already freed\" aka \"purged\"\n                // a good improvement would be to reuse\n                // these slots\n                table[i + INFO_OFFSET] = changeState(info, TableSlotState.Purged);\n                compactedSize += size;\n            } else if (state === TableSlotState.Allocated) {\n                for (let j = offset; j <= i + size; j++) {\n                    heap[j - compactedSize] = heap[j];\n                }\n                table[i] = offset - compactedSize;\n            } else if (state === TableSlotState.Pointer) {\n                table[i] = offset - compactedSize;\n            }\n        }\n        this.offset = this.offset - compactedSize;\n    }\n    capture() {\n        // Only called in eager mode\n        let buffer = slice(this.heap, 0, this.offset);\n        return {\n            handle: this.handle,\n            table: this.table,\n            buffer: buffer\n        };\n    }\n}\nexport class WriteOnlyProgram {\n    constructor(constants = new WriteOnlyConstants(), heap = new Heap()) {\n        this.constants = constants;\n        this.heap = heap;\n        this._opcode = new Opcode(this.heap);\n    }\n    opcode(offset) {\n        this._opcode.offset = offset;\n        return this._opcode;\n    }\n}\nexport class RuntimeProgram {\n    constructor(constants, heap) {\n        this.constants = constants;\n        this.heap = heap;\n        this._opcode = new Opcode(this.heap);\n    }\n    opcode(offset) {\n        this._opcode.offset = offset;\n        return this._opcode;\n    }\n}\nexport class Program extends WriteOnlyProgram {}\nfunction slice(arr, start, end) {\n    if (arr instanceof Uint16Array) {\n        if (arr.slice !== undefined) {\n            return arr.slice(start, end).buffer;\n        }\n        let ret = new Uint16Array(end);\n        for (; start < end; start++) {\n            ret[start] = arr[start];\n        }\n        return ret.buffer;\n    }\n    return null;\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvZ3JhbS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3Byb2dyYW0vbGliL3Byb2dyYW0udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUdBLEFBQU8sU0FBYSxBQUFrQixBQUFvQiwwQkFBTSxBQUFhLEFBQUM7QUFDOUUsQUFBTyxTQUFFLEFBQU0sQUFBRSxjQUFNLEFBQVUsQUFBQztBQUVsQyxJQUFLLEFBS0o7QUFMRCxXQUFLLEFBQWM7QUFDakIsc0RBQVM7QUFDVCxrREFBSztBQUNMLG1EQUFNO0FBQ04sb0RBQU8sQUFDVDtBQUFDLEdBTEksQUFBYyxtQkFBZCxBQUFjLGlCQUtsQjtBQUVELE1BQU0sQUFBVSxhQUFHLEFBQUMsQUFBQztBQUNyQixNQUFNLEFBQVcsY0FBRyxBQUFDLEFBQUM7QUFDdEIsTUFBTSxBQUFTLFlBQUksQUFBa0MsQUFBQztBQUN0RCxNQUFNLEFBQVUsYUFBRyxBQUFrQyxBQUFDO0FBQ3RELE1BQU0sQUFBVSxhQUFHLEFBQWtDLEFBQUM7QUFFdEQseUJBQXlCLEFBQVksTUFBRSxBQUFpQixXQUFFLEFBQWE7QUFDckUsQUFBTSxXQUFDLEFBQUksQUFBRyxPQUFDLEFBQVMsYUFBSSxBQUFFLEFBQUMsS0FBRyxBQUFLLFNBQUksQUFBRSxBQUFDLEFBQ2hEO0FBQUM7QUFFRCxxQkFBcUIsQUFBWSxNQUFFLEFBQWdCO0FBQ2pELEFBQU0sV0FBQyxBQUFJLE9BQUcsQUFBUSxZQUFJLEFBQUUsQUFBQyxBQUMvQjtBQUFDO0FBRUQsQUFtQkc7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQ0gsQUFBTTtBQU1KLGdCQUFZLEFBQXlFO0FBSDdFLGFBQU0sU0FBRyxBQUFDLEFBQUM7QUFDWCxhQUFNLFNBQUcsQUFBQyxBQUFDO0FBR2pCLEFBQUUsQUFBQyxZQUFDLEFBQWMsQUFBQyxnQkFBQyxBQUFDO0FBQ25CLGdCQUFJLEVBQUUsQUFBTSxRQUFFLEFBQUssT0FBRSxBQUFNLEFB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LFlBQUksQUFBRyxNQUFHLElBQUksQUFBVyxZQUFDLEFBQUcsQUFBQyxBQUFDO0FBRS9CLEFBQUcsQUFBQyxBQUFDLGVBQUUsQUFBSyxRQUFHLEFBQUcsS0FBRSxBQUFLLEFBQUUsU0FBRSxBQUFDO0FBQzVCLEFBQUcsZ0JBQUMsQUFBSyxBQUFDLFNBQUksQUFBRyxJQUFDLEFBQUssQUFBQyxBQUFDLEFBQzNCO0FBQUM7QUFFRCxBQUFNLGVBQUMsQUFBRyxJQUFDLEFBQU0sQUFBQyxBQUNwQjtBQUFDO0FBRUQsQUFBTSxXQUFDLEFBQUksQUFBQyxBQUNkO0FBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJcbmltcG9ydCB7IENvbXBpbGVUaW1lUHJvZ3JhbSwgUmVjYXN0LCBWTUhhbmRsZSB9IGZyb20gXCJAZ2xpbW1lci9pbnRlcmZhY2VzXCI7XG5pbXBvcnQgeyBERUJVRyB9IGZyb20gXCJAZ2xpbW1lci9sb2NhbC1kZWJ1Zy1mbGFnc1wiO1xuaW1wb3J0IHsgQ29uc3RhbnRzLCBXcml0ZU9ubHlDb25zdGFudHMsIFJ1bnRpbWVDb25zdGFudHMgfSBmcm9tICcuL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBPcGNvZGUgfSBmcm9tICcuL29wY29kZSc7XG5cbmVudW0gVGFibGVTbG90U3RhdGUge1xuICBBbGxvY2F0ZWQsXG4gIEZyZWVkLFxuICBQdXJnZWQsXG4gIFBvaW50ZXJcbn1cblxuY29uc3QgRU5UUllfU0laRSA9IDI7XG5jb25zdCBJTkZPX09GRlNFVCA9IDE7XG5jb25zdCBTSVpFX01BU0sgPSAgMGIwMDAwMDAwMDAwMDAwMDAwMTExMTExMTExMTExMTExMTtcbmNvbnN0IFNDT1BFX01BU0sgPSAwYjAwMTExMTExMTExMTExMTEwMDAwMDAwMDAwMDAwMDAwO1xuY29uc3QgU1RBVEVfTUFTSyA9IDBiMTEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA7XG5cbmZ1bmN0aW9uIGVuY29kZVRhYmxlSW5mbyhzaXplOiBudW1iZXIsIHNjb3BlU2l6ZTogbnVtYmVyLCBzdGF0ZTogbnVtYmVyKSB7XG4gIHJldHVybiBzaXplIHwgKHNjb3BlU2l6ZSA8PCAxNikgfCBzdGF0ZSA8PCAzMDtcbn1cblxuZnVuY3Rpb24gY2hhbmdlU3RhdGUoaW5mbzogbnVtYmVyLCBuZXdTdGF0ZTogbnVtYmVyKSB7XG4gIHJldHVybiBpbmZvIHwgbmV3U3RhdGUgPDwgMzA7XG59XG5cbi8qKlxuICogVGhlIEhlYXAgaXMgcmVzcG9uc2libGUgZm9yIGR5bmFtaWNhbGx5IGFsbG9jYXRpbmdcbiAqIG1lbW9yeSBpbiB3aGljaCB3ZSByZWFkL3dyaXRlIHRoZSBWTSdzIGluc3RydWN0aW9uc1xuICogZnJvbS90by4gV2hlbiB3ZSBtYWxsb2Mgd2UgcGFzcyBvdXQgYSBWTUhhbmRsZSwgd2hpY2hcbiAqIGlzIHVzZWQgYXMgYW4gaW5kaXJlY3Qgd2F5IG9mIGFjY2Vzc2luZyB0aGUgbWVtb3J5IGR1cmluZ1xuICogZXhlY3V0aW9uIG9mIHRoZSBWTS4gSW50ZXJuYWxseSB3ZSB0cmFjayB0aGUgZGlmZmVyZW50XG4gKiByZWdpb25zIG9mIHRoZSBtZW1vcnkgaW4gYW4gaW50IGFycmF5IGtub3duIGFzIHRoZSB0YWJsZS5cbiAqXG4gKiBUaGUgdGFibGUgMzItYml0IGFsaWduZWQgYW5kIGhhcyB0aGUgZm9sbG93aW5nIGxheW91dDpcbiAqXG4gKiB8IC4uLiB8IGhwICh1MzIpIHwgICAgICAgaW5mbyAodTMyKSAgICAgICAgICB8XG4gKiB8IC4uLiB8ICBIYW5kbGUgIHwgU2l6ZSB8IFNjb3BlIFNpemUgfCBTdGF0ZSB8XG4gKiB8IC4uLiB8IDMyLWJpdHMgIHwgMTZiICB8ICAgIDE0YiAgICAgfCAgMmIgICB8XG4gKlxuICogV2l0aCB0aGlzIGluZm9ybWF0aW9uIHdlIGVmZmVjdGl2ZWx5IGhhdmUgdGhlIGFiaWxpdHkgdG9cbiAqIGNvbnRyb2wgd2hlbiB3ZSB3YW50IHRvIGZyZWUgbWVtb3J5LiBUaGF0IGJlaW5nIHNhaWQgeW91XG4gKiBjYW4gbm90IGZyZWUgZHVyaW5nIGV4ZWN1dGlvbiBhcyByYXcgYWRkcmVzcyBhcmUgb25seVxuICogdmFsaWQgZHVyaW5nIHRoZSBleGVjdXRpb24uIFRoaXMgbWVhbnMgeW91IGNhbm5vdCBjbG9zZVxuICogb3ZlciB0aGVtIGFzIHlvdSB3aWxsIGhhdmUgYSBiYWQgbWVtb3J5IGFjY2VzcyBleGNlcHRpb24uXG4gKi9cbmV4cG9ydCBjbGFzcyBIZWFwIHtcbiAgcHJpdmF0ZSBoZWFwOiBVaW50MTZBcnJheSB8IEFycmF5PG51bWJlcj47XG4gIHByaXZhdGUgdGFibGU6IG51bWJlcltdO1xuICBwcml2YXRlIG9mZnNldCA9IDA7XG4gIHByaXZhdGUgaGFuZGxlID0gMDtcblxuICBjb25zdHJ1Y3RvcihzZXJpYWxpemVkSGVhcD86IHsgYnVmZmVyOiBBcnJheUJ1ZmZlciwgdGFibGU6IG51bWJlcltdLCBoYW5kbGU6IG51bWJlciB9KSB7XG4gICAgaWYgKHNlcmlhbGl6ZWRIZWFwKSB7XG4gICAgICBsZXQgeyBidWZmZXIsIHRhYmxlLCBoYW5kbGUgfSA9IHNlcmlhbGl6ZWRIZWFwO1xuICAgICAgdGhpcy5oZWFwID0gbmV3IFVpbnQxNkFycmF5KGJ1ZmZlcik7XG4gICAgICB0aGlzLnRhYmxlID0gdGFibGU7XG4gICAgICB0aGlzLm9mZnNldCA9IHRoaXMuaGVhcC5sZW5ndGg7XG4gICAgICB0aGlzLmhhbmRsZSA9IGhhbmRsZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5oZWFwID0gbmV3IFVpbnQxNkFycmF5KDB4MTAwMDAwKTtcbiAgICAgIHRoaXMudGFibGUgPSBbXTtcbiAgICB9XG4gIH1cblxuICBwdXNoKGl0ZW06IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMuaGVhcFt0aGlzLm9mZnNldCsrXSA9IGl0ZW07XG4gIH1cblxuICBnZXRieWFkZHIoYWRkcmVzczogbnVtYmVyKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5oZWFwW2FkZHJlc3NdO1xuICB9XG5cbiAgc2V0YnlhZGRyKGFkZHJlc3M6IG51bWJlciwgdmFsdWU6IG51bWJlcikge1xuICAgIHRoaXMuaGVhcFthZGRyZXNzXSA9IHZhbHVlO1xuICB9XG5cbiAgbWFsbG9jKCk6IFZNSGFuZGxlIHtcbiAgICB0aGlzLnRhYmxlLnB1c2godGhpcy5vZmZzZXQsIDApO1xuICAgIGxldCBoYW5kbGUgPSB0aGlzLmhhbmRsZTtcbiAgICB0aGlzLmhhbmRsZSArPSBFTlRSWV9TSVpFO1xuICAgIHJldHVybiBoYW5kbGUgYXMgUmVjYXN0PG51bWJlciwgVk1IYW5kbGU+O1xuICB9XG5cbiAgZmluaXNoTWFsbG9jKGhhbmRsZTogVk1IYW5kbGUsIHNjb3BlU2l6ZTogbnVtYmVyKTogdm9pZCB7XG4gICAgbGV0IHN0YXJ0ID0gdGhpcy50YWJsZVtoYW5kbGUgYXMgUmVjYXN0PFZNSGFuZGxlLCBudW1iZXI+XTtcbiAgICBsZXQgZmluaXNoID0gdGhpcy5vZmZzZXQ7XG4gICAgbGV0IGluc3RydWN0aW9uU2l6ZSA9IGZpbmlzaCAtIHN0YXJ0O1xuICAgIGxldCBpbmZvID0gZW5jb2RlVGFibGVJbmZvKGluc3RydWN0aW9uU2l6ZSwgc2NvcGVTaXplLCBUYWJsZVNsb3RTdGF0ZS5BbGxvY2F0ZWQpO1xuICAgIHRoaXMudGFibGVbKGhhbmRsZSBhcyBSZWNhc3Q8Vk1IYW5kbGUsIG51bWJlcj4pICsgSU5GT19PRkZTRVRdID0gaW5mbztcbiAgfVxuXG4gIHNpemUoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5vZmZzZXQ7XG4gIH1cblxuICAvLyBJdCBpcyBpbGxlZ2FsIHRvIGNsb3NlIG92ZXIgdGhpcyBhZGRyZXNzLCBhcyBjb21wYWN0aW9uXG4gIC8vIG1heSBtb3ZlIGl0LiBIb3dldmVyLCBpdCBpcyBsZWdhbCB0byB1c2UgdGhpcyBhZGRyZXNzXG4gIC8vIG11bHRpcGxlIHRpbWVzIGJldHdlZW4gY29tcGFjdGlvbnMuXG4gIGdldGFkZHIoaGFuZGxlOiBWTUhhbmRsZSk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMudGFibGVbaGFuZGxlIGFzIFJlY2FzdDxWTUhhbmRsZSwgbnVtYmVyPl07XG4gIH1cblxuICBnZXRoYW5kbGUoYWRkcmVzczogbnVtYmVyKTogVk1IYW5kbGUge1xuICAgIHRoaXMudGFibGUucHVzaChhZGRyZXNzLCBlbmNvZGVUYWJsZUluZm8oMCwgMCwgVGFibGVTbG90U3RhdGUuUG9pbnRlcikpO1xuICAgIGxldCBoYW5kbGUgPSB0aGlzLmhhbmRsZTtcbiAgICB0aGlzLmhhbmRsZSArPSBFTlRSWV9TSVpFO1xuICAgIHJldHVybiBoYW5kbGUgYXMgUmVjYXN0PG51bWJlciwgVk1IYW5kbGU+O1xuICB9XG5cbiAgc2l6ZW9mKGhhbmRsZTogVk1IYW5kbGUpOiBudW1iZXIge1xuICAgIGlmIChERUJVRykge1xuICAgICAgbGV0IGluZm8gPSB0aGlzLnRhYmxlWyhoYW5kbGUgYXMgUmVjYXN0PFZNSGFuZGxlLCBudW1iZXI+KSArIElORk9fT0ZGU0VUXTtcbiAgICAgIHJldHVybiBpbmZvICYgU0laRV9NQVNLO1xuICAgIH1cbiAgICByZXR1cm4gLTE7XG4gIH1cblxuICBzY29wZXNpemVvZihoYW5kbGU6IFZNSGFuZGxlKTogbnVtYmVyIHtcbiAgICBsZXQgaW5mbyA9IHRoaXMudGFibGVbKGhhbmRsZSBhcyBSZWNhc3Q8Vk1IYW5kbGUsIG51bWJlcj4pICsgSU5GT19PRkZTRVRdO1xuICAgIHJldHVybiAoaW5mbyAmIFNDT1BFX01BU0spID4+IDE2O1xuICB9XG5cbiAgZnJlZShoYW5kbGU6IFZNSGFuZGxlKTogdm9pZCB7XG4gICAgbGV0IGluZm8gPSB0aGlzLnRhYmxlWyhoYW5kbGUgYXMgUmVjYXN0PFZNSGFuZGxlLCBudW1iZXI+KSArIElORk9fT0ZGU0VUXTtcbiAgICB0aGlzLnRhYmxlWyhoYW5kbGUgYXMgUmVjYXN0PFZNSGFuZGxlLCBudW1iZXI+KSArIElORk9fT0ZGU0VUXSA9IGNoYW5nZVN0YXRlKGluZm8sIFRhYmxlU2xvdFN0YXRlLkZyZWVkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgaGVhcCB1c2VzIHRoZSBbTWFyay1Db21wYWN0IEFsZ29yaXRobV0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTWFyay1jb21wYWN0X2FsZ29yaXRobSkgdG8gc2hpZnRcbiAgICogcmVhY2hhYmxlIG1lbW9yeSB0byB0aGUgYm90dG9tIG9mIHRoZSBoZWFwIGFuZCBmcmVlYWJsZVxuICAgKiBtZW1vcnkgdG8gdGhlIHRvcCBvZiB0aGUgaGVhcC4gV2hlbiB3ZSBoYXZlIHNoaWZ0ZWQgYWxsXG4gICAqIHRoZSByZWFjaGFibGUgbWVtb3J5IHRvIHRoZSB0b3Agb2YgdGhlIGhlYXAsIHdlIG1vdmUgdGhlXG4gICAqIG9mZnNldCB0byB0aGUgbmV4dCBmcmVlIHBvc2l0aW9uLlxuICAgKi9cbiAgY29tcGFjdCgpOiB2b2lkIHtcbiAgICBsZXQgY29tcGFjdGVkU2l6ZSA9IDA7XG4gICAgbGV0IHsgdGFibGUsIHRhYmxlOiB7IGxlbmd0aCB9LCBoZWFwIH0gPSB0aGlzO1xuXG4gICAgZm9yIChsZXQgaT0wOyBpPGxlbmd0aDsgaSs9RU5UUllfU0laRSkge1xuICAgICAgbGV0IG9mZnNldCA9IHRhYmxlW2ldO1xuICAgICAgbGV0IGluZm8gPSB0YWJsZVtpICsgSU5GT19PRkZTRVRdO1xuICAgICAgbGV0IHNpemUgPSBpbmZvICYgU0laRV9NQVNLO1xuICAgICAgbGV0IHN0YXRlID0gaW5mbyAmIFNUQVRFX01BU0sgPj4gMzA7XG5cbiAgICAgIGlmIChzdGF0ZSA9PT0gVGFibGVTbG90U3RhdGUuUHVyZ2VkKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfSBlbHNlIGlmIChzdGF0ZSA9PT0gVGFibGVTbG90U3RhdGUuRnJlZWQpIHtcbiAgICAgICAgLy8gdHJhbnNpdGlvbiB0byBcImFscmVhZHkgZnJlZWRcIiBha2EgXCJwdXJnZWRcIlxuICAgICAgICAvLyBhIGdvb2QgaW1wcm92ZW1lbnQgd291bGQgYmUgdG8gcmV1c2VcbiAgICAgICAgLy8gdGhlc2Ugc2xvdHNcbiAgICAgICAgdGFibGVbaSArIElORk9fT0ZGU0VUXSA9IGNoYW5nZVN0YXRlKGluZm8sIFRhYmxlU2xvdFN0YXRlLlB1cmdlZCk7XG4gICAgICAgIGNvbXBhY3RlZFNpemUgKz0gc2l6ZTtcbiAgICAgIH0gZWxzZSBpZiAoc3RhdGUgPT09IFRhYmxlU2xvdFN0YXRlLkFsbG9jYXRlZCkge1xuICAgICAgICBmb3IgKGxldCBqPW9mZnNldDsgajw9aStzaXplOyBqKyspIHtcbiAgICAgICAgICBoZWFwW2ogLSBjb21wYWN0ZWRTaXplXSA9IGhlYXBbal07XG4gICAgICAgIH1cblxuICAgICAgICB0YWJsZVtpXSA9IG9mZnNldCAtIGNvbXBhY3RlZFNpemU7XG4gICAgICB9IGVsc2UgaWYgKHN0YXRlID09PSBUYWJsZVNsb3RTdGF0ZS5Qb2ludGVyKSB7XG4gICAgICAgIHRhYmxlW2ldID0gb2Zmc2V0IC0gY29tcGFjdGVkU2l6ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLm9mZnNldCA9IHRoaXMub2Zmc2V0IC0gY29tcGFjdGVkU2l6ZTtcbiAgfVxuXG4gIGNhcHR1cmUoKSB7XG4gICAgLy8gT25seSBjYWxsZWQgaW4gZWFnZXIgbW9kZVxuICAgIGxldCBidWZmZXIgPSBzbGljZSh0aGlzLmhlYXAsIDAsIHRoaXMub2Zmc2V0KTtcbiAgICByZXR1cm4ge1xuICAgICAgaGFuZGxlOiB0aGlzLmhhbmRsZSxcbiAgICAgIHRhYmxlOiB0aGlzLnRhYmxlLFxuICAgICAgYnVmZmVyOiBidWZmZXIgYXMgQXJyYXlCdWZmZXJcbiAgICB9O1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBXcml0ZU9ubHlQcm9ncmFtIGltcGxlbWVudHMgQ29tcGlsZVRpbWVQcm9ncmFtIHtcbiAgW2tleTogbnVtYmVyXTogbmV2ZXI7XG5cbiAgcHJpdmF0ZSBfb3Bjb2RlOiBPcGNvZGU7XG5cbiAgY29uc3RydWN0b3IocHVibGljIGNvbnN0YW50czogV3JpdGVPbmx5Q29uc3RhbnRzID0gbmV3IFdyaXRlT25seUNvbnN0YW50cygpLCBwdWJsaWMgaGVhcCA9IG5ldyBIZWFwKCkpIHtcbiAgICB0aGlzLl9vcGNvZGUgPSBuZXcgT3Bjb2RlKHRoaXMuaGVhcCk7XG4gIH1cblxuICBvcGNvZGUob2Zmc2V0OiBudW1iZXIpOiBPcGNvZGUge1xuICAgIHRoaXMuX29wY29kZS5vZmZzZXQgPSBvZmZzZXQ7XG4gICAgcmV0dXJuIHRoaXMuX29wY29kZTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgUnVudGltZVByb2dyYW08U3BlY2lmaWVyPiB7XG4gIFtrZXk6IG51bWJlcl06IG5ldmVyO1xuXG4gIHByaXZhdGUgX29wY29kZTogT3Bjb2RlO1xuXG4gIGNvbnN0cnVjdG9yKHB1YmxpYyBjb25zdGFudHM6IFJ1bnRpbWVDb25zdGFudHM8U3BlY2lmaWVyPiwgcHVibGljIGhlYXA6IEhlYXApIHtcbiAgICB0aGlzLl9vcGNvZGUgPSBuZXcgT3Bjb2RlKHRoaXMuaGVhcCk7XG4gIH1cblxuICBvcGNvZGUob2Zmc2V0OiBudW1iZXIpOiBPcGNvZGUge1xuICAgIHRoaXMuX29wY29kZS5vZmZzZXQgPSBvZmZzZXQ7XG4gICAgcmV0dXJuIHRoaXMuX29wY29kZTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgUHJvZ3JhbTxTcGVjaWZpZXI+IGV4dGVuZHMgV3JpdGVPbmx5UHJvZ3JhbSB7XG4gIHB1YmxpYyBjb25zdGFudHM6IENvbnN0YW50czxTcGVjaWZpZXI+O1xufVxuXG5mdW5jdGlvbiBzbGljZShhcnI6IFVpbnQxNkFycmF5IHwgbnVtYmVyW10sIHN0YXJ0OiBudW1iZXIsIGVuZDogbnVtYmVyKSB7XG4gIGlmIChhcnIgaW5zdGFuY2VvZiBVaW50MTZBcnJheSkge1xuICAgIGlmIChhcnIuc2xpY2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIGFyci5zbGljZShzdGFydCwgZW5kKS5idWZmZXI7XG4gICAgfVxuXG4gICAgbGV0IHJldCA9IG5ldyBVaW50MTZBcnJheShlbmQpO1xuXG4gICAgZm9yICg7IHN0YXJ0IDwgZW5kOyBzdGFydCsrKSB7XG4gICAgICByZXRbc3RhcnRdICA9IGFycltzdGFydF07XG4gICAgfVxuXG4gICAgcmV0dXJuIHJldC5idWZmZXI7XG4gIH1cblxuICByZXR1cm4gbnVsbDtcbn1cbiJdfQ==","import { UpdatableReference } from \"@glimmer/object-reference\";\nimport { VM, Arguments } from \"@glimmer/runtime\";\nimport { Opaque } from '@glimmer/interfaces';\n\nexport default function buildAction(vm: VM, _args: Arguments) {\n  let componentRef = vm.getSelf();\n  let args = _args.capture();\n\n  let actionFunc = args.positional.at(0).value() as Function;\n  if (typeof actionFunc !== 'function') {\n    throwNoActionError(actionFunc, args.positional.at(0));\n  }\n\n  return new UpdatableReference(function action(...invokedArgs) {\n    let curriedArgs = args.positional.value();\n    // Consume the action function that was already captured above.\n    curriedArgs.shift();\n\n    curriedArgs.push(...invokedArgs);\n\n    // Invoke the function with the component as the context, the curried\n    // arguments passed to `{{action}}`, and the arguments the bound function\n    // was invoked with.\n    actionFunc.apply(componentRef && componentRef.value(), curriedArgs);\n  });\n}\n\nfunction throwNoActionError(actionFunc: any, actionFuncReference: Opaque) {\n  let referenceInfo = debugInfoForReference(actionFuncReference);\n  throw new Error(`You tried to create an action with the {{action}} helper, but the first argument ${referenceInfo}was ${typeof actionFunc} instead of a function.`);\n}\n\nexport function debugInfoForReference(reference: any): string {\n  let message = '';\n  let parent;\n  let property;\n\n  if (reference === null || reference === undefined) { return message; }\n\n  if ('parent' in reference && 'property' in reference) {\n    parent = reference['parent'].value();\n    property = reference['property'];\n  } else if ('_parentValue' in reference && '_propertyKey' in reference) {\n    parent = reference['_parentValue'];\n    property = reference['_propertyKey'];\n  }\n\n  if (property !== undefined) {\n    message += `('${property}' on ${debugName(parent)}) `;\n  }\n\n  return message;\n}\n\nfunction debugName(obj: any) {\n  let objType = typeof obj;\n  if (obj === null || obj === undefined) {\n    return objType;\n  } else if (objType === 'number' || objType === 'boolean') {\n    return obj.toString();\n  } else {\n    if (obj['debugName']) {\n      return obj['debugName'];\n    }\n    try {\n      return JSON.stringify(obj);\n    } catch (e) { }\n    return obj.toString();\n  }\n}\n","import { dict, Option } from '@glimmer/util';\n\nexport class TypedRegistry<T> {\n  private byName: { [key: string]: number } = dict<number>();\n  private byHandle: { [key: number]: T } = dict<T>();\n\n  hasName(name: string): boolean {\n    return name in this.byName;\n  }\n\n  getHandle(name: string): Option<number> {\n    return this.byName[name];\n  }\n\n  hasHandle(name: number): boolean {\n    return name in this.byHandle;\n  }\n\n  getByHandle(handle: number): Option<T> {\n    return this.byHandle[handle];\n  }\n\n  register(handle: number, name: string, value: T): void {\n    this.byHandle[handle] = value;\n    this.byName[name] = handle;\n  }\n}\n","import {\n  ModifierManager,\n  Helper as GlimmerHelper,\n  Invocation,\n  Helper,\n  ScannableTemplate,\n  VM,\n  Arguments\n} from '@glimmer/runtime';\nimport { TemplateOptions } from '@glimmer/opcode-compiler';\nimport { expect } from \"@glimmer/util\";\nimport { TypedRegistry } from \"./typed-registry\";\nimport { Opaque, RuntimeResolver as IRuntimeResolver, Option, Maybe, Dict } from \"@glimmer/interfaces\";\nimport { Owner } from \"@glimmer/di\";\nimport Component, { ComponentDefinition, ComponentManager, ComponentFactory } from \"@glimmer/component\";\nimport Application from \"./application\";\nimport { HelperReference } from './helpers/user-helper';\n\nexport type UserHelper = (args: ReadonlyArray<Opaque>, named: Dict<Opaque>) => Opaque;\n\nexport interface Lookup {\n  helper: GlimmerHelper;\n  modifier: ModifierManager;\n  component: ComponentDefinition;\n  template: SerializedTemplateWithLazyBlock<Specifier>;\n  manager: ComponentManager;\n  compiledTemplate: Invocation;\n}\n\nexport type LookupType = keyof Lookup;\n\nexport interface Specifier {\n  specifier: string;\n  managerId?: string;\n};\n\nexport type TemplateEntry = {\n  handle: number;\n  name: string;\n  meta: Specifier;\n};\n\nexport type SerializedTemplateBlockJSON = string;\n\nexport interface SerializedTemplateWithLazyBlock<Specifier> {\n  id?: Option<string>;\n  block: SerializedTemplateBlockJSON;\n  meta: Specifier;\n}\n\nexport class RuntimeResolver implements IRuntimeResolver<Specifier> {\n  templateOptions: TemplateOptions<Specifier>;\n  handleLookup: TypedRegistry<Opaque>[] = [];\n  private cache = {\n    component: new TypedRegistry<ComponentDefinition>(),\n    template: new TypedRegistry<SerializedTemplateWithLazyBlock<Specifier>>(),\n    compiledTemplate: new TypedRegistry<Invocation>(),\n    helper: new TypedRegistry<Helper>(),\n    manager: new TypedRegistry<ComponentManager>(),\n    modifier: new TypedRegistry<ModifierManager>()\n  };\n\n  constructor(private owner: Owner) {}\n\n  setCompileOptions(compileOptions: TemplateOptions<Specifier>) {\n    this.templateOptions = compileOptions;\n  }\n\n  lookup(type: LookupType, name: string, referrer?: Specifier): Option<number> {\n    if (this.cache[type].hasName(name)) {\n      return this.cache[type].getHandle(name);\n    } else {\n      return null;\n    }\n  }\n\n  register<K extends LookupType>(type: K, name: string, value: Lookup[K]): number {\n    let registry = this.cache[type];\n    let handle = this.handleLookup.length;\n    this.handleLookup.push(registry);\n    (this.cache[type] as TypedRegistry<any>).register(handle, name, value);\n    return handle;\n  }\n\n  lookupModifier(name: string, meta?: Specifier): Option<number> {\n    let handle = this.lookup('modifier', name);\n\n    if (handle === null) {\n      throw new Error(`Modifier for ${name} not found.`);\n    }\n\n    return handle;\n  }\n\n  compileTemplate(name: string, layout: Option<number>): Invocation {\n    if (!this.cache.compiledTemplate.hasName(name)) {\n      let serializedTemplate = this.resolve<SerializedTemplateWithLazyBlock<Specifier>>(layout);\n      let { block, meta, id } = serializedTemplate;\n      let parsedBlock = JSON.parse(block);\n      let template = new ScannableTemplate(this.templateOptions, { id, block: parsedBlock, referrer: meta }).asLayout();\n      let invocation = {\n        handle: template.compile(),\n        symbolTable: template.symbolTable\n      };\n\n      this.register('compiledTemplate', name, invocation);\n      return invocation;\n    }\n\n    let handle = this.lookup('compiledTemplate', name);\n    return this.resolve<Invocation>(handle);\n  }\n\n  registerHelper(name: string, helper: UserHelper) {\n    let glimmerHelper = (_vm: VM, args: Arguments) => new HelperReference(helper, args);\n    return this.register('helper', name, glimmerHelper);\n  }\n\n  registerInternalHelper(name: string, helper: GlimmerHelper) {\n    this.register('helper', name, helper);\n  }\n\n  registerComponent(name: string, resolvedSpecifier: string, Component: ComponentFactory, template: SerializedTemplateWithLazyBlock<Specifier>): number {\n    let templateEntry = this.registerTemplate(resolvedSpecifier, template);\n    let manager = this.managerFor(templateEntry.meta.managerId);\n    let definition = new ComponentDefinition(name, manager, Component, templateEntry.handle);\n\n    return this.register('component', name, definition);\n  }\n\n  lookupComponentHandle(name: string, referrer?: Specifier) {\n    if (!this.cache.component.hasName(name)) {\n      this.lookupComponent(name, referrer);\n    }\n    return this.lookup('component', name, referrer);\n  }\n\n  managerFor(managerId = 'main'): ComponentManager {\n    let manager: ComponentManager;\n\n    if (!this.cache.manager.hasName(managerId)) {\n      let { rootName } = this.owner as Application;\n      manager = this.owner.lookup(`component-manager:/${rootName}/component-managers/${managerId}`);\n      if (!manager) {\n        throw new Error(`No component manager found for ID ${managerId}.`);\n      }\n      this.register('manager', managerId, manager);\n      return manager;\n    } else {\n      let handle = this.cache.manager.getHandle(managerId);\n      return this.cache.manager.getByHandle(handle);\n    }\n  }\n\n  registerTemplate(resolvedSpecifier: string, template: SerializedTemplateWithLazyBlock<Specifier> ): TemplateEntry {\n    return {\n      name: resolvedSpecifier,\n      handle: this.register('template', resolvedSpecifier, template),\n      meta: template.meta\n    };\n  }\n\n  lookupComponent(name: string, meta: Specifier): ComponentDefinition {\n    let handle: number;\n    if (!this.cache.component.hasName(name)) {\n      let specifier = expect(this.identifyComponent(name, meta), `Could not find the component '${name}'`);\n      let template = this.owner.lookup('template', specifier);\n      let componentSpecifier = this.owner.identify('component', specifier);\n      let componentFactory: ComponentFactory = null;\n\n      if (componentSpecifier !== undefined) {\n        componentFactory = this.owner.factoryFor(componentSpecifier);\n      } else {\n        componentFactory = {\n          create(injections) {\n            return Component.create(injections);\n          }\n        };\n      }\n\n      handle = this.registerComponent(name, specifier, componentFactory, template);\n    } else {\n      handle = this.lookup('component', name, meta);\n    }\n\n    return this.resolve<ComponentDefinition>(handle);\n  }\n\n  lookupHelper(name: string, meta?: Specifier): Option<number> {\n    if (!this.cache.helper.hasName(name)) {\n      let owner: Owner = this.owner;\n      let relSpecifier = `helper:${name}`;\n      let referrer: string = meta.specifier;\n\n      let specifier = owner.identify(relSpecifier, referrer);\n      if (specifier === undefined) {\n        return null;\n      }\n\n      let helper = this.owner.lookup(specifier, meta.specifier);\n      return this.registerHelper(name, helper);\n    }\n\n    return this.lookup('helper', name, meta);\n  }\n\n  lookupPartial(name: string, meta?: Specifier): never {\n    throw new Error(\"Partials are not available in Glimmer applications.\");\n  }\n\n  resolve<T>(handle: number): T {\n    let registry = this.handleLookup[handle];\n    return registry.getByHandle(handle) as T;\n  }\n\n  private identifyComponent(name: string, meta: Specifier): Maybe<string> {\n    let owner: Owner = this.owner;\n    let relSpecifier = `template:${name}`;\n    let referrer: string = meta.specifier;\n\n    let specifier = owner.identify(relSpecifier, referrer);\n\n    if (specifier === undefined && owner.identify(`component:${name}`, referrer)) {\n      throw new Error(`The component '${name}' is missing a template. All components must have a template. Make sure there is a template.hbs in the component directory.`);\n    }\n\n    return specifier;\n  }\n\n}\n","export default {\"id\":\"j7SGa6Pm\",\"block\":\"{\\\"symbols\\\":[\\\"root\\\"],\\\"statements\\\":[[4,\\\"each\\\",[[22,[\\\"roots\\\"]]],[[\\\"key\\\"],[\\\"id\\\"]],{\\\"statements\\\":[[4,\\\"in-element\\\",[[21,1,[\\\"parent\\\"]]],[[\\\"guid\\\",\\\"nextSibling\\\"],[\\\"%cursor:0%\\\",[21,1,[\\\"nextSibling\\\"]]]],{\\\"statements\\\":[[1,[26,\\\"component\\\",[[21,1,[\\\"component\\\"]]],null],false]],\\\"parameters\\\":[]},null]],\\\"parameters\\\":[1]},null]],\\\"hasEval\\\":false}\",\"meta\":{\"specifier\":\"template:/-application/application/src/templates/main\"}};","import {\n  DOMChanges,\n  DOMTreeConstruction,\n  Environment as GlimmerEnvironment,\n  WithStaticLayout,\n  ComponentDefinition\n} from '@glimmer/runtime';\nimport {\n  Reference,\n  OpaqueIterable\n} from \"@glimmer/reference\";\nimport {\n  Opaque, Option, assert,\n} from '@glimmer/util';\nimport {\n  getOwner,\n  setOwner\n} from '@glimmer/di';\nimport Iterable from './iterable';\nimport { Program, LazyConstants } from '@glimmer/program';\nimport action from './helpers/action';\nimport { RuntimeResolver, Specifier } from \"./runtime-resolver\";\nimport {\n  TemplateOptions,\n  Macros,\n  CompileTimeLookup as ICompileTimeLookup,\n  LazyOpcodeBuilder,\n  OpcodeBuilderConstructor,\n  ICompilableTemplate\n} from '@glimmer/opcode-compiler';\nimport { ProgramSymbolTable, ComponentCapabilities } from '@glimmer/interfaces';\nimport mainTemplate from './templates/main';\n\ntype KeyFor<T> = (item: Opaque, index: T) => string;\n\nexport interface EnvironmentOptions {\n  document?: HTMLDocument;\n  appendOperations?: DOMTreeConstruction;\n}\n\nclass CompileTimeLookup implements ICompileTimeLookup<Specifier> {\n  constructor(private resolver: RuntimeResolver) {}\n\n  private getComponentDefinition(handle: number): ComponentDefinition {\n    let spec = this.resolver.resolve<Option<ComponentDefinition>>(handle);\n\n    assert(!!spec, `Couldn't find a template for ${handle}`);\n\n    return spec!;\n  }\n\n  getCapabilities(handle: number): ComponentCapabilities {\n    let definition = this.getComponentDefinition(handle);\n    let { manager, state } = definition!;\n    return manager.getCapabilities(state);\n  }\n\n  getLayout(handle: number): ICompilableTemplate<ProgramSymbolTable> {\n    let definition = this.getComponentDefinition(handle);\n    let { manager } = definition;\n    let invocation = (manager as WithStaticLayout<any, any, Specifier, RuntimeResolver>).getLayout(definition, this.resolver);\n\n    return {\n      compile() { return invocation.handle; },\n      symbolTable: invocation.symbolTable\n    };\n  }\n\n  lookupHelper(name: string, referrer: Specifier): Option<number> {\n    return this.resolver.lookupHelper(name, referrer);\n  }\n\n  lookupModifier(name: string, referrer: Specifier): Option<number> {\n    return this.resolver.lookupModifier(name, referrer);\n  }\n\n  lookupComponentSpec(name: string, referrer: Specifier): Option<number> {\n    return this.resolver.lookupComponentHandle(name, referrer);\n  }\n\n  lookupPartial(name: string, referrer: Specifier): Option<number> {\n    return this.resolver.lookupPartial(name, referrer);\n  }\n}\n\nexport default class Environment extends GlimmerEnvironment {\n  private uselessAnchor: HTMLAnchorElement;\n  public resolver: RuntimeResolver;\n  protected program: Program<Specifier>;\n  public compileOptions: TemplateOptions<Specifier>;\n\n  static create(options: EnvironmentOptions = {}) {\n    options.document = options.document || self.document;\n    options.appendOperations = options.appendOperations || new DOMTreeConstruction(options.document);\n\n    return new Environment(options);\n  }\n\n  constructor(options: EnvironmentOptions) {\n    super({ appendOperations: options.appendOperations, updateOperations: new DOMChanges(options.document as HTMLDocument || document) });\n\n    setOwner(this, getOwner(options));\n\n    let resolver = this.resolver = new RuntimeResolver(getOwner(this));\n    let program = this.program = new Program(new LazyConstants(resolver));\n    let macros = new Macros();\n    let lookup = new CompileTimeLookup(resolver);\n\n    this.compileOptions = {\n      program,\n      macros,\n      lookup,\n      Builder: LazyOpcodeBuilder as OpcodeBuilderConstructor\n    };\n\n    this.resolver.setCompileOptions(this.compileOptions);\n\n    resolver.registerTemplate('main', mainTemplate);\n    resolver.registerInternalHelper('action', action);\n    resolver.registerHelper('if', (params) => params[0] ? params[1] : params[2]);\n\n    // TODO - required for `protocolForURL` - seek alternative approach\n    // e.g. see `installPlatformSpecificProtocolForURL` in Ember\n    this.uselessAnchor = options.document.createElement('a') as HTMLAnchorElement;\n  }\n\n  protocolForURL(url: string): string {\n    // TODO - investigate alternative approaches\n    // e.g. see `installPlatformSpecificProtocolForURL` in Ember\n    this.uselessAnchor.href = url;\n    return this.uselessAnchor.protocol;\n  }\n\n  iterableFor(ref: Reference<Opaque>, keyPath: string): OpaqueIterable {\n    let keyFor: KeyFor<Opaque>;\n\n    if (!keyPath) {\n      throw new Error('Must specify a key for #each');\n    }\n\n    switch (keyPath) {\n      case '@index':\n        keyFor = (_, index: number) => String(index);\n      break;\n      case '@primitive':\n        keyFor = (item: Opaque) => String(item);\n      break;\n      default:\n        keyFor = (item: Opaque) => item[keyPath];\n      break;\n    }\n\n    return new Iterable(ref, keyFor);\n  }\n}\n","import {\n  Container,\n  Factory,\n  Owner,\n  Registry,\n  RegistryWriter,\n  Resolver,\n  setOwner,\n} from '@glimmer/di';\nimport {\n  templateFactory,\n  Template,\n  TemplateIterator,\n  RenderResult,\n  clientBuilder\n} from '@glimmer/runtime';\nimport {\n  UpdatableReference\n} from '@glimmer/object-reference';\nimport {\n  Option\n} from '@glimmer/util';\nimport {\n  Simple\n} from '@glimmer/interfaces';\nimport {\n  Specifier\n} from '@glimmer/opcode-compiler';\nimport ApplicationRegistry from './application-registry';\nimport DynamicScope from './dynamic-scope';\nimport Environment from './environment';\nimport mainTemplate from './templates/main';\n\nexport interface ApplicationOptions {\n  rootName: string;\n  resolver: Resolver;\n  document?: Simple.Document;\n}\n\nexport interface Initializer {\n  name?: string;\n  initialize(registry: RegistryWriter): void;\n}\n\nexport interface AppRoot {\n  id: number;\n  component: string;\n  parent: Simple.Node;\n  nextSibling: Option<Simple.Node>;\n}\n\nexport interface ApplicationConstructor<T = Application> {\n  new (options: ApplicationOptions): T;\n}\n\nexport type Notifier = [() => void, (err) => void];\n\nexport default class Application implements Owner {\n  public rootName: string;\n  public resolver: Resolver;\n  public document: Simple.Document;\n  public env: Environment;\n\n  private _roots: AppRoot[] = [];\n  private _rootsIndex = 0;\n  private _registry: Registry;\n  private _container: Container;\n  private _initializers: Initializer[] = [];\n  private _initialized = false;\n  private _rendering = false;\n  private _rendered = false;\n  private _scheduled = false;\n  private _result: RenderResult;\n\n  protected _notifiers: Notifier[] = [];\n\n  constructor(options: ApplicationOptions) {\n    this.rootName = options.rootName;\n    this.resolver = options.resolver;\n    this.document = options.document || (typeof window !== 'undefined' && window.document);\n  }\n\n  /**\n   * Renders a component by name into the provided element, and optionally\n   * adjacent to the provided nextSibling element.\n   *\n   * ## Examples\n   *\n   * ```js\n   * app.renderComponent('MyComponent', document.body, document.getElementById('my-footer'));\n   * ```\n   */\n  renderComponent(component: string, parent: Simple.Node, nextSibling: Option<Simple.Node> = null): void {\n    this._roots.push({ id: this._rootsIndex++, component, parent, nextSibling });\n    this.scheduleRerender();\n  }\n\n  /**\n   * Initializes the application and renders any components that have been\n   * registered via `renderComponent()`.\n   */\n  boot(): void {\n    this.initialize();\n\n    this.env = this.lookup(`environment:/${this.rootName}/main/main`);\n\n    this._render();\n  }\n\n  /**\n   * Schedules all components to revalidate and potentially update the DOM to\n   * reflect any changes to underlying component state.\n   *\n   * Generally speaking, you  should avoid calling `scheduleRerender()`\n   * manually. Instead, use tracked properties on components and models, which\n   * invoke this method for you automatically when appropriate.\n   */\n  scheduleRerender(): void {\n    if (this._scheduled || !this._rendered) return;\n\n    this._rendering = true;\n    this._scheduled = true;\n    requestAnimationFrame(() => {\n      this._scheduled = false;\n      this._rerender();\n      this._rendering = false;\n    });\n  }\n\n  /** @hidden */\n  initialize(): void {\n    this.initRegistry();\n    this.initContainer();\n  }\n\n  /** @hidden */\n  registerInitializer(initializer: Initializer): void {\n    this._initializers.push(initializer);\n  }\n\n  /**\n   * @hidden\n   *\n   * Initializes the registry, which maps names to objects in the system. Addons\n   * and subclasses can customize the behavior of a Glimmer application by\n   * overriding objects in the registry.\n   */\n  protected initRegistry(): void {\n    let registry = this._registry = new Registry();\n\n    // Create ApplicationRegistry as a proxy to the underlying registry\n    // that will only be available during `initialize`.\n    let appRegistry = new ApplicationRegistry(this._registry, this.resolver);\n\n    registry.register(`environment:/${this.rootName}/main/main`, Environment);\n    registry.registerOption('helper', 'instantiate', false);\n    registry.registerOption('template', 'instantiate', false);\n    registry.register(`document:/${this.rootName}/main/main`, this.document as any);\n    registry.registerOption('document', 'instantiate', false);\n    registry.registerInjection('environment', 'document', `document:/${this.rootName}/main/main`);\n    registry.registerInjection('component-manager', 'env', `environment:/${this.rootName}/main/main`);\n\n    let initializers = this._initializers;\n    for (let i = 0; i < initializers.length; i++) {\n      initializers[i].initialize(appRegistry);\n    }\n\n    this._initialized = true;\n  }\n\n  /**\n   * @hidden\n   *\n   * Initializes the container, which stores instances of objects that come from\n   * the registry.\n   */\n  protected initContainer(): void {\n    this._container = new Container(this._registry, this.resolver);\n\n    // Inject `this` (the app) as the \"owner\" of every object instantiated\n    // by its container.\n    this._container.defaultInjections = (specifier: string) => {\n      let hash = {};\n      setOwner(hash, this);\n      return hash;\n    };\n  }\n\n  /**\n   * @hidden\n   *\n   * The compiled `main` root layout template.\n   */\n  protected get mainLayout(): Template<Specifier> {\n    return templateFactory(mainTemplate).create(this.env.compileOptions);\n  }\n\n  /**\n   * @hidden\n   *\n   * Configures and returns a template iterator for the root template, appropriate\n   * for performing the initial render of the Glimmer application.\n   */\n  protected get templateIterator(): TemplateIterator {\n    let { env, mainLayout } = this;\n\n    // Create the template context for the root `main` template, which just\n    // contains the array of component roots. Any property references in that\n    // template will be looked up from this object.\n    let self = new UpdatableReference({ roots: this._roots });\n\n    // Create an empty root scope.\n    let dynamicScope = new DynamicScope();\n\n    // The cursor tells the template which element to render into.\n    let cursor = {\n      element: (this.document as Document).body,\n      nextSibling: null\n    };\n\n    return mainLayout.renderLayout({\n      env,\n      self,\n      dynamicScope,\n      builder: clientBuilder(env, cursor)\n    });\n  }\n\n  /** @hidden\n   *\n   * Ensures the DOM is up-to-date by performing a revalidation on the root\n   * template's render result. This method should not be called directly;\n   * instead, any mutations in the program that could cause side-effects should\n   * call `scheduleRerender()`, which ensures that DOM updates only happen once\n   * at the end of the browser's event loop.\n   */\n  protected _rerender() {\n    let { env, _result: result } = this;\n\n    if (!result) {\n      throw new Error('Cannot re-render before initial render has completed');\n    }\n\n    try {\n      env.begin();\n      result.rerender();\n      env.commit();\n\n      this._didRender();\n    } catch (err) {\n      this._didError(err);\n    }\n  }\n\n  /** @hidden */\n  protected _render(): void {\n    let { env, templateIterator } = this;\n\n    try {\n      // Begin a new transaction. The transaction stores things like component\n      // lifecycle events so they can be flushed once rendering has completed.\n      env.begin();\n\n      // Iterate the template iterator, executing the compiled template program\n      // until there are no more instructions left to execute.\n      let result;\n      do {\n        result = templateIterator.next();\n      } while (!result.done);\n\n      // Finally, commit the transaction and flush component lifecycle hooks.\n      env.commit();\n\n      this._result = result.value;\n      this._didRender();\n    } catch (err) {\n      this._didError(err);\n      throw err;\n    }\n  }\n\n  protected _didRender(): void {\n    this._rendered = true;\n\n    let notifiers = this._notifiers;\n    this._notifiers = [];\n\n    notifiers.forEach(n => n[0]());\n  }\n\n  protected _didError(err: Error): void {\n    let notifiers = this._notifiers;\n    this._notifiers = [];\n\n    notifiers.forEach(n => n[1](err));\n  }\n\n  /**\n   * Owner interface implementation\n   *\n   * @hidden\n   */\n  identify(specifier: string, referrer?: string): string {\n    return this.resolver.identify(specifier, referrer);\n  }\n\n  /** @hidden */\n  factoryFor(specifier: string, referrer?: string): Factory<any> {\n    return this._container.factoryFor(this.identify(specifier, referrer));\n  }\n\n  /** @hidden */\n  lookup(specifier: string, referrer?: string): any {\n    return this._container.lookup(this.identify(specifier, referrer));\n  }\n}\n","import { RegistrationOptions } from './registry';\nimport { Factory } from './factory';\n\n// TODO - use symbol\nexport const OWNER = '__owner__';\n\nexport function getOwner(object: object): Owner {\n  return object[OWNER];\n}\n\nexport function setOwner(object: object, owner: Owner): void {\n  object[OWNER] = owner;\n}\n\nexport interface Owner {\n  identify(specifier: string, referrer?: string): string;\n\n  factoryFor(specifier: string, referrer?: string): Factory<any>;\n  \n  lookup(specifier: string, referrer?: string): any;\n}\n","export interface Specifier {\n  rootName?: string;\n  collection?: string;\n  namespace?: string;\n  name?: string;\n  type?: string;\n}\n\nexport function isSpecifierStringAbsolute(specifier: string): boolean {\n  let [type, path] = specifier.split(':');\n  return !!(type && path && path.indexOf('/') === 0 && path.split('/').length > 3);\n}\n\nexport function isSpecifierObjectAbsolute(specifier: Specifier): boolean {\n  return specifier.rootName !== undefined &&\n         specifier.collection !== undefined &&\n         specifier.name !== undefined &&\n         specifier.type !== undefined;\n}\n\nexport function serializeSpecifier(specifier: Specifier): string {\n  let type = specifier.type;\n  let path = serializeSpecifierPath(specifier);\n\n  if (path) {\n    return type + ':' + path;\n  } else {\n    return type;\n  }\n}\n\nexport function serializeSpecifierPath(specifier: Specifier): string {\n  let path = [];\n  if (specifier.rootName) {\n    path.push(specifier.rootName);\n  }\n  if (specifier.collection) {\n    path.push(specifier.collection);\n  }\n  if (specifier.namespace) {\n    path.push(specifier.namespace);\n  }\n  if (specifier.name) {\n    path.push(specifier.name);\n  }\n\n  if (path.length > 0) {\n    let fullPath = path.join('/');\n    if (isSpecifierObjectAbsolute(specifier)) {\n      fullPath = '/' + fullPath;\n    }\n    return fullPath;\n  }\n}\n\nexport function deserializeSpecifier(specifier: string): Specifier {\n  let obj: Specifier = {};\n\n  if (specifier.indexOf(':') > -1) {\n    let [type, path] = specifier.split(':');\n    obj.type = type;\n\n    let pathSegments;\n\n    if (path.indexOf('/') === 0) {\n      pathSegments = path.substr(1).split('/');\n      obj.rootName = pathSegments.shift();\n      obj.collection = pathSegments.shift();\n    } else {\n      pathSegments = path.split('/');\n    }\n\n    if (pathSegments.length > 0) {\n      obj.name = pathSegments.pop();\n\n      if (pathSegments.length > 0) {\n        obj.namespace = pathSegments.join('/');\n      }\n    }\n\n  } else {\n    obj.type = specifier;\n  }\n\n  return obj;\n}\n","export function assert(description: string, test: any) {\n  if (!test) {\n    throw new Error('Assertion Failed: ' + description);\n  }\n}\n","import { Specifier } from '@glimmer/di';\n\nexport function detectLocalResolutionCollection(specifier: Specifier): string {\n  let { namespace, collection } = specifier;\n\n  // Look for the local-most private collection contained in the namespace\n  // (which will appear closest to the end of the string)\n  let startPos = namespace.lastIndexOf('/-');\n  if (startPos > -1) {\n    startPos += 2;\n    let endPos = namespace.indexOf('/', startPos);\n    collection = namespace.slice(startPos, endPos > -1 ? endPos : undefined);\n  }\n\n  return collection;\n}\n","import {\n  Resolver as IResolver,\n  Specifier,\n  isSpecifierStringAbsolute,\n  isSpecifierObjectAbsolute,\n  deserializeSpecifier,\n  serializeSpecifier\n} from '@glimmer/di';\nimport { assert } from './utils/debug';\nimport { detectLocalResolutionCollection } from './utils/specifiers';\nimport { ModuleRegistry } from './module-registry';\nimport { ResolverConfiguration } from './resolver-configuration';\n\nexport default class Resolver implements IResolver {\n  public config: ResolverConfiguration;\n  public registry: ModuleRegistry;\n\n  constructor(config: ResolverConfiguration, registry: ModuleRegistry) {\n    this.config = config;\n    this.registry = registry;\n  }\n\n  identify(specifier: string, referrer?: string): string {\n    if (isSpecifierStringAbsolute(specifier)) {\n      return specifier;\n    }\n\n    let s = deserializeSpecifier(specifier);\n    let result: string;\n\n    if (referrer) {\n      let r = deserializeSpecifier(referrer);\n\n      if (isSpecifierObjectAbsolute(r)) {\n        assert('Specifier must not include a rootName, collection, or namespace when combined with an absolute referrer', s.rootName === undefined && s.collection === undefined && s.namespace === undefined);\n\n        s.rootName = r.rootName;\n        s.collection = r.collection;\n        let definitiveCollection = this._definitiveCollection(s.type);\n\n        if (!s.name) {\n          /*\n           * For specifiers without a name use the referrer's name and\n           * do not fallback to any other resolution rules.\n           */\n          s.namespace = r.namespace;\n          s.name = r.name;\n          return this._serializeAndVerify(s);\n        }\n\n        s.namespace = r.namespace ? r.namespace + '/' + r.name : r.name;\n        if (detectLocalResolutionCollection(s) === definitiveCollection) {\n          /*\n           * For specifiers with a name, try local resolution. Based on\n           * the referrer.\n           */\n          if (result = this._serializeAndVerify(s)) { return result; }\n        }\n\n        // Look for a private collection in the referrer's namespace\n        if (definitiveCollection) {\n          s.namespace += '/-' + definitiveCollection;\n          if (result = this._serializeAndVerify(s)) { return result; }\n        }\n\n        // Because local and private resolution has failed, clear all but `name` and `type`\n        // to proceed with top-level resolution\n        s.rootName = s.collection = s.namespace = undefined;\n      } else {\n        assert('Referrer must either be \"absolute\" or include a `type` to determine the associated type', r.type);\n\n        // Look in the definitive collection for the associated type\n        s.collection = this._definitiveCollection(r.type);\n        assert(`'${r.type}' does not have a definitive collection`, s.collection);\n      }\n    }\n\n    // If the collection is unspecified, use the definitive collection for the `type`\n    if (!s.collection) {\n      s.collection = this._definitiveCollection(s.type);\n      assert(`'${s.type}' does not have a definitive collection`, s.collection);\n    }\n\n    if (!s.rootName) {\n      // If the root name is unspecified, try the app's `rootName` first\n      s.rootName = this.config.app.rootName || 'app';\n      if (result = this._serializeAndVerify(s)) { return result; }\n\n      // Then look for an addon with a matching `rootName`\n      let addonDef;\n      if (s.namespace) {\n        addonDef = this.config.addons && this.config.addons[s.namespace];\n        s.rootName = s.namespace;\n        s.namespace = undefined;\n\n      } else {\n        addonDef = this.config.addons && this.config.addons[s.name];\n        s.rootName = s.name;\n        s.name = 'main';\n      }\n    }\n\n    if (result = this._serializeAndVerify(s)) { return result; }\n  }\n\n  retrieve(specifier: string): any {\n    return this.registry.get(specifier);\n  }\n\n  resolve(specifier: string, referrer?: string): any {\n    let id = this.identify(specifier, referrer);\n    if (id) {\n      return this.retrieve(id);\n    }\n  }\n\n  private _definitiveCollection(type: string): string {\n    let typeDef = this.config.types[type];\n    assert(`'${type}' is not a recognized type`, typeDef);\n    return typeDef.definitiveCollection;\n  }\n\n  private _serializeAndVerify(specifier: Specifier): string {\n    let serialized = serializeSpecifier(specifier);\n    if (this.registry.has(serialized)) {\n      return serialized;\n    }\n  }\n}\n","import Component, { tracked } from '@glimmer/component';\n\nconst dotStyle = {\n    'position': 'absolute',\n    'background': '#61dafb',\n    'font': 'normal 15px sans-serif',\n    'text-align': 'center',\n    'cursor': 'pointer'\n};\n\nexport default class SierpinskiDot extends Component {\n    @tracked private hover = false;\n    private allStyles = '';\n    private tagName = '';\n    @tracked('args', 'hover')\n    get text() {\n        return this.hover ? '*' + this.args.text + '*' : this.args.text;\n    }\n    public didInsertElement() {\n        const s = this.args.size * 1.3;\n        const newStyle = {\n            ...dotStyle,\n            'top': (this.args.y) + 'px',\n            'width': s + 'px',\n            'height': s + 'px',\n            'left': (this.args.x) + 'px',\n            'border-radius': (s / 2) + 'px',\n            'line-height': (s) + 'px',\n        };\n        this.allStyles =  Object.keys(newStyle).map((key) => {\n            return `${key}:${newStyle[key]}`;\n        }).join(';');\n    }\n    @tracked('args', 'hover')\n    get style() {\n        return this.allStyles + ';background:' + (this.hover ? '#ff0' : dotStyle.background);\n    }\n    enter() {\n       this.hover = true;\n    }\n    leave() {\n        this.hover = false;\n    }\n}\n","export default {\"id\":\"v4i1gVlB\",\"block\":\"{\\\"symbols\\\":[],\\\"statements\\\":[[6,\\\"div\\\"],[11,\\\"style\\\",[20,\\\"style\\\"],null],[11,\\\"onmouseenter\\\",[26,\\\"action\\\",[[22,[\\\"enter\\\"]]],null],null],[11,\\\"onmouseleave\\\",[26,\\\"action\\\",[[22,[\\\"leave\\\"]]],null],null],[8],[1,[20,\\\"text\\\"],false],[9]],\\\"hasEval\\\":false}\",\"meta\":{\"specifier\":\"template:/sierpinski-glimmer/components/SierpinskiDot\"}};","import Component, { tracked } from '@glimmer/component';\n\nconst containerStyle = {\n    position: 'absolute',\n    'transform-origin': '0 0',\n    left: '50%',\n    top: '50%',\n    width: '10px',\n    height: '10px',\n    zoom: '.75',\n};\n\nconst styleLine =  Object.keys(containerStyle).map((key) => {\n    return `${key}:${containerStyle[key]}`;\n}).join(';');\n\nexport default class SierpinskiGlimmer extends Component {\n    private tagName = '';\n    public targetSize = 25;\n    public start = 0;\n    public intervalID = null;\n    @tracked public seconds = 0;\n    @tracked public elapsed = 0;\n    @tracked public style = '';\n    public x = 0;\n    public y = 0;\n    public s = 1000;\n    public tick() {\n        this.seconds = (this.seconds % 10 ) + 1;\n    }\n\n    public updateRender() {\n        this.elapsed = new Date().getTime() - this.start;\n        const t = (this.elapsed / 1000) % 10;\n        const scale = 1 + (t > 5 ? 10 - t : t) / 10;\n        const transform = 'scaleX(' + (scale / 2.1) + ') scaleY(0.7) translateZ(0.1px)';\n        this.style = `${styleLine};transform:${transform}`;\n    }\n\n    public didInsertElement() {\n        this.start = new Date().getTime();\n        this.intervalID = setInterval(this.tick.bind(this), 1000);\n        const update = ()  => {\n            this.updateRender();\n            requestAnimationFrame(update);\n        };\n        requestAnimationFrame(update);\n    }\n}\n","export default {\"id\":\"OxrzgNPj\",\"block\":\"{\\\"symbols\\\":[],\\\"statements\\\":[[6,\\\"div\\\"],[11,\\\"style\\\",[20,\\\"style\\\"],null],[8],[0,\\\"\\\\n\\\"],[5,\\\"SierpinskiTriangle\\\",[],[[\\\"@x\\\",\\\"@y\\\",\\\"@s\\\",\\\"@targetSize\\\",\\\"@children\\\"],[[20,\\\"x\\\"],[20,\\\"y\\\"],[20,\\\"s\\\"],[20,\\\"targetSize\\\"],[20,\\\"seconds\\\"]]],{\\\"statements\\\":[],\\\"parameters\\\":[]}],[0,\\\"\\\\n\\\"],[9],[0,\\\"\\\\n\\\"]],\\\"hasEval\\\":false}\",\"meta\":{\"specifier\":\"template:/sierpinski-glimmer/components/SierpinskiGlimmer\"}};","import Component, { tracked } from '@glimmer/component';\n\nexport default class SierpinskiTriangle extends Component {\n    private tagName = '';\n    @tracked('args')\n    get attrs() {\n        let halfTarget = this.args.targetSize / 2;\n        let { x, y } = this.args;\n        let renderDot = this.args.s <= this.args.targetSize;\n        if (renderDot) {\n            return {\n                dotX: x - halfTarget,\n                dotY: y - halfTarget,\n                renderDot\n            };\n        } else {\n            let s = this.args.s / 2;\n            let halfS = s / 2;\n\n            let slowDown = false;\n            if (slowDown) {\n                let e = performance.now() + 0.8;\n                while (performance.now() < e) {\n                    // Artificially long execution time.\n                }\n            }\n\n            return {\n                s,\n                renderDot,\n                x1: x,\n                x2: x - s,\n                x3: x + s,\n                y1: y - halfS,\n                y2: y + halfS,\n                y3: y + halfS\n            };\n        }\n    }\n}\n","export default {\"id\":\"qq4lt0TA\",\"block\":\"{\\\"symbols\\\":[\\\"@children\\\",\\\"@targetSize\\\"],\\\"statements\\\":[[4,\\\"if\\\",[[22,[\\\"attrs\\\",\\\"renderDot\\\"]]],null,{\\\"statements\\\":[[0,\\\"    \\\"],[5,\\\"SierpinskiDot\\\",[],[[\\\"@x\\\",\\\"@y\\\",\\\"@size\\\",\\\"@text\\\"],[[22,[\\\"attrs\\\",\\\"dotX\\\"]],[22,[\\\"attrs\\\",\\\"dotY\\\"]],[21,2,[]],[21,1,[]]]],{\\\"statements\\\":[],\\\"parameters\\\":[]}],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]},{\\\"statements\\\":[[0,\\\"        \\\"],[5,\\\"SierpinskiTriangle\\\",[],[[\\\"@x\\\",\\\"@y\\\",\\\"@s\\\",\\\"@children\\\",\\\"@targetSize\\\"],[[22,[\\\"attrs\\\",\\\"x1\\\"]],[22,[\\\"attrs\\\",\\\"y1\\\"]],[22,[\\\"attrs\\\",\\\"s\\\"]],[21,1,[]],[21,2,[]]]],{\\\"statements\\\":[],\\\"parameters\\\":[]}],[0,\\\"\\\\n        \\\"],[5,\\\"SierpinskiTriangle\\\",[],[[\\\"@x\\\",\\\"@y\\\",\\\"@s\\\",\\\"@children\\\",\\\"@targetSize\\\"],[[22,[\\\"attrs\\\",\\\"x2\\\"]],[22,[\\\"attrs\\\",\\\"y2\\\"]],[22,[\\\"attrs\\\",\\\"s\\\"]],[21,1,[]],[21,2,[]]]],{\\\"statements\\\":[],\\\"parameters\\\":[]}],[0,\\\"\\\\n        \\\"],[5,\\\"SierpinskiTriangle\\\",[],[[\\\"@x\\\",\\\"@y\\\",\\\"@s\\\",\\\"@children\\\",\\\"@targetSize\\\"],[[22,[\\\"attrs\\\",\\\"x3\\\"]],[22,[\\\"attrs\\\",\\\"y3\\\"]],[22,[\\\"attrs\\\",\\\"s\\\"]],[21,1,[]],[21,2,[]]]],{\\\"statements\\\":[],\\\"parameters\\\":[]}],[0,\\\"\\\\n\\\"]],\\\"parameters\\\":[]}]],\\\"hasEval\\\":false}\",\"meta\":{\"specifier\":\"template:/sierpinski-glimmer/components/SierpinskiTriangle\"}};","import { default as __ui_components_SierpinskiDot_component__ } from '../src/ui/components/SierpinskiDot/component';\nimport { default as __ui_components_SierpinskiDot_template__ } from '../src/ui/components/SierpinskiDot/template';\nimport { default as __ui_components_SierpinskiGlimmer_component__ } from '../src/ui/components/SierpinskiGlimmer/component';\nimport { default as __ui_components_SierpinskiGlimmer_template__ } from '../src/ui/components/SierpinskiGlimmer/template';\nimport { default as __ui_components_SierpinskiTriangle_component__ } from '../src/ui/components/SierpinskiTriangle/component';\nimport { default as __ui_components_SierpinskiTriangle_template__ } from '../src/ui/components/SierpinskiTriangle/template';\nexport default {'component:/sierpinski-glimmer/components/SierpinskiDot': __ui_components_SierpinskiDot_component__,'template:/sierpinski-glimmer/components/SierpinskiDot': __ui_components_SierpinskiDot_template__,'component:/sierpinski-glimmer/components/SierpinskiGlimmer': __ui_components_SierpinskiGlimmer_component__,'template:/sierpinski-glimmer/components/SierpinskiGlimmer': __ui_components_SierpinskiGlimmer_template__,'component:/sierpinski-glimmer/components/SierpinskiTriangle': __ui_components_SierpinskiTriangle_component__,'template:/sierpinski-glimmer/components/SierpinskiTriangle': __ui_components_SierpinskiTriangle_template__};\n","export default {\"app\":{\"name\":\"sierpinski-glimmer\",\"rootName\":\"sierpinski-glimmer\"},\"types\":{\"application\":{\"definitiveCollection\":\"main\"},\"component\":{\"definitiveCollection\":\"components\"},\"component-test\":{\"unresolvable\":true},\"helper\":{\"definitiveCollection\":\"components\"},\"helper-test\":{\"unresolvable\":true},\"renderer\":{\"definitiveCollection\":\"main\"},\"template\":{\"definitiveCollection\":\"components\"}},\"collections\":{\"main\":{\"types\":[\"application\",\"renderer\"]},\"components\":{\"group\":\"ui\",\"types\":[\"component\",\"component-test\",\"template\",\"helper\",\"helper-test\"],\"defaultType\":\"component\",\"privateCollections\":[\"utils\"]},\"styles\":{\"group\":\"ui\",\"unresolvable\":true},\"utils\":{\"unresolvable\":true}}};\n","import Application from '@glimmer/application';\nimport Resolver, { BasicModuleRegistry } from '@glimmer/resolver';\nimport moduleMap from '../config/module-map';\nimport resolverConfiguration from '../config/resolver-configuration';\n\nexport default class App extends Application {\n  constructor() {\n    let moduleRegistry = new BasicModuleRegistry(moduleMap);\n    let resolver = new Resolver(resolverConfiguration, moduleRegistry);\n\n    super({\n      resolver,\n      rootName: resolverConfiguration.app.rootName\n    });\n  }\n}\n","import { ComponentManager, setPropertyDidChange } from '@glimmer/component';\nimport App from './main';\n\nconst app = new App();\nconst containerElement = document.getElementById('app');\n\nsetPropertyDidChange(() => {\n  app.scheduleRerender();\n});\n\napp.registerInitializer({\n  initialize(registry) {\n    registry.register(`component-manager:/${app.rootName}/component-managers/main`, ComponentManager);\n  }\n});\n\napp.renderComponent('SierpinskiGlimmer', containerElement, null);\n\napp.boot();\n"],"names":["assert","Ops","WireFormat.Ops","ClientSide.Ops","isGet","WireFormat.isGet","isMaybeLocal","WireFormat.isMaybeLocal","map","ConditionalReference","SVG_NAMESPACE","shouldApplyFix","bounds","Meta","PropertyReference","hasOwnProperty","RootReference","isSpecifierObjectAbsolute","__ui_components_SierpinskiDot_component__","__ui_components_SierpinskiDot_template__","__ui_components_SierpinskiGlimmer_component__","__ui_components_SierpinskiGlimmer_template__","__ui_components_SierpinskiTriangle_component__","__ui_components_SierpinskiTriangle_template__"],"mappings":";;;;;;gBAW0B,KAAe,SACvC;QAAI,QAAQ,QAAQ,QAAQ,WAAW,MAAM,IAAI,MAAM;WAChD;;AAGT,qBAA4B,UAAU,eACpC;WAAO,IAAI,MAAM;;;ACjBnB;;AAIA,qBAA4B,MAAW,KACrC;;;;;QAKI,CAAC,MAAM;cACH,IAAI,MAAM,OAAO;;CAI3B,AAEA;;MCjBc,UAAY,OAAlB;;AASR,gBAAuB,KACrB;SAAK,IAAI,IAAI,GAAG,IAAI,UAAU,QAAQ,KAAK;YACrC,aAAa,UAAU;YACvB,eAAe,QAAQ,OAAO,eAAe,UAAU;YACvD,OAAO,QAAQ;aACd,IAAI,IAAI,GAAG,IAAI,KAAK,QAAQ,KAAK;gBAChC,MAAM,KAAK;gBACX,OAAO,WAAW;;;WAGnB;;AAGT,mBAA6B,OAC3B;QAAI,MAAM,IAAI,MAAM;SAEf,IAAI,IAAE,GAAG,IAAE,OAAO,KAAK;YACtB,KAAK;;WAGJ;;;AC7BT,IAAI,OAAO;AAMX,wBAA+B,QAC7B;WAAQ,OAAO,QAAQ,EAAE;;AAG3B,oBAA2B,QACzB;WAAO,OAAO,SAAS,eAAe;;;gBCEtC;WAAO,OAAO,OAAO;;AAKvB;kBAII;aAAK,OAAO;;QAGV,KACF;YAAI,OAAO,QAAQ,UAAU,KAAK,KAAK,OAAc,SAChD,KAAK,KAAK,WAAW,QAAe;eAClC;;WAGF,KACL;YAAI,OAAO,QAAQ,UAAU,OAAO,KAAK,KAAK,UACzC,IAAK,IAAY,OAAO,OAAO,KAAK,KAAM,IAAY;;;AAI/D;kBACU;aAAK,QAAQ;aACP,UAAc;;QAEjB,OACT;eAAO,KAAK,MAAM;;SAGf,MACH;aAAK,UAAU;aACV,MAAM,KAAK;;UAIhB;YAAI,OAAO,KAAK,MAAM;YAClB,MAAM,KAAK,MAAM;aAChB,UAAU,QAAQ,IAAI,OAAO,KAAK,MAAM,MAAM;eAE5C,SAAS,YAAY,OAAO;;cAInC;eAAO,KAAK,MAAM,WAAW;;;;;gBC/CnB,OAJL;aAAI,OAAwB;aACxB,OAAwB;aAI5B,QAAQ;;;AAQjB;kBAMI;aAAK;;WAIL;eAAO,KAAK;;WAIZ;eAAO,KAAK;;YAIZ;aAAK,QAAQ,KAAK,QAAQ;;cAI1B;YAAI,MAAW;aACV,YAAY,KAAK,IAAI,KAAK;eACxB;;aAGA,MACP;eAAO,KAAK;;gBAGF,UACV;YAAI,OAAO,KAAK;eAET,SAAS,MAAM;qBACX;mBACF,KAAK;;;iBAIH,MAAS,YAAuB,MAC3C;YAAI,cAAc,MAAM,OAAO,KAAK,OAAO;YAEvC,UAAU,MAAM,UAAU,KAAK,OAAO,UACrC,KAAK,QAAQ;aAEb,OAAO,UAAU;aACjB,OAAO;kBACF,OAAO;eAEV;;WAGF,MACL;YAAI,OAAO,KAAK;YAEZ,MAAM;iBACH,OAAO;iBACP,OAAO;iBACP,OAAO;eACP;iBACA,QAAQ;;eAGP,KAAK,QAAQ;;WAGhB,MACL;YAAI,KAAK,MAAM,KAAK,KAAK,OAAO,KAAK,UAChC,KAAK,QAAQ,KAAK;YAEnB,KAAK,MAAM,KAAK,KAAK,OAAO,KAAK,UAChC,KAAK,QAAQ,KAAK;eAEhB;;;AAgBX;gBAIc,MAAiB,MAC3B;aAAK,QAAQ;aACR,QAAQ;;gBAGH,UACV;YAAI,OAAO,KAAK;eAET,SAAS,MAAM;qBACX;mBACF,KAAK,SAAS;;;WAKvB;eAAO,KAAK;;WAIZ;eAAO,KAAK;;cAIZ;YAAI,MAAW;aACV,YAAY,KAAK,IAAI,KAAK;eACxB;;aAGA,MACP;YAAI,SAAS,KAAK,OAAO,OAAO;eACzB,KAAK;;;AAIhB,AAAO,MAAM,cAAc,IAAI,UAAU,MAAM;;ACrJxC,MAAM,cAAqB,OAAO,OAAO;;ACsBzC,MAAM,WAAqB;AAClC,AAAO,MAAM,UAAqB;AAClC,AAAO,MAAM,WAAqB;AAElC;aAKW,UACP;eAAO,KAAK,YAAY;;;AALnB,YAAE,KAAG;AASd,MAAM,QAAoD;AAC1D,MAAM,WAA0E;AAEhF;gBACsB,MAAqB,OAArB;aAAI,OAAJ;aAA0B,QAAL;;YAGvC;YAAI,OAAO,MAAM,KAAK;eACf,KAAK,KAAK;;aAGV,UACP;YAAI,OAAO,SAAS,KAAK;eAClB,KAAK,KAAK,OAAO;;;AAM5B,kBAAkB,MAChB;QAAI,OAAO,MAAM;UACX,KAAK,OAAsB,IAAI;aAC5B,KAAK,CAAC,KAAkB,aAAuB,IAAI,SAAS;SAChE,KAAK;;;;AAMZ,MAAM,KAAK,MAAM;AACjB,SAAS,KAAK,CAAC,MAAM,aAAa,aAAa;AAC/C,AAAO,MAAM,eAAe,IAAI,WAAW,GAAG;;AAG9C,MAAM,KAAK,MAAM;AACjB,SAAS,KAAK,CAAC,MAAM,aAAa,aAAa;AAC/C,AAAO,MAAM,eAAe,IAAI,WAAW,GAAG;;AAG9C,MAAM,KAAK,MAAM;AACjB,SAAS,KAAK,CAAC,MAAM,aAAa,aAAa;AAC/C,AAAO,MAAM,cAAc,IAAI,WAAW,GAAG;AAE7C,iBAAwB,EAAE,OACxB;WAAO,QAAQ;;AAGjB,oBAA2B,KACzB;WAAO,QAAQ;;;AAKjB,IAAI,YAAY;AAEhB,MAA0B,qBAAQ;WACzB,OAAO,WAAW,WACvB;eAAO,IAAI,WAAW,KAAK,IAAI,IAAI,aAAa;;gBAKtC,WAAW,WACrB;;aACK,WAAW;;YAIhB;eAAO,KAAK;;YAIZ;aAAK,WAAW,EAAE;;;AAItB,SAAS;AAET,uBAA8B,QAC5B;QAAI,YAAmB;SAElB,IAAI,IAAE,GAAG,IAAE,OAAO,QAAQ,IAAE,GAAG,KAAK;YACnC,MAAM,OAAO,GAAG;YAChB,QAAQ,cAAc,OAAO;YAC7B,QAAQ,cAAc;kBAChB,KAAK;;WAGV,SAAS;;AAGlB,sBAA6B,OAC3B;QAAI,YAAmB;QAEnB,OAAO,MAAM;WAEX,SAAS,MAAM;YACf,MAAM,KAAK;YAEX,QAAQ,cAAc,OAAO;YAC7B,QAAQ,cAAc,UAAU,KAAK;eAElC,MAAM,SAAS;;WAGjB,SAAS;;AAGlB,iBAAwB,MACtB;QAAI,YAAmB;SAElB,IAAI,IAAE,GAAG,IAAE,KAAK,QAAQ,IAAE,GAAG,KAAK;YACjC,MAAM,KAAK;YACX,QAAQ,cAAc,OAAO;YAC7B,QAAQ,cAAc;kBAChB,KAAK;;WAGV,SAAS;;AAGlB,kBAAkB,MAChB;YAAQ,KAAK;aACN;mBACI;aACJ;mBACI,KAAK;aACT;mBACI,SAAS,OAAO,KAAK,IAAI,KAAK;;mBAE9B,eAAe,OAAO;;;AAInC,MAAgC,kBAAQ;;iBAC9B;aAAW,cAAqB;aACvB,YAAqB;;;YAG9B;YAAa,YAAc;;YAE7B,gBAAgB,WAAW;iBACxB,cAAc;iBACd,YAAY,YAAY,KAAK;;eAG7B,KAAK;;iBAIZ;aAAK,cAAc;;;AAMvB,MAAe,iBAAQ;WACd,OAAO,OAAY,QACxB;eAAO,IAAI,WAAW,KAAK,IAAI,IAAI,SAAS,OAAO;;gBAMjC,OAAY,QAC9B;;aACK,QAAQ;aACR,SAAS;;cAId;eAAO,KAAK,IAAI,KAAK,MAAM,SAAS,KAAK,OAAO;;;AAIpD,SAAS;AAET,MAAqB,uBAAQ;WACpB,OAAO,MACZ;eAAO,IAAI,WAAW,KAAK,IAAI,IAAI,eAAe;;gBAKhC,MAClB;;aACK,OAAO;;;YAIN,OAAS;;YAEX,MAAM,CAAC;aAEN,IAAI,IAAE,GAAG,IAAE,KAAK,QAAQ,KAAK;gBAC5B,QAAQ,KAAK,GAAG;kBACd,KAAK,IAAI,OAAO;;eAGjB;;;AAIX,SAAS;AAET,MAA0B,qBAAQ;WACzB,OAAO,KACZ;eAAO,IAAI,WAAW,KAAK,IAAI,IAAI,aAAa;;gBAM9B,KAClB;;aACK,MAAM;aACN,cAAc;;cAInB;eAAO,KAAK,IAAI,KAAK,aAAa,KAAK,IAAI;;WAGtC,KACL;YAAI,QAAQ,KAAK,KAAK;iBACf,MAAM;iBACN,cAAc;iBACd;;;;AAKX,SAAS;AAUT;kBAGU;aAAY,eAAqB;aACxB,YAAc;;;YAGvB,MAAiC;YAA5B;YAAc;;YAErB,iBAAiB,QAAQ,CAAC,IAAI,SAAS,eAAe;wBAC5C,KAAK,YAAY,KAAK;iBAC7B,eAAe,IAAI;;eAGnB;;iBAMP;aAAK,eAAe;;;AAQxB,AAmBA;;AAMA;gBAQc,WAJJ;aAAS,YAAc;aACX,eAAqB;aACtB,cAAG;aAGf,MAAM,UAAU;aAChB,YAAY;;WAIjB;YAAI,CAAC,KAAK,aAAa;mBACd,KAAK;;eAGP,KAAK;;;YAIR,CAAC,KAAK,aAAa;mBACd,KAAK;;YAGR,YAA4B;YAAjB;;YACb,MAAM,UAAU;YAEhB,IAAI,SAAS,eAAyB,OAAO;aAC5C,eAAe,IAAI;YAElB,YAAc;;YAChB,QAAQ,UAAU;YAClB,UAAU,WAAW,OAAO;aAC3B,YAAY;eAEV;;;YAID,YAAc;;YAEhB,QAAQ,KAAK,YAAY,UAAU;aAClC,eAAe,UAAU,IAAI;aAC7B,cAAc;eAEZ;;;AAQX,MAAM,eAA4B;AAElC,oBAA8B,OAC5B;WAAO,UAAU;;;;gBChYK,OAAA;aAAK,QAFpB;aAAG,MAAQ;;YAIL;eAAO,KAAK;;;;MC2BL,iBAAQ;gBAOhB,UAA0B,QACpC;cAAM,SAAS,kBALV;aAAQ,WAAG;aACP,OAAG;aAKP,MAAM,OAAO;aACb,WAAW;aACX,OAAO,SAAS,iBAAiB;;WAGjC,MACL;aAAK,WAAW;aACX,SAAS,qBAAqB,KAAK,OAAO;aAC1C,SAAS,oBAAoB,KAAK,MAAM;;mBAI7C;eAAO,CAAC,KAAK;;YAIb;aAAK,WAAW;aACX,OAAO;;;AAIhB;gBAQc,UAJJ;aAAQ,WAA2B;aAChC,MAAG;aACF,OAAG,IAAI;aAGZ,MAAM,SAAS;aACf,WAAW;;cAIhB;YAAI,WAAW,KAAK,WAAW,KAAK,SAAS;eACtC,SAAS;;cAIhB;YAAI;YAEA,KAAK,aAAa,MAAM;uBACf,KAAK,SAAS;eACpB;uBACM,KAAK;;aAGb,WAAW;eAET;;QAGL,KACF;eAAO,CAAC,CAAC,KAAK,IAAI;;QAGhB,KACF;eAAO,KAAK,IAAI;;YAGV,KACN;YAAI,OAAO,KAAK,IAAI;eACb,SAAS,aAAa,KAAK;;WAG7B;YACC,MAAwB;YAAnB;YAAM;;YACb,OAAO,IAAI,KAAK,OAAO,IAAI,SAAS,UAAU;aAE7C,OAAO;eACL;;iBAGI,MAA2B;YAChC,MAAwB;YAAnB;YAAM;;YAEb,OAAO,IAAI,KAAK,OAAO,IAAI,SAAS,UAAU;aAC7C,WAAW;aACX,aAAa,MAAM;eACjB;;SAGJ,MAAgB;YACb,OAAS;;aAEV,WAAW;aACX,OAAO;aACP,aAAa,MAAM;;WAGnB;YACC,OAAS;;aAEV,OAAO;eACL,KAAK,IAAI,KAAK;;aAGd,MACP;eAAO,KAAK,KAAK,SAAS;;WAI1B;eAAO,KAAK,KAAK;;;AAIrB;;;gBAMc,UAJJ;aAAQ,WAA2B;YAKrC,YAAY,IAAI,mBAAmB;aAClC,YAAY;;;YAIX,YAAc;;YAEhB,WAAY,KAAK,WAAW,KAAK,YAAY,UAAU;YAEvD,OAAO,SAAS;YAEhB,SAAS,MAAM,OAAO;eAEnB,UAAU,OAAO;;;AAiB5B,IAAK;AAAL,WAAK,OACH;iCAAM;gCACD;+BACD;GAHD,UAAA,QAIJ;AAED;gBAMc,EAAE,QAAQ,aACpB;aAAK,SAAS;aACT,YAAY;aACZ,WAAW,UAAU;aACrB,UAAU,UAAU;;WAIzB;YAAI,QAAe,MAAM;eAElB,MAAM;oBACH;qBACD,MAAM;4BAAgB,KAAK;;qBAC3B,MAAM;4BAAe,KAAK;;qBAC1B,MAAM;yBAAW;;;;;iBAKP;YACb,UAAuB;YAAd;;YAEX,OAAO;eAEJ,SAAS,QAAQ,KAAK,QAAQ,KAAK;iBACnC,OAAO;mBACL,UAAU,SAAS;;YAGxB,SAAS,MAAM;iBACZ,UAAU,UAAU,SAAS;;;;YAK9B;YAAU,UAAuB;YAAd;;YAErB,OAAO,SAAS;YAEhB,SAAS,MAAM;mBACV,KAAK;;YAGR,MAAQ;;YAEV,YAAY,QAAQ,QAAQ,QAAQ,KAAK;iBACtC,WAAW;mBACP,UAAU,IAAI,MAAM;iBACxB,SAAS;eACT;iBACA,WAAW;;eAGX,MAAM;;eAGI;YACX;YAAW,UAAY;;kBAEZ;gBAET,OAAO;aACV,UAAU,UAAU,SAAS;aAC7B,OAAO,OAAO,KAAK,KAAK,QAAQ,OAAO,QAAQ;;aAGrC;YACT;YAAS;YAAW,SAAW;YAC/B,MAAQ;;YAEV,QAAQ,UAAU,IAAI,KAAK;cACzB,OAAO;YAET,UAAU,QAAQ,KAAK,MAAM;sBACrB,KAAK,OAAO;mBACf,KAAK,MAAM,KAAK,MAAM,OAAO,MAAM,MAAM,UAAU,QAAQ,MAAM;eACnE;iBACA,aAAa;;;eAIH;YACX;YAAW,SAAoB;YAAZ;;YAErB,OAAO,UAAU,aAAa,MAAM;eACjC,OAAO,KAAK,KAAK,KAAK,OAAO,KAAK,MAAM,UAAU,QAAQ,MAAM;;iBAIvE;aAAK,UAAU,KAAK,UAAU;eACvB,MAAM;;;YAIP;YAAW,SAAoB;YAAZ;;YAErB,YAAY,MAAM;mBACb,MAAM;;YAGX,OAAO;aACN,UAAU,UAAU,SAAS;YAE9B,KAAK,gBAAgB;sBACb,OAAO;mBACV,OAAO,KAAK;eACd;iBACA;;eAGA,MAAM;;eAIb;aAAK,OAAO;;;;;;QCrRH;;;;eAIJ;;;;YAIL;gEACgD;;mCAE7B;;;;;;;;;;;;;0BAkBL;;;;;;;;;;;;;;;AAwBlB;;;;;;;;;;;;;YAuBI;;;;;;;;;;;;;;;;;;;;;;;;oCAgCwB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;oBAoCV;;YAGZ;YAEF;;4CAGgC;;;;;;;;;uBAQZ;;;;;;;;;;;;;;;;;;IAkCtB;AAGF;QACI;+BACqB,KAAK,OAAO;;;gCAKX;;2BAEH;;;;;;;;;;;eAgBE;;;;;;;;gBAUN;cACb;sBADa;;;oBALA;;;;;iCAoBE,IAAI,KAAK;;;;YAItB;;;;eAKD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;mBCzRQ;;;;mBAeU;;;;;;;;;;;;;;;;;;;;;;0BCHO;;;;;;eASzB;YACH;;;yCAMyB;;oCAIH;;;;qBAOjB;;;;;;oBASC;;;wBAMS;;;;YAOf;YAEA,UAAU;;;uDAE+B;;;qBAMtB;YAGnB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;aCMC;YAED;;;;;;YAQA;;;;;;YASA;;;;;;;;;;;YAeA,UAAU,wBAAwB;YAElC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvHJ;kBAGuB;;;;;;;;;;;;;;;;;;;;oBCOT;;;;;;;;kBCQJ;aAAc,iBAAqB,yBAAmC;;QAEzD,MAAY,UAC/B;aAAK,eAAe,QAAkB;;aAG/B,IAAgB,QAAgB,MACvC;YAAI,OAAO,KAAK,eAAe;YAgB3B;YACA;YACA;aAeC,IAAI;;;;AAgCb,AAAO,MAAM,iBAAiB,IAAI;AAElC;kBAKI;uBAAe;;;AAInB,MAAqC,uBAAQ;;iBAG3C;aAAI,OAA2B;aAC3B,OAA2B;;;;ACjHjC;;;;;;AAOA,AAAA,IAAY;AAAZ,WAAY,UACV;;mCACI;;mCAGA;;mCAGA;;mCAGA;;mCAGA;mCACA;;mCAGA;mCACA;;mCAGA;GAtBM,aAAA,WAuBX;;MCzBoD,2BAAQ;gBAiBrC,OACpB;cAAM;;WAjBD,OAA4B,OACjC;YAAI,UAAU,WAAW;mBAChB;mBACE,UAAU,MAAM;mBAClB;mBACE,UAAU,MAAM;mBAClB;mBACE,UAAU,OAAO;mBACnB;mBACE,OAAO,UAAU,UAAU;mBAC7B,IAAI,eAAe;eACrB;mBACE,IAAI,gBAAgB;;;QAQ3B,MACF;eAAO;;;AAIX,MAAsB,wBAAQ;;iBACpB;aAAe,kBAAuC;;QAE1D,KACF;YAAI,QAAQ;gBACJ,kBAAoB;;gBAEtB,oBAAoB,MAAM;kCACV,KAAK,kBAAkB,IAAI,eAAe,KAAK,MAAM;;mBAGlE;eACF;mBACE,MAAM,IAAI;;;;AAOvB,MAAsC,uBAAQ;gBAChC,OACV;cAAM;;;AAIV,AAAO,MAAM,sBAAqD,IAAI,eAAe;AACrF,AAAO,MAAM,iBAA2C,IAAI,eAAe;AAC3E,AAAO,MAAM,iBAA8C,IAAI,eAAe;AAC9E,AAAO,MAAM,kBAA+C,IAAI,eAAe;AAE/E;gBAGsB,OAAA;aAAK,QAAL;aACb,MAAM,MAAM;;YAIjB;eAAO,KAAK,OAAO,KAAK,MAAM;;WAGf,OACf;eAAO,CAAC,CAAC;;;;MCvEgB,wBAAQ;gBAGf,OAClB;;aADuB,QAAL;aAEb,MAAM,cAAc;;cAIzB;YAAI,QAAQ,IAAI;aAEX,IAAI,IAAI,GAAG,IAAI,KAAK,MAAM,QAAQ,KAAK;gBACtC,QAAQ,KAAK,MAAM,GAAG;gBAEtB,UAAU,QAAQ,UAAU,WAAW;sBACnC,KAAK,aAAa;;;YAIxB,MAAM,SAAS,GAAG;mBACb,MAAM,KAAK;;eAGb;;;AAIX,sBAAsB,OACpB;QAAI,OAAO,MAAM,aAAa,YAAY;eACjC;;WAGF,OAAO;;;qBChCY,MAAc,KACxC;0CAAsC,aAAa,OAAO,IAC3D;;;ACUD,eAAe,oBAAe,CAAC,IAAI,EAAE,KAAK,aACxC;QAAI,QAAQ,GAAG;QACX,SAAe,GAAG,UAAU,cAAc;QAC1C,OAAa,MAAM;QACnB,QAAQ,OAAO,IAAI;OAEpB,UAAU,SAAS,IAAI;;AAG5B,eAAe,yBAAoB,CAAC,IAAI,EAAE,KAAK,aAC7C;QAAI,OAAO,GAAG,mBAAmB;OAC9B,MAAM,KAAK;;AAGhB,eAAe,yBAAoB,CAAC,IAAI,EAAE,KAAK,aAC7C;QAAI,OAAa,GAAG,MAAM;OACvB,QAAQ,WAAW,QAAQ;;AAGhC,eAAe,sBAAiB,CAAC,IAAI,EAAE,KAAK;QACtC,SAAe,GAAG,MAAM;QACxB,QAAc,GAAG,MAAM,MAD3B;QAEI,QAAc,GAAG,MAAM;QAEvB,QAA4B,QAAQ,CAAC,QAAS,OAAQ,SAAS;OAEhE,QAAQ,UAAU,QAAQ;;AAG/B,eAAe,gCAA0B,CAAC,IAAI,EAAE,KAAK,YACnD;QAAI,OAAO,GAAG,UAAU,UAAU;QAC9B,SAAS,GAAG,QAAQ;QAEpB,MAAM,OAAO;QACb,QAAQ,WAAW;cACf,GAAG,UAAU,IAAI;;OAGtB,MAAM,KAAK;;AAGhB,eAAe,wBAAkB,CAAC,IAAI,EAAE,KAAK,SAAS,KAAK,sBACzD;OAAG,cAAc,SAAS,CAAC,CAAC;;AAG9B,eAAe,yBAAoB,CAAC,IAAI,EAAE,KAAK,WAC7C;QAAI,MAAM,GAAG,UAAU,UAAU;QAC7B,OAAa,GAAG,MAAM;OACvB,MAAM,KAAK,KAAK,IAAI;;AAGzB,eAAe,sBAAiB,CAAC,IAAI,EAAE,KAAK;QACpC,QAAU;;QACZ,QAAQ,GAAG,QAAQ,SAAS;QAE5B,OAAO;cACH,KAAK,MAAM;cACX,KAAK,MAAM;cACX,KAAK,MAAM;WACZ;cACC,KAAK;cACL,KAAK;cACL,KAAK;;;AAMf,eAAe,sBAAiB,CAAC,IAAI,EAAE,KAAK,aAC1C;QAAI,WAAW,CAAC,CAAC,GAAG,QAAQ,SAAS;OAClC,MAAM,KAAK,WAAW,iBAAiB;;AAG5C,eAAe,4BAAuB,MACpC;;QAGI,QAAc,GAAG,MAAM;aAE3BA,YAAO,UAAU,QAAS,SAAS,OAAO,UAAU,YAAY,MAAM,QAAQ,MAAM,aAAc,YAAY,4BAA4B;;QAEtI,iBAAiB,SAAS,MAAM,WAAW;OAC5C,MAAM,KAAK,iBAAiB,iBAAiB;;AAGlD,eAAe,oBAAe,CAAC,IAAI,EAAE,KAAK,YACxC;QAAI,MAA6C,IAAI,MAAM;SAEtD,IAAI,IAAI,OAAO,IAAI,GAAG,KAAK;YAC1B,SAAS,IAAI;YACb,UAAgB,GAAG,MAAM;;OAG5B,MAAM,KAAK,IAAI,gBAAgB;;;AC5GpC,IAAY;AAAZ,WAAY,SACV;;mCACI;qCACE;sCACC;uCACC;oCACH;wCACI;0CACE;kDACQ;2CACP;2CACA;0CACF;2CACC;yCACF;qCACJ;uCACE;0CAEG;yCACD;4CACG;wCACJ;mDACW;;uCAIZ;mCACJ;0CACO;wCACF;8CACM;yCACL;sCACH;sCACA;oDACc;GAlCV,YAAA,UAmCX;;YCbqB,SACpB;WAAO,UAAS,OACd;eAAO,MAAM,QAAQ,UAAU,MAAM,OAAO;;;;AA4LhD,AAAO;AACP,AAAO;AAEP;AAIA;;AAKA,AAAO,MAAM,QAAmB,GAAoB,QAAQ;AAC5D,AAAO,MAAM,eAAmB,GAA2B,QAAQ;;AC/NnE,IAAYC;AAAZ,WAAY,KACV;2CAAoB;uCACJ;wCACC;sCACF;+BACP;GALEA,UAAAA,QAMX;;ACAD,IAAOA,SAAMC;AAQb,AAAO,MAAM,cAAc;AAE3B;gBAIsB,SAAS,GAAT;aAAM,SAHlB;aAAK,QAAG;aACH,QAAkC;;QAIhC,MAAc,MAC3B;aAAK,MAAM,KAAK;aACX,MAAM,QAAQ,KAAK,MAAM,SAAS;;YAGtB,MAAS,SAC1B;YAAI,OAAe,KAAK,KAAK;YACzB,QAAQ,KAAK,MAAM;YACnB,OAAO,KAAK,MAAM;iBACtBF,YAAO,CAAC,CAAC,wCAAwC,KAAK,WAAW,IAAIC,OAAI,KAAK,MAAME,MAAe,KAAK,GACxG;;aAAK,MAAM;;;AAIf,IAAI;AAEJ,6BACE;QAAI,oBAAoB;eACf;;UAGH,aAAa,qBAAqB,IAAI;eAEjC,IAAIF,OAAI,MAAM,CAAC,MAAc,YACtC;gBAAQ,KAAK,KAAK;;eAGT,IAAIA,OAAI,SAAS,CAAC,MAAiB,YAC5C;gBAAQ,QAAQ,KAAK;;eAGZ,IAAIA,OAAI,cAAc,CAAC,OAAuB,YACvD;gBAAQ;;eAGC,IAAIA,OAAI,cAAc,CAAC,OAAuB,YACvD;gBAAQ;;eAGC,IAAIA,OAAI,UAAU,CAAC,MAAkB;YACxC,SAAqB;YAAb;YACP,OAAsB;YAAhB;YAAQ;;YAEjB,YAAY,OAAO,eAAe,MAAM;YAExC,WAAW;oBACL,SAAS,WAAW,QAAQ;eAC/B;kBACC,IAAI,uBAAuB,IAClC;;;eAGQ,IAAIA,OAAI,YAAY,CAAC,MAAoB;YAC3C,OAA0B;YAApB;YAAO;;gBACZ,WAAW,MAAM,WAAW;;eAG3B,IAAIA,OAAI,aAAa,CAAC,MAAqB,YACpD;oBAAY,MAAM,OAAO;;eAGhB,IAAIA,OAAI,cAAc,CAAC,MAAqB,YACrD;oBAAY,MAAM,MAAM;;eAGf,IAAIA,OAAI,aAAa,CAAC,MAAqB,YACpD;gBAAQ,qBAAqB,KAAK;;eAGzB,IAAIA,OAAI,qBAAqB,CAAC,MAAsB,YAC7D;gBAAQ,kBAAkB;gBAClB;gBACA,0BAA0B,KAAK;;eAG9B,IAAIA,OAAI,WAAW,CAAC,MAAmB;YACzC,MAA4B;YAAvB;YAAQ;YAAM;YAEpB,SAAqB;YAAb;;YACV,SAAS,OAAO,oBAAoB,KAAK;YAEzC,WAAW,MAAM;gBACf,eAAe,OAAO,gBAAgB;gBAEtC,QAAgC,CAClC,CAACA,OAAI,qBAAqBE,MAAe,mBAAmB,OAC5D,GAAG,QACH,CAACF,OAAI,qBAAqBE,MAAe,mBAAmB;gBAE1D,aAAa,QAAQ,YAAY,EAAE,YAAY,OAAO,YAAY;gBAClE,QAAQ,QAAQ,SAAS;gBAEzB,aAAa,kBAAkB,OAAO;oBACpC,SAAS,OAAO,UAAU;wBAEtB,wBAAwB;wBACxB,sBAAsB,cAAc,QAAQ,YAAY,MAAM,MAAM,OAAO,SAAS;mBACvF;wBACG,wBAAwB;wBACxB,gBAAgB,YAAY,MAAM,MAAM,OAAO,SAAS;;eAE7D;kBACC,IAAI,8CAA8C,GACzD;;;eAGQ,IAAIF,OAAI,SAAS,CAAC,MAAiB;YACrC,OAAkB;YAAZ;YAEP,WAAa;;gBAEX;gBAEA;gBAEA,SAAS;gBAET,KAAK;gBAEL;gBAEA,MAAM;gBAEN,WAAW;gBAEX,cAAc,UAAU,QAAQ,eAAgB;gBAChD;gBACA;gBAEA,MAAM;gBACN;gBACA;gBAEA,MAAM;gBACN;gBAEA;;eAGC,IAAIA,OAAI,OAAO,CAAC,MAAmC;YACrD,KAAc;YAAV;;gBAEH,MAAM,IAAI;;eAGT,IAAIA,OAAI,WAAW,CAAC,MAAuC;YAC7D,KAAM;;gBAEL,MAAM,IAAI;gBACV,iBAAiB,SAAS;gBAC1B,kBAAkB;;eAGjB,IAAIA,OAAI,UAAU,CAAC,MAAsC;YAC3D,WAAY;;gBAEX,SAAS,QAAQ,eAAgB;;eAGhC,IAAIA,OAAI,qBAAqB,CAAC,MAAwC,YAC/E;oBAAY,QAAQ,MAAwC;;eAGnD,IAAIA,OAAI,QAAQ,CAAC,MAAgB;YACnC,QAAmB;YAAZ;YAER,UAAY,QAAQ;;YACtB,WAAW,QAAQ,QAAQ,MAAM,YAAY;YAE7C,aAAa,MAAM;YAEnBG,WAAQC,MAAiB;YACzBC,kBAAeC,aAAwB;YAEvC,UAAU;oBACJ,cAAc,OAAO;eACxB;gBACDH,YAASE,iBAAc;wBACjB,cAAc,OAAO;mBACxB;wBACG,KAAK;wBACL,eAAe;;;;eAKlB,IAAIL,OAAI,OAAO,CAAC,MAAe;YACjC,OAA2C;YAArC;YAAQ;YAAM;YAAW;;YAClC,WAAW,QAAQ,SAAS;YAC5B,UAAU,QAAQ,SAAS;YAE3B,gBAAgB,YAAY;YAC5B,eAAe,WAAW;YAExB,SAAW,QAAQ;;eAClB,QAAQ,MAAM,QAAQ,MAAM,eAAe,cAAc;;UAG5D,cAAc,IAAI,UAA0C;gBAEtD,IAAIE,MAAe,sBAAsB,CAAC,MAAuC,YAC3F;gBAAQ;gBACA,0BAA0B,KAAK;;gBAG7B,IAAIA,MAAe,kBAAkB,CAAC,OAAoC,YACpF;gBAAQ,iBAAiB,SAAS;;gBAGxB,IAAIA,MAAe,mBAAmB,CAAC,MAAoC,YACrF;gBAAQ,kBAAkB,KAAK;;gBAGrB,IAAIA,MAAe,UAAU,MACvC;;;;gBAIU,IAAIA,MAAe,iBAAiB,CAAC,OAAmC,YAClF;gBAAQ,gBAAgB,SAAS;;WAG5B;;AAGT,qBAAgC,MAAsC,UAAmB;QAChF,OAA0B;QAApB;QAAO;;YAEZ,KAAK;QAET,WAAW;gBACL,YAAY,MAAM,WAAW;WAChC;gBACG,YAAY,MAAM,MAAM;;;AAIpC,IAAI;AAEJ,8BACE;QAAI,qBAAqB;eAChB;;UAGH,cAAc,sBAAsB,IAAI;gBAElC,IAAIF,OAAI,SAAS,CAAC,MAAiB;YACvC,SAAgC;YAAxB;YAAW;;YACrB,OAAO,KAAK;YAEZ,YAAY,OAAO,aAAa,MAAM;YAEtC,cAAc,MAAM;oBACd,OAAO,WAAW,MAAM;mBACvB,WAAW;oBACZ,kBAAkB;eACrB;oBACG,YAAY;oBACZ,YAAY;;;gBAIZ,IAAIA,OAAI,QAAQ,CAAC,MAAgB,YAC3C;YAAI,QAAQ,KAAK;aACZ,IAAI,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;oBAC7B,KAAK,MAAM;;gBAEb,OAAO,MAAM;;gBAGX,IAAIA,OAAI,QAAQ,CAAC,MAAgB;YACrC,SAAqB;YAAb;YACP,OAAsB;YAAhB;YAAQ;;;YAGjB,SAAS;qBACXD,YAAO,OAAO,QAAQ;;gBAEjB;gBAAe,WAAY;;oBACxB,eAAe,YAAY,UAAU,MAAM;;;YAIjD,YAAY,OAAO,aAAa,MAAM;YAEtC,cAAc,MAAM;oBACd,OAAO,WAAW,QAAQ;eAC7B;kBACC,IAAI,wBAAwB,IACnC;;;gBAGS,IAAIC,OAAI,KAAK,CAAC,MAAa;YAC9B,OAAc;YAAR;;gBACL,YAAY;aACf,IAAI,IAAI,GAAG,IAAI,KAAK,QAAQ,KAAK;oBAC5B,YAAY,KAAK;;;gBAIjB,IAAIA,OAAI,YAAY,CAAC,MAAoB;YAC5C,OAAQ;;YAEX,QAAQ,WAAW;gBACjB,OAAO,KAAK;mBACT,KAAK,MAAM;oBAEV,kBAAkB;eACrB;oBACG,YAAY;;aAGlB,IAAI,IAAI,GAAG,IAAI,KAAK,QAAQ,KAAK;oBAC3B,YAAY,KAAK;;;gBAIjB,IAAIA,OAAI,WAAW,CAAC,OAAO,YACrC;eAAO,QAAQ,uBAAuB;;gBAG5B,IAAIA,OAAI,UAAU,CAAC,MAAkB,YAC/C;gBAAQ,SAAS,KAAK;;gBAGZ,IAAIA,OAAI,gBAAgB,CAAC,MAAwB,YAC3D;gBAAQ,eAAe,KAAK;;WAGvB;;AAGT;;gCAK8B;;YAApB;YAAQ;;aACT,SAAS;aACT,UAAU;;;AAOnB;kBACU;aAAK,QAAG;aACH,QAAyB;;QAGvB,MAAc,MAC3B;aAAK,MAAM,KAAK;aACX,MAAM,QAAQ,KAAK,MAAM,SAAS;;eAGnB,MACpB;aAAK,UAAU;;YAGE,MAAc,QAAkB,MAAc,UAAmC,SAAkC,SACpI;YAAI,QAAQ,KAAK,MAAM;YAEnB,UAAU,WAAW;qBACvBD,YAAO,CAAC,CAAC,KAAK,YAAY,IAC1B;;gBAAI,OAAO,KAAK;gBACZ,UAAU,KAAK,MAAM,QAAQ,MAAM,UAAU,SAAS;qBAC1DA,YAAO,CAAC,CAAC,YAAY,IACtB;eAAM;gBACD,OAAO,KAAK,MAAM;iBACjB,QAAQ,MAAM,UAAU,SAAS;;;;AAQ5C;kBACU;aAAK,QAAG;aACH,QAA0B;;QAGxB,MAAc,MAC3B;aAAK,MAAM,KAAK;aACX,MAAM,QAAQ,KAAK,MAAM,SAAS;;eAGnB,MACpB;aAAK,UAAU;;YAGE,MAAoB,SACrC;YAAI,QAAQ,KAAK;;;;YAMb,CAAC,MAAM,QAAQ,QAAQ,OAAO,CAAC,QAAQ;YAEvC;YACA;YACA;YAEA,MAAM,OAAOC,OAAI,QAAQ;mBACpB,MAAM;qBACJ,MAAM;mBACR,MAAM;mBACJ,MAAM,OAAOA,OAAI,SAAS;mBAC5B,MAAM;qBACJ,OAAO;eACX;mBACE,CAAC,QAAQ;;YAGd,QAAQ,KAAK,MAAM;YAEnB,UAAU,aAAa,KAAK,SAAS;gBACnC,OAAO,KAAK;gBACZ,WAAW,KAAK,MAAM,QAAQ,MAAM;mBACjC,aAAa,QAAQ,CAAC,QAAQ,SAAS;mBACrC,UAAU,WAAW;gBAC1B,OAAO,KAAK,MAAM;gBAClB,WAAW,KAAK,MAAM,QAAQ,MAAM;mBACjC,aAAa,QAAQ,CAAC,QAAQ,SAAS;eACzC;mBACE,CAAC,QAAQ;;;;AAKtB,0BAAiC,SAAiB,IAAI,UAAU,UAAmB,IAAI,WACrF;WAAO,IAAI,MAAM,CAAC,QAAQ,OAAO,UAAU,SAAS,YAClD;;;;;;;;;;;;YAYI,CAAC,UAAU,OAAO,WAAW,GAAG;kBAC5B,IAAI,MACX;;gBAEO;gBAEA;gBAEA,SAAS;gBAET,KAAK,OAAO;gBAEZ;gBAEA,MAAM;gBAEN,WAAW;gBAEX,kBAAyB;YAE7B,SAAS;oBACH,KAAK;oBAEL,MAAM;oBACN,kBAAkB;oBAElB,MAAM;oBACN;oBACA;eACH;oBACG,MAAM;oBACN;oBACA;;gBAGF,MAAM;gBACN;gBAEA;;WAGH,IAAI,UAAU,CAAC,QAAQ,OAAO,UAAU,SAAS,YACtD;;;;;;;;;;;;YAYI,CAAC,UAAU,OAAO,WAAW,GAAG;kBAC5B,IAAI,MACX;;gBAEO;gBAEA;gBAEA,SAAS;gBAET,KAAK,OAAO;gBAEZ;gBAEA,MAAM;gBAEN,OAAO;gBAEP,kBAAyB;YAE7B,SAAS;oBACH,KAAK;oBAEL,MAAM;oBACN,kBAAkB;oBAElB,MAAM;oBACN;oBACA;eACH;oBACG,MAAM;oBACN;oBACA;;gBAGF,MAAM;gBACN;gBAEA;;WAGH,IAAI,QAAQ,CAAC,QAAQ,OAAO,UAAU,SAAS,YACpD;;;;;;;;;;;;YAYI,CAAC,UAAU,OAAO,WAAW,GAAG;kBAC5B,IAAI,MACX;;gBAEO;gBAEA;gBAEA,SAAS;gBAET,KAAK,OAAO;gBAEZ;gBACA;gBAEA,MAAM;gBAEN,WAAW;gBAEX,kBAAyB,UAAW;YAExC,SAAS;oBACH,KAAK;oBAEL,MAAM;oBACN,kBAAkB;oBAElB,MAAM;oBACN;oBACA;eACH;oBACG,MAAM;oBACN;oBACA;;gBAGF,MAAM;gBACN;gBAEA;;WAGH,IAAI,QAAQ,CAAC,QAAQ,MAAM,UAAU,SAAS,YACnD;;;;;;;;;;;;;;;;;;;;;;;gBAuBQ;gBAEA;gBAEA,SAAS;YAEb,QAAQ,KAAK,GAAG,OAAO,OAAO;oBACxB,KAAK,KAAK,GAAG;eAChB;oBACG,uBAAuB;;gBAGzB,KAAK,OAAO;gBAEZ,MAAM;gBAEN;gBAEA,WAAW;gBAEX;gBAEA,SAAS;gBAET,IAAI,SAAS,IAAI;gBAEjB,UAAU;gBAEV,MAAM;gBACN,QAAQ;gBAER,MAAM;gBACN,kBAAyB,UAAW;gBACpC,IAAI;gBACJ;gBACA;gBAEA,MAAM;gBACN;gBACA;YAEJ,SAAS;oBACH,KAAK;oBAEL,MAAM;oBACN,kBAAkB;oBAElB,MAAM;oBACN;oBACA;eACH;oBACG,MAAM;oBACN;oBACA;;gBAGF,MAAM;gBACN;gBAEA;;WAGH,IAAI,cAAc,CAAC,QAAQ,MAAM,UAAU,UAAU;YACtD,CAAC,UAAU,OAAO,WAAW,GAAG;kBAC5B,IAAI,MACX;;gBAEO;gBAEA;gBAEA,SAAS;YAEX,OAAiB;YAAX;;aAEP,IAAI,IAAI,GAAG,IAAI,KAAK,QAAQ,KAAK;gBAChC,MAAM,KAAK;gBACX,QAAQ,iBAAiB,QAAQ,QAAQ;wBACnC,KAAK,OAAO;mBACf;sBACC,IAAI,qDAAqD,KAAK,EACrE;;;gBAGK,KAAK,OAAO;gBAEZ;gBAEA,MAAM;gBAEN,WAAW;gBAEX;gBACA,kBAAyB;gBACzB;gBAEA,MAAM;gBACN;gBACA;gBAEA,MAAM;gBACN;gBAEA;;WAGH,IAAI,sBAAsB,CAAC,SAAS,MAAM,UAAU,UAAU,YACnE;YAAI;gBACG,QAAsB;gBAAf;;oBAEJ,cAAc;oBAEd;oBACA,iBAAiB;oBACjB,kBAAyB;oBACzB;eACH;oBACG,kBAAyB;;;WAI9B,IAAI,aAAa,CAAC,SAAS,MAAM,UAAU,SAAS;iBACzDD,YAAO,WAAW,QAAQ,QAAQ;;YAE7B;YAAe,SAAU;;gBACtB,iBAAiB,YAAY,QAAQ,MAAM,MAAM,UAAU;;YAG7D,IAAI,aAAa,CAAC,OAAO,SAAS,MAAM;iBAC9CA,YAAO,WAAW,QAAQ,QAAQ;;YAE7B;YAAe,SAAU;;gBACtB,iBAAiB,YAAY,QAAQ,MAAM,MAAM,MAAM;eAExD;;WAGF,EAAE,QAAQ;;;;gBCjvBG,YAAiC,kBAAwC,SAA2C,aAApH;aAAU,aAAV;aAAiD,mBAAhB;aAA+C,UAAP;aAAsD,cAJ3I;aAAQ,WAAqB;aAK9B,oBAAoB;;WAdpB,SAAoB,OAAgC,SACzD;eAAO,IAAI,mBACT,MAAM,YACN,EAAE,OAAO,UAAU,QAAQ,YAC3B,SACA,EAAE,UAAU,QAAQ,UAAU,SAAS,MAAM,SAAS,SAAS,MAAM;;;YAajE,WAAa;;YACf,aAAa,MAAM,OAAO;YAExB,UAA0C;YAAjC;YAAY;YACrB,WAAa;YACb;YAAS,SAAuC;YAA/B;YAAQ;YAAW;;YAEtC,UAAU,IAAI,QAAQ,SAAS,QAAQ,UAAU,QAAQ,kBAAkB;aAE1E,IAAI,IAAI,GAAG,IAAI,WAAW,QAAQ,KAAK;iBACrC,kBAAkB,QAAQ,WAAW,IAAI;;YAG5C,SAAS,QAAQ,OAAO,QAAQ;eAU5B,KAAK,WAAW;;;;;gBCmEN,SAAA;aAAO,UAAP;;WAEb,QAAgB;YAChB;YAAQ,OAA2B;YAArB;YAAU;YACvB,UAAY;YACZ,SAAW;;YAEb,WAAW,MAAM;gBACf,eAAe,OAAO,gBAAgB;gBAEtC,aAAa,kBAAkB,OAAO;oBACpC,SAAS,OAAO,UAAU;wBAEtB,wBAAwB;wBACxB,sBAAsB,cAAc,QAAQ,MAAM,QAAQ,MAAM,OAAO,UAAU;mBACpF;wBACG,wBAAwB;wBACxB,gBAAgB,MAAM,QAAQ,MAAM,OAAO,UAAU;;;;;;AC1I9D,MAAM,YAAY;AACzB,MAAM,WAA0B;AAChC,AAAO,MAAM,YAAmB;AAChC,AAAO,MAAM,YAAmB;AAChC,AAAO,MAAM,mBAAmB;AAEhC;gBACqB,QAAA;aAAM,SAAN;aACZ,UAAG;aACN,OAFkC;;WAG/B,MAAU,GAAG,UAClB;YAAI,OAAO,WAAW;kBACd,IAAI,sCAAsC,IACjD;;aAEI,OAAO,KAAM,OAAQ,SAAS,UAAU;aAExC,UAAU,KAAK,OAAO,SAAS;iBAE3B,QAAQ,MACf;gBAAI,KAAK,UAAU;sBACX,IAAI,mCAAmC,EAC9C;;iBACI,OAAO,KAAK;;aAGd,OAAO,KAAK,OAAO;;YAGlB,SACN;eAAO,OAAO,aAAa,GAAG;;UAG1B,UAAkB,SACtB;YAAI,KAAK,OAAO,WAAW,OAAO,CAAC,GAAG;iBAC/B,OAAO,WAAW,KAAK;eACvB;kBACC,IAAI,MAAM;;;;;ACKtB;kBACE;aAAM,SAAG;aACF,UAAgE;;UAEjE,MAAc,OAClB;aAAK,OAAO,QAAQ;;WAGf,IAAY,QAAsB,QACvC;aAAK,QAAQ,KAAK,EAAE,IAAI,QAAQ;;UAG5B;YACE;YAAS,SAAW;;aACrB,IAAI,IAAI,GAAG,IAAI,QAAQ,QAAQ;6BACb,QAAQ;gBAAvB;gBAAI;;gBACN,UAAU,OAAO,UAAU;oBACvB,MAAM,IAAI;;;;AAsCxB;gBAUW,SACA,QACA,UACA,QACA,kBACA,WALA;aAAO,UAAP;aACM,SAAN;aACQ,WAAR;aACM,SAAN;aACgB,mBAAhB;aACS,YAZV;aAAO,UAAG,IAAI,mBAAmB;aACtB,cAAG,IAAI;aACF,mBAAG;aAEX,YAAgC,IAAI,iBAAiB;aAU9D,YAAY,QAAQ;aACpB,qBAAqB;;QAGhB,MACV;eAAO,KAAK,QAAQ;;QAGV,UACV;eAAO,KAAK,QAAQ;;SAGjB,YACH;YAAI,MAAM,QAAQ,aAAa;iBACxB,mBAAmB,QAAQ,YAAY;eACvC;iBACA,uBAAuB;;;WAIL,OACzB;eAAO,UAAU;;YAGX,MAAU,OAAO,GACvB;YAAI,mBAAmB;aAClB,IAAI,IAAI,GAAG,IAAI,MAAM,KAAK;6BACZ,KAAK,CAAC;;aAGpB,KAAK,MAAM,GAAG;;SAGhB,MAAU,GAAG;YACV,UAAY;;gBACV,OAAO,MAAM,GAAG;;WAGnB;aACA;YAEC,SAAW,KAAK;;;YAGlB,SAAS,KAAK;aAEb,IAAI,IAAI,GAAG,IAAI,OAAO,QAAQ,KAAK;iBACjC,KAAK,OAAO;;aAGd,aAAa,QAAQ,KAAK,iBAAiB,MAAM,QAAQ;eAEvD;;sBAGS,SAChB;aAAK,mBAAmB;;;aAKjB,OAAiB,OACxB;YAAI,aAAa,KAAK,UAAU,YAAY;aACvC,wBAAkB,YAAY;;;QAKzB,SACV;eAAc,KAAK,YAAY;;kBAI/B;aAAK,YAAY,KAAK,IAAI;;iBAI1B;YAAI,QAAe,KAAK,YAAY;cAC9B,MAAM,KAAK;;;4BAKK,QACtB;aAAK,uCAAiC,KAAK,UAAU,OAAO;;gCAGlC,UAC1B;aAAK,2CAAqC,KAAK,UAAU,aAAa;;gBAG5D,OACV;aAAK,2BAAqB;;oBAGZ,OAAiB,YAAqB,YACpD;YAAI,OAAO,CAAC,eAAe,OAAO,IAAI,KAAM,CAAC,eAAe,OAAO,IAAI,MAAM;aACxE,+BAAyB,MAAM;;gCAGV,OAC1B;aAAK,2CAAqC;;gCAI1C;aAAK;;iCAIL;aAAK;;6BAIL;aAAK;;qBAGU,OACf;aAAK,gCAA0B;;wBAGb,OAClB;aAAK,mCAA6B;;uBAGjB,OACjB;aAAK,kCAA4B;;4BAIjC;aAAK;;qBAGU,OACf;aAAK,gCAA0B;;oBAGjB,OACd;aAAK,+BAAyB;;;kBAKlB,UAAqB,SAAmB,UACpD;YAAI,QAAQ,KAAK,UAAU,aAAa;YACpC,WAAW,KAAK,UAAU,YAAY;YACtC,YAAY,KAAK,UAAU,MAAM;aAEhC,6BAAuB,OAAO,UAAU;;sBAG7B,MAChB;aAAK,iCAA2B,KAAK,OAAO;;;aAKrC,SAAmB,UAC1B;aAAK,wBAAkB,KAAK,UAAU,YAAY,UAAU,KAAK,UAAU,MAAM;;;mBAKpE,YACb;aAAK,8BAAwB,aAAa,IAAI;;;SAK3C,MACH;aAAK,oBAAc,KAAK,UAAU,OAAO;;yBAGtB,KACnB;aAAK,2BAAqB,KAAK,UAAU,OAAO;;8BAGxB,KACxB;aAAK,yCAAmC,KAAK,UAAU,OAAO;;yBAI9D;aAAK;;mBAIL;aAAK;;mBAIL;aAAK;;eAGI,OAAe,YAA4B,QACpD;YAAI,OAAO,KAAK,UAAU,OAAO;YAC7B,YAAY,aAAa,KAAK,UAAU,OAAO,cAAc;YAE7D,KAAK,kBAAkB;iBACpB,uBAAuB;iBACvB,6BAAuB,MAAM,GAAG;eAChC;gBACD,QAAQ,KAAK,UAAU,OAAO;iBAC7B,0BAAoB,MAAM,OAAO;;;gBAI9B,OAAe,YAA4B,UACrD;YAAI,OAAO,KAAK,UAAU,OAAO;YAC7B,YAAY,aAAa,KAAK,UAAU,OAAO,cAAc;YAE7D,KAAK,kBAAkB;iBACpB,6BAAuB,MAAO,aAAa,OAAO,IAAI,GAAI;eAC1D;iBACA,2BAAqB,MAAO,aAAa,OAAO,IAAI,GAAI;;;YAIzD,UACN;YAAI,UAAU,KAAK,UAAU,OAAO;aAC/B,uBAAiB;;aAGf,WAAsB,QAAwC,MACrE;aAAK;aACA,YAAY,QAAQ,MAAM,MAAM;aAChC,wBAAkB,KAAK,UAAU,OAAO;aACxC;;;kBAML;aAAK;;cAGG,OACR;aAAK;aACA,OAAO,OAAO,KAAK,yBAAmB;;eAI3C;aAAK;;YAGC,QACN;aAAK;aACA,OAAO,OAAO,KAAK,uBAAiB;;;gBAK/B,QACV;aAAK,0BAAqB;;aAGnB,QACP;aAAK,uBAAkB;;gBAGb,QACV;aAAK,0BAAqB;;gBAGhB,KACV;aAAK,0BAAqB,KAAK,OAAO;;aAG/B,QACP;aAAK,uBAAkB;;aAGhB,QACP;aAAK,uBAAkB;;mBAGV,IACb;aAAK,SAAS;aACT;aACA;;WAGA,MACL;aAAK,qBAAgB;;SAGlB,UACH;aAAK,oBAAc;;UAGf,UACJ;aAAK,qBAAe;;QAGlB,WAAW,SAAS,IAAI,SAAS,GACnC;eAAO,KAAK,mBAAa,UAAU;;QAGjC,QAAQ,GACV;eAAO,KAAK,mBAAa;;;wBAMzB;aAAK;;uBAIL;aAAK;;UAGD,MACJ;aAAK,OAAO,MAAM,MAAM,KAAK;;kBAGjB,SAAiB,iBAC7B;aAAK,yBAAmB,SAAU,kBAAkB,IAAI;;qBAIxD;aAAK;;eAIL;aAAK;;aAGE,OACP;aAAK;aACA,OAAO,OAAO,KAAK,wBAAkB;;uBAI1C;aAAK;;sBAIL;aAAK;;cAGG,YACR;YAAI;YACA;gBACI,OAAO;iBACR;oBACC,aAAuB,MAAM,GAAG;wBAC9B,aAAuB,CAAC,GAAG;oCACjB;2BACP;oCACO,KAAK,SAAS;;;uBAGvB;gCACO,KAAK,MAAM;;;;iBAItB;4BACS,KAAK,OAAO;;;iBAGrB;4BACU,aAAqB;;;iBAG/B;;4BAES;;;iBAGT;4BACS;;;;sBAIN,IAAI,MAAM;;aAGf,yBAAmB,aAAa,IAAI;;UAGrC,KACJ;eAAO,KAAK,UAAU,MAAM;;aAGrB,KACP;eAAO,KAAK,UAAU,SAAS;;2BAGV,WACrB;aAAK,UAAU;aACV;;yBAIL;aAAK;;WAGA,QAAmB,QAAwC,MAChE;aAAK;aACA,YAAY,QAAQ,MAAM,MAAM;aAChC,qBAAgB,KAAK,UAAU,OAAO;aACtC;aACA,MAAM,SAAS;;qBAGL,QACf;aAAK,gCAA0B,KAAK,MAAM;;UAGtC,MACJ;aAAK,qBAAe;;WAIpB;aAAK;;aAIL;aAAK;;gBAIL;aAAK;;eAIL;aAAK;;oBAIL;aAAK;;kBAIL;aAAK;;gBAIL;aAAK;;SAGF,QACH;aAAK;aACA,OAAO,OAAO,KAAK,oBAAc;;WAGjC,QACL;aAAK;aACA,OAAO,OAAO,KAAK,sBAAgB;;eAG/B,QACT;aAAK;aACA,OAAO,OAAO,KAAK,0BAAoB;;;WAKvC,SACL;eAAO,KAAK,UAAU,OAAO;;UAGf,QACd;YAAI,QAAkB;aAEjB,IAAI,IAAI,GAAG,IAAI,OAAO,QAAQ,KAAK;gBAClC,IAAI,OAAO;kBACT,KAAI,KAAK,UAAU,OAAO;;eAG3B,KAAK,UAAU,MAAM;;YAGZ,SAChB;eAAO,KAAK,UAAU,MAAM;;;gBAKlB;YACJ,aAA2B;YAAf;;YACd,cAAc,EAAE,YAAY,UAAU,KAAK,iBAAiB;YAC5D;qBACO,KAAK;oBACN,KAAK;qBACJ,KAAK;oBACN,KAAK;uBACF,KAAK;sBACN,KANE;;eASP,IAAI,mBAAmB,YAAY,KAAK,kBAAkB,SAAS;;;YAIhD,QAAY,KAAhC;;eAEC,MAAM,UAAU,MAAM,UAAU;;kBAG3B,QACZ;YAAI,CAAC,QAAQ,OAAO;aAEf,IAAI,IAAI,GAAG,IAAI,OAAO,QAAQ,KAAK;iBACjC,KAAK,OAAO;;eAGZ,OAAO;;gBAGJ,QAAwC,MAAoC,QAAwB,WAC9G;YAAI,QAAQ;iBACL,mBAAmB,OAAO;iBAC1B,mBAAmB,OAAO;iBAC1B,mBAAmB,OAAO;;YAG7B,QAAQ,KAAK,cAAc;YAE3B,QAAQ,SAAS;YAEjB,WAAW,SAAS;YAEpB,QAAQ;qBACD;;YAGP,QAAkB;YAElB,MAAM;oBACA,KAAK;gBACT,MAAM,KAAK;iBACV,IAAI,IAAI,GAAG,IAAI,IAAI,QAAQ,KAAK;qBAC9B,KAAK,IAAI;;;aAIb,SAAS,OAAO;;sBAGL,OAAwB,cAAc;YAChD,aAAe,MAAM;;YACvB,cAAc,WAAW;YACzB,QAAQ,KAAK,IAAI,aAAa;aAE7B;YAED,OAAO;iBACJ;iBAEA,IAAI,IAAI,GAAG,IAAI,OAAO,KAAK;qBACzB,IAAI,SAAS,IAAI,cAAc;qBAC/B,YAAY,WAAW;;;aAI3B,UAAU;aACV;aACA;YAED,OAAO;iBACJ;;aAGF;;kBAGO,YAAmC,UAC/C;aAAK;aAEA;aAEA,SAAS;aAET,KAAK;aAEL;aACA;aAEA,MAAM;aAEN,WAAW;aAEX,4BAA4B,KAAK;aACjC,gBAAgB,MAAM,MAAM,MAAM,OAAO,MAAM;aAE/C;aAEA;aAEA,MAAM;aAEN,eAAe;aAEf;aAEA;aAEA,MAAM;aAEN;aAEA;;UAGD,IAAY,QAChB;aAAK,YAAY,QAAQ,MAAM,MAAM;aAChC,SAAS;aACT;aACA;aACA;aACA;;oBAGS,OAAgC,QAAwC,MAA4B,WAAoB,OAAgC,UAAmC,MAAM,QAC/M;aAAK,MAAM,SAAS;aACf,IAAI,SAAS,IAAI;aACjB,KAAK,SAAS;aAEd;YAED,SAAS,EAAE,MAAM,OAAO,MAAM,SAAS;aAEtC,YAAY,QAAQ,MAAM,QAAQ;aAClC,YAAY,SAAS;aAErB;aACA;aACA,gBAAgB,SAAS,IAAI,UAAU,MAAM,YAAY;aACzD,4BAA4B,SAAS;aAErC,iBAAiB,SAAS;YAE3B,QAAQ;iBACL,gBAAgB,OAAO;iBACvB,WAAW;iBACX;eACA;iBACA,mBAAmB,SAAS;;aAG9B;aACA,gBAAgB,SAAS;aACzB;aAEA;aACA;aACA;aAEA,KAAK,SAAS;;0BAGC,cAAqC,QAAiD,OAAgC,QAAwC,MAA4B,WAAoB,OAAgC,UAAmC;YAC/R,cAAgB;;YAElB,UACF,YAAY,WACZ,aAAa;YAEX,SAAS;iBACN,gBAAgB,OAAO,QAAQ,MAAM,WAAW,OAAO,SAAS;;;aAIlE,MAAM,SAAS;aACf,IAAI,SAAS,IAAI;aACjB,KAAK,SAAS;YAEb,UAAY;;YAEd,aAAa,YAAY;iBACtB;iBACA,YAAY,MAAM,MAAM,MAAM;;aAGhC;aACA;aACA,gBAAgB,SAAS,IAAI,UAAU,MAAM,YAAY;YAE1D,aAAa,YAAY;iBACtB;;aAGF,4BAA4B,SAAS;YAEtC,WAAmD;aAElD,iBAAiB,SAAS;iBACtB,KAAK,EAAE,QAAQ,GAAG,SAAS;aAE/B,IAAI,IAAI,GAAG,IAAI,QAAQ,QAAQ,KAAK;gBACnC,SAAS,QAAQ;oBAEb,OAAO,OAAO;qBACf;wBACC,cAAuC;wBAEvC,WAAW,YAAY;sCACX;+BACL,WAAW,YAAY;sCAClB;+BACL,WAAW,aAAa;sCACnB;2BACT;8BACC;;wBAGJ,aAAa;6BACV,mBAAmB;iCACf,KAAK,EAAE,QAAQ,IAAI,GAAG,SAAS;2BACnC;6BACA,mBAAmB;iCACf,KAAK,EAAE,QAAQ,IAAI,GAAG,SAAS;;;qBAKvC;wBACC,CAAC,MAAM;;;wBAIN,OAAgB;wBAAV;;wBACP,aAAa;wBAEb,WAAW;qCACA,OAAO,MAAM;;wBAGxB,QAAQ,KAAK,QAAQ;wBAErB,UAAU,CAAC,GAAG;6BACX,KAAK,OAAO;iCACR,KAAK,EAAE,QAAQ,IAAI,GAAG,SAAS;;;;;aAO3C,cAAc,QAAQ,SAAS,GAAG,CAAC,EAAE,SAAS,WAAW;aAEzD,IAAI,IAAI,SAAS,SAAS,GAAG,KAAK,GAAG;8BACd,SAAS;gBAA7B;gBAAQ;;gBAEV,SAAS;qBACN,SAAS;mBACT;qBACA,YAAY;;;aAIhB;aAEA,aAAa;aACb,gBAAgB,SAAS;aACzB;aAEA;aACA;aACA;aAEA,KAAK,SAAS;;qBAGJ,sDAA8E,QAAwC,MAA4B,WAAoB,OAAgC,UAAmC,MACxP;aAAK;aAEA;aAEA,SAAS;aAET,KAAK;aAEL;aAEA,MAAM;aAEN,WAAW;aAEX,4BAA4B,KAAK;aACjC,gBAAgB,MAAM,QAAQ,MAAM,WAAW,OAAO;aAEtD,MAAM;aACN;aACA;aAEA,MAAM;aACN;aAEA;;kBAIL;aAAK;;mBAGQ,sDAA8E,QAAwC,MAA4B,WAC/J;YAAI,WAAW,KAAK;aAEf;aACA,YAAY,QAAQ,MAAM,MAAM;aAChC,KAAK;aACL,8BAAwB,KAAK,UAAU,aAAa;aACpD;aACA,MAAM,SAAS;;oBASN,OACd;YAAI,OAAO;gBACL,WAAW,KAAK,UAAU,MAAM;iBAC/B,+BAAyB;eACzB;iBACA,UAAU;;;qBAKjB;aAAK;;uBAGY,OACjB;aAAK,gBAAgB,SAAS,MAAM;aAC/B;aACA,UAAU;;aAGR,OACP;YAAI,CAAC,OAAO,OAAO;eAEZ,KAAK,YAAY;;;AAI5B,AAEA,MAA0C,0BAAQ;cAGtC,OACR;YAAI,OAAO;iBACJ,UAAU;eACV;iBACA,UAAU;;;mBAKjB;aAAK;;eAGI,QACT;YAAI,QAAQ;iBACL,UAAU;eACV;iBACA,UAAU;;;oBAKjB;aAAK;;iBAGM,YACX;aAAK,UAAU;aACV;aACA;;cAGgB,OACrB;aAAK,wBAAkB,KAAK,MAAM;;UAGpB,OACd;eAAO,KAAK,UAAU,MAAM;;CAIhC;;;kBCl5BU;aAAK,QAAoB;aAChB,aAAG,IAAI;aACZ,QAAG,IAAI;aACN,SAAG,IAAI;;UAEd,OAAwB,OAAiB,YAAsB,iBAAyB,WAC5F;aAAK,QAAQ;;;;;;;;YAUT,QAAQ,KAAK;YACb,aAAa,MAAM;YACnB,YAAa,MAAM,KAAK,aAAa;cAEnC,MAAM,OAAO,WAAW,YAAY,OAAO;YAE7C,aAAa,KAAK;YAClB,iBAAiB,YAAY;mBAEtB,MAAM,OAAO,gBAAgB;YAEpC,SAAS,KAAK;YACd,cAAc,WAAW;YACzB,aAAa,iBAAkB,cAAc;eAE1C,MAAM,OAAO,YAAY,aAAa;;QAG3C,MACF;eAAO,cAAc,CAAC,KAAK,YAAY,KAAK;;QAG1C,OACF;eAAO,KAAK,OAAO;;QAGjB,SACF;eAAO,KAAK,WAAW,SAAS,KAAK,MAAM,SAAU,KAAK,OAAO,SAAS;;OAG/B,KAC3C;eAAO,KAAK,WAAW,GAAM;;YAGvB,QACN;YAAI,SAAS;gBACL;gBAAY,QAAiB;gBAAV;;gBACrB,UAAU,WAAW,OAAO;gBAC5B,SAAS,WAAW,SAAS,MAAM;iBAEnC,IAAI,IAAE,SAAO,GAAG,KAAG,GAAG,KAAK;sBACvB,IAAI,MAAM,IAAI,GAAG,WAAW,OAAO,GAAG;;uBAGnC,QAAQ;kBACb,QAAQ;kBACR,MAAM;;;cAKd;YAAI,aAAa,KAAK,WAAW,WAAW,IAAI,mBAAmB,KAAK,WAAW;YAC/E,QAAQ,KAAK,MAAM,WAAW,IAAI,cAAc,KAAK,MAAM;;iBAExD,KAAK;oBACF,KAAK;;;;;;YAOT,QAAkB;YAAX;;cACP,IAAI;;;AAId;kBACS;aAAI,OAAG;aACD,SAAG;aAEH,QAAoB;aAErB,OAAgB;aACT,cAA6C;;UAE1D,OAAwB,MAAc,QAC1C;aAAK,QAAQ;aACR,OAAO;aACP,SAAS;YAEV,WAAW,GAAG;iBACX,OAAO;iBACP,cAAc;eACd;iBACA,OAAO;iBACP,cAAc;;;QAInB,MACF;YAAI,MAAM,KAAK;YAEX,CAAC,KAAK;kBACF,KAAK,OAAO,cAAc,KAAK;;eAGhC;;OAGoC;YACrC,OAAwB;YAAlB;YAAQ;;YAEhB,WAAW,KAAK,YAAY,QAAQ;mBAC/B;;eAGI,MAAM,IAAI,UAAU;;cAIjC;eAAO,IAAI,4BAA4B,KAAK,KAAK,KAAK;;YAGhD,OACN;YAAI,YAAY,MAAM;YAElB,YAAY;gBACR,OAAwB;gBAAlB;gBAAQ;;iBAEf,OAAO,OAAO,OAAO;iBACrB,SAAS,SAAS;iBAElB,IAAI,IAAI,GAAG,IAAI,WAAW,KAAK;sBAC5B,IAAI,MAAM,GAAG,IAAI,GAAG;;iBAGvB,OAAO;iBACP,cAAc;;;QAIX,aACV;YAAI,aAAa,KAAK;YAElB,CAAC;gBACG;gBAAO,OAAiB;gBAAX;;yBACN,KAAK,cAAc,MAAM,MAAsC,MAAM,OAAO;;eAGpF;;;AAIX;gBAMW,KACA,YACA,SAAS,WAAW,QAFpB;aAAG,MAAH;aACU,aAAV;aACM,SAAN;;WAPF,QACL;eAAO,IAAI,4BAA4B,cAAc,aAAa;;OASvB,UAC3C;eAAO,KAAK,WAAW;;YAIvB;eAAO,KAAK,WAAW,IAAI,KAAK;;QAG9B;YACI;YAAY,SAAW;;YAEzB,SAAS,UAAU;mBACd,mBAAmB,OAAO;eAC5B;gBACD,MAAM,SAAS,MAAM;gBAErB,MAAM,KAAK,OAAO,QAAQ;uBACrB;mBACF;uBACE,WAAW;;;;YAKI,WAC1B;eAAO,UAAU;;;AAIrB;kBACS;aAAI,OAAG;aACD,SAAG;aAIJ,OAAgB;aACT,cAA6C;aAElD,SAAqB;aACnB,WAAqB;;UAE/B,OAAwB,MAAc,QAAgB,OAAiB,WAC3E;aAAK,QAAQ;aACR,OAAO;aACP,SAAS;YAEV,WAAW,GAAG;iBACX,OAAO;iBACP,cAAc;iBACd,SAAS;iBACT,WAAW;eACX;iBACA,OAAO;iBACP,cAAc;gBAEf,WAAW;qBACR,SAAS;qBACT,WAAW;mBACX;qBACA,SAAS;qBACT,WAAW;;;;QAKlB,MACF;eAAO,cAAc,KAAK;;QAGxB,QACF;YAAI,QAAQ,KAAK;YAEb,CAAC,OAAO;oBACF,KAAK,SAAS,KAAK,SAAU,IAAI,KAAK;;eAGzC;;QAGL,UACF;YAAI,UAAU,KAAK;YAEf,CAAC,SAAS;sBACF,KAAK,WAAW,KAAK,OAAQ,IAAI,KAAK;;eAG3C;;QAGL,MACF;eAAO,KAAK,MAAM,QAAQ,UAAU,CAAC;;QAGO,MAAc,YAAY;YAChE,OAAgB;YAAV;;YAER,QAAQ,YAAY,KAAK,QAAQ,KAAK;YAEtC,MAAM,MAAM,QAAQ;YAEpB,QAAQ,CAAC,GAAG;mBACP;;eAGF,MAAM,IAAO,KAAK;;cAIzB;eAAO,IAAI,uBAAuB,KAAK,KAAK,KAAK,OAAO,KAAK;;UAGzD;YACU,SAAW,MAAnB;;YAEF,SAAS;gBACL,QAAyB;gBAAlB;gBAAQ;gBACR,aAAe,MAAtB;;gBAEF,OAAO,SAAS,UAAU,MAAM,WAAW,GAAG;wBACxC;;iBAGL,IAAI,IAAI,GAAG,IAAI,QAAQ,KAAK;oBAC3B,OAAO,WAAW;oBAClB,MAAM,MAAM,QAAQ;oBAEpB,QAAQ,CAAC,GAAG;6BACL,MAAM,KAAK;0BACd,KAAK,MAAM,WAAW;;;iBAI3B,SAAS;iBACT,OAAO;iBACP,cAAc;iBACd,SAAS;iBACT,WAAW;;;QAIR,aACV;YAAI,aAAa,KAAK;YAElB,CAAC;gBACG,OAAwB;gBAAlB;gBAAQ;;yBACP,KAAK,cAAc,MAAM,MAAsC,MAAM,OAAO;;eAGpF;;oBAG2B,MAClC;eAAO,KAAK,MAAM;;aAGS,MAC3B;mBAAW,IACZ;;;AAGH;gBAKW,KACA,OACA,YAFA;aAAG,MAAH;aACK,QAAL;aACU,aAAV;aAEF,SAAS,MAAM;aACf,OAAO;;QAGV,MACF;YAAIQ,SAAM,KAAK;YAEX,CAACA;gBACG,QAAsB;gBAAf;;qBACP,KAAK,OAAO;iBAEb,IAAI,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;oBACjC,OAAO,MAAM;uBACZ,QAAQ,WAAW;;;eAKrBA;;QAGL,MACF;eAAO,KAAK,MAAM,QAAQ,UAAU,CAAC;;QAGO;YACtC,QAAsB;YAAf;;YACT,MAAM,MAAM,QAAQ;YAEpB,QAAQ,CAAC,GAAG;mBACP;eACF;mBACE,WAAW;;;;YAKd,QAAsB;YAAf;;YACT,MAAM;aAEL,IAAI,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;gBACjC,OAAO,MAAM;gBACb,QAAQ,WAAW,GAAG;;eAGrB;;;AAIX;kBAEU;aAAc,iBAAuB;aAE3B,cAAgB;aACtB,QAAa;aAEZ,SAAG;aACL,OAAG;;UAER,OAAwB,MAAc,QAAgB,OAC1D;aAAK,QAAQ;aACR,QAAQ;aACR,OAAO;aACP,SAAS;YAEV,WAAW,GAAG;iBACX,cAAc;iBACd,iBAAiB;eACjB;iBACA,cAAc;iBACd,iBAAiB;;;QAItB,SACF;YAAI,SAAS,KAAK;YAEd,CAAC;gBACG,OAAwB;gBAAlB;gBAAQ;;qBACX,KAAK,iBAAiB,MAAM,MAAgB,MAAM,OAAO,SAAS;;eAGtE;;QAGL,MACF;eAAO,KAAK,MAAO,QAAQ,UAAU,CAAC;;QAGpC;YACI,OAAuB;YAAjB;YAAO;;YAEf,MAAM,MAAO,QAAQ;YAErB,MAAO,QAAQ,UAAU,CAAC,GAAG;mBACxB;;YAGL,QAAc,MAAM,IAAI,MAAM,GAAG;YACjC,QAAc,MAAM,IAAI,MAAM,IAAI,GAAG;YACrC,SAAe,MAAM,IAAI,MAAM,IAAI,GAAG;eAEnC,WAAW,OAAO,OAAO,CAAC,QAAQ,OAAQ;;cAIjD;eAAO,IAAI,uBAAuB,KAAK,OAAO,KAAK;;;AAKvD;gBAIW,OACA,QADA;aAAK,QAAL;aACM,SAAN;aAEF,SAAS,MAAM;;QAGlB,MACF;eAAO,KAAK,MAAM,QAAQ,UAAU,CAAC;;QAGnC,MACF;YAAI,MAAM,KAAK,MAAM,QAAQ;YAEzB,QAAQ,CAAC,GAAG,OAAO;eAEhB,CACL,KAAK,OAAO,MAAM,IAAI,IACtB,KAAK,OAAO,MAAM,IAAI,IACtB,KAAK,OAAO,MAAM;;;AAKxB,MAAM,cAAc,IAAI,uBAAuB,cAAc,aAAa;AAC1E,MAAM,mBAAmB,IAAI,4BAA4B,cAAc;AACvE,AAAO,MAAM,aAAiC,EAAE,KAAK,cAAc,QAAQ,GAAG,YAAY,kBAAkB,OAAO;;ACjjBnH,MAAM,qCAAqC;AAE3C,sCAA6C,YAC3C;WAAO,CAAC,EAAE,cAAc,WAAW;;AAGrC;AAIA;;gBAEwB,OAAmE,MAAnE;aAAK,QAAL;aAAuE,OAAJ;aAClF,sCAAsC;;WAGtC,MACL;aAAK,QAAQ,KAAK;YAEd,aAAyC;eAEtC;8BAC8B;gBAAvB,0BAAN;gBAAmB;;gBAErB,aAAa;qBACV,WAAW,QAAQ,YAAY;qBAC/B,MAAM,MAAM,YAAY;;gBAG3B,CAAC,6BAA6B,QAAQ;uBACjC;;yBAGI;;;;QAKb;YACI;YAAO,OAAS;;YAClB,SAAS,OAAO,KAAK,WAAW,SAAS;eACtC,6BAA6B,SAAS,SAAS,MAAM,SAAS;;CAIzE;;MCtCmD,8CAAQC;WAClD,OAAO,OACZ;eAAO,IAAI,sCAAsC;;WAG5C,OACL;eAAO,6BAA6B;;;AAIxC,eAAe,6BAAuB,CAAC,IAAI,EAAE,KAAK,iBAChD;QAAI,YAAkB,GAAG,MAAM;QAC3B,QAAQ,UAAU;QAClB;QAEA,YAAY;kBACJ,GAAG,WAAW,6BAA6B;WAChD;kBACK,GAAG,WAAW,6BAA6B;;QAGnD,CAAC,QAAQ,YAAY;WACpB,WAAW,IAAI,2BAA2B,WAAW;;;AAM5D,MAAiC,mCAAQ;gBAGnB,WAA+C,SACjE;;aAD2B,YAAT;aAAsD,UAAP;aAE5D,MAAM,UAAU;;aAGd;YACD,UAAuB;YAAd;;gBACP,OAAO,GAAG,KAAK,UAAU;;;;AC5BrC,eAAe,yBAAmB,MAAM,GAAG;AAE3C,eAAe,uBAAiB,MAAM,GAAG;AAEzC,eAAe,+BAAyB,MAAM,GAAG;AAEjD,eAAe,8BAAwB,MAAM,GAAG;AAEhD,eAAe,uBAAiB,CAAC,IAA+C,EAAE,KAAK,YACrF;OAAG,MAAM,KAAK,GAAG,UAAU,SAAS;;AAGtC,eAAe,wBAAkB,CAAC,IAAI,EAAE,KAAK;QACvC,QAAQ,GAAG;QACX,OAAO,YAAY,EADvB;QAEI,QAAQ,aAAa;YAEjB;;kBAEE,KAAK;;;kBAGL,KAAK,GAAG,UAAU,SAAS;;;kBAG3B,KAAK,GAAG,UAAU,UAAU;;;oBAG1B;qBACD;0BAAS,KAAK;;qBACd;0BAAS,KAAK;;qBACd;0BAAS,KAAK;;qBACd;0BAAS,KAAK;;;;;kBAIf,KAAK,GAAG,UAAU,YAAY;;;;AAK1C,eAAe,iCAA2B,MACxC;QAAI,QAAQ,GAAG;UACT,KAAK,mBAAmB,OAAa,MAAM;;AAGnD,eAAe,kBAAY,CAAC,IAAI,EAAE,KAAK,UAAU,KAAK,aACpD;QAAI,WAAiB,GAAG,WAAT,YAA8C;OAC1D,MAAM,IAAI;;AAGf,eAAe,kBAAY,CAAC,IAAI,EAAE,KAAK,YACrC;OAAG,MAAM,IAAI;;AAGf,eAAe,mBAAa,CAAC,IAAI,EAAE,KAAK,eACtC;OAAG,KAAK;;AAGV,eAAe,oBAAc,CAAC,IAAI,EAAE,KAAK,eACvC;OAAG,MAAM;;AAGX,eAAe,+BAAyB,CAAC,IAAI,EAAE,KAAK,aAClD;QAAI,QAAQ,GAAG,UAAU,SAAS;OAC/B,iBAAiB;;AAGtB,eAAe,wBAAkB,MAC/B;OAAG;;AAML,eAAe,uBAAiB,MAC9B;OAAG;;AAGL,eAAe,oBAAc,CAAC,IAAI,EAAE,KAAK,WACvC;OAAG,MAAM;;AAGX,eAAe,mBAAa,MAC1B;OAAG;;AAGL,eAAe,8BAAwB,CAAC,IAAI,EAAE,KAAK,aACjD;QAAI,QAAQ,GAAG;UACT,KAAK,GAAG,UAAU,eAAe;;AAGzC,eAAe,6BAAuB,MACpC;QAAI,QAAQ,GAAG;UACT,KAAK,GAAG;;AAGhB,eAAe,2BAAqB,MAClC;QAAI,QAAQ,GAAG;QACX,QAAQ,MAAM;UACZ,KAAK,QAAQ,MAAM,YAAY;;AAKvC,eAAe,4BAAsB,MACnC;OAAG,KAAW,GAAG,MAAM;;AAGzB,eAAe,2BAAqB,CAAC,IAAI,EAAE,KAAK,aAC9C;OAAG,KAAK;;AAGV,eAAe,0BAAoB;QAC3B,QAAU;;QAEZ,SAAe,MAAM;QACrB,QAAc,MAAM;QACpB,QAAc,MAAM;aAExBT,YAAO,UAAU,QAAS,SAAS,OAAO,UAAU,YAAY,MAAM,QAAQ,MAAM,aAAc,YAAY,4BAA4B;;QAEtI,OAAa,MAAM;QAEnB,UAAU,MAAM;;WAGf;WACA,UAAU;;;QAIX,gBAAgB;;;YAId,SAAS,MAAM;YACf,cAAc,OAAO;YAErB,cAAc,GAAG;4BACH,cAAc;iBAEzB,IAAI,IAAE,GAAG,IAAE,aAAa,KAAK;8BAClB,WAAW,OAAQ,IAAI,KAAK,GAAG;;;;OAKhD;OACA,UAAU;OACV,KAAK;;AAGV,eAAe,mBAAa,CAAC,IAAI,EAAE,KAAK,aACtC;OAAG,KAAK;;AAGV,eAAe,qBAAe,CAAC,IAAI,EAAE,KAAK,aACxC;QAAI,YAAkB,GAAG,MAAM;QAE3B,QAAQ,YAAY;YAClB,UAAU,SAAS;eAClB,KAAK;;WAEL;YACD,QAAQ,IAAI,eAAe;YAE3B,MAAM,QAAQ;eACb,KAAK;;WAGP,WAAW,IAAI,OAAO;;;AAI7B,eAAe,yBAAmB,CAAC,IAAI,EAAE,KAAK,aAC5C;QAAI,YAAkB,GAAG,MAAM;QAE3B,QAAQ,YAAY;YAClB,CAAC,UAAU,SAAS;eACnB,KAAK;;WAEL;YACD,QAAQ,IAAI,eAAe;YAE3B,CAAC,MAAM,QAAQ;eACd,KAAK;;WAGP,WAAW,IAAI,OAAO;;;AAI7B,eAAe,qBAAe,MAC5B;OAAG;;AAKL,eAAe,uBAAiB,CAAC,IAAI,EAAE,KAAK,eAC1C;OAAG,SAAS;;AAGd,eAAe,wBAAkB;QACzB,MAAe;QAAV;;UACL,KAAK,IAAI,uBAA6B,MAAM;;AAGpD,MAAoB,eAAQ;gBAOd,OACV;;aAPS,OAAG;aAQP,MAAM,MAAM;aACZ,QAAQ;;aAGN;YACD,QAAU;;YAEZ,WAAW,MAAM,eAAe;eAC/B;;;;AAKT,MAAqC,gCAAQ;gBAO/B,KAAkB,QAC5B;;aADkC,SAN7B;aAAI,OAAG;aAQP,MAAM;aACN,eAAe,IAAI;;aAGjB;YACD,MAA8B;YAAzB;YAAQ;;YAEf,CAAC,GAAG,oBAAoB,IAAI,SAAS,eAAe;eACnD,KAAK;;;gBAKV;aAAK,eAAe,KAAK,IAAI;;;AAIjC,MAA6B,wBAAQ;gBAKf,QAClB;;aADwB,SAJnB;aAAI,OAAG;aAMP,MAAM;;eAIX;aAAK,OAAO;;;AAIhB;gBASc,OARL;aAAG,MAAQ;aACP,OAAG;aACF,QAAmB;aAG3B,OAAQ;aACR,OAAQ;uBAGK;aACV,QAAQ;;eAGH;cAGV;kBAAU,KAAK,UAAU,KAAK,KAC/B;;;;AClSH,eAAe,mBAAa,CAAC,IAAI,EAAE,KAAK,WACtC;OAAG,WAAW,WAAW,GAAG,UAAU,UAAU;;AAGlD,eAAe,wCAAkC,CAAC,IAAI,EAAE,KAAK,UAC3D;QAAI,UAAU,GAAG,UAAU,UAAU;OAClC,WAAW,YAAY;;AAG5B,eAAe,sBAAgB,CAAC,IAAI,EAAE,KAAK,WACzC;OAAG,WAAW,cAAc,GAAG,UAAU,UAAU;;AAGrD,eAAe,0BAAoB,CAAC,IAAI,EAAE,KAAK,UAC7C;OAAG,WAAW,YAAY,GAAG,UAAU,UAAU;;AAGnD,eAAe,iCAA2B,MACxC;QAAI,UAAsB,GAAG,MAAT,MAAsC;OACvD,WAAW,YAAY;;AAG5B,eAAe,gCAA0B,MACvC;QAAI,aAAmB,GAAG,MAAM;QAC5B,iBAAuB,GAAG,MAAM;QAChC,UAAgB,GAAG,MAAM;QAEzB;QACA;QACA,OAAO,QAAQ;QAEf,QAAQ,aAAa;kBACP,WAAW;WACtB;YACD,QAAQ,IAAI,eAAe;kBACf,MAAM;WACnB,WAAW,IAAI,OAAO;;QAGvB,QAAQ,iBAAiB;sBACP,eAAe;WAC9B;YACD,QAAQ,IAAI,eAAe;sBACX,MAAM;WACvB,WAAW,IAAI,OAAO;;OAGxB,WAAW,kBAAkB,SAAS,MAAM;;AAGjD,eAAe,+BAAyB,MACtC;OAAG,WAAW;;AAGhB,eAAe,2BAAqB,MAClC;QAAI,aAAmB,GAAG,WAAW,SAAS;QAE1C,YAAY;mBACH,MAAM;WACd,UAAU,SAAS,IAAI;;OAGzB,WAAW;;AAGhB,eAAe,2BAAqB,MAClC;OAAG,WAAW;;AAKhB,eAAe,uBAAiB,CAAC,IAAI,EAAE,KAAK;QACtC,UAAU,GAAG,UAAU,cAA+B;QACtD,QAAQ,GAAG;QACX,OAAa,MAAM;;uBAC2B,GAAG;;QAAjC,uBAAd;QAAuB;;QACzB,eAAe,GAAG;QAClB,WAAW,QAAQ,OAAO,SAA4C,MAAM,cAAc;OAE3F,IAAI,wBAAwB,UAAU;QACrC,aAAa,QAAQ,cAAc;QAEnC,YAAY;WACX,eAAe;;QAGhB,MAAM,QAAQ,OAAO;QAErB,CAAC,WAAW,MAAM;WACjB,WAAW,IAAI,qBAChB,KACA,SACA;;;AAKN,MAAkC,6BAAQ;gBAK/B,KACC,SACA,UAER;;aAJU,MAAH;aACQ,UAAP;aACQ,WANX;aAAI,OAAG;aASP,cAAc,IAAI;;aAGhB;YACD;YAAS;YAAU,MAAqB;YAAhB;;YAE1B,CAAC,IAAI,SAAS,cAAc;eAC3B,IAAI,uBAAuB,UAAU;iBACnC,cAAc,IAAI;;;;AAK7B,eAAe,yBAAmB,CAAC,IAAI,EAAE,KAAK,OAAO,KAAK,QAAQ,KAAK,iBACrE;QAAI,OAAO,GAAG,UAAU,UAAU;QAC9B,QAAQ,GAAG,UAAU,UAAU;QAC/B,YAAY,aAAa,GAAG,UAAU,UAAU,cAAc;OAE/D,WAAW,mBAAmB,MAAM,OAAO;;AAGhD,eAAe,0BAAoB,CAAC,IAAI,EAAE,KAAK,OAAO,KAAK,UAAU,KAAK,iBACxE;QAAI,OAAO,GAAG,UAAU,UAAU;QAC9B,YAAkB,GAAG,MAAM;QAC3B,QAAQ,UAAU;QAClB,YAAY,aAAa,GAAG,UAAU,UAAU,cAAc;QAE9D,YAAY,GAAG,WAAW,oBAAoB,MAAM,OAAO,CAAC,CAAC,UAAU;QAEvE,CAAC,QAAQ,YAAY;WACpB,WAAW,IAAI,6BAA6B,WAAW;;;AAI9D,MAA0C,qCAAQ;gBAM5B,WAA+C,WACjE;;aAD2B,YAAT;aAAwD,YALrE;aAAI,OAAG;aAOP,MAAM,UAAU;aAChB,eAAe,KAAK,IAAI;;aAGtB;YACD;YAAW;YAAW,MAAQ;;YAChC,CAAC,IAAI,SAAS,KAAK,eAAe;iBAC/B,eAAe,IAAI;sBACd,OAAO,UAAU,SAAS,GAAG;;;;;0BC7KD,UAAsC,MAAc,MAC9F;QAAI,aAAa,SAAS,gBAAgB,MAAM;aAChDA,YAAO,iDAAiD,IACxD;;WAAO;;;ACqGT;AACA,yBAAsG,OAAU,SAC9G;WAAO,QAAQ,gBAAgB,OAAO,kBAAkB;;;AAY1D,0BAAuG,OAAU,SAC/G;WAAO,QAAQ,gBAAgB,OAAO,kBAAkB;CAG1D;;;gBC9GY,OACA,UACA,MACA,MAHA;aAAK,QAAL;aACQ,WAAR;aACI,OAAJ;aACI,OAAJ;aAEH,MAAM,MAAM;aACZ,YAAY;aACZ,iBAAiB;;;YAIhB,QAAqB;YAAd;;YAET,QAAQ,MAAM;YAEd,UAAU,WAAW;mBAChB,KAAK;;YAGV,aAAuE;YAEvE,6BAA6B,QAAQ;yBAC1B;eACR,IAAI,OAAO,UAAU,YAAY;gBAChC;gBAAU,OAAS;;yBACZ,iBAAiB,UAAU,OAAO;;qBAGpC,KAAK,MAAM;aAEnB,YAAY;aACZ,iBAAiB;eAEf;;UAIP;eAAO;;UAGK;YACN,OAAS;;YAEX,CAAC,QAAQ,6BAA6B,aAAa;mBAC9C;mBACE,CAAC,YAAY;mBACf;eACF;mBACE,IAAI,2BAA2B,YAAY;;;;;8BCvDnB,OACnC;QAAI,QAAQ,QAAQ;eACX;;WAEF,OAAO;;AAGhB,+BAAsC,OACpC;QAAI,QAAQ,QAAQ;eACX;;QAEL,SAAS,QAAQ;eACZ;;QAEL,aAAa,QAAQ;eAChB,MAAM;;QAEX,OAAO,QAAQ;eACV;;WAEF,OAAO;;AAGhB,iBAAwB,OACtB;WAAO,UAAU,QAAQ,UAAU,aAAa,OAAO,MAAM,aAAa;;AAG5E,sBAA6B,OAC3B;WAAO,OAAO,UAAU,YAAY,UAAU,QAAQ,OAAQ,MAAc,WAAW;;AAGzF,gBAAuB,OACrB;WAAO,OAAO,UAAU,YAAY,UAAU,QAAQ,OAAQ,MAAc,aAAa;;AAG3F,oBAA2B,OACzB;WAAO,OAAO,UAAU,MAAM,aAAa;;AAG7C,kBAAyB,OACvB;WAAO,OAAO,UAAU;;;;gBCzCJ,MAAA;aAAI,OAAJ;aACb,MAAM,cAAc;aACpB,OAAO;;;YAIR,MAAgB;YACd,OAAS;;aAEV,IAAI,IAAE,GAAG,IAAE,KAAK,QAAQ,KAAK;gBAC5B,QAAQ,qBAAqB,KAAK,GAAG;gBACrC,OAAO,IAAI,KAAK;;eAGf,IAAI,WAAW,IAAI,OAAO,IAAI,KAAK;;;;ACmC9C,MAAM,OAAO,IAAI;AAkCjB,eAAe,0BAAoB,MACjC;QAAI,QAAQ,GAAG;QACX,MAAY,MAAM;UAEhB,KAAK,sCAAsC,OAAO;;AAG1D,eAAe,6BAAuB,CAAC,IAAI,EAAE,KAAK,YAChD;QAAI,QAAQ,GAAG;QAEX,aAAmB,MAAM;QACzB,OAAa,MAAM;QACnB,WAAuC;QAEvC,KAAK,QAAQ;mBACJ,KAAK;;QAGd,OAAO,GAAG,UAAU,gBAA8B;QAClD,WAAW,GAAG,UAAU;OAEzB,UAAU,SAAS,IAAI,IAAI,wBAAwB,YAAY,UAAU,MAAM;;;AAKpF,eAAe,sCAAgC,CAAC,IAAI,EAAE,KAAK;QACrD,aAAa,GAAG,UAAU,cAAmC;aACjEA,YAAO,CAAC,CAAC,qCAAqC,MAE9C;;QAAM,UAAY;;OACf,MAAM,KAAK,EAAE,YAAY,SAAS,OAAO;;AAK9C,eAAe,0CAAoC,CAAC,IAAI,EAAE,KAAK,YAC7D;QAAI,QAAQ,GAAG;QAEX,YAAkB,MAAN,MAAuC;QACnD;QAEA,OAAO,cAAc;YACjB;YAAwB,WAAe,GAA5B;;YACb,OAAO,UAAU,gBAA8B;YAC/C,qBAAqB,iBAAiB,UAAU,WAAW;qBAE3C;eACX,6BAA6B,YAAY;qBACrC;WACR;cACC;;UAGF,KAAK,EAAE,YAAY,SAAS,MAAM,OAAO;;AAKjD,eAAe,uBAAiB,CAAC,IAAI,EAAE,KAAK,QAAQ,KAAK,YACvD;QAAI,QAAQ,GAAG;QACX,QAAQ,GAAG,UAAU,eAAe;QAEpC,kBAAkB,SAAS;QAC3B,YAAY,QAAQ;QACpB,aAAa;QAEb,QAAQ,QAAQ,WAAW,KAAK;QAChC,QAAQ,QAAQ,WAAW,KAAK;QAChC,QAAQ,QAAQ,WAAW,KAAK;SAE/B,MAAM,OAAO,OAAO,YAAY,iBAAiB,CAAC,CAAC;UAClD,KAAK;;AAGb,eAAe,0BAAoB,CAAC,IAAI,EAAE,KAAK;QACzC,QAAQ,GAAG;QACX,WAAW,GAAG,WAAqC;QAEjD,aAAe;;QAEjB;QAEA,6BAA6B,aAAa;iBAC5CA,YAAO,CAAC,WAAW,SAAS;;eAEf,MAAM;qBACN,SAAS,aAAa,WAAW,OAAO;WAChD;eACQ,MAAM;;sBAGI;QAAnB;QAAS;;aACN,UAAU,WAAW;QAE1B,QAAQ,gBAAgB,OAAO,gBAAgB,MAAM;cACjD,KAAK;;;QAIT,SAAS,KAAK,OAAO;QACrB,aAAa,KAAK,OAAO;QACzB,eAAe,QAAQ,YAAY,OAAO;QAE1C;aACG;aAEA,IAAI,IAAI,GAAG,IAAI,OAAO,QAAQ,KAAK;kBAChC,KAAK,OAAO;;YAGd;YAAY,QAAU;;YAExB,kBAAkB,WAAW;aAE5B,IAAI,IAAI,GAAG,IAAI,iBAAiB,KAAK;kBAClC,KAAK,WAAW;;YAGpB,QAAQ,OAAO,KAAK;aAEnB,IAAI,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;kBAC/B,KAAK,MAAM,MAAM;;aAGpB,MAAM,OAAO,OAAO,YAAY,iBAAiB;;UAGlD,KAAK;;AAGb,eAAe,8BAAwB,CAAC,IAAI,EAAE,KAAK,OAAO,KAAK;QACzD,eAAe,GAAG;QAElB,WAAW,GAAG,WAAuC;QACnD;QAAY,UAAY;;QAE1B,kBAAkB,QAAQ;QAC1B,OAA2B;QAE3B,QAAQ,gBAAgB,WAAW,OAAO,YAAY;eAC3C,GAAG,MAAM;;QAGpB,QAAQ,QAAQ,OAAO,GAAG,KAAK,WAAW,OAAO,MAAM,cAAc,GAAG,WAAW,CAAC,CAAC;;;aAIvB,QAAQ;QAEtE,MAAM,QAAQ,OAAO;QAErB,CAAC,WAAW,MAAM;WACjB,WAAW,IAAI,sBAAsB,KAAK,OAAO,SAAS;;;AAIjE,eAAe,0CAAoC,CAAC,IAAI,EAAE,KAAK;yBAC9B,GAAG,WAAW;;QAAvC;QAAS;;QAEX,aAAa,QAAQ,cAAc;QACnC,YAAY,GAAG,eAAe;;AAGpC,eAAe,wCAAkC,MAC/C;OAAG;OACA,WAAW;;AAGhB,eAAe,qCAA+B,MAC5C;OAAG,UAAU,SAAS,IAAI,IAAI;;AAKhC,eAAe,4BAAsB,CAAC,IAAI,EAAE,KAAK,OAAO,KAAK,UAAU,KAAK,iBAC1E;QAAI,OAAO,GAAG,UAAU,UAAU;QAC9B,YAAkB,GAAG,MAAM;QAC3B,YAAY,aAAa,GAAG,UAAU,UAAU,cAAc;OAEzD,WAAW,SAApB,IAA+E,aAAa,MAAM,WAAW,CAAC,CAAC,UAAU;;AAS3H;kBACU;aAAU,aAAG;aACN,UAAiC;;iBAEnC,MAAc,OAAmC,UAAmB,WAC/E;YAAI,WAAW,EAAE,OAAO,WAAW;YAE/B,SAAS,SAAS;iBACf,QAAQ,KAAK;;aAGf,WAAW,QAAQ;;UAGpB,IACJ;aAAK,IAAI,QAAQ,KAAK;gBAChB,OAAO,KAAK,WAAW;gBACd,iBAAP;gBAAkB;gBAAW,WAAa;;gBAE5C,SAAS,SAAS;4BACR,IAAI,mBAAmB,KAAK;;gBAGtC,YAAY,GAAG,WAAW,oBAAoB,MAAM,UAAU,SAAS,UAAU;gBAEjF,CAAC,QAAQ,YAAY;mBACpB,WAAW,IAAI,6BAA6B,WAAW;;;;;AAMlE,eAAe,+BAAyB,CAAC,IAAI,EAAE,KAAK;0BAChB,GAAG,WAAW;;QAA1C;QAAY;QACZ,UAAY;;QAEd,aAAmB,GAAG,WAAW,SAAS;QAE1C,SAAS;YAC2B,iBAAiB,OAAO,GAAG,WAAW,mBAAmB,SAAS;;AAG5G,eAAe,+BAAyB,CAAC,IAAI,EAAE,KAAK;0BAChB,GAAG,WAAW;;QAA1C;QAAY;QACZ,UAAY;;OAEf,MAAM,KAAK,QAAQ,QAAQ;;AAGhC,eAAe,kCAA4B,CAAC,IAAI,EAAE,KAAK;0BACnB,GAAG,WAAW;;QAA1C;QAAY;QACZ,UAAY;;OAEf,MAAM,KAAM,QAAoE,WAAW;;;AAIhG,eAAe,iCAA2B,CAAC,IAAI,EAAE,KAAK;QAChD,WAAiB,GAAG,WAAW;QAC7B,UAAwB;QAAf;QACI,cAAb;QAAyB,QAAU;QAE5B,gBAAkB,SAAzB;QACO,kBAAoB,WAA3B;;QAEF;QAEA,gBAAgB,iBAAiB,UAAU;iBACpC,QAAQ,UAAU,iBAAiB;eACnC,iBAAiB,iBAAiB,UAAU;iBAC5C,QAAQ,iBAAiB,eAAe;WAC5C;cACC;;UAGF,KAAK,OAAO;UACZ,KAAK,OAAO;;;AAIpB,eAAe,oCAA8B;QACrC,QAAU;;QAEZ,SAAe,MAAM;;qBACQ,MAAM;;QAAjC;QAAS;;;YAGT,QAAQ,GAAG,cAAc,QAAQ,SAAS,GAAG;cAC3C,SAAe,MAAM;YAEvB,OAAa,GAAG,MAAM;YAEtB,SAAkC;YAClC,QAAwB,CAAC;YAEzB,SAAS;oBACH,QAAQ,QAAQ,WAAW;qBAC1B;;YAGP,cAAc,KAAK,MAAM;aAExB,IAAI,IAAE,YAAY,SAAS,GAAG,KAAG,GAAG,KAAK;gBACxC,SAAS,YAAY;gBACrB,SAAS,QAAQ,QAAQ,YAAY;gBACrC,QAAQ,KAAK,MAAM,IAAI,QAAQ;gBAE/B,WAAW,CAAC,GAAG,MAAM,WAAW,SAAS,GAAG;gBAC5C,SAAS,OAAQ,UAAU;;YAG7B,YAAY,CAAC,YAAoB,cACnC;gBAAI,SAAS,QAAQ,QAAQ;gBAEzB,QAAQ,OAAO,IAAI;gBAEnB,WAAW,CAAC,GAAG;sBACX,UAAU,SAAS,GAAG;;gBAG1B,QAAQ,OAAO,cAAc;;YAG/B,SAAS,KAAK;kBACR,aAAa;kBACb,YAAY;kBACZ,YAAY;YAElB,QAAQ,MAAM,cAAc;WAE7B,KAAK;;;AAIZ,eAAe,8BAAwB,CAAC,IAAI,EAAE,KAAK;0BAClB,GAAG,WAAW;;QAAvC;QAAS;;QACX,SAAS,GAAG,WAAW;QAEvB,MAAY;QAEZ,gBAAgB,OAAO;OAExB,IAAI,UAAU,OAAO;OAErB,WAAW,IAAI,sBAAsB,SAAS,OAAO;;AAK1D,eAAe,yCAAmC,MAChD;OAAG;;AAKL,MAAmC,8BAAQ;gBAIhC,KACC,WACA,SACA,cAER;;aALU,MAAH;aACU,YAAT;aACO,UAAP;aACY,eANf;aAAI,OAAG;;aAWL;YACD;YAAW,UAA0B;YAAjB;;gBAElB,OAAO,WAAW;;;AAI9B,MAAmC,8BAAQ;gBAK/B,SACA,WACA,QAER;;aAJe,UAAP;aACS,YAAT;aACM,SANT;aAAI,OAAG;aACJ,MAAQ;;aAUT;YACD;YAAS;YAAW,SAAW;;gBAE7B,gBAAgB,WAAW;WAEhC,IAAI,UAAU,WAAW;;;;AC5chC,uBAAuB,SAAiB,KACtC;YAAQ,KAAK;;gBAGD,IAAI;;;;AAMlB,IAAI,WAAW;;AAGf;AAIA;AAIA;gBAGsB,OAAc,SAAmB,UAAjC;aAAK,QAFjB;aAAM,SAAG;aAGV,IAAI,IAAI,GAAG,IAAI,SAAS,QAAQ,KAAK;gBACpC,OAAO,SAAS;gBAChB,OAAO,QAAQ,OAAO;gBACtB,MAAO,MAAM,UAAU;iBACtB,OAAO,QAAQ;;;QAIpB;YACI,QAAkB;YAAX;;YACT,QAAQ,KAAK,MAAM;;0BACD,KAAK,MAAM;;YAA5B;YAAS;;YAEV,YAAY,MAAM;YAClB;YAEA,SAAS,QAAQ;kBACb,MAAM;mBACH,OAAO,OAAO;kBACjB,OAAO;mBACJ,KAAK,QAAQ,SAAS,KAAK,UAAU,OAAO;kBAC/C,UAAU;eACX;kBACC,KAAK,MAAM;mBACV;;eAGF,KAAK,OAAO,CAAC,GAAG,SAAS,EAAE,IAAI,OAAO;;;AAIjD,eAAe,uBAAiB,CAAC,IAAI,EAAE,KAAK,UAAU,KAAK,gBACzD;QAAI,UAAU,GAAG,UAAU,eAAe;QACtC,WAAW,GAAG,UAAU,SAAS;QACjC,YAAY,IAAI,eAAe,GAAG,SAAS,SAAS;aAC/C,GAAG,UAAU,SAAS,QAAQ,UAAU,IAAI,MAAM;;;AC9D7D,eAAe,4BAAsB,CAAC,IAAI,EAAE,KAAK,OAAO,KAAK,UAAU,KAAK;QACpE;QAAwB,cAAb;QAAyB,QAAU;;QAEhD,OAAa,MAAN,MAAmC;aAC9CA,YAAO,OAAO,SAAS,6CAA6C,OAAO,KAE3E;;QAAI,OAAO,UAAU,gBAA8B;QAC/C,eAAe,UAAU,eAAe;QACxC,WAAW,UAAU,SAAS;QAE9B,YAAY,SAAS,cAAc,MAAgB;aAEvDA,YAAO,8CAA8C,IAErD;;QAAI,aAAa,SAAS,QAA2B;;gCAEvB,WAAW;;QAAnC;QAAa;;;YAGb,iBAAiB,YAAY;YAC7B,aAAa,GAAG;YAChB,eAAe,GAAG,cAAc,eAAe,QAAQ;qBAC9C,gBAAgB,WAAW;qBAC3B,cAAc,WAAW;qBACzB,SAAS,WAAW;YAE7B,SAAS;aAER,IAAI,IAAI,GAAG,IAAI,SAAS,QAAQ,KAAK;gBACpC,OAAO,SAAS;gBAChB,OAAO,aAAa,OAAO;gBAC3B,MAAO,WAAW,UAAU;mBACzB,QAAQ;;YAGb,YAAY,WAAW;aAEtB,IAAI,IAAI,GAAG,IAAI,eAAe,QAAQ,KAAK;gBAC1C,OAAO,eAAe;gBACtB,SAAS,IAAI;gBACb,QAAQ,UAAU;gBAElB,UAAU,WAAW,aAAa,KAAK,QAAQ;;qBAGxC,eAAe;WAEzB;WACA,KAAK;;;;AC/CZ;gBAIc,WACV;aAAK,MAAM,UAAU;aAChB,YAAY;;YAIjB;eAAO,CAAC,KAAK,UAAU;;;AAI3B,eAAe,0BAAoB,MACjC;QAAI,QAAQ,GAAG;QACX,UAAgB,MAAM;QACtB,MAAY,MAAM;QAClB,WAAW,GAAG,IAAI,YAAY,SAAe,IAAI;QACjD,WAAW,IAAI,kBAAkB;UAE/B,KAAK;UACL,KAAK,IAAI,0BAA0B,SAAS;;AAGpD,eAAe,wBAAkB,CAAC,IAAI,EAAE,KAAK,oBAC3C;OAAG,UAAU;;AAGf,eAAe,uBAAiB,MAC9B;OAAG;;AAGL,eAAe,sBAAgB,CAAC,IAAI,EAAE,KAAK,aACzC;QAAI,QAAQ,GAAG;QACX,OAAa,MAAN,OAAwD;QAE/D,MAAM;YACJ,YAAY,GAAG,QAAQ,KAAK,MAAM,KAAK;WACxC,UAAU,KAAK,KAAK;WAClB;WACF,KAAK;;;;;gBCzCS,SAAgC,aAAhC;aAAO,UAAP;aAA2C,cAAX;;;AAOrD;gBACqB,YAAoC,OAAoC,MAAxE;aAAU,aAAV;aAAyC,QAAL;aAAwC,OAAJ;;oBAEzE;eAAO,KAAK;;gBAChB;eAAO,KAAK;;eACb;eAAO,KAAK;;;AAG3B;gBAIc,YAA4B,MACtC;aAAK,aAAa;aACb,OAAO;;oBAGI;eAAO,KAAK;;gBAChB;eAAO,KAAK;;eACb;eAAO,KAAK;;;AAG3B,gBAAuB,QAAwB,OAAoB,MACjE;WAAO,IAAI,eAAe,QAAQ,OAAO;;AAG3C,gBAAuB,QAAwB,MAC7C;WAAO,IAAI,iBAAiB,QAAQ;;AAGtC,cAAqB,QAAgB,WACnC;QAAI,SAAS,OAAO;QAChB,QAAQ,OAAO;QACf,OAAO,OAAO;QAEd,OAA4B;WAEzB,MAAM;YACP,OAAO,KAAK;eACT,aAAa,MAAM;YACtB,SAAS,MAAM,OAAO;eACnB;;WAGF;;AAGT,eAAsB,QACpB;QAAI,SAAS,OAAO;QAChB,QAAQ,OAAO;QACf,OAAO,OAAO;QAEd,OAA4B;WAEzB,MAAM;YACP,OAAO,KAAK;eACT,YAAY;YACf,SAAS,MAAM,OAAO;eACnB;;WAGF;;;AC3EF,MAAMU,kBAAgB;;;;;;;;;;;;AAc7B,8BAAqC,UAA4B,UAAgC,cAC/F;QAAI,CAAC,UAAU,OAAO;QAElB,CAAC,eAAe,UAAU,eAAe;eACpC;;QAGL,MAAM,SAAS,cAAc;WAE1B,MAAoC,sCAAQ;yBAChC,QAAqB,aAAmB,MACvD;gBAAI,SAAS,QAAQ,SAAS,IAAI;uBACzB,MAAM,iBAAiB,QAAQ,aAAa;;gBAGjD,OAAO,iBAAiB,cAAc;uBACjC,MAAM,iBAAiB,QAAQ,aAAa;;mBAG9C,OAAO,QAAQ,KAAK,MAAM;;;;AAKvC,gBAAgB,QAAiB,KAAkB,MAAc;;;QAG3D,cAAc,UAAU,OAAO;QAE/B,YAAY;;2BAEI,gBAAgB,IAAI,YAAoB,QAAQ;;QAA/D;QAAO;;WACL,IAAI,eAAe,QAAQ,OAAO;;AAG3C,wBAAwB,UAAoB,cAC1C;QAAI,MAAM,SAAS,gBAAgB,cAAc;QAE7C;YACE,sBAAsB,aAAa;MACvC,OAAO,GAAG;;;cAGF;;YAEJ,IAAI,WAAW,WAAW,KAAY,IAAP,WAAuB,iBAAiBA,iBAAe;;mBAEjF;;eAGF;;;;AChEX;;;;;;;;;;;;AAYA,iCAAwC,UAA4B,UAClE;QAAI,CAAC,UAAU,OAAO;QAElB,CAACC,iBAAe,WAAW;eACtB;;WAGF,MAAuC,yCAAQ;oBAGxC,UACV;kBAAM;iBACD,iBAAiB,SAAS,cAAc;;yBAG9B,QAAqB,aAAmB,MACvD;gBAAI,SAAS,MAAM;uBACV,MAAM,iBAAiB,QAAQ,aAAa;;gBAGjD,uBAAuB;gBAEvB,eAAe,cAAc,YAAY,kBAAkB,OAAO;gBAClE,gBAAgB,wBAAwB,MAAM;uCACzB;uBAChB,aAAa,KAAK,gBAAgB;;gBAGvC,SAAS,MAAM,iBAAiB,QAAQ,aAAa;gBAErD,sBAAsB;uBACjB,YAAY,KAAK;;mBAGnB;;;;AAKb,0BAAwB,UACtB;QAAI,iBAAiC,SAAS,cAAc;mBAE7C,YAAY;mBACZ,mBAAmB,aAAa;QAE3C,eAAe,WAAW,WAAW,GAAG;;eAEnC;;WAGF;;;ACvDF,MAAMD,mBAAgB;;AAG7B,MAAM,yBAAyB,EAAE,eAAe,GAAG,MAAM,GAAG,OAAO;;;;;;AASnE,AAAO,MAAM,kBAAkB,OAAO,OAAO;AAE5C,CACC,KAAK,OAAO,cAAc,QAAQ,MAAM,UAAU,QAAQ,MAAM,OAAO,MAAM,MAAM,MAAM,SACzF,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,QAAQ,MAAM,KAAK,OAAO,MAAM,WAAW,QAAQ,QAAQ,QAC/F,MAAM,KAAK,OAAO,QAAQ,KAAK,SAAS,QAAQ,UAAU,UAAU,OAAO,OAAO,SAAS,MAAM,KACjG,MAJF,OAKG,QAAQ,OAAO,gBAAgB,OAAO;AAEzC,AAEA,IAAI,MAAwB,OAAO,aAAa,cAAc,OAAO;AAErE;AAIA,yBAAgC,QAAqB,QAAwB,aAC3E;QAAI,QAAQ,OAAO;QACf,OAA2B;QAC3B,UAAU;WACP,SAAS;eACP;kBACG,QAAQ;eACX,aAAa,MAAM;;WAErB,CAAC,OAAO;;AAGjB;gBAGwB,UAAA;aAAQ,WAAR;aACf;;;;0BAML;aAAK,iBAAiB,KAAK,SAAS,cAAc;;kBAGtC,KAAa,SACzB;YAAI,yBAAkC;YAElC,SAAS;sCACe,QAAQ,iBAAiBA,oBAAiB,QAAQ;qCACnD,uBAAuB,QAAQ;eACnD;sCACqB,QAAQ;qCACT;;YAGvB,2BAA2B,CAAC,wBAAwB;;;;gBAIlD,gBAAgB,MAAM;sBAClB,IAAI,yBAAyB,GACpC;;mBAEM,KAAK,SAAS,gBAAgBA,kBAAe;eAC/C;mBACE,KAAK,SAAS,cAAc;;;iBAI1B,QAAwB,MAAmB,WACtD;eAAO,aAAa,MAAM;;qBAGX,SAAyB,aAAkC,MAC1E;eAAO,iBAAiB,KAAK,gBAAgB,SAAS,aAAa;;mBAGtD,MACb;eAAO,KAAK,SAAS,eAAe;;kBAGxB,MACZ;eAAO,KAAK,SAAS,cAAc;;;AAIvC,IAAiB;AAAjB,WAAiB,KASf;UAA8B,yBAAQ;wBACpB,WAAsB,KACpC;mBAAO,KAAK,SAAS,gBAAgB,WAAW;;qBAGrC,SAAkB,MAAc,OAAe,YAA4B,MACtF;gBAAI,WAAW;wBACL,eAAe,WAAW,MAAM;mBACnC;wBACG,aAAa,MAAM;;;;QATJ,mBAY5B;QAEG,yBAAyB;6BACJ,wBAAwB,KAAK;6BAC7B,qBAAqB,KAAK,wBAAwBA;QAE3C,sBAAG;GA3BpB,QAAA,MA6BhB;AAED,MAAwB,mBAAQ;gBAGR,UACpB;cADoB;aAAQ,WAAR;aAEf,YAAY;;iBAGN,SAAyB,MAAc,OAClD;gBAAQ,aAAa,MAAM;;oBAGb,SAAyB,MACvC;gBAAQ,gBAAgB;;gBAGd,SAAyB,MAAmB,WACtD;aAAK,aAAa,SAAS,MAAM,UAAU;;;AAI/C,0BAA6C,UAA0B,SAAyB,cAAmC,MACjI;;;;;QAII,SAAS;QACT,UAAU;QACV,cAAc;QAEd,OAAO,cAAc,YAAY,kBAAkB,OAAO;QAC1D;QAEA,SAAS,QAAQ,SAAS,IAAI;eACzB,IAAI,eAAe,QAAQ,MAAM;;QAGtC,gBAAgB,MAAM;eACjB,mBAAmB,aAAa;eAChC,OAAO;eACL,uBAAuB,aAAa;oBACjC,mBAAmB,eAAe;eACvC,YAAY;WACd;;;;;;eAME,aAAa,SAAS;gBACrB,mBAAmB,eAAe;eACnC,QAAQ;eACR,YAAY;;QAGjB,QAAQ,OAAO,KAAK,cAAc,OAAO;WACtC,IAAI,eAAe,QAAQ,OAAO;;AAG3C,IAAI,SAAS;AAEb,SAAS,wBAAwB,KAAK;AACtC,SAAS,qBAAqB,KAAK,QAAQA;AAE3C,mBAAe;AACf,AAAO,MAAM,sBAAsB,IAAI;;ACtMvC,MAAM,eAAe,CACnB,eACA;AAGF,MAAM,UAAU,CACd,KACA,QACA,QACA,OACA,UACA,QACA;AAGF,MAAM,oBAAoB,CACxB;AAGF,MAAM,gBAAgB,CACpB,QACA,OACA,cACA;AAGF,MAAM,0BAA0B,CAC9B;AAGF,aAAa,OAAsB,MACjC;WAAO,MAAM,QAAQ,UAAU,CAAC;;AAGlC,kBAAkB,SAAyB,WACzC;WAAO,CAAC,YAAY,QAAQ,IAAI,SAAS,aAAa,IAAI,eAAe;;AAG3E,sBAAsB,SAAyB,WAC7C;QAAI,YAAY,MAAM,OAAO;WACtB,IAAI,mBAAmB,YAAY,IAAI,yBAAyB;;AAGzE,8BAAqC,SAAiB,WACpD;WAAO,SAAS,SAAS,cAAc,aAAa,SAAS;;AAG/D,gCAAuC,KAAkB,SAAyB,WAAmB,OACnG;QAAI,UAA0B;QAE1B,UAAU,QAAQ,UAAU,WAAW;eAClC;;QAGL,aAAa,QAAQ;eAChB,MAAM;;QAGX,CAAC,SAAS;kBACF;WACL;kBACK,QAAQ,QAAQ;;QAGxB,MAAM,qBAAqB;QAE3B,SAAS,SAAS,YAAY;YAC5B,WAAW,IAAI,eAAe;YAC9B,IAAI,cAAc,WAAW;6BACd,GAClB;;;QAGC,aAAa,SAAS,YAAY;yBACnB,GAClB;;WAEM;;;AC/ET;;;;;;AAMA,2BAAkC,SAAyB,UACzD;QAAI,MAAM;QAEN,YAAY,SAAS;qBACV;eACN;WACF;YACD,QAAQ,SAAS;YACjB,SAAS,SAAS;mBACb;yBACM;eACR;mBACE;yBACM;;;QAIb,SAAS,WACR,WAAW,kBAAkB,WAC7B,WAAW,QAAQ,SAAS,cAAc;eACtC;;WAGF,EAAE,YAAY;;AAGvB;;;;AAWA,MAAM;;cAGI;;;;qBAIO;;;cALR;;;;YAaG,EAAE,MAAM;YACR,EAAE,MAAM;cACR,EAAE,MAAM;WACR,EAAE,MAAM;cACR,EAAE,MAAM;YACR,EAAE,MAAM;YACR,EAAE,MArBS;;AAwBvB,oBAAoB,SAAiB,UACnC;QAAI,MAAM,eAAe,QAAQ;WAC1B,OAAO,IAAI,SAAS,kBAAkB;;;kCC3DN,SAAyB;QAC1D,UAA0B;QAAjB;;QAEX,iBAAiBA,kBAAe;eAC3B,wBAAwB,SAAS;;;6BAGf,kBAAkB,SAAS;;QAAhD;QAAM;;QAER,SAAS,QAAQ;eACZ,wBAAwB,SAAS;WACnC;eACE,uBAAuB,SAAS;;;AAI3C,iCAAwC,SAAiB,MACvD;QAAI,qBAAqB,SAAS,OAAO;eAChC;WACF;eACE;;;AAIX,gCAAuC,SAAiB,MACtD;QAAI,qBAAqB,SAAS,OAAO;eAChC;;QAGL,iBAAiB,SAAS,OAAO;eAC5B;;QAGL,iBAAiB,SAAS,OAAO;eAC5B;;WAGF;;AAGT;gBACqB,WAAA;aAAS,YAAT;;;AAMrB,MAAoC,+BAAQ;QACtC,KAAqB,OAAe,MACtC;YAAI,kBAAkB,eAAe;YAEjC,oBAAoB;6BACI,KAAK;gBAAzB;gBAAM;;gBACR,eAAe,MAAM,iBAAiB;;;WAIvC,OAAe;YAChB,kBAAkB,eAAe;0BACb,KAAK;YAAvB;YAAS;;YAEX,oBAAoB,MAAM;oBACpB,gBAAgB;eACnB;oBACG,aAAa,MAAM;;;;AAKjC,MAAoC,+BAAQ;QAEtC,KAAqB,OAAe,MACtC;YAAI,UAAU,QAAQ,UAAU;gBACxB,OAAS,KAAK;;iBACf,QAAQ;gBACT,cAAc,MAAM;;;WAIrB,OAAe;0BACI,KAAK;YAAvB;YAAS;;YAEX,KAAK,UAAU,OAAO;oBAChB,QAAQ,KAAK,QAAQ;gBAEzB,UAAU,QAAQ,UAAU,WAAW;qBACpC;;;;;;;0BAS0B,KAAK;YAAlC;YAAS;YAAM;;YAEjB,WAAW;oBACL,kBAAkB,WAAW;eAChC;oBACG,gBAAgB;;;;AAK9B,MAAiC,4BAAQ;QACnC,KAAqB,OAAe;0BACd,KAAK;YAAvB;YAAS;;YACX,YAAY,uBAAuB,KAAK,SAAS,MAAM;cACrD,IAAI,KAAK,WAAW;;WAGrB,OAAe;0BACI,KAAK;YAAvB;YAAS;;YACX,YAAY,uBAAuB,KAAK,SAAS,MAAM;cACrD,OAAO,WAAW;;;AAI5B,MAAkC,6BAAQ;QACpC,KAAqB,OAAe;0BACd,KAAK;YAAvB;YAAS;;YACX,YAAY,uBAAuB,KAAK,SAAS,MAAM;cACrD,IAAI,KAAK,WAAW;;WAGrB,OAAe;0BACI,KAAK;YAAvB;YAAS;;YACX,YAAY,uBAAuB,KAAK,SAAS,MAAM;cACrD,OAAO,WAAW;;;AAI5B,MAAwC,mCAAQ;QAC1C,KAAqB,OACvB;YAAI,cAAc,SAAS,qBAAqB;;WAG3C,OACL;YAAI,QAAQ,KAAK,UAAU;YACvB,eAAe,MAAM;YACrB,kBAAkB,qBAAqB;YACvC,iBAAiB,iBAAiB;kBAC9B,QAAQ;;;;AAKpB,MAA4C,uCAAQ;QAC9C,KAAqB,OACvB;YAAI,UAAU,QAAQ,UAAU,aAAa,UAAU,OAAO;gBACxD,cAAc,YAAY;;;WAI3B,OACL;YAAI,SAAS,KAAK,UAAU;YAExB,OAAO;mBACF,WAAW;eACb;mBACE,WAAW;;;;AAKxB,0BAA0B,SAAiB,WACzC;WAAO,YAAY,YAAY,cAAc;;AAG/C,0BAA0B,SAAiB,WACzC;WAAO,CAAC,YAAY,WAAW,YAAY,eAAe,cAAc;;AAG1E,wBAAwB,OACtB;QAAI,UAAU,SAAS,UAAU,aAAa,UAAU,QAAQ,OAAO,MAAM,aAAa,aAAa;eAC9F;;QAEL,UAAU,MAAM;eACX;;;QAGL,OAAO,UAAU,YAAY;eACxB;;WAGF,OAAO;;;;;;WC5IJ;;;;gBADA;aAAK,QAAL;aACW,cAAX;aAES,YAAT;aAEU,aAAV;;WA3BH,KAAK,MAA6B,OAAO,GAC9C;YAAI,OAAgC,IAAI,MAAM,OAAO;aAEhD,IAAI,IAAI,GAAG,KAAK,MAAM,KAAK;iBACzB,KAAK;;eAGL,IAAI,MAAM,MAAM,MAAM,MAAM,MAAM,KAAK,EAAE;;WAG3C,MAAM,OAAO,GAClB;YAAI,OAAgC,IAAI,MAAM,OAAO;aAEhD,IAAI,IAAI,GAAG,KAAK,MAAM,KAAK;iBACzB,KAAK;;eAGL,IAAI,MAAM,MAAM,MAAM,MAAM;;SAahC,EAAE,QACL;aAAK,MAAM,KAAK;eACT;;cAIP;eAAO,KAAK,IAA2B;;cAG/B,QACR;eAAO,KAAK,IAA2B;;aAGhC,QACP;eAAO,KAAK,IAAgB;;mBAI5B;eAAO,KAAK;;oBAIZ;eAAO,KAAK;;SAGT,QAAgB,OACnB;aAAK,IAAI,QAAQ;;aAGV,MACP;aAAK,IAA2B,GAAG;;eAG1B,QAAgB,OACzB;aAAK,IAAI,QAAQ;;cAGT,QAAgB,OACxB;aAAK,IAAwB,QAAQ;;kBAGzB,KACZ;aAAK,YAAY;;mBAGJ,KACb;aAAK,aAAa;;oBAGJ,OACd;aAAK,cAAc;;qBAInB;eAAO,KAAK;;YAIZ;eAAO,IAAI,MAAM,KAAK,MAAM,SAAS,KAAK,aAAa,KAAK,WAAW,KAAK;;QAG7C,OAC/B;YAAI,SAAS,KAAK,MAAM,QAAQ;kBACxB,IAAI,+BAA+B,4BAA4B,KAAK,MAAM,MACjF;;eAEM,KAAK,MAAM;;QAGa,OAAe,OAC9C;YAAI,SAAS,KAAK,MAAM,QAAQ;kBACxB,IAAI,+BAA+B,4BAA4B,KAAK,MAAM,MACjF;;aAEI,MAAM,SAAS;;;AAIxB;kBACS;aAAwB,2BAAsB;aACrB,4BAAe;aACT,kCAAsB;aAC7B,2BAAe;aACtB,oBAAgB;aAClB,kBAAuB;aACrB,oBAAgB;aAClB,kBAAuB;aAC3B,cAAkB;;cAE1B,WAAsB,SAC9B;aAAK,kBAAkB,KAAK;aACvB,gBAAgB,KAAK;;cAGlB,WAAsB,SAC9B;aAAK,kBAAkB,KAAK;aACvB,gBAAgB,KAAK;;4BAGJ,UAAoB,SAC1C;aAAK,yBAAyB,KAAK;aAC9B,0BAA0B,KAAK;;2BAGf,UAAoB,SACzC;aAAK,gCAAgC,KAAK;aACrC,yBAAyB,KAAK;;eAG1B,GACT;aAAK,YAAY,KAAK;;;YAIhB;YAAmB,kBAAoB;;aAExC,IAAI,IAAE,GAAG,IAAE,kBAAkB,QAAQ,KAAK;gBACzC,YAAY,kBAAkB;gBAC9B,UAAU,gBAAgB;oBACtB,UAAU;;YAGd;YAAmB,kBAAoB;;aAExC,IAAI,IAAE,GAAG,IAAE,kBAAkB,QAAQ,KAAK;gBACzC,YAAY,kBAAkB;gBAC9B,UAAU,gBAAgB;oBACtB,UAAU;;YAGd,cAAgB;;aAEjB,IAAI,IAAE,GAAG,IAAE,YAAY,QAAQ,KAAK;wBAC3B,GAAG;;YAGX,2BAAwD;YAA9B;;aAE3B,IAAI,IAAI,GAAG,IAAI,yBAAyB,QAAQ,KAAK;gBACpD,UAAU,yBAAyB;gBACnC,WAAW,0BAA0B;oBACjC,QAAQ;;YAGZ;YAAiC,2BAA6B;;aAE/D,IAAI,IAAI,GAAG,IAAI,gCAAgC,QAAQ,KAAK;gBAC3D,UAAU,gCAAgC;gBAC1C,WAAW,yBAAyB;oBAChC,OAAO;;;;AAiBrB;gBAKc,EAAE,kBAAkB,oBAFxB;aAAY,eAAwB;aAGrC,mBAAmB;aACnB,mBAAmB;;2BAGH,WACrB;eAAO,IAAID,uBAAqB;;0BAMW;eAAO,KAAK;;aAClC;eAAO,KAAK;;gBAEvB,QACV;eAAO,WAAW,UAAU;;;iBAI5BT,YAAO,CAAC,KAAK,cAAc;;aACtB,eAAe,IAAI;;QAGd,cACV;eAAc,KAAK;;cAGX,WAAsB,SAC9B;aAAK,YAAY,UAAU,WAAW;;cAG9B,WAAsB,SAC9B;aAAK,YAAY,UAAU,WAAW;;4BAGhB,UAAoB,SAC1C;aAAK,YAAY,wBAAwB,UAAU;;2BAG9B,UAAoB,SACzC;aAAK,YAAY,uBAAuB,UAAU;;eAGzC,GACT;aAAK,YAAY,WAAW;;aAI5B;YAAI,cAAc,KAAK;aAClB,eAAe;oBACR;;iBAGD,SAAyB,MAAc,aAAsB,aAA6B,MACrG;eAAO,yBAAyB,SAAS;;CAI7C,AAaA;;AC3SA;gBACwB,UAAA;aAAQ,WAAR;;UAMN,KAAkB;YAC1BY,YAAW;;YACb,gBAAgBA,UAAO;YACvB,cAAc,MAAMA;YAEpB,QAAQ,kBAAkB,iBAAiB,KAAK,EAAE,SAAS,eAAe;YAE1E,KAAK,UAAU;mBACV,MAAM,+BAA+B;eACvC;mBACE,MAAM,+BAA+B;;;;AAKlD,AAEA;gBAesB,OAAA;aAAK,QAAL;aACb,SAAS,MAAM;;oBAdpB;eAAO,KAAK,OAAO;;gBAInB;eAAO,KAAK,OAAO;;eAInB;eAAO,KAAK,OAAO;;WASd,KAAkB,OACvB;YAAI,QAAQ,KAAK,QAAQ,KAAK,MAAM,OAAO,KAAK;aAC3C,SAAS,MAAM;eACb;;;;MClD6B,2BAAQ;gBAC3B,QAAkC,WAAmB,SACtE;cADiB;aAAM,SAAN;aAA2C,YAAT;;WAI9C,KAAkB;YACjB,YAAc;;YAEhB,UAAU,WAAW,OAAO;YAC5B,OAAO,UAAU,aAAa,QAAQ,OAAO,KAAK,MAAM,KAAK;YAE7D;YAEA,QAAQ,QAAQ;yBACL;mBACJ,SAAS,QAAQ;yBACb;eACR;yBACQ,OAAO;;YAGlB,eAAe,WAAW;gBACxB,WAAW,KAAK,OAAO;qBAClB,YAAY,KAAK,YAAY;;eAGjC;;;;MC3B6B,2BAAQ;gBAC3B,QAAwB,WAAwB,UACjE;cADiB;aAAM,SAAN;aAAiC,YAAT;;WAIpC,KAAkB;YACjB,YAAc;;YAEhB,UAAU,WAAW,OAAO;eAEzB,KAAK,MAAM,KAAK;;;;MCTa,2BAAQ;gBAC3B,QAAwB,WAAuB,SAChE;cADiB;aAAM,SAAN;aAAiC,YAAT;;WAIpC,KAAkB;YACjB,YAAc;;YAEhB,UAAU,WAAW,OAAO;YAE5B,aAAa,UAAU,MAAM,aAAa,UAAU,UAAU;iBAC3D,YAAY;mBACV;;eAGF,KAAK,MAAM,KAAK;;;AAI3B,MAAuC,kCAAQ;gBAC1B,QAAwB,WAAmB,SAC5D;cADiB;aAAM,SAAN;aAAiC,YAAT;;WAIpC,KAAkB;YACjB,YAAc;;YAEhB,UAAU,WAAW,OAAO;YAC5B,WAAW,sBAAsB;YACjC,aAAa,WAAW,OAAO;eAE5B,KAAK,MAAM,KAAK;;;;ACT3B;gBACsB,MAAA;aAAI,OAAJ;;gBAGlB;eAAO,KAAK;;;AAIhB;gBACsB,MAAA;aAAI,OAAJ;;eAGlB;eAAO,KAAK;;;AAQhB;AAwEA;gBA0Bc,KAAkB,YAA4B,aAvBnD;aAAY,eAA2B;aAC7B,aAA8B;aAG1B,cAAG,IAAI;aACV,aAAG,IAAI;aAmBlB,YAAY,YAAY;aAExB,MAAM;aACN,MAAM,IAAI;aACV,mBAAmB,IAAI;;WArBvB,iBAAiB,KAAkB,QACxC;YAAI,UAAU,IAAI,KAAK,KAAK,OAAO,SAAS,OAAO;gBAC3C;eACD;;WAGF,OAAO,KAAkB,SAAkB,aAChD;YAAI,aAAa,QAAQ;YAErB,QAAQ,IAAI,KAAK,KAAK,YAAY;cAChC;cACA,iBAAiB;eAEhB;;QAWL,UACF;eAAO,KAAK,YAAY,QAAS;;QAG/B,cACF;eAAO,KAAK,YAAY,QAAS;;uBAGhB,QACjB;eAAc,KAAK;;YAInB;eAAc,KAAK,WAAW;;iBAI9B;aAAK,YAAY;aACL,YAAZ;;sBAIA;eAAO,KAAK,iBAAiB,IAAI,mBAAmB,KAAK;;yBAIzD;eAAO,KAAK,iBAAiB,IAAI,sBAAsB,KAAK;;kBAGhD,MACZ;eAAO,KAAK,iBAAiB,IAAI,iBAAiB,KAAK,SAAS;;qBAGpB,SAAY,WAAW,OACnE;YAAI,UAAU,KAAK,WAAW;YAE1B,YAAY,MAAM;oBACZ,eAAe;gBAEnB,CAAC,UAAU;wBACL,gBAAgB;;;aAIvB;aACA,WAAW,KAAK;eACd;;eAIP;aAAK,QAAQ,SAAS;aACjB;eACS,KAAK,WAAW;;kBAGX;mBACC;;gBAGV,KACV;YAAI,UAAU,KAAK,cAAc;aAC5B,eAAe;eAEb;;kBAGK,KACZ;eAAO,KAAK,IAAI,cAAc,KAAK,KAAK;;mBAIxC;YAAI,SAAS,KAAK;YACd,UAAiB,KAAK;aAErB,eAAe,QAAQ;aAEvB,eAAe;aACf,aAAa;aAEb,YAAY,SAAS;aACrB,eAAe;;mBAGP,QAAwB,cACrC;aAAK,IAAI,aAAa,QAAQ,cAAc,KAAK;;mBAIjD;aAAK;aACA;;sBAGW,SAAyB,MAAc,cAAmC,MAC1F;aAAK,oBAAoB,SAAS,MAAM;;wBAGtB,SAAyB,OAAe,aAC1D;aAAK,YAAY,SAAS;YACtB,UAAU,IAAI,mBAAmB;aAChC,iBAAiB,SAAS;;uBAI/B;aAAK;aACA;;gBAGe,SAAyB,aAC7C;aAAK,YAAY,KAAK,IAAI,OAAO,SAAS;;sBAG1B,GAChB;aAAK,QAAQ,eAAe;;oBAGdA,WACd;aAAK,QAAQ,gBAAgBA;eACtBA;;kBAG4B,MACnC;aAAK,QAAQ,cAAc;eACpB;;mBAGM,SACb;aAAK,QAAQ,YAAY;eAClB;;uBAIP;aAAK,QAAQ;;eAGJ,QACT;eAAO,KAAK,cAAc,KAAK,aAAa;;iBAGjC;YACL,MAA8B;YAAzB;YAAS;;YAChB,OAAO,IAAI,eAAe;YAC1B,aAAa,SAAS,MAAM;eACzB;;iBAGI,MACX;aAAK,IAAI,aAAa,KAAK,SAAS,MAAM,KAAK;eACxC;;qBAGQ,UACf;YAAI,QAAQ,SAAS;YAEjB,OAAO;gBACL,MAAM,OAAO,KAAK,SAAS,OAAO,SAAS;iBAC1C,IAAI,aAAa,KAAK,SAAS,UAAU,KAAK;mBAC5C;eACF;mBACE,OAAO,KAAK,SAAS,KAAK,gBAAgB;;;iBAIxC,MACX;eAAO,KAAK,IAAI,iBAAiB,KAAK,SAAS,KAAK,aAAa;;iCAGtC,OAC3B;YAAI,UAAU,IAAI,sBAAsB,KAAK,+BAA+B;aACvE,gBAAgB;eACd;;mCAGsB,OAC7B;YAAI,SAAS,QAAQ;mBACZ,KAAK,eAAe;mBAClB,QAAQ,QAAQ;mBAClB,KAAK,eAAe;eACtB,IAAI,aAAa,QAAQ;mBACvB,KAAK,eAAe,MAAM;;YAC7B,WAAW,QAAQ;gBACnBA,YAAS,KAAK,iBAAiB;mBAC5B,IAAI,mBAAmBA,WAAQ,OAAO;eACxC,IAAI,OAAO,QAAQ;gBACpB,OAAO,KAAK,aAAa;mBACtB,IAAI,mBAAmB,OAAO,KAAK,SAAS,OAAO,MAAM;;eAG3D,KAAK,eAAe,OAAO;;iCAGP,OAC3B;YAAI,UAAU,IAAI,sBAAsB,KAAK,+BAA+B;aACvE,gBAAgB,QAAQ;eACtB;;mCAGsB,OAC7B;YAAI,SAAS,QAAQ;mBACZ,KAAK,iBAAiB;mBACpB,QAAQ,QAAQ;mBAClB,KAAK,iBAAiB;mBACpB,WAAW,QAAQ;gBACxBA,YAAS,KAAK,iBAAiB;mBAC5B,IAAI,mBAAmBA,WAAQ,OAAO;mBACpC,OAAO,QAAQ;gBACpB,OAAO,KAAK,aAAa;mBACtB,IAAI,mBAAmB,OAAO,KAAK,SAAS,OAAO,MAAM;eAC3D,IAAI,aAAa,QAAQ;gBAC1B,aAAa,MAAM;gBACnBA,YAAS,KAAK,aAAa;;mBAExB,IAAI,mBAAmBA,WAAQ,OAAO;;eAGxC,KAAK,iBAAiB,OAAO;;mBAGf,OACrB;YAAIA,YAAS,KAAK,aAAa;eACxB,IAAI,0BAA0BA,WAAQ,OAAO;;qBAG7B,OACvB;YAAI,WAAW,KAAK,aAAa;YAC7BA,YAAS,OAAO,KAAK,SAAS;eAC3B,IAAI,mBAAmBA,WAAQ,OAAO;;kBAGjC,QACZ;eAAO,KAAK,cAAc,KAAK,gBAAgB;;oBAGjC;YACR,MAA8B;YAAzB;YAAS;;YAChB,OAAO,IAAI,cAAc;YACzB,aAAa,SAAS,MAAM;eACzB;;mBAGM,MAAc,OAAe,WAC1C;aAAK,IAAI,aAAa,KAAK,cAAe,MAAM,OAAO;;kBAG3C,MAAc,OAC1B;aAAK,aAAc,QAAQ;;uBAGV,MAAc,OAAe,WAC9C;aAAK,eAAe,MAAM,OAAO;;wBAGf,MAAc,OAAe,UAAmB,WAClE;YAAI,UAAU,KAAK;YACf,mBAAmB,KAAK,IAAI,aAAa,SAAS,MAAM,UAAU;YAClE,YAAY,IAAI,iBAAiB,EAAE,SAAS,MAAM,WAAW,aAAa;kBAEpE,IAAI,MAAM,OAAO,KAAK;eAEzB;;;AAaX;gBAMsB,QAAA;aAAM,SALhB;aAAK,QAAsB;aACvB,OAAqB;aACb,eAA0B;aAC/B,UAAG;;;YAKZ,eAAiB;;YAEnB,gBAAgB,aAAa,QAAQ;iBAClC,IAAI,IAAE,GAAG,IAAE,aAAa,QAAQ,KAAK;6BAC3B,GAAG;;;;oBAMpB;eAAO,KAAK;;gBAIZ;eAAO,KAAK,SAAS,KAAK,MAAM;;eAIhC;eAAO,KAAK,QAAQ,KAAK,KAAK;;gBAGpB,SACV;aAAK,cAAc;aACd;;mBAIL;aAAK;;kBAGO,MACZ;YAAI,KAAK,YAAY,GAAG;YAEpB,CAAC,KAAK,OAAO;iBACV,QAAQ,IAAI,MAAM;;aAGpB,OAAO,IAAI,KAAK;;oBAGPA,WACd;YAAI,KAAK,YAAY,GAAG;YAEpB,CAAC,KAAK,OAAO;iBACV,QAAQA;;aAGV,OAAOA;;mBAGC,GACb;aAAK,eAAe,KAAK,gBAAgB;aACpC,aAAa,KAAK;;aAGhB,OACP;YAAI,CAAC,KAAK,OAAO;kBACT,cAAc;;;;AAK1B,MAAgC,2BAAQ;cAEpC;cAAM;cAEA;;;AAQV,MAAmC,8BAAQ;UACnC;YACE,eAAiB;;YAEnB,gBAAgB,aAAa,QAAQ;iBAClC,IAAI,IAAE,GAAG,IAAE,aAAa,QAAQ,KAAK;oBACpC,WAAW,aAAa;;;YAI5B,cAAc,MAAM;aAEnB,QAAQ;aACR,OAAO;aACP,eAAe;aACf,UAAU;eAER;;;AAIX;gBACsB,QAAgC,WAAhC;aAAM,SAAN;aAAyC,YAAT;aAC7C,SAAS;aACT,YAAY;;cAIjB;aAAK,UAAU,YAAY,QAAQ,KAAK;;oBAIxC;eAAO,KAAK;;gBAIZ;YAAI,OAAO,KAAK,UAAU;eACnB,QAAQ,KAAK;;eAIpB;YAAI,OAAO,KAAK,UAAU;eACnB,QAAQ,KAAK;;gBAGV;iBACVZ,YAAO,OAAO;;;iBAIdA,YAAO,OAAO;;kBAGF;iBACZA,YAAO,OAAO;;oBAGA,SAChB;mBAEe,IACf;aAES,QACT;;AAGF,uBAA8B,KAAkB,QAC9C;WAAO,kBAAkB,iBAAiB,KAAK;;;;gBC7hBnC,KAAkB,SAA6B,EAAE,mBAAmB,SAFxE;aAAU,aAA2B,IAAI;aAG1C,MAAM;aACN,YAAY,QAAQ;aACpB,MAAM,IAAI;aACV,mBAAmB;;YAGlB,SAAwB;YACxB,aAAe;;aAEhB,IAAI,SAAS;eAEX,MAAM;gBACP,WAAW,WAAW;gBAEtB,SAAS,KAAK,MAAM;gBAEpB,WAAW,MAAM;qBACd,WAAW;;;mBAIX,SAAS;;;QAIR,QACV;eAAc,KAAK,WAAW;;SAG3B,IACH;aAAK,MAAM,KAAK;;QAGd,KAAoB,SACtB;aAAK,WAAW,KAAK,IAAI,gBAAgB,MAAM,KAAK;;YAIpD;aAAK,MAAM;aACN,WAAW;;;AAgBpB,MAAkC,oBAAQ;gBAQrB,OAA2B,OAAgBY,WAA2B,UACvF;;aADsB,QAAL;aAAgC,QAP5C;aAAI,OAAG;aACH,OAAG;aACH,OAAG;aAQP,WAAW;aACX,SAASA;;oBAMd;eAAO,KAAK,OAAO;;gBAInB;eAAO,KAAK,OAAO;;eAInB;eAAO,KAAK,OAAO;;aAGZ,IACP;WAAG,IAAI,KAAK,UAAU;;cAItB;aAAK,OAAO;;iBAIZ;aAAK,MAAM,IAAI,WAAW,KAAK;;;AAInC,MAAuB,kBAAQ;gBASjB,OAAiB,OAAgBA,WAA0B,UACrE;cAAM,OAAO,OAAOA,WATf;aAAI,OAAG;aAUP,MAAM,KAAK,OAAO,aAAa,OAAO;;4BAI3C;aAAK,KAAK,MAAM,OAAO,aAAa,KAAK;;aAGlC,IACP;WAAG,IAAI,KAAK,UAAU;;;YAIhB;YAAOA;YAAQ;YAAU;YAAO,OAAe;YAAT;;iBAEnC;YAEL,eAAe,kBAAkB,OACnC,MAAM,KACNA,WACAA,UAAO,MAAM,MAAM;YAGjB,KAAK,GAAG,OAAO,OAAO;YAEtB,WAAW,IAAI;WAEhB,QAAQ,OAAO,MAChB;eAAG,QAAQ,gBAAgB,QAAQ,MAAM;eACtC,oBAAoB,KAAK;eACzB,WAAW;eACX,oBAAoB,KAAK;;aAGzB,OAAO;aACP,OAAO;;;AAIhB;gBAOsB,QAAiC,QAAjC;aAAM,SAAN;aAAuC,SAHnD;aAAS,YAAG;aACH,YAAG;aAGb,MAAM,OAAO;aACb,WAAW,OAAO;;WAGlB,KAAa,MAA6B,MAA6B;YACtEJ,SAA0B;YAArB;YAAQ;;YACf,cAAmC;YACnC,YAAiC;YAEjC,QAAQ;wBACEA,OAAI;0BACF,UAAU,UAAU;eAC7B;0BACS,KAAK;;YAGjB,KAAK,OAAO,eAAe;YAC3B,YAA+B;YAE7B,QAAU;;WAEb,QAAQ,OAAO,MAChB;mBAAI,OAAO,YAAY,GAAG,QAAQ,MAAM;eACrC,oBAAoB,KAAK,IAAI;eAC7B,WAAW;eACX,oBAAoB,KAAK,UAAU;;iBAG/B,aAAa,WAAY;aAE7B,YAAY;;WAGZ,MAAc,OAA8B,OACnD;SAEK,KAAa,OAA8B,OAA8B;YACtEA,SAAkB;YAAb;;YAEP,QAAQA,OAAI;YACZ,YAAYA,OAAI,WAAW;YAE3B,QAAQ;iBACC,OAAO,UAAU;eACvB;iBACM,OAAO,KAAK;;iBAGhB,OAAO;iBACP,aAAa,OAAO;;WAGxB;YACCA,SAAQ;;YACV,SAASA,OAAI;eACV;cACD;aACD,SAAS,OAAO;eACdA,OAAI;aAEN,YAAY;;WAIjB;aAAK,OAAO,sBAAsB,KAAK,aAAa,KAAK;;;AAI7D,MAA6B,wBAAQ;gBASvB,OAAiB,OAAgBI,WAAiB,UAAsC,WAClG;cAAM,OAAO,OAAOA,WATf;aAAI,OAAG;aACJ,MAAG;aAIO,eAAa;aAK1B,YAAY;YACb,OAAO,KAAK,OAAO,aAAa,OAAO;aACtC,MAAM,QAAQ,CAAC,UAAU,KAAK;;0BAGf,gBAAgB,MACpC;aAAK,eAAe,KAAK,UAAU,IAAI;YAEnC,eAAe;iBACZ,KAAK,MAAM,OAAO,aAAa,KAAK;;;aAIpC;YACD,YAA4B;YAAjB;;YAEb,CAAC,UAAU,IAAI,SAAS;gBACpBA,YAAW;gBACX,MAAQ;;gBAEV,SAAS,IAAI,cAAc;gBAC3B,YAAYA,UAAO,iBAAiB,QAAeA,UAAO;gBAE1D,SAAS,IAAI,yBAAyB,MAAM;gBAC5C,eAAe,IAAI,qBAAqB,EAAE,QAAQ;yBAEzC;iBAER,gBAAgB,YAAY;;;cAI7B,SAAS;;mBAGF;YACPA;YAAQ,QAAU;;YAEpB,eAAe,kBAAkB,iBACnC,MAAM,KACN,EAAE,SAASA,UAAO,iBAAiB;eAG9B,GAAG,OAAO,OAAO;;;AAI5B;gBAGsB,IAAgC,KAA4B,kBAA5D;aAAE,KAAF;aAAmC,MAAH;aAA4C,mBAAhB;aACzE,KAAK;aACL,MAAM;aACN,UAAU,IAAI;;SAGhB,IACH;aAAK,UAAU;;;YAIT;YAAS,MAAQ;;YACnB,SAAS,KAAK,UAAU,IAAI,SAAS;eAClC;;sBAIP;YAAI,KAAK,kBAAkB;iBACpB,iBAAiB;;;;;;gBCvUjB,KACC,SACA,UACAA,WAHD;aAAG,MAAH;aACQ,UAAP;aACQ,WAAR;aACM,SAANA;;aAGD,EAAE,mBAAmB,UAAU,EAAE,kBAAkB;YACpD,MAA2B;YAAtB;YAAS;;YAChB,KAAK,IAAI,WAAW,KAAK,SAAS,EAAE;WACrC,QAAQ,UAAU;;oBAIrB;eAAO,KAAK,OAAO;;gBAInB;eAAO,KAAK,OAAO;;eAInB;eAAO,KAAK,OAAO;;sBAInB;cAAM;;cAIN;aAAK,OAAO;cACN,KAAK;;;;;gBCHO,OAAwB,IAAmB,IAA3C;aAAK,QAAL;aAA0B,KAAF;aAAqB,KAAF;;;WARxD,QACL;eAAO,IAAI,KAAK,IAAI,GAAG,CAAC;;WAGnB,QAAQ,UACb;eAAO,IAAI,KAAK,SAAS,SAAS,GAAG,SAAS,SAAS;;SASpD,OACH;aAAK,MAAM,EAAE,KAAK,MAAM;;QAGtB,WAAW,KAAK,IAClB;aAAK,KAAK,KAAK,MAAM;;QAGhB,IAAI,GACT;YAAI,MAAM,KAAK,MAAM,KAAK;aACrB,MAAM;eACJ;;SAGD,SAAS,GACf;eAAO,KAAK,MAAM,KAAK,KAAK;;QAGvB,QAAgB,OAAO,KAAK,IACjC;eAAO,KAAK,MAAM,OAAO;;QAGvB,OAAe,QAAgB,OAAO,KAAK,IAC7C;aAAK,MAAM,OAAO,UAAU;;UAGZ,OAAe,KAC/B;eAAO,KAAK,MAAM,MAAM,OAAO;;YAGzB,OACN;YAAI,MAAM,KAAK,KAAK;YAChB,QAAQ,MAAM;eACX,KAAK,MAAM,MAAM,OAAO;;YAI/B;aAAK,MAAM,SAAS;;cAIpB;eAAO,KAAK,MAAM,MAAM,KAAK,IAAI,KAAK,KAAK;;;AAY/C;gBAqIY,SACD,KACP,OACA,cACQ,cAJA;aAAO,UAAP;aACE,MAAH;aAGa,eAxId;aAAiB,oBAAG,IAAI;aACd,aAAG,IAAI;aACC,sBAAG,IAAI;aACf,cAAG,IAAI;aACJ,iBAAG,IAAI;aAIhB,QAAG,gBAAgB;;aAIpB,MAAG,CAAC;aACL,KAAG,CAAC;aAEO,gBAAG;aA2Bf,KAAQ;aACR,KAAQ;aACR,KAAQ;aACR,KAAQ;aACR,KAAQ;aA4FV,MAAM;aACN,OAAO,QAAQ;aACf,YAAY,QAAQ;aACpB,eAAe;aACf,WAAW,KAAK;aAChB,kBAAkB,KAAK;;QA9H1B,KACF;eAAO,KAAK;;QAGV,GAAG;iBACLZ,YAAO,OAAO,UAAU,YAAY,SAAS,CAAC,kBAAkB,KAChE;;aAAK,MAAM;;QAGD,KACV;eAAO,KAAK,MAAM;;QAGR,GAAG,IACb;aAAK,MAAM,KAAK;;QAGN,KACV;eAAO,KAAK,MAAM;;QAGR,GAAG,IACb;aAAK,MAAM,KAAK;;;UAUZ,UACJ;aAAK,MAAM,KAAK,KAAK,SAAS;;;SAI3B,UACH;aAAK,SAAS,aAAa,KAAK,MAAM;;;eAI1B,UACZ;eAAO,KAAK,SAAS;;;cAIV,UAAoB,OAC/B;aAAK,SAAS,aAAa;;;gBAK3B;aAAK,MAAM,KAAK,KAAK;aAChB,MAAM,KAAK,KAAK;aAChB,KAAK,KAAK,KAAK;;;eAKpB;aAAK,KAAK,KAAK,KAAK;aACf,KAAK,KAAK,MAAM,IAAY;aAC5B,KAAK,KAAK,MAAM,IAAY;;;SAI9B,QACH;YAAI,OAAQ,KAAK,KAAN,SAAqB,KAAK;aAChC,KAAK;;;SAIP,QACH;aAAK,KAAK,KAAK;aACV,KAAK,KAAK,KAAK,QAAQ;;;aAIrB,QACP;YAAI,OAAQ,KAAK,KAAN,SAAqB,KAAK;aAChC,KAAK;;;aAKV;aAAK,KAAK,KAAK;;WAGV,QACL,SACA,KACA,MACA,MACA,cACA,cACA,QAEA;YAAI,YAAY,QAAQ,KAAK,YAAY;YACrC,QAAQ,MAAM,KAAK,MAAM;YAEzB,MAAM;YAIN,KAAK,IAAI,GAAG,SAAS,KAAK,OAAO,cAAc;WAChD,KAAK,GAAG,KAAK,QAAQ;WACrB,oBAAoB,KAAK,IAAI;eACzB;;WAGF,OAAO,EAAE,SAAS,KAAK,OAAO,gBAAyB,OAC5D;eAAO,IAAI,GAAG,SAAS,KAAK,OAAO,cAAc;;YAkB3C,MACN;;iBACO,KAAK;qBACD,KAAK;0BACA,KAAK;mBACZ,KAAK;mBACL,KAAK,MAAM,QALb;;;sBAUP;aAAK,YAAY,KAAK,KAAK,WAAW;;uBAItC;;;;;;;YAOI,MAAM,IAAI,YAAY;YAEtB,UAAU,KAAK;YACf,SAAS,KAAK,YAAY;YAC1B,OAAO,SAAS,QAAQ,SAAS,UAAU,QAAQ;YACnD,OAAO,QAAQ;YACf,MAAM,aAAa,IAAI,UAAU,MAAM;YAEvC,QAAQ,IAAI,wBAAwB,KAAK;gBAErC,aAAa,OAAO;gBACpB,OAAO,IAAI,gBAAgB;gBAC3B,OAAO;;UAGX,MACJ;YAAI,WAAW,IAAI;YAEf,QAAQ,KAAK,QAAQ;YACrB,UAAU,KAAK,WAAW;YAE1B,YAAY,IAAI,UAAU,KAAK,KAAK,UAAU,KAAK,KAAK,OAAO,SAAS;aAEvE,SAAS;;YAGR,MAAsC,OAC5C;YAAI,QAAQ,KAAK;cACX,KAAK;cACL,KAAK;YAEP,QAAQ,KAAK,QAAQ;YACrB,UAAU,KAAK,WAAW;;;;eAMvB,IAAI,UAAU,KAAK,KAAK,UAAU,KAAK,KAAK,OAAO,SAAS,IAAI;;cAG/D,KAAa,QACrB;aAAK,YAAY,IAAI,OAAO;aACvB,SAAS;;cAGN,eACR;YAAI,WAAW,IAAI;YAEf,QAAQ,KAAK,QAAQ;YACrB,UAAU,KAAK,WAAW,cAAc;YACxC,YAAY,KAAK,MAAM,OAA0B;YAEjD,OAAQ,KAAK,KAAN,gBAA4B,KAAK;YACxC,QAAQ,KAAK,KAAK,UAAU;YAE5B,SAAS,IAAI,gBAAgB,OAAO,OAAO,SAAS,UAAU;aAE7D,eAAe,KAAK;aAEpB,SAAS;;aAGC,QACf;aAAK,WAAW;aACX,oBAAoB,KAAK,OAAO;;WAIrC;aAAK,WAAW;aACX,oBAAoB;YAErB,SAAS,KAAK,WAAW;eAEtB;;eAIP;aAAK;aACA,eAAe;;eAGX,QACT;aAAK,WAAW,OAAO;;gBAIvB;eAAc,KAAK,eAAe;;eAIlC;eAAc,KAAK,oBAAoB;;eAIvC;eAAO,KAAK;;YAIZ;eAAc,KAAK,WAAW;;mBAI9B;eAAc,KAAK,kBAAkB;;qBAIrC;aAAK,WAAW,KAAK,KAAK,QAAQ;;uBAIlC;YAAI,QAAQ,KAAK,eAAe;aAC3B,kBAAkB,KAAK;eACrB;;kBAGK,MAAc,YAC1B;YAAI,QAAQ,MAAM,MAAM;YACpB,YAAY,MAAM,gBAAgB,KAAK;aACtC,WAAW,KAAK;eACd;;cAGC,OACR;aAAK,WAAW,KAAK;;eAIrB;aAAK,WAAW;;sBAIhB;aAAK,kBAAkB;;mBAGV,GACb;aAAK,WAAW,kBAAkB;;;cAMlC;eAAO,KAAK,QAAQ;;uBAGH,QACjB;eAAO,KAAK,QAAQ,UAAU;;;YAKxB,OAAiB,YACvB;aAAK,KAAK,KAAK,KAAK,QAAQ;YAExB,YAAY,WAAW;YAEvB;eAEG,MAAM;qBACF,KAAK;gBACV,OAAO,MAAM;;eAGZ,OAAO;;;YAIR,MAAoD;YAA/C;YAAS;YAAqB;;YACrC,SAAS,KAAK;YACd;YACA,WAAW,MAAM;2BACJ,SAAS,MAAM,QAAQ,OAAO;qBACpC,EAAE,MAAM,OAAO,OAAO;eAC1B;;iBAEA,MAAM;;sBAGH;uBACC,IAAI,aACT,KACA,SACO,oBAAoB,OAC3B,aANK;;;eAUJ;;;YAID,KAAgB;YAAZ;;YAEN,OAAO,CAAC,GAAG;mBACN;;;;;;;;8BAOM,KAAK,QAAQ,OAAO;;YAA7B;;YACF,gBAAgB,KAAK,gBAAgB;aACpC,MAAM;eAEJ,QAAQ,OAAO;;qBAGP,OACf;YAAI,QAAQ,KAAK;aAEb,IAAI,IAAE,MAAM,SAAS,GAAG,KAAG,GAAG,KAAK;gBACjC,OAAO,KAAK,UAAU,UAAU,MAAM;kBACpC,IAAI,MAAM,KAAK,MAAM;;;;;;gBCvYX,IAAA;aAAE,KAAF;;WAElB;eAAO,KAAK,GAAG;;;AAInB,IAAI,WAAW;AASf,yBAAwC,EAAE,IAAI,YAAY,MAAM,SAC9D;QAAI;QACA,KAAK,wBAAwB,UACjC;QAAI,SAAS,CAAC,SAAkC,YAC9C;YAAI,UAAU,UAAU,OAAO,IAAI,SAAS,QAAQ;YAChD,CAAC,aAAa;0BACF,KAAK,MAAM;;eAEpB,IAAI,kBAAkB,SAAS,EAAE,IAAI,OAAO,aAAa,UAAU;;WAErE,EAAE,IAAI,MAAM;;AAGrB;gBASsB,SAA6C;aAAtC,UAAP;aAAyD,eARrE;aAAM,SAA2B;aAC1B,UAA2B;YAQlC,QAAU;;aACX,UAAU,MAAM;aAChB,UAAU,MAAM;aAChB,aAAa,MAAM;aACnB,WAAW,aAAa;aACxB,KAAK,aAAa,gBAAgB,UACxC;;iBAEY;YACL,MAAwD;YAAnD;YAAM;;YAAc,qCAAO;YAAY;;YAE9C,SAAS,KAAK;YACd,SAAS,OAAO;YAEhB,KAAK,GAAG,QAAQ,KAAK,QAAQ,SAA0C,KAAK,MAAM,MAAM,cAAc,SAAS;eAC5G,IAAI,iBAAiB;;eAI5B;YAAI,KAAK,QAAQ,OAAO,KAAK;eACtB,KAAK,SAAS,WAAW,KAAK,cAAc,KAAK,SAAS;;gBAIjE;YAAI,KAAK,SAAS,OAAO,KAAK;eACvB,KAAK,UAAU,WAAW,KAAK,cAAc,KAAK,SAAS;;;AAItE,oBAAsC,QAAiC,SAAkC;QACjG,QAAoB;QAAb;QACP,UAAqB;QAAZ;;QACX,iBAAiB,OAAO,IAAI,SAAS,EAAE,WAAW;WAE/C,IAAI,mBAAmB,MAAM,YAAY,QAAQ,gBAAgB,EAAE,UAAU,SAAS;;;AC0N/F,mBAAmB,MACjB;WAAO,KAAK,aAAa;;AAG3B,2BAA2B,MACzB;QAAI,cAAc,KAAK,UAAW,MAAM;QAEpC,eAAe,YAAY,IAAI;eAC1B,OAAO,YAAY;WACrB;eACE;;;AAIX,4BAA4B,MAC1B;QAAI,cAAc,KAAK,UAAW,MAAM;QAEpC,eAAe,YAAY,IAAI;eAC1B,OAAO,YAAY;WACrB;eACE;;CAIX,AAIA,AAIA,AAIA,AAGA,AAOA,AASA;;;QC9XM;;;;;;;aAIa;;;;;;;;;yBAYJ,kBAAkB;;;;;;;;;;;QAY3B;;YAQF;kBACI;;eAIC;;;AAKT;kBAMc;YACV,QAAQ;;;mBAKH;;;;eAOA;;;MAOsB,8BAAQ;;;aAQlC;;;;;eAWG,kBAA0B;;;;;;;;;;;mBAyBvB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;YCpFP,OAAO;;YAKP;;kBAGM;;;;;;eAWH,UAAU;;;eAGR,OAA6B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;uBCxGP;;;gBCkBjB,QAA2B,UAP7B;aAAK,QAAQ;aACV,QAAyB;aACxB,SAAqC;aAC5B,kBAAQ;aACnB,QAAG;aACL,MAAQ;aAGX,SAAS;aACT,WAAW;;;YAIV;YAAiB;YAAU,QAAU;;YACvC,cAAc,KAAK;YAEnB,gBAAgB,QAAQ,gBAAgB,WAAW;mBAC7C,KAAK,QAAQ;;YAGnB,oBAAoB,aAAa;oBAC3B,KAAK;eACR;gBACD,gBAAgB,OAAO,gBAAgB,WAAWa,OAAK,IAAI,aAAa,iBAAiB,YAAYC;oBACjG,KAAK,QAAQ,IAAI,cAAc,aAAa,UAAU;;;;;eAOxD,KAAK,QAAQ,MAAO;;QAG1B,MACF;YAAI,SAAS,KAAK;YACd,QAAkB,QAAQ,OAAO,OAAO;eACpC,OAAO,QAAQ,IAAI,cAAc,MAAM;;YAI/C;eAAO;;iBAIP;YAAI,KAAK,QAAQ,OAAO,KAAK;eACrB,KAAK,SAAS;;mBAItB;YAAI,SAAS,KAAK,OAAO;aACpB,kBAAkB;eAChB;;CAIX;;;gBCzDc,QAHJ;aAAM,SAAG;aACP,MAAQ;aAGX,SAAS;;YAGH;eAAO,KAAK;;WAElB,QACL;aAAK,SAAS;;;QAIT,MACL;YAAI,SAAS,KAAK;YACd,QAAkB,QAAQ,OAAO,OAAO;eACpC,OAAO,QAAQ,IAAI,cAAc,MAAM;;aAGrC,MACV;YAAI,SAAS,KAAK;YACd,QAAkB,QAAQ,OAAO,OAAO;eACrC;;SAGJ,QACH;eAAO,KAAK,mBAAmB,OAAO,MAAM;;uBAG3B,OACjB;eAAO,MAAM,OAAO,CAAC,KAAK,SAAS,IAAI,IAAI,OAAiC;;YAI5E;eAAO;;;;ACzBX,MAAM,eAAe,EAAE,UAAW;AAElC;gBAKc,QAAa,WAFlB;aAAG,MAAG;aAGN,SAAS;;YAGN;eAAO;;aACP;YAGR;eAAO,KAAK,OAAO,KAAK;;QAGtB,MACF;eAAO,IAAI,UAAU,KAAK,OAAO,KAAK,WAAW;;;AAIrD;gBAIc,OAFL;aAAG,MAAG;aAGN,QAAQ;;WAGR,OACL;aAAK,QAAQ;;YAGL;eAAO;;aACP;YAGR;eAAO,KAAK;;uBAGK,QACjB;cAAM,IAAI,MAAM;;aAGT,OACP;cAAM,IAAI,MAAM;;QAGd,MACF;eAAO,IAAI,UAAU,KAAK,OAAO;;;AAIrC;gBAGc,QACV;aAAK,SAAS;;WAId;eAAO,IAAI,UAAU,KAAK;;;AAI9B,AAAO,MAAM,aAAa;AAE1B,MAAMC,mBAAiB,OAAO;AAE9B;gBAoCc,QAAa,EAAE,sBAAsB,+BANzC;aAAU,aAAyD;aAE5D,QAAsB;aACb,iBAA6C;aAC3C,mBAAsB;aAGzC,SAAS;aACT,uBAAwB,wBAAwBC;aAChD,8BAA8B,+BAA+BF;;WAtC7D,IAAI,KACT;YAAI,QAAQ,QAAQ,QAAQ,WAAW,OAAO,IAAID,OAAK,KAAK;YACxDE,iBAAe,KAAK,KAAK,YAAY,IAAI,OAAO,OAAO,IAAI;YAC3D,CAAC,OAAO,aAAa,MAAM,OAAO,IAAI,UAAU;YAEhD,YAAyBF;YAEzB,IAAI,eAAe,IAAI,YAAY,aAAa;gBAC9C,YAAuB,IAAI,YAAY;wBAC/B,UAAU;eACjB,IAAI,IAAI,aAAa;wBACd,IAAI,YAAY;;eAGtB,IAAI,QAAQ,IAAI,UAAU,KAAK;;WAGlC,OAAO,KACZ;eAAO,OAAO,QAAQ,YAAY,IAAI;;WAGjC,oBAAoB,MACzB;eAAO;;iBAmBI,UAAkB,WAC7B;YAAI,OAAO,KAAK,aAAa,KAAK,cAAc;YAC5C,MAAM,KAAK,YAAY,KAAK,aAAa,IAAI;YAC7C,IAAI;;wBAGU,UAAkB,MACpC;aAAK,iBAAiB,KAAK,kBAAkB;aACxC,eAAe,YAAY;;qBAGjB,UACf;YAAI,CAAC,KAAK,gBAAgB,OAAOC;eAC1B,KAAK,eAAe,aAAaA;;oBAG1B,UAAkB,WAChC;YAAI,CAAC,KAAK,YAAY;YAClB,MAAM,KAAK,WAAW;YACtB,OAAO;;wBAIX;aAAK,iBAAiB,KAAK,kBAAkB;eACtC,KAAK;;kBAGA,UACZ;YAAI,CAAC,KAAK,YAAY,OAAO;eACtB,KAAK,WAAW;;eAIvB;eAAQ,KAAK,QAAQ,KAAK,SAAS;;WAInC;eAAQ,KAAK,YAAY,KAAK,aAAa,IAAI,KAAK,qBAAqB,KAAK;;CAIlF,AAMA;;;gBCpKc,QAAa,UAAkB,QAFpC;aAAG,MAAQ;aAGX,SAAS;aACT,WAAW;;YAGR;eAAO,KAAK,OAAO,KAAK;;YAGhC;eAAO;;CAIX;;ACzBA;0CAGA,AAcA;;;;;;gBCcY;;;;;YAOR;;;iBAKO;;;;;kCAQyB;;;sCAKsC;YACtE;sCAC0B;;;YAK1B;;;sBAKY;;;;;YAMV;uBACO;;;;;;;;;;;;;;;;;;;;;;;;gBChDH;;;;;;;;;;;;;;;;;;;;;qBC2BG;;;;;;;YAYP;YAAU;;;YAEZ,YAAY,MAAM;YAElB;YAEA,aAAa;YAEb,OAAO;;eAKF;;;;;;oBAkBG;;;;;eASL;;;;;;YAGqB;;YACtB,iBAAiB,QAAQ;;;kBAIvB;aAEH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClHL,MAAM,aAAa;AAEnB,MAAM,kCAAkC;AACxC,MAAM,wBAAwB,OAAO,OAAO;AAqB5C;kBACE;;aAEiB,UAAa;aACd,SAA6B,CAAC;aAC9B,SAAkB;aACjB,UAAa;aACP,gBAAa;aAClB,WAAa;aACf,SAAa;aACV,YAAa;;UAE1B,OACJ;YAAI,QAAQ,KAAK,OAAO,QAAQ;YAE5B,QAAQ,CAAC,GAAG;mBACP;;eAGF,KAAK,OAAO,KAAK,SAAS;;aAG1B,UACP;eAAO,KAAK,UAAU,KAAK,YAAY;;WAGlC,OACL;YAAI,QAAQ,KAAK,QAAQ,QAAQ;YAE7B,QAAQ,CAAC,GAAG;mBACP;;eAGF,KAAK,QAAQ,KAAK,SAAS;;gBAGxB,SACV;YAAI,WAAqB,IAAI,MAAM,QAAQ;aAEtC,IAAI,IAAI,GAAG,IAAI,QAAQ,QAAQ,KAAK;qBAC9B,KAAK,KAAK,OAAO,QAAQ;;eAG7B,KAAK,MAAM;;UAGd,QACJ;YAAI,OAAO,WAAW,GAAG;mBAChB;;YAGL,QAAS,KAAK,OAAsB,QAAQ;YAE5C,QAAQ,CAAC,GAAG;mBACP;;eAGD,KAAK,OAAsB,KAAK,UAAU;;UAG9C,GACJ;YAAI,QAAQ,KAAK,OAAO,QAAQ;YAE5B,QAAQ,CAAC,GAAG;mBACP;;eAGF,KAAK,OAAO,KAAK,KAAK;;WAGxB,QACL;aAAK,SAAS,KAAK;eACZ,KAAK,QAAQ,KAAK;;iBAGd,OACX;YAAI,QAAQ,KAAK,cAAc,QAAQ;YAEnC,QAAQ,CAAC,GAAG;mBACP;;eAGF,KAAK,cAAc,KAAK,SAAS;;aAIxC;;qBACW,KAAK;oBACN,KAAK;oBACL,KAAK;qBACJ,KAAK;2BACC,KAAK;oBACZ,KAAK;uBACF,KAPN;;;;AAYX;AAwEA,MAAkC,kBAAQ;gBACrB,UAAsC,MACvD;;aADyB,WAAR;YAGb,MAAM;iBACH,UAAU,KAAK;iBACf,SAAS,KAAK;iBACd,SAAS,KAAK;iBACd,UAAU,KAAK;iBACf,gBAAgB,KAAK;iBACrB,SAAS,KAAK;iBACd,YAAY,KAAK;iBACjB,WAAW,KAAK,QAAQ,IAAI,MAAM;;;;aAKlC,OACP;eAAO,KAAK,OAAO;;gBAGT,OACV;eAAO,KAAK,UAAU;;cAGd,OACR;eAAO,KAAK,QAAQ;;mBAGP,OACb;YAAI,QAAQ,KAAK,SAAS;YACtB,SAAmB,IAAI,MAAM,MAAM;aAElC,IAAI,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;gBACjC,IAAI,MAAM;mBACP,KAAK,KAAK,UAAU;;eAGtB;;aAGA,OACP;eAAQ,KAAK,OAAsB;;mBAGC,OACpC;eAAO,KAAK,OAAO;;kBAGJ,GACf;YAAI,QAAQ,IAAI;YACZ,WAAW,KAAK,SAAS;YAEzB,aAAa,YAAY;gBACvB,SAAS,KAAK,QAAQ;uBACf,KAAK,SAAS,SAAS,KAAK,SAAS,QAAQ;;eAGnD;;oBAGU,GACjB;eAAO,KAAK,cAAc;;;AAI9B,MAA2B,sBAAQ;;iBACzB;aAAM,SAAa;;aAEf,OACV;eAAO,KAAK,OAAO,QAAQ;;UAGvB,OACJ;eAAO,KAAK,OAAO,KAAK;;;;;gBCzQN,MAAA;aAAI,OADjB;aAAM,SAAG;;QAGZ,OACF;YAAI,UAAU,KAAK,KAAK,UAAU,KAAK;eAChC,CAAC,CAAC,UAAU,qBAAqB,aAAa;;QAGnD,OACF;eAAQ,KAAK,KAAK,UAAU,KAAK,UAAU;;QAGzC,MACF;eAAO,KAAK,KAAK,UAAU,KAAK,SAAS;;QAGvC,MACF;eAAO,KAAK,KAAK,UAAU,KAAK,SAAS;;QAGvC,MACF;eAAO,KAAK,KAAK,UAAU,KAAK,SAAS;;;;ACnB7C,IAAK;AAAL,WAAK,gBACH;sDAAS;kDACJ;mDACC;oDACC;GAJJ,mBAAA,iBAKJ;AAED,MAAM,aAAa;AACnB,MAAM,cAAc;AACpB,MAAM,YAAa;AACnB,MAAM,aAAa;AACnB,MAAM,aAAa;AAEnB,yBAAyB,MAAc,WAAmB,OACxD;WAAO,OAAQ,aAAa,KAAM,SAAS;;AAG7C,qBAAqB,MAAc,UACjC;WAAO,OAAO,YAAY;;;;;;;;;;;;;;;;;;;;;;AAuB5B;gBAMc,gBAHJ;aAAM,SAAG;aACH,SAAG;YAGX;gBACI;gBAAQ,QAAkB;gBAAX;;iBAChB,OAAO,IAAI,YAAY;iBACvB,QAAQ;iBACR,SAAS,KAAK,KAAK;iBACnB,SAAS;eACT;iBACA,OAAO,IAAI,YAAY;iBACvB,QAAQ;;;SAIZ,MACH;aAAK,KAAK,KAAK,YAAY;;cAGnB,SACR;eAAO,KAAK,KAAK;;cAGT,SAAiB,OACzB;aAAK,KAAK,WAAW;;aAIrB;aAAK,MAAM,KAAK,KAAK,QAAQ;YACzB,SAAS,KAAK;aACb,UAAU;eACR;;iBAGI,QAAkB,WAC7B;YAAI,QAAQ,KAAK,MAAM;YACnB,SAAS,KAAK;YACd,kBAAkB,SAAS;YAC3B,OAAO,gBAAgB,iBAAiB,WAAW,eAAe;aACjE,MAAO,SAAsC,eAAe;;WAIjE;eAAO,KAAK;;;;;YAMN,QACN;eAAO,KAAK,MAAM;;cAGV,SACR;aAAK,MAAM,KAAK,SAAS,gBAAgB,GAAG,GAAG,eAAe;YAC1D,SAAS,KAAK;aACb,UAAU;eACR;;WAGF,QACL;eAIO,CAAC;;gBAGE,QACV;YAAI,OAAO,KAAK,MAAO,SAAsC;eACtD,CAAC,OAAO,eAAe;;SAG3B,QACH;YAAI,OAAO,KAAK,MAAO,SAAsC;aACxD,MAAO,SAAsC,eAAe,YAAY,MAAM,eAAe;;;;;;;;;;YAW9F,gBAAgB;YACd;YAAgB,cAAT;YAAmB,OAAS;;aAEpC,IAAI,IAAE,GAAG,IAAE,QAAQ,KAAG,YAAY;gBACjC,SAAS,MAAM;gBACf,OAAO,MAAM,IAAI;gBACjB,OAAO,OAAO;gBACd,QAAQ,OAAO,cAAc;gBAE7B,UAAU,eAAe,QAAQ;;uBAE1B,UAAU,eAAe,OAAO;;;;sBAInC,IAAI,eAAe,YAAY,MAAM,eAAe;iCACzC;uBACR,UAAU,eAAe,WAAW;qBACxC,IAAI,IAAE,QAAQ,KAAG,IAAE,MAAM,KAAK;yBAC5B,IAAI,iBAAiB,KAAK;;sBAG3B,KAAK,SAAS;mBACf,IAAI,UAAU,eAAe,SAAS;sBACrC,KAAK,SAAS;;;aAInB,SAAS,KAAK,SAAS;;cAI5B;;YACI,SAAS,MAAM,KAAK,MAAM,GAAG,KAAK;;oBAE5B,KAAK;mBACN,KAAK;oBAFP;;;;AAQX;gBAKqB,YAAgC,IAAI,sBAA6B,OAAO,IAAI,QAA5E;aAAS,YAAT;aAAqE,OAAJ;aAC7E,UAAU,IAAI,OAAO,KAAK;;WAG1B,QACL;aAAK,QAAQ,SAAS;eACf,KAAK;;;AAIhB;AAeA,MAAgC,gBAAQ,iBAEvC;AAED,eAAe,KAA6B,OAAe,KACzD;QAAI,eAAe,aAAa;YAC1B,IAAI,UAAU,WAAW;mBACpB,IAAI,MAAM,OAAO,KAAK;;YAG3B,MAAM,IAAI,YAAY;eAEnB,QAAQ,KAAK,SAAS;gBACvB,SAAU,IAAI;;eAGb,IAAI;;WAGN;;;qBC5NyB;QAC9B;;;;;;;YAYA;;;;;;;;;;;wBAgBiE;;;;;;;;;;0DAWjB;;;;;mBAOvC,UAAU;;;wBAGH;;WAEX;;;;;;eAME;mBACA;;;;;;;;;;;;;;;;;;uBC5DI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BCmGH;;oBAGJ;;;;;;;;;YAeJ,WAAW;;;;;;;YAUX,WAAW;;+BAGU;;eAGlB;;mBAGI;0BACG;6BAEK;kBACb;;;;;wBAOY;;gBAEZ;;;;8BACY;;gBAEZ;;sCAGyC;;8CAGb;;;qDAKS;oBACnC;;;;6CAIqB;;;sBAKjB;;;YAGR;YAEA,0BAA+C;;eAI5C,2BAA2B,MAAM;;0BAGtB;;;;;;;YAWd;gCAG0C;;;;iBAIrC;;;;;;8BAOW;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzNpB,mBAAe,EAAC,MAAK,UAAN,EAAiB,SAAQ,kXAAzB,EAA4Y,QAAO,EAAC,aAAY,uDAAb,EAAnZ,EAAf;;;gBCgF4B;wBAAA;;;;oBAWnB;;;;YAQL;;;;;;cAOI;YAEJ;;;;;;;;;;;;;;;;;;;;;;;;;kBAwCI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BCZa;;;;;;;;;;;;;;;;;;oBA2BP;+BACO;aAChB;;;;;;;;;;;;;;;;;;;;YA4BW;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;iBA2CK;gCACG;iBAEf;gCACa;;iBAGb;;4BAGS;;;;;;;;;;;;;;;4CAqBe;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;oBCnQjC;;;;;;;;;;;qBCiBe,aAAa,mDACnB,0CACM;;AAIf;;QAEI;;sBAGY;;;;;;eAOP;;4BAGa;;;;;;;;QAShB;kBACiB;;aAIhB,YAAY;YAEf,gBAAgB;YAEhBG,4BAA0B;;;;;;;;kBAWpB;;;;;;;;YAMN;;gBAGI;;;;;;;;;;;;;;;;;kBCpFe;QACnB,CAAC,MAAM;kBACD;;;;;;;;;;yCCQyB;oBACrB,GAAG;;;;;;;;;;sBCyBP;;;;;;;;;sBAcA;;;;+BAMG;;;;;;;;;;;;;oBAYL;;;;;;;;;;oBAWF;sBACA,aAAa;;;;;;;+BAMsC;mBAAS;;;;;;;;;;;;;;;;;;;;kBAwB1D;;+BAES;;;2BAKF,2BAA2B;+BACvB;;;;YAMf,SAAS,yBAAyB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;kBC5HpB;cAEJ;;;;;aAIY;;;;;;;;uBAOJ;8DAGF,KAAK,MAAN,2GAaP;;;;;;;;;aAYA;;;;;;;AA/BZ;AA2BI,YADC,6DAGA;;ACvCL,+CAAe,QAAK;;;;;;;;;;;;;;;YCGR;;;;;QAMJ;AAGR;;;;;;;;;qBAM0B;;;;;;uBAKK,iBAAD;;;;;;;;;;;aAajB;;;;;;;;;;;;ACpCb,mDAAe,QAAK;;;;;;;;;;;;;;;mCCAe;;YAErB;;;;;;;;;;;;;gBAUE;gBACA;;;;;;;;;oBAUI;;;;;;;;;;;;ACvBpB,oDAAe,QAAK;;ACMpB,gBAAe,EAAC,0DAA0DC,aAA3D,EAAqG,yDAAyDC,wCAA9J,EAAuM,8DAA8DC,iBAArQ,EAAmT,6DAA6DC,4CAAhX,EAA6Z,+DAA+DC,kBAA5d,EAA2gB,8DAA8DC,6CAAzkB,EAAf;;ACNA,4BAAe,EAAC,OAAM,EAAC,QAAO,oBAAR,EAA6B,YAAW,oBAAxC,EAAP,EAAqE,SAAQ,EAAC,eAAc,EAAC,wBAAuB,MAAxB,EAAf,EAA+C,aAAY,EAAC,wBAAuB,YAAxB,EAA3D,EAAiG,kBAAiB,EAAC,gBAAe,IAAhB,EAAlH,EAAwI,UAAS,EAAC,wBAAuB,YAAxB,EAAjJ,EAAuL,eAAc,EAAC,gBAAe,IAAhB,EAArM,EAA2N,YAAW,EAAC,wBAAuB,MAAxB,EAAtO,EAAsQ,YAAW,EAAC,wBAAuB,YAAxB,EAAjR,EAA7E,EAAqY,eAAc,EAAC,QAAO,EAAC,SAAQ,CAAC,aAAD,EAAe,UAAf,CAAT,EAAR,EAA6C,cAAa,EAAC,SAAQ,IAAT,EAAc,SAAQ,CAAC,WAAD,EAAa,gBAAb,EAA8B,UAA9B,EAAyC,QAAzC,EAAkD,aAAlD,CAAtB,EAAuF,eAAc,WAArG,EAAiH,sBAAqB,CAAC,OAAD,CAAtI,EAA1D,EAA2M,UAAS,EAAC,SAAQ,IAAT,EAAc,gBAAe,IAA7B,EAApN,EAAuP,SAAQ,EAAC,gBAAe,IAAhB,EAA/P,EAAnZ,EAAf;;;;YCQI;YAEA;;;;;;;;ACNJ,MAAM;AAEN;AAEA;;;IAKE;;;;;;;;"}